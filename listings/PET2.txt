bassrc......PAGE 0001

LINE# LOC   CODE        LINE


00001  0000              ;**********************************
00002  0000              ;*COMMODORE PET BASIC             *
00003  0000              ;*                                *
00004  0000              ;*VERSION 2                       *
00005  0000              ;*COPYRIGHT 1978 BY               *
00006  0000              ;*COMMODORE INTERNATIONAL LIMITED *
00007  0000              ;*ROMS PRODUCED: 901465-01        *
00008  0000              ;*               901465-02        *
00009  0000              ;*               901447-24        *
00010  0000              ;*RECONSTRUCTED: M.HOFFMANN-VETTER*
00011  0000              ;**********************************

00013  0000              OFFSET =$8000          ;RAM/ROM SWITCH
00014  0000              ROMLOC =$4000+OFFSET   ;START THIS VERSION

00016  0000              ;VERSION 1 - AUGUST 1977
00017  0000              ;     ORIGINAL MICROSOFT RELEASE
00018  0000              ;VERSION 2 - AUGUST 1978
00019  0000              ;     FIXED MANY BUGS SOME ARE:
00020  0000              ;     1) ARRAYS LIMITED TO 255
00021  0000              ;     2) NON-INTERRUPTABLE CODE
00022  0000              ;     3) GARBAGE COLLECT STRINGS



00024  0000              ;*****LISTING DATE: ??? ??, ????*****



00026  0000              ;CONSTANTS FROM PET OS
00027  0000              CTIMR  =$8D            ;(TIME)
00028  0000              CSTAT  =$96            ;(SATUS)
00029  0000              CHTIM  =$E844          ;(TIL)
00030  0000              TRMPOS =$C6            ;(PNTR)



00032  0000              ;OS ROUTINES IN JUMP TABLE
00033  0000                     * =$7FC0+OFFSET
00034  FFC0              COPEN  *=*+3           ;OPEN FILE
00035  FFC3              CCLOS  *=*+3           ;CLOSE FILE
00036  FFC6              COIN   *=*+3           ;OPEN INPUT CHAHNEL
00037  FFC9              COOUT  *=*+3           ;OPEN OUTPUT CHAHHEL
00038  FFCC              CLSCHN
00039  FFCC              CCCHN  *=*+3           ;CLOSE I/O CHANNELS
00040  FFCF              CINCH  *=*+3           ;INPUT CHARACTER(S)
00041  FFD2              OUTCH  *=*+3           ;OUTPUT CHARACTER
00042  FFD5              CLOAD  *=*+3           ;CASSETTE LOAD
00043  FFD8              CSAVE  *=*+3           ;CASSETTE SAVE
00044  FFDB              CVERF  *=*+3           ;CASSETTE VERIFY
00045  FFDE              CSYS   *=*+3           ;SYS FUNCTION
00046  FFE1              ISCNTC *=*+3           ;SCAN STOP KEY
00047  FFE4              CGETL  *=*+3           ;GET CHARACTER
00048  FFE7              CCALL  *=*+3           ;CLOSE ALL FILES







bassrc......PAGE 0002

LINE# LOC   CODE        LINE


00050  FFEA              LINLEN =40
00051  FFEA              FORSIZ =@22
00052  FFEA              BUFLEN =81
00053  FFEA              ADDPRC =1
00054  FFEA              BUFPAG =2
00055  FFEA              BUF    =512
00056  FFEA              STKEND =507
00057  FFEA              CLMWID =10
00058  FFEA              PI     =255
00059  FFEA              NUMLEV =23
00060  FFEA              STRSIZ =3
00061  FFEA              RAMLOC =$0400





00063  FFEA              ;ZERO PAGE STORAGE
00064  FFEA                     * =0
00065  0000              USRPOK *=*+3
00066  0003              INTEGR
00067  0003              CHARAC *=*+1
00068  0004              ENDCHR *=*+1
00069  0005              COUNT  *=*+1
00070  0006              DIMFLG *=*+1
00071  0007              VALTYP *=*+1
00072  0008              INTFLG *=*+1
00073  0009              GARBFL 
00074  0009              DORES  *=*+1
00075  000A              SUBFLG *=*+1
00076  000B              INPFLG *=*+1
00077  000C              DOMASK
00078  000C              TANSGN *=*+1
00079  000D              CNTWFL *=*+1
00080  000E              CHANNL *=*+1
00081  000F              LINWID *=*+1
00082  0010              NCMWFL *=*+1
00083  0011              POKER
00084  0011              LINNUM *=*+2
00085  0013              TEMPPT *=*+1
00086  0014              LASTPT *=*+2
00087  0016              TEMPST *=*+9
00088  001F              INDEX
00089  001F              INDEX1 *=*+2
00090  0021              INDEX2 *=*+2
00091  0023              RESHO  *=*+1
00092  0024              RESMOH *=*+1
00093  0025              ADDEND
00094  0025              RESMO  *=*+1
00095  0026              RESLO  *=*+1
00096  0027                     *=*+1
00097  0028              TXTTAB *=*+2
00098  002A              VARTAB *=*+2
00099  002C              ARYTAB *=*+2
00100  002E              STREND *=*+2






bassrc......PAGE 0003

LINE# LOC   CODE        LINE


00101  0030              FRETOP *=*+2
00102  0032              FRESPC *=*+2
00103  0034              MEMSIZ *=*+2
00104  0036              CURLIN *=*+2
00105  0038              OLDLIN *=*+2
00106  003A              OLDTXT *=*+2
00107  003C              DATLIN *=*+2
00108  003E              DATPTR *=*+2
00109  0040              INPPTR *=*+2
00110  0042              VARNAM *=*+2
00111  0044              FDECPT
00112  0044              VARPNT *=*+2
00113  0046              LSTPNT
00114  0046              ANDMSK
00115  0046              FORPNT *=*+2
00116  0048              EORMSK =FORPNT+1
00117  0048              VARTXT
00118  0048              OPPTR  *=*+2
00119  004A              OPMASK *=*+1
00120  004B              GRBPNT
00121  004B              TEMPF3
00122  004B              DEFPNT *=*+2
00123  004D              DSCPNT *=*+2
00124  004F                     *=*+1
00125  0050              FOUR6  *=*+1
00126  0051              JMPER  *=*+1
00127  0052              SIZE   *=*+1
00128  0053              OLDOV  *=*+1
00129  0054              TEMPF1 *=*+1
00130  0055              ARYPNT
00131  0055              HIGHDS *=*+2
00132  0057              HIGHTR *=*+2
00133  0059              TEMPF2 *=*+1
00134  005A              DECCNT
00135  005A              LOWDS  *=*+2
00136  005C              GRBTOP
00137  005C              DPTFLG
00138  005C              LOWTR  *=*+1
00139  005D              EXPSGN *=*+1
00140  005E              TENEXP =LOWDS+1
00141  005E              EPSGN  =LOWTR+1
00142  005E              DSCTMP
00143  005E              FAC
00144  005E              FACEXP *=*+1
00145  005F              FACHO  *=*+1
00146  0060              FACMOH *=*+1
00147  0061              INDICE
00148  0061              FACMO  *=*+1
00149  0062              FACLO  *=*+1
00150  0063              FACSGN *=*+1
00151  0064              DEGREE
00152  0064              SGNFLG *=*+1
00153  0065              BITS   *=*+1
00154  0066              ARGEXP *=*+1
00155  0067              ARGHO  *=*+1






bassrc......PAGE 0004

LINE# LOC   CODE        LINE


00156  0068              ARGMOH *=*+1
00157  0069              ARGMO  *=*+1
00158  006A              ARGLO  *=*+1
00159  006B              ARGSGN *=*+1
00160  006C              STRNG1
00161  006C              ARISGN *=*+1
00162  006D              FACOV  *=*+1
00163  006E              BUFPTR
00164  006E              STRNG2
00165  006E              POLYPT
00166  006E              CURTOL
00167  006E              FBUFPT *=*+2
00168  0070              CHRGET *=*+6
00169  0076              CHRGOT *=*+1
00170  0077              TXTPTR *=*+6
00171  007D              QNUM   *=*+10
00172  0087              CHRRTS *=*+1
00173  0088              RNDX   *=*+5





00175  008D                     * =$FF
00176  00FF              LOFBUF *=*+1
00177  0100              FBUFFR *=*+1
00178  0101              .FIL   TOKENS





00180  0101              ;STATEMENT DISPATCH TABLE
00181  0101                     * =ROMLOC



























bassrc......PAGE 0005

LINE# LOC   CODE        LINE


00183  C000  40 C7       STMDSP .WOR END-1
00184  C002  57 C6              .WOR FOR-1
00185  C004  1F CC              .WOR NEXT-1
00186  C006  FF C7              .WOR DATA-1
00187  C008  A6 CA              .WOR INPUTN-1
00188  C00A  C0 CA              .WOR INPUT-1
00189  C00C  62 CF              .WOR DIM-1
00190  C00E  06 CB              .WOR READ-1
00191  C010  AC C8              .WOR LET-1
00192  C012  AC C7              .WOR GOTO-1
00193  C014  84 C7              .WOR RUN-1
00194  C016  2F C8              .WOR IF-1
00195  C018  2F C7              .WOR RESTOR-1
00196  C01A  8F C7              .WOR GOSUB-1
00197  C01C  D9 C7              .WOR RETURN-1
00198  C01E  42 C8              .WOR REM-1
00199  C020  3E C7              .WOR STOP-1
00200  C022  52 C8              .WOR ONGOTO-1
00201  C024  0F D7              .WOR FNWAIT-1
00202  C026  D4 FF              .WOR CLOAD-1
00203  C028  D7 FF              .WOR CSAVE-1
00204  C02A  DA FF              .WOR CVERF-1
00205  C02C  8C D2              .WOR DEF-1
00206  C02E  06 D7              .WOR POKE-1
00207  C030  8A C9              .WOR PRINTN-1
00208  C032  AA C9              .WOR PRINT-1
00209  C034  6A C7              .WOR CONT-1
00210  C036  B4 C5              .WOR LIST-1
00211  C038  76 C5              .WOR CLEAR-1
00212  C03A  90 C9              .WOR CMD-1
00213  C03C  DD FF              .WOR CSYS-1
00214  C03E  BF FF              .WOR COPEN-1
00215  C040  C2 FF              .WOR CCLOS-1
00216  C042  7C CA              .WOR GET-1
00217  C044  5A C5              .WOR SCRATH-1
00218  C046  45 DB       FUNDSP .WOR SGN
00219  C048  D8 DB              .WOR INT
00220  C04A  64 DB              .WOR ABS
00221  C04C  00 00       USRLOC .WOR USRPOK
00222  C04E  59 D2              .WOR FRE
00223  C050  7A D2              .WOR POS
00224  C052  5E DE              .WOR SQR
00225  C054  7F DF              .WOR RND
00226  C056  F6 D8              .WOR LOG
00227  C058  DA DE              .WOR EXP
00228  C05A  D8 DF              .WOR COS
00229  C05C  DF DF              .WOR SIN
00230  C05E  28 E0              .WOR TAN
00231  C060  8C E0              .WOR ATN
00232  C062  E8 D6              .WOR PEEK
00233  C064  56 D6              .WOR LEN
00234  C066  3F D3              .WOR STRD
00235  C068  87 D6              .WOR VAL
00236  C06A  65 D6              .WOR ASC
00237  C06C  C6 D5              .WOR CHRD






bassrc......PAGE 0006

LINE# LOC   CODE        LINE


00238  C06E  DA D5              .WOR LEFTD
00239  C070  06 D6              .WOR RIGHTD
00240  C072  11 D6              .WOR MIDD
00241  C074  79          OPTAB  .BYT 121
00242  C075  75 D7              .WOR FADDT-1
00243  C077  79                 .BYT 121
00244  C078  35 D7              .WOR FSUBT-1
00245  C07A  7B                 .BYT 123
00246  C07B  36 D9              .WOR FMULTT-1
00247  C07D  7B                 .BYT 123
00248  C07E  1D DA              .WOR FDIVT-1
00249  C080  7F                 .BYT 127
00250  C081  67 DE              .WOR FPWRT-1
00251  C083  50                 .BYT 80
00252  C084  CA CE              .WOR ANDOP-1
00253  C086  46                 .BYT 70
00254  C087  C7 CE              .WOR OROP-1
00255  C089  7D          NEGTAB .BYT 125
00256  C08A  A0 DE              .WOR NEGOP-1
00257  C08C  5A          NOTTAB .BYT 90
00258  C08D  CE CD              .WOR NOTOP-1
00259  C08F  64          PTDORL .BYT 100
00260  C090  F7 CE              .WOR DOREL-1





00262  C092              ;RESERVED WORD LIST

00264  C092  45 4E       RESLST .BYT 'EN',$C4
00264  C094  C4 
00265  C095              ENDTK  =@200
00266  C095  46 4F              .BYT 'FO',$D2
00266  C097  D2 
00267  C098              FORTK  =@201
00268  C098  4E 45 58           .BYT 'NEX',$D4
00268  C09B  D4 
00269  C09C  44 41 54           .BYT 'DAT',$C1
00269  C09F  C1 
00270  C0A0              DATATK =@203
00271  C0A0  49 4E              .BYT 'INPUT',$A3
00271  C0A5  A3 
00272  C0A6  49 4E              .BYT 'INPU',$D4
00272  C0AA  D4 
00273  C0AB  44 49              .BYT 'DI',$CD
00273  C0AD  CD 
00274  C0AE  52 45 41           .BYT 'REA',$C4
00274  C0B1  C4 
00275  C0B2  4C 45              .BYT 'LE',$D4
00275  C0B4  D4 
00276  C0B5  47 4F 54           .BYT 'GOT',$CF
00276  C0B8  CF 
00277  C0B9              GOTOTK =@211
00278  C0B9  52 55              .BYT 'RU',$CE






bassrc......PAGE 0007

LINE# LOC   CODE        LINE


00278  C0BB  CE 
00279  C0BC  49                 .BYT 'I',$C6
00279  C0BD  C6 
00280  C0BE  52 45              .BYT 'RESTOR',$C5
00280  C0C4  C5 
00281  C0C5  47 4F              .BYT 'GOSU',$C2
00281  C0C9  C2 
00282  C0CA              GOSUTK =@215
00283  C0CA  52 45              .BYT 'RETUR',$CE
00283  C0CF  CE 
00284  C0D0  52 45              .BYT 'RE',$CD
00284  C0D2  CD 
00285  C0D3              REMTK  =@217
00286  C0D3  53 54 4F           .BYT 'STO',$D0
00286  C0D6  D0 
00287  C0D7  4F                 .BYT 'O',$CE
00287  C0D8  CE 
00288  C0D9  57 41 49           .BYT 'WAI',$D4
00288  C0DC  D4 
00289  C0DD  4C 4F 41           .BYT 'LOA',$C4
00289  C0E0  C4 
00290  C0E1  53 41 56           .BYT 'SAV',$C5
00290  C0E4  C5 
00291  C0E5  56 45              .BYT 'VERIF',$D9
00291  C0EA  D9 
00292  C0EB  44 45              .BYT 'DE',$C6
00292  C0ED  C6 
00293  C0EE  50 4F 4B           .BYT 'POK',$C5
00293  C0F1  C5 
00294  C0F2  50 52              .BYT 'PRINT',$A3
00294  C0F7  A3 
00295  C0F8  50 52              .BYT 'PRIN',$D4
00295  C0FC  D4 
00296  C0FD              PRINTK =@231
00297  C0FD  43 4F 4E           .BYT 'CON',$D4
00297  C100  D4 
00298  C101  4C 49 53           .BYT 'LIS',$D4
00298  C104  D4 
00299  C105  43 4C              .BYT 'CL',$D2
00299  C107  D2 
00300  C108  43 4D              .BYT 'CM',$C4
00300  C10A  C4 
00301  C10B  53 59              .BYT 'SY',$D3
00301  C10D  D3 
00302  C10E  4F 50 45           .BYT 'OPE',$CE
00302  C111  CE 
00303  C112  43 4C              .BYT 'CLOS',$C5
00303  C116  C5 
00304  C117  47 45              .BYT 'GE',$D4
00304  C119  D4 
00305  C11A  4E 45              .BYT 'NE',$D7
00305  C11C  D7 
00306  C11D              SCRATK =@242
00307  C11D              .FIL   TOKEN2
00308  C11D              ;TOKEN2






bassrc......PAGE 0008

LINE# LOC   CODE        LINE


00309  C11D  54 41 42           .BYT 'TAB',$A8
00309  C120  A8 
00310  C121              TABTK  =@243
00311  C121  54                 .BYT 'T',$CF
00311  C122  CF 
00312  C123              TOTK   =@244
00313  C123  46                 .BYT 'F',$CE
00313  C124  CE 
00314  C125              FNTK   =@245
00315  C125  53 50 43           .BYT 'SPC',$A8
00315  C128  A8 
00316  C129              SPCTK  =@246
00317  C129  54 48 45           .BYT 'THE',$CE
00317  C12C  CE 
00318  C12D              THENTK =@247
00319  C12D  4E 4F              .BYT 'NO',$D4
00319  C12F  D4 
00320  C130              NOTTK  =@250
00321  C130  53 54 45           .BYT 'STE',$D0
00321  C133  D0 
00322  C134              STEPTK =@251
00323  C134  AB                 .BYT $AB
00324  C135              PLUSTK =@252
00325  C135  AD                 .BYT $AD
00326  C136              MINUTK =@253
00327  C136  AA                 .BYT $AA
00328  C137  AF                 .BYT $AF
00329  C138  DE                 .BYT $DE
00330  C139  41 4E              .BYT 'AN',$C4
00330  C13B  C4 
00331  C13C  4F                 .BYT 'O',$D2
00331  C13D  D2 
00332  C13E  BE                 .BYT 190
00333  C13F              GREATK =@261
00334  C13F  BD                 .BYT $BD
00335  C140              EQULTK =@262
00336  C140  BC                 .BYT 188
00337  C141              LESSTK =@263
00338  C141  53 47              .BYT 'SG',$CE
00338  C143  CE 
00339  C144              ONEFUN =@264
00340  C144  49 4E              .BYT 'IN',$D4
00340  C146  D4 
00341  C147  41 42              .BYT 'AB',$D3
00341  C149  D3 
00342  C14A  55 53              .BYT 'US',$D2
00342  C14C  D2 
00343  C14D  46 52              .BYT 'FR',$C5
00343  C14F  C5 
00344  C150  50 4F              .BYT 'PO',$D3
00344  C152  D3 
00345  C153  53 51              .BYT 'SQ',$D2
00345  C155  D2 
00346  C156  52 4E              .BYT 'RN',$C4
00346  C158  C4 






bassrc......PAGE 0009

LINE# LOC   CODE        LINE


00347  C159  4C 4F              .BYT 'LO',$C7
00347  C15B  C7 
00348  C15C  45 58              .BYT 'EX',$D0
00348  C15E  D0 
00349  C15F  43 4F              .BYT 'CO',$D3
00349  C161  D3 
00350  C162  53 49              .BYT 'SI',$CE
00350  C164  CE 
00351  C165  54 41              .BYT 'TA',$CE
00351  C167  CE 
00352  C168  41 54              .BYT 'AT',$CE
00352  C16A  CE 
00353  C16B  50 45 45           .BYT 'PEE',$CB
00353  C16E  CB 
00354  C16F  4C 45              .BYT 'LE',$CE
00354  C171  CE 
00355  C172  53 54 52           .BYT 'STR',$A4
00355  C175  A4 
00356  C176  56 41              .BYT 'VA',$CC
00356  C178  CC 
00357  C179  41 53              .BYT 'AS',$C3
00357  C17B  C3 
00358  C17C  43 48 52           .BYT 'CHR',$A4
00358  C17F  A4 
00359  C180              LASNUM =@307
00360  C180  4C 45              .BYT 'LEFT',$A4
00360  C184  A4 
00361  C185  52 49              .BYT 'RIGHT',$A4
00361  C18A  A4 
00362  C18B  4D 49 44           .BYT 'MID',$A4
00362  C18E  A4 
00363  C18F  47                 .BYT 'G',$CF
00363  C190  CF 
00364  C191              GOTK   =@313
00365  C191  00                 .BYT 0

00367  C192              ;BASIC ERROR MESSAGES

00369  C192  4E 45       ERRTAB .BYT 'NEXT WITHOUT FO',$D2
00369  C1A1  D2 
00370  C1A2              ERRNF  =@0
00371  C1A2  53 59              .BYT 'SYNTA',$D8
00371  C1A7  D8 
00372  C1A8              ERRSN  =@20
00373  C1A8  52 45              .BYT 'RETURN WITHOUT GOSU',$C2
00373  C1BB  C2 
00374  C1BC              ERRRG  =@26
00375  C1BC  4F 55              .BYT 'OUT OF DAT',$C1
00375  C1C6  C1 
00376  C1C7              ERROD  =@52
00377  C1C7  49 4C              .BYT 'ILLEGAL QUANTIT',$D9
00377  C1D6  D9 
00378  C1D7              ERRFC  =@65
00379  C1D7  4F 56              .BYT 'OVERFLO',$D7
00379  C1DE  D7 






bassrc......PAGE 000A

LINE# LOC   CODE        LINE


00380  C1DF              ERROV  =@105
00381  C1DF  4F 55              .BYT 'OUT OF MEMOR',$D9
00381  C1EB  D9 
00382  C1EC              ERROM  =@115
00383  C1EC  55 4E              .BYT 'UNDEF',$27
00383  C1F1  27 
00384  C1F2  44 20              .BYT 'D STATEMEN',$D4
00384  C1FC  D4 
00385  C1FD              ERRUS  =@132
00386  C1FD  42 41              .BYT 'BAD SUBSCRIP',$D4
00386  C209  D4 
00387  C20A              ERRBS  =@153
00388  C20A  52 45              .BYT 'REDIM',$27,'D ARRA',$D9
00388  C20F  27 
00388  C210  44 20 
00388  C216  D9 
00389  C217              ERRDD  =@170
00390  C217  44 49              .BYT 'DIVISION BY ZER',$CF
00390  C226  CF 
00391  C227              ERRDVO =@205
00392  C227  49 4C              .BYT 'ILLEGAL DIREC',$D4
00392  C234  D4 
00393  C235              ERRID  =@225
00394  C235  54 59              .BYT 'TYPE MISMATC',$C8
00394  C241  C8 
00395  C242              ERRTM  =@243
00396  C242  53 54              .BYT 'STRING TOO LON',$C7
00396  C250  C7 
00397  C251              ERRLS  =@260
00398  C251  46 49              .BYT 'FILE DAT',$C1
00398  C259  C1 
00399  C25A              ERRBD  =@277
00400  C25A  46 4F              .BYT 'FORMULA TOO COMPLE',$D8
00400  C26C  D8 
00401  C26D              ERRST  =@310
00402  C26D  43 41 4E           .BYT 'CAN',$27,'T CONTINU',$C5
00402  C270  27 
00402  C271  54 20 
00402  C27A  C5 
00403  C27B              ERRCN  =@333
00404  C27B  55 4E              .BYT 'UNDEF',$27,'D FUNCTIO',$CE
00404  C280  27 
00404  C281  44 20 
00404  C28A  CE 
00405  C28B              ERRUF  =@351
00406  C28B  20 45       ERR    .BYT ' ERROR',0
00406  C291  00 
00407  C292  20 49       INTXT  .BYT ' IN ',0
00407  C296  00 
00408  C297  0D          REDDY  .BYT $D,$A,'READY.',$D,$A,0
00408  C298  0A 
00408  C299  52 45 
00408  C29F  0D 
00408  C2A0  0A 
00408  C2A1  00 






bassrc......PAGE 000B

LINE# LOC   CODE        LINE


00409  C2A2  0D          BRKTXT .BYT $D,$A,'BREAK',0
00409  C2A3  0A 
00409  C2A4  42 52 
00409  C2A9  00 

























































PET BASIC......PAGE 000C

LINE# LOC   CODE        LINE


00411  C2AA              ;START OF INTERPRETER CODE
00412  C2AA  BA          FNDFOR TSX
00413  C2AB  E8                 INX
00414  C2AC  E8                 INX
00415  C2AD  E8                 INX
00416  C2AE  E8                 INX
00417  C2AF  BD 01 01    FFLOOP LDA 257,X
00418  C2B2  C9 81              CMP #FORTK
00419  C2B4  D0 21              BNE FFRTS
00420  C2B6  A5 47              LDA FORPNT+1
00421  C2B8  D0 0A              BNE CMPFOR
00422  C2BA  BD 02 01           LDA 258,X
00423  C2BD  85 46              STA FORPNT
00424  C2BF  BD 03 01           LDA 259,X
00425  C2C2  85 47              STA FORPNT+1
00426  C2C4  DD 03 01    CMPFOR CMP 259,X
00427  C2C7  D0 07              BNE ADDFRS
00428  C2C9  A5 46              LDA FORPNT
00429  C2CB  DD 02 01           CMP 258,X
00430  C2CE  F0 07              BEQ FFRTS
00431  C2D0  8A          ADDFRS TXA
00432  C2D1  18                 CLC
00433  C2D2  69 12              ADC #FORSIZ
00434  C2D4  AA                 TAX
00435  C2D5  D0 D8              BNE FFLOOP
00436  C2D7  60          FFRTS  RTS
00437  C2D8  20 28 C3    BLTU   JSR REASON
00438  C2DB  85 2E              STA STREND
00439  C2DD  84 2F              STY STREND+1
00440  C2DF  38          BLTUC  SEC
00441  C2E0  A5 57              LDA HIGHTR
00442  C2E2  E5 5C              SBC LOWTR
00443  C2E4  85 1F              STA INDEX
00444  C2E6  A8                 TAY
00445  C2E7  A5 58              LDA HIGHTR+1
00446  C2E9  E5 5D              SBC LOWTR+1
00447  C2EB  AA                 TAX
00448  C2EC  E8                 INX
00449  C2ED  98                 TYA
00450  C2EE  F0 23              BEQ DECBLT
00451  C2F0  A5 57              LDA HIGHTR
00452  C2F2  38                 SEC
00453  C2F3  E5 1F              SBC INDEX
00454  C2F5  85 57              STA HIGHTR
00455  C2F7  B0 03              BCS BLT1
00456  C2F9  C6 58              DEC HIGHTR+1
00457  C2FB  38                 SEC
00458  C2FC  A5 55       BLT1   LDA HIGHDS
00459  C2FE  E5 1F              SBC INDEX
00460  C300  85 55              STA HIGHDS
00461  C302  B0 08              BCS MOREN1
00462  C304  C6 56              DEC HIGHDS+1
00463  C306  90 04              BCC MOREN1
00464  C308  B1 57       BLTLP  LDA (HIGHTR)Y
00465  C30A  91 55              STA (HIGHDS)Y






PET BASIC......PAGE 000D

LINE# LOC   CODE        LINE


00466  C30C  88          MOREN1 DEY
00467  C30D  D0 F9              BNE BLTLP
00468  C30F  B1 57              LDA (HIGHTR),Y
00469  C311  91 55              STA (HIGHDS),Y
00470  C313  C6 58       DECBLT DEC HIGHTR+1
00471  C315  C6 56              DEC HIGHDS+1
00472  C317  CA                 DEX
00473  C318  D0 F2              BNE MOREN1
00474  C31A  60                 RTS
00475  C31B  0A          GETSTK ASL A
00476  C31C  69 3E              ADC #NUMLEV+NUMLEV+16
00477  C31E  B0 35              BCS OMERR
00478  C320  85 1F              STA INDEX
00479  C322  BA                 TSX
00480  C323  E4 1F              CPX INDEX
00481  C325  90 2E              BCC OMERR
00482  C327  60                 RTS
00483  C328  C4 31       REASON CPY FRETOP+1
00484  C32A  90 28              BCC REARTS
00485  C32C  D0 04              BNE TRYMOR
00486  C32E  C5 30              CMP FRETOP
00487  C330  90 22              BCC REARTS
00488  C332  48          TRYMOR PHA
00489  C333  A2 09              LDX #8+ADDPRC
00490  C335  98                 TYA
00491  C336  48          REASAV PHA
00492  C337  B5 54              LDA HIGHDS-1,X
00493  C339  CA                 DEX
00494  C33A  10 FA              BPL REASAV
00495  C33C  20 00 D4           JSR GARBA2
00496  C33F  A2 F7              LDX #248-ADDPRC
00497  C341  68          REASTO PLA
00498  C342  95 5E              STA HIGHDS+8+ADDPRC,X
00499  C344  E8                 INX
00500  C345  30 FA              BMI REASTO
00501  C347  68                 PLA
00502  C348  A8                 TAY
00503  C349  68                 PLA
00504  C34A  C4 31              CPY FRETOP+1
00505  C34C  90 06              BCC REARTS
00506  C34E  D0 05              BNE OMERR
00507  C350  C5 30              CMP FRETOP
00508  C352  B0 01              BCS OMERR
00509  C354  60          REARTS RTS
00510  C355              .FIL   CODE1
00511  C355              ;*****CODE1*****
00512  C355  A2 4D       OMERR  LDX #ERROM



00514  C357  46 0D       ERROR  LSR CNTWFL
00515  C359  A5 0E              LDA CHANNL
00516  C35B  F0 07              BEQ ERRCRD
00517  C35D  20 CC FF           JSR CLSCHN
00518  C360  A9 00              LDA #0






PET BASIC......PAGE 000E

LINE# LOC   CODE        LINE


00519  C362  85 0E              STA CHANNL
00520  C364  20 E2 C9    ERRCRD JSR CRDO
00521  C367  20 43 CA           JSR OUTQST
00522  C36A  BD 92 C1    GETERR LDA ERRTAB,X
00523  C36D  48                 PHA
00524  C36E  29 7F              AND #127
00525  C370  20 45 CA           JSR OUTDO
00526  C373  E8                 INX
00527  C374  68                 PLA
00528  C375  10 F3              BPL GETERR
00529  C377  20 93 C5    TYPERR JSR STKINI
00530  C37A  A9 8B              LDA #<ERR
00531  C37C  A0 C2              LDY #>ERR
00532  C37E  20 1C CA    ERRFIN JSR STROUT
00533  C381  A4 37              LDY CURLIN+1
00534  C383  C8                 INY
00535  C384  F0 03              BEQ READY
00536  C386  20 CE DC           JSR INPRT



00538  C389  46 0D       READY  LSR CNTWFL
00539  C38B  A9 97              LDA #<REDDY
00540  C38D  A0 C2              LDY #>REDDY
00541  C38F  20 1C CA           JSR STROUT



00543  C392  20 6F C4    MAIN   JSR INLIN
00544  C395  86 77              STX TXTPTR
00545  C397  84 78              STY TXTPTR+1
00546  C399  20 70 00           JSR CHRGET
00547  C39C  AA                 TAX
00548  C39D  F0 F3              BEQ MAIN
00549  C39F  A2 FF              LDX #255
00550  C3A1  86 37              STX CURLIN+1
00551  C3A3  90 06              BCC MAIN1
00552  C3A5  20 95 C4           JSR CRUNCH
00553  C3A8  4C F7 C6           JMP GONE
00554  C3AB  20 73 C8    MAIN1  JSR LINGET
00555  C3AE  20 95 C4           JSR CRUNCH
00556  C3B1  84 05              STY COUNT
00557  C3B3  20 2C C5           JSR FNDLIN
00558  C3B6  90 44              BCC NODEL
00559  C3B8  A0 01              LDY #1
00560  C3BA  B1 5C              LDA (LOWTR)Y
00561  C3BC  85 20              STA INDEX1+1
00562  C3BE  A5 2A              LDA VARTAB
00563  C3C0  85 1F              STA INDEX1
00564  C3C2  A5 5D              LDA LOWTR+1
00565  C3C4  85 22              STA INDEX2+1
00566  C3C6  A5 5C              LDA LOWTR
00567  C3C8  88                 DEY
00568  C3C9  F1 5C              SBC (LOWTR)Y
00569  C3CB  18                 CLC






PET BASIC......PAGE 000F

LINE# LOC   CODE        LINE


00570  C3CC  65 2A              ADC VARTAB
00571  C3CE  85 2A              STA VARTAB
00572  C3D0  85 21              STA INDEX2
00573  C3D2  A5 2B              LDA VARTAB+1
00574  C3D4  69 FF              ADC #255
00575  C3D6  85 2B              STA VARTAB+1
00576  C3D8  E5 5D              SBC LOWTR+1
00577  C3DA  AA                 TAX
00578  C3DB  38                 SEC
00579  C3DC  A5 5C              LDA LOWTR
00580  C3DE  E5 2A              SBC VARTAB
00581  C3E0  A8                 TAY
00582  C3E1  B0 03              BCS QDECT1
00583  C3E3  E8                 INX
00584  C3E4  C6 22              DEC INDEX2+1
00585  C3E6  18          QDECT1 CLC
00586  C3E7  65 1F              ADC INDEX1
00587  C3E9  90 03              BCC MLOOP
00588  C3EB  C6 20              DEC INDEX1+1
00589  C3ED  18                 CLC
00590  C3EE  B1 1F       MLOOP  LDA (INDEX1)Y
00591  C3F0  91 21              STA (INDEX2)Y
00592  C3F2  C8                 INY
00593  C3F3  D0 F9              BNE MLOOP
00594  C3F5  E6 20              INC INDEX1+1
00595  C3F7  E6 22              INC INDEX2+1
00596  C3F9  CA                 DEX
00597  C3FA  D0 F2              BNE MLOOP
00598  C3FC  20 72 C5    NODEL  JSR RUNC
00599  C3FF  20 42 C4           JSR LNKPRG
00600  C402  AD 00 02           LDA BUF
00601  C405  F0 8B              BEQ MAIN
00602  C407  18                 CLC
00603  C408  A5 2A              LDA VARTAB
00604  C40A  85 57              STA HIGHTR
00605  C40C  65 05              ADC COUNT
00606  C40E  85 55              STA HIGHDS
00607  C410  A4 2B              LDY VARTAB+1
00608  C412  84 58              STY HIGHTR+1
00609  C414  90 01              BCC NODELC
00610  C416  C8                 INY
00611  C417  84 56       NODELC STY HIGHDS+1
00612  C419  20 D8 C2           JSR BLTU
00613  C41C  A5 11              LDA LINNUM
00614  C41E  A4 12              LDY LINNUM+1
00615  C420  8D FE 01           STA BUF-2
00616  C423  8C FF 01           STY BUF-1
00617  C426  A5 2E              LDA STREND
00618  C428  A4 2F              LDY STREND+1
00619  C42A  85 2A              STA VARTAB
00620  C42C  84 2B              STY VARTAB+1
00621  C42E  A4 05              LDY COUNT
00622  C430  88                 DEY
00623  C431  B9 FC 01    STOLOP LDA BUF-4,Y
00624  C434  91 5C              STA (LOWTR)Y






PET BASIC......PAGE 0010

LINE# LOC   CODE        LINE


00625  C436  88                 DEY
00626  C437  10 F8              BPL STOLOP
00627  C439  20 72 C5    FINI   JSR RUNC
00628  C43C  20 42 C4           JSR LNKPRG
00629  C43F  4C 92 C3           JMP MAIN
00630  C442  A5 28       LNKPRG LDA TXTTAB
00631  C444  A4 29              LDY TXTTAB+1
00632  C446  85 1F              STA INDEX
00633  C448  84 20              STY INDEX+1
00634  C44A  18                 CLC
00635  C44B  A0 01       CHEAD  LDY #1
00636  C44D  B1 1F              LDA (INDEX)Y
00637  C44F  F0 1D              BEQ LNKRTS
00638  C451  A0 04              LDY #4
00639  C453  C8          CZLOOP INY
00640  C454  B1 1F              LDA (INDEX)Y
00641  C456  D0 FB              BNE CZLOOP
00642  C458  C8                 INY
00643  C459  98                 TYA
00644  C45A  65 1F              ADC INDEX
00645  C45C  AA                 TAX
00646  C45D  A0 00              LDY #0
00647  C45F  91 1F              STA (INDEX)Y
00648  C461  A5 20              LDA INDEX+1
00649  C463  69 00              ADC #0
00650  C465  C8                 INY
00651  C466  91 1F              STA (INDEX)Y
00652  C468  86 1F              STX INDEX
00653  C46A  85 20              STA INDEX+1
00654  C46C  90 DD              BCC CHEAD
00655  C46E  60          LNKRTS RTS
00656  C46F  A2 00       INLIN  LDX #0
00657  C471  20 81 C4    INLINC JSR INCHR
00658  C474  C9 0D              CMP #13
00659  C476  F0 06              BEQ FININ1
00660  C478  9D 00 02           STA BUF,X
00661  C47B  E8                 INX
00662  C47C  D0 F3              BNE INLINC
00663  C47E  4C D5 C9    FININ1 JMP FININL
00664  C481  20 CF FF    INCHR  JSR CINCH
00665  C484  A4 0E              LDY CHANNL
00666  C486  D0 0C              BNE INCRTS
00667  C488  C9 0F              CMP #$0F
00668  C48A  D0 08              BNE INCRTS
00669  C48C  48                 PHA
00670  C48D  A5 0D              LDA CNTWFL
00671  C48F  49 FF              EOR #$FF
00672  C491  85 0D              STA CNTWFL
00673  C493  68                 PLA
00674  C494  60          INCRTS RTS
00675  C495              .FIL   CODE2
00676  C495              ;*****CODE2*****
00677  C495              BUFOFS =@1000
00678  C495  A6 77       CRUNCH LDX TXTPTR
00679  C497  A0 04              LDY #4






PET BASIC......PAGE 0011

LINE# LOC   CODE        LINE


00680  C499  84 09              STY DORES
00681  C49B  BD 00 02    KLOOP  LDA BUFOFS,X
00682  C49E  10 07              BPL CMPSPC
00683  C4A0  C9 FF              CMP #PI
00684  C4A2  F0 3E              BEQ STUFFH
00685  C4A4  E8                 INX
00686  C4A5  D0 F4              BNE KLOOP
00687  C4A7  C9 20       CMPSPC CMP #' 
00688  C4A9  F0 37              BEQ STUFFH
00689  C4AB  85 04              STA ENDCHR
00690  C4AD  C9 22              CMP #34
00691  C4AF  F0 56              BEQ STRNG
00692  C4B1  24 09              BIT DORES
00693  C4B3  70 2D              BVS STUFFH
00694  C4B5  C9 3F              CMP #'?
00695  C4B7  D0 04              BNE KLOOP1
00696  C4B9  A9 99              LDA #PRINTK
00697  C4BB  D0 25              BNE STUFFH
00698  C4BD  C9 30       KLOOP1 CMP #'0
00699  C4BF  90 04              BCC MUSTCR
00700  C4C1  C9 3C              CMP #60
00701  C4C3  90 1D              BCC STUFFH
00702  C4C5  84 6E       MUSTCR STY BUFPTR
00703  C4C7  A0 00              LDY #0
00704  C4C9  84 05              STY COUNT
00705  C4CB  88                 DEY
00706  C4CC  86 77              STX TXTPTR
00707  C4CE  CA                 DEX
00708  C4CF  C8          RESER  INY
00709  C4D0  E8                 INX
00710  C4D1  BD 00 02    RESCON LDA BUFOFS,X
00711  C4D4  38                 SEC
00712  C4D5  F9 92 C0           SBC RESLST,Y
00713  C4D8  F0 F5              BEQ RESER
00714  C4DA  C9 80              CMP #128
00715  C4DC  D0 30              BNE NTHIS
00716  C4DE  05 05              ORA COUNT
00717  C4E0  A4 6E       GETBPT LDY BUFPTR
00718  C4E2  E8          STUFFH INX
00719  C4E3  C8                 INY
00720  C4E4  99 FB 01           STA BUF-5,Y
00721  C4E7  B9 FB 01           LDA BUF-5,Y
00722  C4EA  F0 36              BEQ CRDONE
00723  C4EC  38                 SEC
00724  C4ED  E9 3A              SBC #':
00725  C4EF  F0 04              BEQ COLIS
00726  C4F1  C9 49              CMP #DATATK-$3A
00727  C4F3  D0 02              BNE NODATT
00728  C4F5  85 09       COLIS  STA DORES
00729  C4F7  38          NODATT SEC
00730  C4F8  E9 55              SBC #REMTK-$3A
00731  C4FA  D0 9F              BNE KLOOP
00732  C4FC  85 04              STA ENDCHR
00733  C4FE  BD 00 02    STR1   LDA BUFOFS,X
00734  C501  F0 DF              BEQ STUFFH






PET BASIC......PAGE 0012

LINE# LOC   CODE        LINE


00735  C503  C5 04              CMP ENDCHR
00736  C505  F0 DB              BEQ STUFFH
00737  C507  C8          STRNG  INY
00738  C508  99 FB 01           STA BUF-5,Y
00739  C50B  E8                 INX
00740  C50C  D0 F0              BNE STR1
00741  C50E  A6 77       NTHIS  LDX TXTPTR
00742  C510  E6 05              INC COUNT



00744  C512              ;LOOK FOR END OF RESERVED WORD
00745  C512  C8          NTHIS1 INY
00746  C513  B9 91 C0           LDA RESLST-1,Y
00747  C516  10 FA              BPL NTHIS1



00749  C518              ;LOOK FOR END OF RESLST
00750  C518  B9 92 C0           LDA RESLST,Y
00751  C51B  D0 B4              BNE RESCON
00752  C51D  BD 00 02           LDA BUFOFS,X
00753  C520  10 BE              BPL GETBPT



00755  C522  99 FD 01    CRDONE STA BUF-3,Y
00756  C525  C6 78              DEC TXTPTR+1
00757  C527              ZZ1    =BUF-1
00758  C527  A9 FF              LDA #<ZZ1
00759  C529  85 77              STA TXTPTR
00760  C52B  60                 RTS
00761  C52C  A5 28       FNDLIN LDA TXTTAB
00762  C52E  A6 29              LDX TXTTAB+1
00763  C530  A0 01       FNDLNC LDY #1
00764  C532  85 5C              STA LOWTR
00765  C534  86 5D              STX LOWTR+1
00766  C536  B1 5C              LDA (LOWTR)Y
00767  C538  F0 1F              BEQ FLINRT
00768  C53A  C8                 INY
00769  C53B  C8                 INY
00770  C53C  A5 12              LDA LINNUM+1
00771  C53E  D1 5C              CMP (LOWTR)Y
00772  C540  90 18              BCC FLNRTS
00773  C542  F0 03              BEQ FNDLO1
00774  C544  88                 DEY
00775  C545  D0 09              BNE AFFRTS
00776  C547  A5 11       FNDLO1 LDA LINNUM
00777  C549  88                 DEY
00778  C54A  D1 5C              CMP (LOWTR)Y
00779  C54C  90 0C              BCC FLNRTS
00780  C54E  F0 0A              BEQ FLNRTS
00781  C550  88          AFFRTS DEY
00782  C551  B1 5C              LDA (LOWTR)Y
00783  C553  AA                 TAX






PET BASIC......PAGE 0013

LINE# LOC   CODE        LINE


00784  C554  88                 DEY
00785  C555  B1 5C              LDA (LOWTR)Y
00786  C557  B0 D7              BCS FNDLNC
00787  C559  18          FLINRT CLC
00788  C55A  60          FLNRTS RTS
00789  C55B  D0 FD       SCRATH BNE FLNRTS
00790  C55D  A9 00       SCRTCH LDA #0
00791  C55F  A8                 TAY
00792  C560  91 28              STA (TXTTAB)Y
00793  C562  C8                 INY
00794  C563  91 28              STA (TXTTAB)Y
00795  C565  A5 28              LDA TXTTAB
00796  C567  18                 CLC
00797  C568  69 02              ADC #2
00798  C56A  85 2A              STA VARTAB
00799  C56C  A5 29              LDA TXTTAB+1
00800  C56E  69 00              ADC #0
00801  C570  85 2B              STA VARTAB+1
00802  C572  20 A7 C5    RUNC   JSR STXTPT
00803  C575  A9 00              LDA #0
00804  C577  D0 2D       CLEAR  BNE STKRTS
00805  C579  A5 34       CLEARC LDA MEMSIZ
00806  C57B  A4 35              LDY MEMSIZ+1
00807  C57D  85 30              STA FRETOP
00808  C57F  84 31              STY FRETOP+1
00809  C581  20 E7 FF           JSR CCALL
00810  C584  A5 2A              LDA VARTAB
00811  C586  A4 2B              LDY VARTAB+1
00812  C588  85 2C              STA ARYTAB
00813  C58A  84 2D              STY ARYTAB+1
00814  C58C  85 2E              STA STREND
00815  C58E  84 2F              STY STREND+1
00816  C590  20 30 C7    FLOAD  JSR RESTOR
00817  C593  A2 16       STKINI LDX #TEMPST
00818  C595  86 13              STX TEMPPT
00819  C597  68                 PLA
00820  C598  A8                 TAY
00821  C599  68                 PLA
00822  C59A  A2 FA              LDX #STKEND-257
00823  C59C  9A                 TXS
00824  C59D  48                 PHA
00825  C59E  98                 TYA
00826  C59F  48                 PHA
00827  C5A0  A9 00              LDA #0
00828  C5A2  85 3B              STA OLDTXT+1
00829  C5A4  85 0A              STA SUBFLG
00830  C5A6  60          STKRTS RTS
00831  C5A7  18          STXTPT CLC
00832  C5A8  A5 28              LDA TXTTAB
00833  C5AA  69 FF              ADC #255
00834  C5AC  85 77              STA TXTPTR
00835  C5AE  A5 29              LDA TXTTAB+1
00836  C5B0  69 FF              ADC #255
00837  C5B2  85 78              STA TXTPTR+1
00838  C5B4  60                 RTS






PET BASIC......PAGE 0014

LINE# LOC   CODE        LINE


00839  C5B5              .FIL   CODE3
00840  C5B5              ;*****CODE3*****
00841  C5B5  90 06       LIST   BCC GOLST
00842  C5B7  F0 04              BEQ GOLST
00843  C5B9  C9 AB              CMP #MINUTK
00844  C5BB  D0 E9              BNE STKRTS
00845  C5BD  20 73 C8    GOLST  JSR LINGET
00846  C5C0  20 2C C5           JSR FNDLIN
00847  C5C3  20 76 00           JSR CHRGOT
00848  C5C6  F0 0C              BEQ LSTEND
00849  C5C8  C9 AB              CMP #MINUTK
00850  C5CA  D0 8E              BNE FLNRTS
00851  C5CC  20 70 00           JSR CHRGET
00852  C5CF  20 73 C8           JSR LINGET
00853  C5D2  D0 86              BNE FLNRTS
00854  C5D4  68          LSTEND PLA
00855  C5D5  68                 PLA
00856  C5D6  A5 11              LDA LINNUM
00857  C5D8  05 12              ORA LINNUM+1
00858  C5DA  D0 06              BNE LIST4
00859  C5DC  A9 FF              LDA #255
00860  C5DE  85 11              STA LINNUM
00861  C5E0  85 12              STA LINNUM+1
00862  C5E2  A0 01       LIST4  LDY #1
00863  C5E4  84 09              STY DORES
00864  C5E6  B1 5C              LDA (LOWTR)Y
00865  C5E8  F0 43              BEQ GRODY
00866  C5EA  20 E1 FF           JSR ISCNTC
00867  C5ED  20 E2 C9           JSR CRDO
00868  C5F0  C8                 INY
00869  C5F1  B1 5C              LDA (LOWTR)Y
00870  C5F3  AA                 TAX
00871  C5F4  C8                 INY
00872  C5F5  B1 5C              LDA (LOWTR)Y
00873  C5F7  C5 12              CMP LINNUM+1
00874  C5F9  D0 04              BNE TSTDUN
00875  C5FB  E4 11              CPX LINNUM
00876  C5FD  F0 02              BEQ TYPLIN
00877  C5FF  B0 2C       TSTDUN BCS GRODY
00878  C601  84 46       TYPLIN STY LSTPNT
00879  C603  20 D9 DC           JSR LINPRT
00880  C606  A9 20              LDA #' 
00881  C608  A4 46       PRIT4  LDY LSTPNT
00882  C60A  29 7F              AND #127
00883  C60C  20 45 CA    PLOOP  JSR OUTDO
00884  C60F  C9 22              CMP #34
00885  C611  D0 06              BNE PLOOP1
00886  C613  A5 09              LDA DORES
00887  C615  49 FF              EOR #@377
00888  C617  85 09              STA DORES
00889  C619  C8          PLOOP1 INY
00890  C61A  F0 11              BEQ GRODY
00891  C61C  B1 5C              LDA (LOWTR)Y
00892  C61E  D0 10              BNE QPLOP
00893  C620  A8                 TAY






PET BASIC......PAGE 0015

LINE# LOC   CODE        LINE


00894  C621  B1 5C              LDA (LOWTR)Y
00895  C623  AA                 TAX
00896  C624  C8                 INY
00897  C625  B1 5C              LDA (LOWTR)Y
00898  C627  86 5C              STX LOWTR
00899  C629  85 5D              STA LOWTR+1
00900  C62B  D0 B5              BNE LIST4
00901  C62D  4C 89 C3    GRODY  JMP READY
00902  C630  10 DA       QPLOP  BPL PLOOP
00903  C632  C9 FF              CMP #PI
00904  C634  F0 D6              BEQ PLOOP
00905  C636  24 09              BIT DORES
00906  C638  30 D2              BMI PLOOP
00907  C63A  38                 SEC
00908  C63B  E9 7F              SBC #127
00909  C63D  AA                 TAX
00910  C63E  84 46              STY LSTPNT
00911  C640  A0 FF              LDY #255
00912  C642  CA          RESRCH DEX
00913  C643  F0 08              BEQ PRIT3
00914  C645  C8          RESCR1 INY
00915  C646  B9 92 C0           LDA RESLST,Y
00916  C649  10 FA              BPL RESCR1
00917  C64B  30 F5              BMI RESRCH
00918  C64D  C8          PRIT3  INY
00919  C64E  B9 92 C0           LDA RESLST,Y
00920  C651  30 B5              BMI PRIT4
00921  C653  20 45 CA           JSR OUTDO
00922  C656  D0 F5              BNE PRIT3
00923  C658  A9 80       FOR    LDA #128
00924  C65A  85 0A              STA SUBFLG
00925  C65C  20 AD C8           JSR LET
00926  C65F  20 AA C2           JSR FNDFOR
00927  C662  D0 05              BNE NOTOL
00928  C664  8A                 TXA
00929  C665  69 0F              ADC #FORSIZ-3
00930  C667  AA                 TAX
00931  C668  9A                 TXS
00932  C669  68          NOTOL  PLA
00933  C66A  68                 PLA
00934  C66B  A9 09              LDA #8+ADDPRC
00935  C66D  20 1B C3           JSR GETSTK
00936  C670  20 0E C8           JSR DATAN
00937  C673  18                 CLC
00938  C674  98                 TYA
00939  C675  65 77              ADC TXTPTR
00940  C677  48                 PHA
00941  C678  A5 78              LDA TXTPTR+1
00942  C67A  69 00              ADC #0
00943  C67C  48                 PHA
00944  C67D  A5 37              LDA CURLIN+1
00945  C67F  48                 PHA
00946  C680  A5 36              LDA CURLIN
00947  C682  48                 PHA
00948  C683  A9 A4              LDA #TOTK






PET BASIC......PAGE 0016

LINE# LOC   CODE        LINE


00949  C685  20 FA CD           JSR SYNCHR
00950  C688  20 8E CC           JSR CHKNUM
00951  C68B  20 8B CC           JSR FRMNUM
00952  C68E  A5 63              LDA FACSGN
00953  C690  09 7F              ORA #127
00954  C692  25 5F              AND FACHO
00955  C694  85 5F              STA FACHO
00956  C696  A9 A1              LDA #<LDFONE
00957  C698  A0 C6              LDY #>LDFONE
00958  C69A  85 1F              STA INDEX1
00959  C69C  84 20              STY INDEX1+1
00960  C69E  4C 44 CD           JMP FORPSH
00961  C6A1  A9 C8       LDFONE LDA #<FONE
00962  C6A3  A0 D8              LDY #>FONE
00963  C6A5  20 AE DA           JSR MOVFM
00964  C6A8  20 76 00           JSR CHRGOT
00965  C6AB  C9 A9              CMP #STEPTK
00966  C6AD  D0 06              BNE ONEON
00967  C6AF  20 70 00           JSR CHRGET
00968  C6B2  20 8B CC           JSR FRMNUM
00969  C6B5  20 37 DB    ONEON  JSR SIGN
00970  C6B8  20 39 CD           JSR PUSHF
00971  C6BB  A5 47              LDA FORPNT+1
00972  C6BD  48                 PHA
00973  C6BE  A5 46              LDA FORPNT
00974  C6C0  48                 PHA
00975  C6C1  A9 81              LDA #FORTK
00976  C6C3  48                 PHA
00977  C6C4              .FIL   CODE4
































CODE4......PAGE 0017

LINE# LOC   CODE        LINE


00979  C6C4  20 E1 FF    NEWSTT JSR ISCNTC
00980  C6C7  A5 77              LDA TXTPTR
00981  C6C9  A4 78              LDY TXTPTR+1
00982  C6CB  C0 02              CPY #BUFPAG
00983  C6CD  EA                 NOP
00984  C6CE  F0 04              BEQ DIRCON
00985  C6D0  85 3A              STA OLDTXT
00986  C6D2  84 3B              STY OLDTXT+1
00987  C6D4  A0 00       DIRCON LDY #0
00988  C6D6  B1 77              LDA (TXTPTR)Y
00989  C6D8  D0 40              BNE MORSTS
00990  C6DA  A0 02              LDY #2
00991  C6DC  B1 77              LDA (TXTPTR)Y
00992  C6DE  18                 CLC
00993  C6DF  D0 03              BNE DIRCN1
00994  C6E1  4C 5B C7           JMP ENDCON
00995  C6E4  C8          DIRCN1 INY
00996  C6E5  B1 77              LDA (TXTPTR)Y
00997  C6E7  85 36              STA CURLIN
00998  C6E9  C8                 INY
00999  C6EA  B1 77              LDA (TXTPTR)Y
01000  C6EC  85 37              STA CURLIN+1
01001  C6EE  98                 TYA
01002  C6EF  65 77              ADC TXTPTR
01003  C6F1  85 77              STA TXTPTR
01004  C6F3  90 02              BCC GONE
01005  C6F5  E6 78              INC TXTPTR+1
01006  C6F7  20 70 00    GONE   JSR CHRGET
01007  C6FA  20 00 C7           JSR GONE3
01008  C6FD  4C C4 C6           JMP NEWSTT
01009  C700  F0 3C       GONE3  BEQ ISCRTS
01010  C702  E9 80       GONE2  SBC #ENDTK
01011  C704  90 11              BCC GLET
01012  C706  C9 23              CMP #SCRATK-ENDTK+1
01013  C708  B0 17              BCS SNERRX
01014  C70A  0A                 ASL A
01015  C70B  A8                 TAY
01016  C70C  B9 01 C0           LDA STMDSP+1,Y 
01017  C70F  48                 PHA
01018  C710  B9 00 C0           LDA STMDSP,Y
01019  C713  48                 PHA
01020  C714  4C 70 00           JMP CHRGET
01021  C717  4C AD C8    GLET   JMP LET
01022  C71A  C9 3A       MORSTS CMP #':
01023  C71C  F0 D9              BEQ GONE
01024  C71E  4C 03 CE    SNERR1 JMP SNERR



01026  C721  C9 4B       SNERRX CMP #GOTK-ENDTK
01027  C723  D0 F9              BNE SNERR1
01028  C725  20 70 00           JSR CHRGET
01029  C728  A9 A4              LDA #TOTK
01030  C72A  20 FA CD           JSR SYNCHR
01031  C72D  4C AD C7           JMP GOTO






CODE4......PAGE 0018

LINE# LOC   CODE        LINE


01032  C730  38          RESTOR SEC
01033  C731  A5 28              LDA TXTTAB
01034  C733  E9 01              SBC #1
01035  C735  A4 29              LDY TXTTAB+1
01036  C737  B0 01              BCS RESFIN
01037  C739  88                 DEY
01038  C73A  85 3E       RESFIN STA DATPTR
01039  C73C  84 3F              STY DATPTR+1
01040  C73E  60          ISCRTS RTS
01041  C73F  B0 01       STOP   BCS STOPC
01042  C741  18          END    CLC
01043  C742  D0 40       STOPC  BNE CONTRT
01044  C744  A5 77              LDA TXTPTR
01045  C746  A4 78              LDY TXTPTR+1
01046  C748  A6 37              LDX CURLIN+1
01047  C74A  E8                 INX
01048  C74B  F0 0C              BEQ DIRIS
01049  C74D  85 3A              STA OLDTXT
01050  C74F  84 3B              STY OLDTXT+1
01051  C751  A5 36       STPEND LDA CURLIN
01052  C753  A4 37              LDY CURLIN+1
01053  C755  85 38              STA OLDLIN
01054  C757  84 39              STY OLDLIN+1
01055  C759  68          DIRIS  PLA
01056  C75A  68                 PLA
01057  C75B  A9 A2       ENDCON LDA #<BRKTXT
01058  C75D  A0 C2              LDY #>BRKTXT
01059  C75F  A2 00              LDX #0
01060  C761  86 0D              STX CNTWFL
01061  C763  90 03              BCC GORDY
01062  C765  4C 7E C3           JMP ERRFIN
01063  C768  4C 89 C3    GORDY  JMP READY
01064  C76B  D0 17       CONT   BNE CONTRT
01065  C76D  A2 DB              LDX #ERRCN
01066  C76F  A4 3B              LDY OLDTXT+1
01067  C771  D0 03              BNE *+5
01068  C773  4C 57 C3           JMP ERROR
01069  C776  A5 3A              LDA OLDTXT
01070  C778  85 77              STA TXTPTR
01071  C77A  84 78              STY TXTPTR+1
01072  C77C  A5 38              LDA OLDLIN
01073  C77E  A4 39              LDY OLDLIN+1
01074  C780  85 36              STA CURLIN
01075  C782  84 37              STY CURLIN+1
01076  C784  60          CONTRT RTS
01077  C785  D0 03       RUN    BNE *+5
01078  C787  4C 72 C5           JMP RUNC
01079  C78A  20 79 C5           JSR CLEARC
01080  C78D  4C A4 C7           JMP RUNC2
01081  C790  A9 03       GOSUB  LDA #3
01082  C792  20 1B C3           JSR GETSTK
01083  C795  A5 78              LDA TXTPTR+1
01084  C797  48                 PHA
01085  C798  A5 77              LDA TXTPTR
01086  C79A  48                 PHA






CODE4......PAGE 0019

LINE# LOC   CODE        LINE


01087  C79B  A5 37              LDA CURLIN+1
01088  C79D  48                 PHA
01089  C79E  A5 36              LDA CURLIN
01090  C7A0  48                 PHA
01091  C7A1  A9 8D              LDA #GOSUTK
01092  C7A3  48                 PHA
01093  C7A4  20 76 00    RUNC2  JSR CHRGOT
01094  C7A7  20 AD C7           JSR GOTO
01095  C7AA  4C C4 C6           JMP NEWSTT
01096  C7AD  20 73 C8    GOTO   JSR LINGET
01097  C7B0  20 11 C8           JSR REMN
01098  C7B3  A5 37              LDA CURLIN+1
01099  C7B5  C5 12              CMP LINNUM+1
01100  C7B7  B0 0B              BCS LUK4IT
01101  C7B9  98                 TYA
01102  C7BA  38                 SEC
01103  C7BB  65 77              ADC TXTPTR
01104  C7BD  A6 78              LDX TXTPTR+1
01105  C7BF  90 07              BCC LUKALL
01106  C7C1  E8                 INX
01107  C7C2  B0 04              BCS LUKALL
01108  C7C4  A5 28       LUK4IT LDA TXTTAB
01109  C7C6  A6 29              LDX TXTTAB+1
01110  C7C8  20 30 C5    LUKALL JSR FNDLNC
01111  C7CB  90 1E              BCC USERR
01112  C7CD  A5 5C              LDA LOWTR
01113  C7CF  E9 01              SBC #1
01114  C7D1              .FIL   CODE5

































CODE5......PAGE 001A

LINE# LOC   CODE        LINE


01116  C7D1  85 77              STA TXTPTR
01117  C7D3  A5 5D              LDA LOWTR+1
01118  C7D5  E9 00              SBC #0
01119  C7D7  85 78              STA TXTPTR+1
01120  C7D9  60          GORTS  RTS
01121  C7DA  D0 FD       RETURN BNE GORTS
01122  C7DC  A9 FF              LDA #255
01123  C7DE  85 47              STA FORPNT+1
01124  C7E0  20 AA C2           JSR FNDFOR
01125  C7E3  9A                 TXS
01126  C7E4  C9 8D              CMP #GOSUTK
01127  C7E6  F0 0B              BEQ RETU1
01128  C7E8  A2 16              LDX #ERRRG
01129  C7EA  2C                 .BYT $2C
01130  C7EB  A2 5A       USERR  LDX #ERRUS
01131  C7ED  4C 57 C3           JMP ERROR
01132  C7F0  4C 03 CE    SNERR2 JMP SNERR
01133  C7F3  68          RETU1  PLA
01134  C7F4  68                 PLA
01135  C7F5  85 36              STA CURLIN
01136  C7F7  68                 PLA
01137  C7F8  85 37              STA CURLIN+1
01138  C7FA  68                 PLA
01139  C7FB  85 77              STA TXTPTR
01140  C7FD  68                 PLA
01141  C7FE  85 78              STA TXTPTR+1
01142  C800  20 0E C8    DATA   JSR DATAN
01143  C803  98          ADDON  TYA
01144  C804  18                 CLC
01145  C805  65 77              ADC TXTPTR
01146  C807  85 77              STA TXTPTR
01147  C809  90 02              BCC REMRTS
01148  C80B  E6 78              INC TXTPTR+1
01149  C80D  60          REMRTS RTS
01150  C80E  A2 3A       DATAN  LDX #':
01151  C810  2C                 .BYT $2C
01152  C811  A2 00       REMN   LDX #0
01153  C813  86 03              STX CHARAC
01154  C815  A0 00              LDY #0
01155  C817  84 04              STY ENDCHR
01156  C819  A5 04       EXCHQT LDA ENDCHR
01157  C81B  A6 03              LDX CHARAC
01158  C81D  85 03              STA CHARAC
01159  C81F  86 04              STX ENDCHR
01160  C821  B1 77       REMER  LDA (TXTPTR)Y
01161  C823  F0 E8              BEQ REMRTS
01162  C825  C5 04              CMP ENDCHR
01163  C827  F0 E4              BEQ REMRTS
01164  C829  C8                 INY
01165  C82A  C9 22              CMP #34
01166  C82C  D0 F3              BNE REMER
01167  C82E  F0 E9              BEQ EXCHQT
01168  C830  20 9F CC    IF     JSR FRMEVL
01169  C833  20 76 00           JSR CHRGOT
01170  C836  C9 89              CMP #GOTOTK






CODE5......PAGE 001B

LINE# LOC   CODE        LINE


01171  C838  F0 05              BEQ OKGOTO
01172  C83A  A9 A7              LDA #THENTK
01173  C83C  20 FA CD           JSR SYNCHR
01174  C83F  A5 5E       OKGOTO LDA FACEXP
01175  C841  D0 05              BNE DOCOND
01176  C843  20 11 C8    REM    JSR REMN
01177  C846  F0 BB              BEQ ADDON
01178  C848  20 76 00    DOCOND JSR CHRGOT
01179  C84B  B0 03              BCS DOCO
01180  C84D  4C AD C7           JMP GOTO
01181  C850  4C 00 C7    DOCO   JMP GONE3
01182  C853  20 78 D6    ONGOTO JSR GETBYT
01183  C856  48                 PHA
01184  C857  C9 8D              CMP #GOSUTK
01185  C859  F0 04              BEQ ONGLOP
01186  C85B  C9 89       SNERR3 CMP #GOTOTK
01187  C85D  D0 91              BNE SNERR2
01188  C85F  C6 62       ONGLOP DEC FACLO
01189  C861  D0 04              BNE ONGLP1
01190  C863  68                 PLA
01191  C864  4C 02 C7           JMP GONE2
01192  C867  20 70 00    ONGLP1 JSR CHRGET
01193  C86A  20 73 C8           JSR LINGET
01194  C86D  C9 2C              CMP #44
01195  C86F  F0 EE              BEQ ONGLOP
01196  C871  68                 PLA
01197  C872  60          ONGRTS RTS
01198  C873  A2 00       LINGET LDX #0
01199  C875  86 11              STX LINNUM
01200  C877  86 12              STX LINNUM+1
01201  C879  B0 F7       MORLIN BCS ONGRTS
01202  C87B  E9 2F              SBC #$2F
01203  C87D  85 03              STA CHARAC
01204  C87F  A5 12              LDA LINNUM+1
01205  C881  85 1F              STA INDEX
01206  C883  C9 19              CMP #25
01207  C885  B0 D4              BCS SNERR3
01208  C887  A5 11              LDA LINNUM
01209  C889  0A                 ASL A
01210  C88A  26 1F              ROL INDEX
01211  C88C  0A                 ASL A
01212  C88D  26 1F              ROL INDEX
01213  C88F  65 11              ADC LINNUM
01214  C891  85 11              STA LINNUM
01215  C893  A5 1F              LDA INDEX
01216  C895  65 12              ADC LINNUM+1
01217  C897  85 12              STA LINNUM+1
01218  C899  06 11              ASL LINNUM
01219  C89B  26 12              ROL LINNUM+1
01220  C89D  A5 11              LDA LINNUM
01221  C89F  65 03              ADC CHARAC
01222  C8A1  85 11              STA LINNUM
01223  C8A3  90 02              BCC NXTLGC
01224  C8A5  E6 12              INC LINNUM+1
01225  C8A7  20 70 00    NXTLGC JSR CHRGET






CODE5......PAGE 001C

LINE# LOC   CODE        LINE


01226  C8AA  4C 79 C8           JMP MORLIN
01227  C8AD  20 6D CF    LET    JSR PTRGET
01228  C8B0  85 46              STA FORPNT
01229  C8B2  84 47              STY FORPNT+1
01230  C8B4  A9 B2              LDA #$B2
01231  C8B6  20 FA CD           JSR SYNCHR
01232  C8B9  A5 08              LDA INTFLG
01233  C8BB  48                 PHA
01234  C8BC  A5 07              LDA VALTYP
01235  C8BE  48                 PHA
01236  C8BF  20 9F CC           JSR FRMEVL
01237  C8C2  68                 PLA
01238  C8C3  2A                 ROL A
01239  C8C4  20 91 CC           JSR CHKVAL
01240  C8C7  D0 18              BNE COPSTR
01241  C8C9  68                 PLA
01242  C8CA  10 12       QINTGR BPL COPFLT
01243  C8CC  20 27 DB           JSR ROUND
01244  C8CF  20 9A D0           JSR AYINT
01245  C8D2  A0 00              LDY #0
01246  C8D4  A5 61              LDA FACMO
01247  C8D6  91 46              STA (FORPNT)Y
01248  C8D8  C8                 INY
01249  C8D9  A5 62              LDA FACLO
01250  C8DB  91 46              STA (FORPNT)Y
01251  C8DD  60                 RTS
01252  C8DE  4C DC DA    COPFLT JMP MOVVF
01253  C8E1  68          COPSTR PLA
01254  C8E2  A4 47       INPCOM LDY FORPNT+1
01255  C8E4  C0 DE              CPY #>ZERO
01256  C8E6  D0 4F              BNE GETSPT
01257  C8E8  20 80 D5           JSR FREFAC
01258  C8EB  C9 06              CMP #6
01259  C8ED  D0 40              BNE FCERR2
01260  C8EF  A0 00              LDY #0
01261  C8F1  84 5E              STY FACEXP
01262  C8F3  84 63              STY FACSGN
01263  C8F5              .FIL   CODE6























CODE6......PAGE 001D

LINE# LOC   CODE        LINE


01265  C8F5  84 6E       TIMELP STY FBUFPT
01266  C8F7  20 28 C9           JSR TIMNUM
01267  C8FA  20 EE D9           JSR MUL10
01268  C8FD  E6 6E              INC FBUFPT
01269  C8FF  A4 6E              LDY FBUFPT
01270  C901  20 28 C9           JSR TIMNUM
01271  C904  20 18 DB           JSR MOVAF
01272  C907  AA                 TAX
01273  C908  F0 05              BEQ NOML6
01274  C90A  E8                 INX
01275  C90B  8A                 TXA
01276  C90C  20 F9 D9           JSR FINML6
01277  C90F  A4 6E       NOML6  LDY FBUFPT
01278  C911  C8                 INY
01279  C912  C0 06              CPY #6
01280  C914  D0 DF              BNE TIMELP
01281  C916  20 EE D9           JSR MUL10
01282  C919  20 A7 DB           JSR QINT
01283  C91C  A2 02              LDX #2
01284  C91E  78                 SEI
01285  C91F  B5 60       TIMEST LDA FACMOH,X
01286  C921  95 8D              STA CTIMR,X
01287  C923  CA                 DEX
01288  C924  10 F9              BPL TIMEST
01289  C926  58                 CLI
01290  C927  60                 RTS
01291  C928  B1 1F       TIMNUM LDA (INDEX)Y
01292  C92A  20 7D 00           JSR QNUM
01293  C92D  90 03              BCC GOTNUM
01294  C92F  4C 23 D1    FCERR2 JMP FCERR
01295  C932  E9 2F       GOTNUM SBC #$2F
01296  C934  4C 8A DC           JMP FINLOG
01297  C937  A0 02       GETSPT LDY #2
01298  C939  B1 61              LDA (FACMO)Y
01299  C93B  C5 31              CMP FRETOP+1
01300  C93D  90 17              BCC DNTCPY
01301  C93F  D0 07              BNE QVARIA
01302  C941  88                 DEY
01303  C942  B1 61              LDA (FACMO)Y
01304  C944  C5 30              CMP FRETOP
01305  C946  90 0E              BCC DNTCPY
01306  C948  A4 62       QVARIA LDY FACLO
01307  C94A  C4 2B              CPY VARTAB+1
01308  C94C  90 08              BCC DNTCPY
01309  C94E  D0 0D              BNE COPY
01310  C950  A5 61              LDA FACMO
01311  C952  C5 2A              CMP VARTAB
01312  C954  B0 07              BCS COPY
01313  C956  A5 61       DNTCPY LDA FACMO
01314  C958  A4 62              LDY FACMO+1
01315  C95A  4C 73 C9           JMP COPYC
01316  C95D  A0 00       COPY   LDY #0
01317  C95F  B1 61              LDA (FACMO)Y
01318  C961  20 4F D3           JSR STRINI
01319  C964  A5 4D              LDA DSCPNT






CODE6......PAGE 001E

LINE# LOC   CODE        LINE


01320  C966  A4 4E              LDY DSCPNT+1
01321  C968  85 6C              STA STRNG1
01322  C96A  84 6D              STY STRNG1+1
01323  C96C  20 54 D5           JSR MOVINS
01324  C96F  A9 5E              LDA #<DSCTMP
01325  C971  A0 00              LDY #>DSCTMP
01326  C973  85 4D       COPYC  STA DSCPNT
01327  C975  84 4E              STY DSCPNT+1
01328  C977  20 B5 D5           JSR FRETMS
01329  C97A  A0 00              LDY #0
01330  C97C  B1 4D              LDA (DSCPNT)Y
01331  C97E  91 46              STA (LSTPNT)Y
01332  C980  C8                 INY
01333  C981  B1 4D              LDA (DSCPNT)Y
01334  C983  91 46              STA (LSTPNT)Y
01335  C985  C8                 INY
01336  C986  B1 4D              LDA (DSCPNT)Y
01337  C988  91 46              STA (LSTPNT)Y
01338  C98A  60                 RTS





01340  C98B  20 91 C9    PRINTN JSR CMD
01341  C98E  4C B7 CA           JMP IODONE
01342  C991  20 78 D6    CMD    JSR GETBYT
01343  C994  F0 05              BEQ SAVEIT
01344  C996  A9 2C              LDA #44
01345  C998  20 FA CD           JSR SYNCHR
01346  C99B  08          SAVEIT PHP
01347  C99C  20 C9 FF           JSR COOUT
01348  C99F  86 0E              STX CHANNL
01349  C9A1  28                 PLP
01350  C9A2  4C AB C9           JMP PRINT
01351  C9A5  20 1F CA    STRDON JSR STRPRT
01352  C9A8  20 76 00    NEWCHR JSR CHRGOT
01353  C9AB  F0 35       PRINT  BEQ CRDO
01354  C9AD  F0 3F       PRINTC BEQ PRTRTS
01355  C9AF  C9 A3              CMP #TABTK
01356  C9B1  F0 49              BEQ TABER
01357  C9B3  C9 A6              CMP #SPCTK
01358  C9B5  18                 CLC
01359  C9B6  F0 44              BEQ TABER
01360  C9B8  C9 2C              CMP #44
01361  C9BA  F0 33              BEQ COMPRT
01362  C9BC  C9 3B              CMP #59
01363  C9BE  F0 51              BEQ NOTABR
01364  C9C0  20 9F CC           JSR FRMEVL
01365  C9C3  24 07              BIT VALTYP
01366  C9C5  30 DE              BMI STRDON
01367  C9C7  20 E9 DC           JSR FOUT
01368  C9CA  20 61 D3           JSR STRLIT
01369  C9CD  20 1F CA           JSR STRPRT
01370  C9D0  20 39 CA           JSR OUTSPC






CODE6......PAGE 001F

LINE# LOC   CODE        LINE


01371  C9D3  D0 D3              BNE NEWCHR
01372  C9D5  A9 00       FININL LDA #0
01373  C9D7  9D 00 02           STA BUF,X
01374  C9DA              ZZ5=BUF-1
01375  C9DA  A2 FF              LDX #<ZZ5
01376  C9DC  A0 01              LDY #>ZZ5
01377  C9DE  A5 0E              LDA CHANNL
01378  C9E0  D0 0C              BNE PRTRTS
01379  C9E2  A9 0D       CRDO   LDA #13
01380  C9E4  20 45 CA           JSR OUTDO
01381  C9E7  A9 0A              LDA #$0A        ;LINE FEED
01382  C9E9  20 45 CA           JSR OUTDO
01383  C9EC  49 FF       CRFIN  EOR #255
01384  C9EE  60          PRTRTS RTS
01385  C9EF  A5 C6       COMPRT LDA TRMPOS
01386  C9F1              NCMPOS =@36
01387  C9F1  38                 SEC
01388  C9F2  E9 0A       MORCO1 SBC #CLMWID
01389  C9F4  B0 FC              BCS MORCO1
01390  C9F6  49 FF              EOR #255
01391  C9F8  69 01              ADC #1
01392  C9FA  D0 10              BNE ASPAC
01393  C9FC  08          TABER  PHP
01394  C9FD  20 75 D6           JSR GTBYTC
01395  CA00  C9 29              CMP #41
01396  CA02  D0 5D              BNE SNERR4
01397  CA04  28                 PLP
01398  CA05  90 06              BCC XSPAC
01399  CA07  8A                 TXA
01400  CA08  E5 C6              SBC TRMPOS
01401  CA0A  90 05              BCC NOTABR
01402  CA0C  AA          ASPAC  TAX
01403  CA0D  E8          XSPAC  INX
01404  CA0E  CA          XSPAC2 DEX
01405  CA0F  D0 06              BNE XSPAC1
01406  CA11  20 70 00    NOTABR JSR CHRGET
01407  CA14  4C AD C9           JMP PRINTC
01408  CA17              .FIL   CODE7























CODE7......PAGE 0020

LINE# LOC   CODE        LINE


01410  CA17  20 39 CA    XSPAC1 JSR OUTSPC
01411  CA1A  D0 F2              BNE XSPAC2
01412  CA1C  20 61 D3    STROUT JSR STRLIT
01413  CA1F  20 80 D5    STRPRT JSR FREFAC
01414  CA22  AA                 TAX
01415  CA23  A0 00              LDY #0
01416  CA25  E8                 INX
01417  CA26  CA          STRPR2 DEX
01418  CA27  F0 C5              BEQ PRTRTS
01419  CA29  B1 1F              LDA (INDEX)Y
01420  CA2B  20 45 CA           JSR OUTDO
01421  CA2E  C8                 INY
01422  CA2F  C9 0D              CMP #13
01423  CA31  D0 F3              BNE STRPR2
01424  CA33  20 EC C9           JSR CRFIN
01425  CA36  4C 26 CA           JMP STRPR2
01426  CA39              OUTSPC
01427  CA39  A5 0E              LDA CHANNL
01428  CA3B  F0 03              BEQ CRTSKP
01429  CA3D  A9 20              LDA #' 
01430  CA3F  2C                 .BYT $2C
01431  CA40  A9 1D       CRTSKP LDA #29
01432  CA42  2C                 .BYT $2C
01433  CA43  A9 3F       OUTQST LDA #'?
01434  CA45  24 0D       OUTDO  BIT CNTWFL
01435  CA47  30 03              BMI OUTRTS
01436  CA49  20 D2 FF           JSR OUTCH
01437  CA4C  29 FF       OUTRTS AND #255
01438  CA4E  60                 RTS
01439  CA4F  A5 0B       TRMNOK LDA INPFLG
01440  CA51  F0 11              BEQ TRMNO1
01441  CA53  30 04              BMI GETDTL
01442  CA55  A0 FF              LDY #255
01443  CA57  D0 04              BNE STCURL
01444  CA59  A5 3C       GETDTL LDA DATLIN
01445  CA5B  A4 3D              LDY DATLIN+1
01446  CA5D  85 36       STCURL STA CURLIN
01447  CA5F  84 37              STY CURLIN+1
01448  CA61  4C 03 CE    SNERR4 JMP SNERR
01449  CA64  A5 0E       TRMNO1 LDA CHANNL
01450  CA66  F0 05              BEQ DOAGIN
01451  CA68  A2 BF              LDX #ERRBD
01452  CA6A  4C 57 C3           JMP ERROR
01453  CA6D  A9 0D       DOAGIN LDA #<TRYAGN
01454  CA6F  A0 CC              LDY #>TRYAGN
01455  CA71  20 1C CA           JSR STROUT
01456  CA74  A5 3A              LDA OLDTXT
01457  CA76  A4 3B              LDY OLDTXT+1
01458  CA78  85 77              STA TXTPTR
01459  CA7A  84 78              STY TXTPTR+1
01460  CA7C  60                 RTS
01461  CA7D  20 80 D2    GET    JSR ERRDIR
01462  CA80  C9 23              CMP #'#
01463  CA82  D0 10              BNE GETTTY
01464  CA84  20 70 00           JSR CHRGET






CODE7......PAGE 0021

LINE# LOC   CODE        LINE


01465  CA87  20 78 D6           JSR GETBYT
01466  CA8A  A9 2C              LDA #44
01467  CA8C  20 FA CD           JSR SYNCHR
01468  CA8F  20 C6 FF           JSR COIN
01469  CA92  86 0E              STX CHANNL
01470  CA94              ZZ2=BUF+1
01471  CA94  A2 01       GETTTY LDX #<ZZ2
01472  CA96              ZZ3=BUF+2
01473  CA96  A0 02              LDY #>ZZ3
01474  CA98  A9 00              LDA #0
01475  CA9A  8D 01 02           STA BUF+1
01476  CA9D  A9 40              LDA #64
01477  CA9F  20 10 CB           JSR INPCO1
01478  CAA2  A6 0E              LDX CHANNL
01479  CAA4  D0 13              BNE IORELE
01480  CAA6  60                 RTS
01481  CAA7  20 78 D6    INPUTN JSR GETBYT
01482  CAAA  A9 2C              LDA #44
01483  CAAC  20 FA CD           JSR SYNCHR
01484  CAAF  20 C6 FF           JSR COIN
01485  CAB2  86 0E              STX CHANNL
01486  CAB4  20 D2 CA           JSR NOTQTI
01487  CAB7  A5 0E       IODONE LDA CHANNL
01488  CAB9  20 CC FF    IORELE JSR CCCHN
01489  CABC  A2 00              LDX #0
01490  CABE  86 0E              STX CHANNL
01491  CAC0  60                 RTS
01492  CAC1  46 0D       INPUT  LSR CNTWFL
01493  CAC3  C9 22              CMP #34
01494  CAC5  D0 0B              BNE NOTQTI
01495  CAC7  20 B8 CD           JSR STRTXT
01496  CACA  A9 3B              LDA #59
01497  CACC  20 FA CD           JSR SYNCHR
01498  CACF  20 1F CA           JSR STRPRT
01499  CAD2  20 80 D2    NOTQTI JSR ERRDIR
01500  CAD5  A9 2C              LDA #44
01501  CAD7  8D FF 01           STA BUF-1
01502  CADA  20 FA CA    GETAGN JSR QINLIN
01503  CADD  A5 0E              LDA CHANNL
01504  CADF  F0 0C              BEQ BUFFUL
01505  CAE1  A5 96              LDA CSTAT
01506  CAE3  29 02              AND #2
01507  CAE5  F0 06              BEQ BUFFUL
01508  CAE7  20 B7 CA           JSR IODONE
01509  CAEA  4C 00 C8           JMP DATA
01510  CAED  AD 00 02    BUFFUL LDA BUF
01511  CAF0  D0 1C              BNE INPCON
01512  CAF2  A5 0E              LDA CHANNL
01513  CAF4  D0 E4              BNE GETAGN
01514  CAF6  18                 CLC
01515  CAF7  4C 51 C7           JMP STPEND
01516  CAFA  A5 0E       QINLIN LDA CHANNL
01517  CAFC  D0 06              BNE GINLIN
01518  CAFE  20 43 CA           JSR OUTQST
01519  CB01  20 39 CA           JSR OUTSPC






CODE7......PAGE 0022

LINE# LOC   CODE        LINE


01520  CB04  4C 6F C4    GINLIN JMP INLIN
01521  CB07  A6 3E       READ   LDX DATPTR
01522  CB09  A4 3F              LDY DATPTR+1
01523  CB0B  A9                 .BYT $A9
01524  CB0C  98                 TYA
01525  CB0D  2C                 .BYT $2C
01526  CB0E  A9 00       INPCON LDA #0
01527  CB10  85 0B       INPCO1 STA INPFLG
01528  CB12  86 40              STX INPPTR
01529  CB14  84 41              STY INPPTR+1
01530  CB16  20 6D CF    INLOOP JSR PTRGET
01531  CB19  85 46              STA FORPNT
01532  CB1B  84 47              STY FORPNT+1
01533  CB1D  A5 77              LDA TXTPTR
01534  CB1F  A4 78              LDY TXTPTR+1
01535  CB21  85 48              STA VARTXT
01536  CB23  84 49              STY VARTXT+1
01537  CB25  A6 40              LDX INPPTR
01538  CB27  A4 41              LDY INPPTR+1
01539  CB29  86 77              STX TXTPTR
01540  CB2B  84 78              STY TXTPTR+1
01541  CB2D  20 76 00           JSR CHRGOT
01542  CB30  D0 20              BNE DATBK1
01543  CB32  24 0B              BIT INPFLG
01544  CB34  50 0C              BVC QDATA
01545  CB36  20 E4 FF           JSR CGETL
01546  CB39  8D 00 02           STA BUF
01547  CB3C              ZZ4=BUF-1
01548  CB3C  A2 FF              LDX #<ZZ4
01549  CB3E  A0 01              LDY #>ZZ4
01550  CB40  D0 0C              BNE DATBK
01551  CB42  30 75       QDATA  BMI DATLOP
01552  CB44  A5 0E              LDA CHANNL
01553  CB46  D0 03              BNE GETNTH
01554  CB48  20 43 CA           JSR OUTQST
01555  CB4B  20 FA CA    GETNTH JSR QINLIN
01556  CB4E  86 77       DATBK  STX TXTPTR
01557  CB50  84 78              STY TXTPTR+1
01558  CB52              .FIL   CODE8






















CODE8......PAGE 0023

LINE# LOC   CODE        LINE


01560  CB52  20 70 00    DATBK1 JSR CHRGET
01561  CB55  24 07              BIT VALTYP
01562  CB57  10 31              BPL NUMINS
01563  CB59  24 0B              BIT INPFLG
01564  CB5B  50 09              BVC SETQUT
01565  CB5D  E8                 INX
01566  CB5E  86 77              STX TXTPTR
01567  CB60  A9 00              LDA #0
01568  CB62  85 03              STA CHARAC
01569  CB64  F0 0C              BEQ RESETC
01570  CB66  85 03       SETQUT STA CHARAC
01571  CB68  C9 22              CMP #34
01572  CB6A  F0 07              BEQ NOWGET
01573  CB6C  A9 3A              LDA #':
01574  CB6E  85 03              STA CHARAC
01575  CB70  A9 2C              LDA #44
01576  CB72  18          RESETC CLC
01577  CB73  85 04       NOWGET STA ENDCHR
01578  CB75  A5 77              LDA TXTPTR
01579  CB77  A4 78              LDY TXTPTR+1
01580  CB79  69 00              ADC #0
01581  CB7B  90 01              BCC NOWGE1
01582  CB7D  C8                 INY
01583  CB7E  20 67 D3    NOWGE1 JSR STRLT2
01584  CB81  20 BD D6           JSR ST2TXT
01585  CB84  20 E2 C8           JSR INPCOM
01586  CB87  4C 92 CB           JMP STRDN2
01587  CB8A  20 FF DB    NUMINS JSR FIN
01588  CB8D  A5 08              LDA INTFLG
01589  CB8F  20 CA C8           JSR QINTGR
01590  CB92  20 76 00    STRDN2 JSR CHRGOT
01591  CB95  F0 07              BEQ TRMOK
01592  CB97  C9 2C              CMP #44
01593  CB99  F0 03              BEQ *+5
01594  CB9B  4C 4F CA           JMP TRMNOK
01595  CB9E  A5 77       TRMOK  LDA TXTPTR
01596  CBA0  A4 78              LDY TXTPTR+1
01597  CBA2  85 40              STA INPPTR
01598  CBA4  84 41              STY INPPTR+1
01599  CBA6  A5 48              LDA VARTXT
01600  CBA8  A4 49              LDY VARTXT+1
01601  CBAA  85 77              STA TXTPTR
01602  CBAC  84 78              STY TXTPTR+1
01603  CBAE  20 76 00           JSR CHRGOT
01604  CBB1  F0 2C              BEQ VAREND
01605  CBB3  20 F8 CD           JSR CHKCOM
01606  CBB6  4C 16 CB           JMP INLOOP
01607  CBB9  20 0E C8    DATLOP JSR DATAN
01608  CBBC  C8                 INY
01609  CBBD  AA                 TAX
01610  CBBE  D0 12              BNE NOWLIN
01611  CBC0  A2 2A              LDX #ERROD
01612  CBC2  C8                 INY
01613  CBC3  B1 77              LDA (TXTPTR)Y
01614  CBC5  F0 6D              BEQ ERRGO5






CODE8......PAGE 0024

LINE# LOC   CODE        LINE


01615  CBC7  C8                 INY
01616  CBC8  B1 77              LDA (TXTPTR)Y
01617  CBCA  85 3C              STA DATLIN
01618  CBCC  C8                 INY
01619  CBCD  B1 77              LDA (TXTPTR)Y
01620  CBCF  C8                 INY
01621  CBD0  85 3D              STA DATLIN+1
01622  CBD2  B1 77       NOWLIN LDA (TXTPTR)Y
01623  CBD4  AA                 TAX
01624  CBD5  20 03 C8           JSR ADDON
01625  CBD8  E0 83              CPX #DATATK
01626  CBDA  D0 DD              BNE DATLOP
01627  CBDC  4C 52 CB           JMP DATBK1
01628  CBDF  A5 40       VAREND LDA INPPTR
01629  CBE1  A4 41              LDY INPPTR+1
01630  CBE3  A6 0B              LDX INPFLG
01631  CBE5  10 03              BPL VARY0
01632  CBE7  4C 3A C7           JMP RESFIN
01633  CBEA  A0 00       VARY0  LDY #0
01634  CBEC  B1 40              LDA (INPPTR)Y
01635  CBEE  F0 0B              BEQ INPRTS
01636  CBF0  A5 0E              LDA CHANNL
01637  CBF2  D0 07              BNE INPRTS
01638  CBF4  A9 FC              LDA #<EXIGNT
01639  CBF6  A0 CB              LDY #>EXIGNT
01640  CBF8  4C 1C CA           JMP STROUT
01641  CBFB  60          INPRTS RTS
01642  CBFC  3F 45       EXIGNT .BYT '?EXTRA IGNORED'
01643  CC0A  0D                 .BYT $D,$A
01643  CC0B  0A 
01644  CC0C  00                 .BYT 0
01645  CC0D  3F 52       TRYAGN .BYT '?REDO FROM START'
01646  CC1D  0D                 .BYT $D,$A
01646  CC1E  0A 
01647  CC1F  00                 .BYT 0
01648  CC20  D0 04       NEXT   BNE GETFOR
01649  CC22  A0 00              LDY #0
01650  CC24  F0 03              BEQ STXFOR
01651  CC26  20 6D CF    GETFOR JSR PTRGET
01652  CC29  85 46       STXFOR STA FORPNT
01653  CC2B  84 47              STY FORPNT+1
01654  CC2D  20 AA C2           JSR FNDFOR
01655  CC30  F0 04              BEQ HAVFOR
01656  CC32  A2 00              LDX #ERRNF
01657  CC34  F0 66       ERRGO5 BEQ ERRGO4
01658  CC36  9A          HAVFOR TXS
01659  CC37  8A                 TXA
01660  CC38  18                 CLC
01661  CC39  69 04              ADC #4
01662  CC3B  48                 PHA
01663  CC3C  69 06              ADC #5+ADDPRC
01664  CC3E  85 21              STA INDEX2
01665  CC40  68                 PLA
01666  CC41  A0 01              LDY #1
01667  CC43  20 AE DA           JSR MOVFM






CODE8......PAGE 0025

LINE# LOC   CODE        LINE


01668  CC46  BA                 TSX
01669  CC47  BD 09 01           LDA ADDPRC+264,X
01670  CC4A  85 63              STA FACSGN
01671  CC4C  A5 46              LDA FORPNT
01672  CC4E  A4 47              LDY FORPNT+1
01673  CC50  20 73 D7           JSR FADD
01674  CC53  20 DC DA           JSR MOVVF
01675  CC56  A0 01              LDY #1
01676  CC58  20 69 DB           JSR FCOMPN
01677  CC5B  BA                 TSX
01678  CC5C  38                 SEC
01679  CC5D  FD 09 01           SBC ADDPRC+264,X
01680  CC60  F0 17              BEQ LOOPDN
01681  CC62  BD 0F 01           LDA 269+ADDPRC+ADDPRC,X
01682  CC65  85 36              STA CURLIN
01683  CC67  BD 10 01           LDA 270+ADDPRC+ADDPRC,X
01684  CC6A  85 37              STA CURLIN+1
01685  CC6C  BD 12 01           LDA 272+ADDPRC+ADDPRC,X
01686  CC6F  85 77              STA TXTPTR
01687  CC71  BD 11 01           LDA 271+ADDPRC+ADDPRC,X
01688  CC74  85 78              STA TXTPTR+1
01689  CC76  4C C4 C6    NEWSGO JMP NEWSTT
01690  CC79  8A          LOOPDN TXA
01691  CC7A  69 11              ADC #15+ADDPRC+ADDPRC
01692  CC7C  AA                 TAX
01693  CC7D  9A                 TXS
01694  CC7E  20 76 00           JSR CHRGOT
01695  CC81  C9 2C              CMP #44
01696  CC83  D0 F1              BNE NEWSGO
01697  CC85  20 70 00           JSR CHRGET
01698  CC88  20 26 CC           JSR GETFOR
01699  CC8B  20 9F CC    FRMNUM JSR FRMEVL
01700  CC8E  18          CHKNUM CLC
01701  CC8F  24                 .BYT $24
01702  CC90  38          CHKSTR SEC
01703  CC91  24 07       CHKVAL BIT VALTYP
01704  CC93              .FIL   CODE9
























CODE9......PAGE 0026

LINE# LOC   CODE        LINE


01706  CC93  30 03              BMI DOCSTR
01707  CC95  B0 03              BCS CHKERR
01708  CC97  60          CHKOK  RTS
01709  CC98  B0 FD       DOCSTR BCS CHKOK
01710  CC9A  A2 A3       CHKERR LDX #ERRTM
01711  CC9C  4C 57 C3    ERRGO4 JMP ERROR
01712  CC9F  A6 77       FRMEVL LDX TXTPTR
01713  CCA1  D0 02              BNE FRMEV1
01714  CCA3  C6 78              DEC TXTPTR+1
01715  CCA5  C6 77       FRMEV1 DEC TXTPTR
01716  CCA7  A2 00              LDX #0
01717  CCA9  24                 .BYT $24
01718  CCAA  48          LPOPER PHA
01719  CCAB  8A                 TXA
01720  CCAC  48                 PHA
01721  CCAD  A9 01              LDA #1
01722  CCAF  20 1B C3           JSR GETSTK
01723  CCB2  20 84 CD           JSR EVAL
01724  CCB5  A9 00              LDA #0
01725  CCB7  85 4A              STA OPMASK
01726  CCB9  20 76 00    TSTOP  JSR CHRGOT
01727  CCBC  38          LOPREL SEC
01728  CCBD  E9 B1              SBC #GREATK
01729  CCBF  90 17              BCC ENDREL
01730  CCC1  C9 03              CMP #LESSTK-GREATK+1
01731  CCC3  B0 13              BCS ENDREL
01732  CCC5  C9 01              CMP #1
01733  CCC7  2A                 ROL A
01734  CCC8  49 01              EOR #1
01735  CCCA  45 4A              EOR OPMASK
01736  CCCC  C5 4A              CMP OPMASK
01737  CCCE  90 61              BCC SNERR5
01738  CCD0  85 4A              STA OPMASK
01739  CCD2  20 70 00           JSR CHRGET
01740  CCD5  4C BC CC           JMP LOPREL
01741  CCD8  A6 4A       ENDREL LDX OPMASK
01742  CCDA  D0 2C              BNE FINREL
01743  CCDC  B0 7B              BCS QOP
01744  CCDE  69 07              ADC #GREATK-PLUSTK
01745  CCE0  90 77              BCC QOP
01746  CCE2  65 07              ADC VALTYP
01747  CCE4  D0 03              BNE *+5
01748  CCE6  4C 17 D5           JMP CAT
01749  CCE9  69 FF              ADC #$FF
01750  CCEB  85 1F              STA INDEX1
01751  CCED  0A                 ASL A
01752  CCEE  65 1F              ADC INDEX1
01753  CCF0  A8                 TAY
01754  CCF1  68          QPREC  PLA
01755  CCF2  D9 74 C0           CMP OPTAB,Y
01756  CCF5  B0 67              BCS QCHNUM
01757  CCF7  20 8E CC           JSR CHKNUM
01758  CCFA  48          DOPREC PHA
01759  CCFB  20 21 CD    NEGPRC JSR DOPRE1
01760  CCFE  68                 PLA






CODE9......PAGE 0027

LINE# LOC   CODE        LINE


01761  CCFF  A4 48              LDY OPPTR
01762  CD01  10 17              BPL QPREC1
01763  CD03  AA                 TAX
01764  CD04  F0 56              BEQ QOPGO
01765  CD06  D0 5F              BNE PULSTK
01766  CD08  46 07       FINREL LSR VALTYP
01767  CD0A  8A                 TXA
01768  CD0B  2A                 ROL A
01769  CD0C  A6 77              LDX TXTPTR
01770  CD0E  D0 02              BNE FINRE2
01771  CD10  C6 78              DEC TXTPTR+1
01772  CD12  C6 77       FINRE2 DEC TXTPTR
01773  CD14  A0 1B              LDY #PTDORL-OPTAB
01774  CD16  85 4A              STA OPMASK
01775  CD18  D0 D7              BNE QPREC
01776  CD1A  D9 74 C0    QPREC1 CMP OPTAB,Y
01777  CD1D  B0 48              BCS PULSTK
01778  CD1F  90 D9              BCC DOPREC
01779  CD21  B9 76 C0    DOPRE1 LDA OPTAB+2,Y
01780  CD24  48                 PHA
01781  CD25  B9 75 C0           LDA OPTAB+1,Y
01782  CD28  48                 PHA
01783  CD29  20 34 CD           JSR PUSHF1
01784  CD2C  A5 4A              LDA OPMASK
01785  CD2E  4C AA CC           JMP LPOPER
01786  CD31  4C 03 CE    SNERR5 JMP SNERR
01787  CD34  A5 63       PUSHF1 LDA FACSGN
01788  CD36  BE 74 C0           LDX OPTAB,Y
01789  CD39  A8          PUSHF  TAY
01790  CD3A  68                 PLA
01791  CD3B  85 1F              STA INDEX1
01792  CD3D  E6 1F              INC INDEX1
01793  CD3F  68                 PLA
01794  CD40  85 20              STA INDEX1+1
01795  CD42  98                 TYA
01796  CD43  48                 PHA
01797  CD44  20 27 DB    FORPSH JSR ROUND
01798  CD47  A5 62              LDA FACLO
01799  CD49  48                 PHA
01800  CD4A  A5 61              LDA FACMO
01801  CD4C  48                 PHA
01802  CD4D  A5 60              LDA FACMOH
01803  CD4F  48                 PHA
01804  CD50  A5 5F              LDA FACHO
01805  CD52  48                 PHA
01806  CD53  A5 5E              LDA FACEXP
01807  CD55  48                 PHA
01808  CD56  6C 1F 00           JMP (INDEX1)
01809  CD59  A0 FF       QOP    LDY #255
01810  CD5B  68                 PLA
01811  CD5C  F0 23       QOPGO  BEQ QOPRTS
01812  CD5E  C9 64       QCHNUM CMP #100
01813  CD60  F0 03              BEQ UNPSTK
01814  CD62  20 8E CC           JSR CHKNUM
01815  CD65  84 48       UNPSTK STY OPPTR






CODE9......PAGE 0028

LINE# LOC   CODE        LINE


01816  CD67  68          PULSTK PLA
01817  CD68  4A                 LSR A
01818  CD69  85 0C              STA DOMASK
01819  CD6B  68                 PLA
01820  CD6C  85 66              STA ARGEXP
01821  CD6E  68                 PLA
01822  CD6F  85 67              STA ARGHO
01823  CD71  68                 PLA
01824  CD72  85 68              STA ARGMOH
01825  CD74  68                 PLA
01826  CD75  85 69              STA ARGMO
01827  CD77  68                 PLA
01828  CD78  85 6A              STA ARGLO
01829  CD7A  68                 PLA
01830  CD7B  85 6B              STA ARGSGN
01831  CD7D  45 63              EOR FACSGN
01832  CD7F  85 6C              STA ARISGN
01833  CD81  A5 5E       QOPRTS LDA FACEXP
01834  CD83  60          UNPRTS RTS
01835  CD84  A9 00       EVAL   LDA #0
01836  CD86  85 07              STA VALTYP
01837  CD88  20 70 00    EVAL0  JSR CHRGET
01838  CD8B  B0 03              BCS EVAL2
01839  CD8D  4C FF DB    EVAL1  JMP FIN
01840  CD90  20 F7 CF    EVAL2  JSR ISLETC
01841  CD93  B0 7A              BCS ISVAR
01842  CD95  C9 FF              CMP #PI
01843  CD97  D0 0F              BNE QDOT
01844  CD99  A9 A3              LDA #<PIVAL
01845  CD9B  A0 CD              LDY #>PIVAL
01846  CD9D  20 AE DA           JSR MOVFM
01847  CDA0  4C 70 00           JMP CHRGET
01848  CDA3  82          PIVAL  .BYT @202
01849  CDA4  49                 .BYT @111
01850  CDA5  0F                 .BYT @017
01851  CDA6  DA                 .BYT @332
01852  CDA7  A1                 .BYT @241
01853  CDA8  C9 2E       QDOT   CMP #'.
01854  CDAA  F0 E1              BEQ EVAL1
01855  CDAC  C9 AB              CMP #MINUTK
01856  CDAE  F0 58              BEQ DOMIN
01857  CDB0  C9 AA              CMP #PLUSTK
01858  CDB2  F0 D4              BEQ EVAL0
01859  CDB4  C9 22              CMP #34
01860  CDB6  D0 0F              BNE EVAL3
01861  CDB8  A5 77       STRTXT LDA TXTPTR
01862  CDBA  A4 78              LDY TXTPTR+1
01863  CDBC  69 00              ADC #0
01864  CDBE  90 01              BCC STRTX2
01865  CDC0  C8                 INY
01866  CDC1  20 61 D3    STRTX2 JSR STRLIT
01867  CDC4  4C BD D6           JMP ST2TXT
01868  CDC7  C9 A8       EVAL3  CMP #NOTTK
01869  CDC9  D0 13              BNE EVAL4
01870  CDCB  A0 18              LDY #24






CODE9......PAGE 0029

LINE# LOC   CODE        LINE


01871  CDCD  D0 3B              BNE GONPRC
01872  CDCF  20 9A D0    NOTOP  JSR AYINT
01873  CDD2  A5 62              LDA FACLO
01874  CDD4  49 FF              EOR #255
01875  CDD6  A8                 TAY
01876  CDD7  A5 61              LDA FACMO
01877  CDD9  49 FF              EOR #255
01878  CDDB  4C 6D D2           JMP GIVAYF
01879  CDDE  C9 A5       EVAL4  CMP #FNTK
01880  CDE0  D0 03              BNE *+5
01881  CDE2  4C CE D2           JMP FNDOER
01882  CDE5  C9 B4              CMP #ONEFUN
01883  CDE7  90 03              BCC PARCHK
01884  CDE9  4C 89 CE           JMP ISFUN
01885  CDEC  20 F5 CD    PARCHK JSR CHKOPN
01886  CDEF  20 9F CC           JSR FRMEVL
01887  CDF2  A9 29       CHKCLS LDA #41
01888  CDF4  2C                 .BYT $2C
01889  CDF5  A9 28       CHKOPN LDA #40
01890  CDF7  2C                 .BYT $2C
01891  CDF8  A9 2C       CHKCOM LDA #44
01892  CDFA  A0 00       SYNCHR LDY #0
01893  CDFC  D1 77              CMP (TXTPTR)Y
01894  CDFE  D0 03              BNE SNERR
01895  CE00  4C 70 00           JMP CHRGET
01896  CE03  A2 10       SNERR  LDX #ERRSN
01897  CE05  4C 57 C3           JMP ERROR
01898  CE08  A0 15       DOMIN  LDY #21
01899  CE0A  68          GONPRC PLA
01900  CE0B  68                 PLA
01901  CE0C  4C FB CC           JMP NEGPRC
01902  CE0F              .FIL   CODE10





























CODE10......PAGE 002A

LINE# LOC   CODE        LINE


01904  CE0F  20 6D CF    ISVAR  JSR PTRGET
01905  CE12  85 61       ISVRET STA FACMO
01906  CE14  84 62              STY FACLO
01907  CE16  A5 42              LDA VARNAM
01908  CE18  A4 43              LDY VARNAM+1
01909  CE1A  A6 07              LDX VALTYP
01910  CE1C  F0 25              BEQ GOOO
01911  CE1E  A2 00              LDX #0
01912  CE20  86 6D              STX FACOV
01913  CE22  24 62              BIT FACLO
01914  CE24  10 1C              BPL STRRTS
01915  CE26  C9 54              CMP #'T
01916  CE28  D0 18              BNE STRRTS
01917  CE2A  C0 C9              CPY #$C9
01918  CE2C  D0 14              BNE STRRTS
01919  CE2E  20 69 CE           JSR GETTIM
01920  CE31  84 5B              STY TENEXP
01921  CE33  88                 DEY
01922  CE34  84 6E              STY FBUFPT
01923  CE36  A0 06              LDY #6
01924  CE38  84 5A              STY DECCNT
01925  CE3A  A0 24              LDY #FDCEND-FOUTBL
01926  CE3C  20 74 DD           JSR FOUTIM
01927  CE3F  4C 49 D3           JMP TIMSTR
01928  CE42  60          STRRTS RTS
01929  CE43  A6 08       GOOO   LDX INTFLG
01930  CE45  10 0D              BPL GOOOOO
01931  CE47  A0 00              LDY #0
01932  CE49  B1 61              LDA (FACMO)Y
01933  CE4B  AA                 TAX
01934  CE4C  C8                 INY
01935  CE4D  B1 61              LDA (FACMO)Y
01936  CE4F  A8                 TAY
01937  CE50  8A                 TXA
01938  CE51  4C 6D D2           JMP GIVAYF
01939  CE54  24 62       GOOOOO BIT FACLO       ;AN ARRAY?
01940  CE56  10 2A              BPL GOMOVF
01941  CE58  C9 54              CMP #'T
01942  CE5A  D0 19              BNE QSTATV
01943  CE5C  C0 49              CPY #'I
01944  CE5E  D0 22              BNE GOMOVF
01945  CE60  20 69 CE           JSR GETTIM
01946  CE63  98                 TYA
01947  CE64  A2 A0              LDX #160
01948  CE66  4C 5B DB           JMP FLOATB
01949  CE69              ZZ7=CTIMR-2
01950  CE69  A9 8B       GETTIM LDA #<ZZ7
01951  CE6B  A0 00              LDY #>ZZ7
01952  CE6D  78                 SEI
01953  CE6E  20 AE DA           JSR MOVFM
01954  CE71  58                 CLI
01955  CE72  84 5F              STY FACHO
01956  CE74  60                 RTS
01957  CE75  C9 53       QSTATV CMP #'S
01958  CE77  D0 09              BNE GOMOVF






CODE10......PAGE 002B

LINE# LOC   CODE        LINE


01959  CE79  C0 54              CPY #'T
01960  CE7B  D0 05              BNE GOMOVF
01961  CE7D  A5 96              LDA CSTAT
01962  CE7F  4C 48 DB           JMP FLOAT
01963  CE82  A5 61       GOMOVF LDA FACMO
01964  CE84  A4 62              LDY FACMO+1
01965  CE86  4C AE DA           JMP MOVFM
01966  CE89  0A          ISFUN  ASL A
01967  CE8A  48                 PHA
01968  CE8B  AA                 TAX
01969  CE8C  20 70 00           JSR CHRGET
01970  CE8F  E0 8F              CPX #LASNUM+LASNUM-255
01971  CE91  90 20              BCC OKNORM
01972  CE93  20 F5 CD           JSR CHKOPN
01973  CE96  20 9F CC           JSR FRMEVL
01974  CE99  20 F8 CD           JSR CHKCOM
01975  CE9C  20 90 CC           JSR CHKSTR
01976  CE9F  68                 PLA
01977  CEA0  AA                 TAX
01978  CEA1  A5 62              LDA FACMO+1
01979  CEA3  48                 PHA
01980  CEA4  A5 61              LDA FACMO
01981  CEA6  48                 PHA
01982  CEA7  8A                 TXA
01983  CEA8  48                 PHA
01984  CEA9  20 78 D6           JSR GETBYT
01985  CEAC  68                 PLA
01986  CEAD  A8                 TAY
01987  CEAE  8A                 TXA
01988  CEAF  48                 PHA
01989  CEB0  4C B8 CE           JMP FINGO
01990  CEB3  20 EC CD    OKNORM JSR PARCHK
01991  CEB6  68                 PLA
01992  CEB7  A8                 TAY
01993  CEB8  B9 DE BF    FINGO  LDA FUNDSP-ONEFUN-ONEFUN+256,Y
01994  CEBB  85 52              STA JMPER+1
01995  CEBD  B9 DF BF           LDA FUNDSP-ONEFUN-ONEFUN+257,Y
01996  CEC0  85 53              STA JMPER+2
01997  CEC2  20 51 00           JSR JMPER
01998  CEC5  4C 8E CC           JMP CHKNUM
01999  CEC8  A0 FF       OROP   LDY #255
02000  CECA  2C                 .BYT $2C
02001  CECB  A0 00       ANDOP  LDY #0
02002  CECD  84 05              STY COUNT
02003  CECF  20 9A D0           JSR AYINT
02004  CED2  A5 61              LDA FACMO
02005  CED4  45 05              EOR COUNT
02006  CED6  85 03              STA INTEGR
02007  CED8  A5 62              LDA FACLO
02008  CEDA  45 05              EOR COUNT
02009  CEDC  85 04              STA INTEGR+1
02010  CEDE  20 08 DB           JSR MOVFA
02011  CEE1  20 9A D0           JSR AYINT
02012  CEE4  A5 62              LDA FACLO
02013  CEE6  45 05              EOR COUNT






CODE10......PAGE 002C

LINE# LOC   CODE        LINE


02014  CEE8  25 04              AND INTEGR+1
02015  CEEA  45 05              EOR COUNT
02016  CEEC  A8                 TAY
02017  CEED  A5 61              LDA FACMO
02018  CEEF  45 05              EOR COUNT
02019  CEF1  25 03              AND INTEGR
02020  CEF3  45 05              EOR COUNT
02021  CEF5  4C 6D D2           JMP GIVAYF
02022  CEF8  20 91 CC    DOREL  JSR CHKVAL
02023  CEFB  B0 13              BCS STRCMP
02024  CEFD  A5 6B              LDA ARGSGN
02025  CEFF  09 7F              ORA #127
02026  CF01  25 67              AND ARGHO
02027  CF03  85 67              STA ARGHO
02028  CF05  A9 66              LDA #<ARGEXP
02029  CF07  A0 00              LDY #>ARGEXP
02030  CF09  20 67 DB           JSR FCOMP
02031  CF0C  AA                 TAX
02032  CF0D  4C 43 CF           JMP QCOMP
02033  CF10  A9 00       STRCMP LDA #0
02034  CF12  85 07              STA VALTYP
02035  CF14  C6 4A              DEC OPMASK
02036  CF16  20 80 D5           JSR FREFAC
02037  CF19  85 5E              STA DSCTMP
02038  CF1B  86 5F              STX DSCTMP+1
02039  CF1D  84 60              STY DSCTMP+2
02040  CF1F  A5 69              LDA ARGMO
02041  CF21  A4 6A              LDY ARGMO+1
02042  CF23  20 84 D5           JSR FRETMP
02043  CF26  86 69              STX ARGMO
02044  CF28  84 6A              STY ARGMO+1
02045  CF2A  AA                 TAX
02046  CF2B  38                 SEC
02047  CF2C  E5 5E              SBC DSCTMP
02048  CF2E  F0 08              BEQ STASGN
02049  CF30  A9 01              LDA #1
02050  CF32  90 04              BCC STASGN
02051  CF34  A6 5E              LDX DSCTMP
02052  CF36  A9 FF              LDA #$FF
02053  CF38  85 63       STASGN STA FACSGN
02054  CF3A  A0 FF              LDY #255
02055  CF3C  E8                 INX
02056  CF3D  C8          NXTCMP INY
02057  CF3E  CA                 DEX
02058  CF3F  D0 07              BNE GETCMP
02059  CF41  A6 63              LDX FACSGN
02060  CF43  30 0F       QCOMP  BMI DOCMP
02061  CF45  18                 CLC
02062  CF46  90 0C              BCC DOCMP
02063  CF48  B1 69       GETCMP LDA (ARGMO)Y
02064  CF4A              .FIL   CODE11
02065  CF4A              ;*****CODE11*****
02066  CF4A  D1 5F              CMP (DSCTMP+1)Y
02067  CF4C  F0 EF              BEQ NXTCMP
02068  CF4E  A2 FF              LDX #$FF






CODE10......PAGE 002D

LINE# LOC   CODE        LINE


02069  CF50  B0 02              BCS DOCMP
02070  CF52  A2 01              LDX #1
02071  CF54  E8          DOCMP  INX
02072  CF55  8A                 TXA
02073  CF56  2A                 ROL A
02074  CF57  25 0C              AND DOMASK
02075  CF59  F0 02              BEQ GOFLOT
02076  CF5B  A9 FF              LDA #$FF
02077  CF5D  4C 48 DB    GOFLOT JMP FLOAT
02078  CF60  20 F8 CD    DIM3   JSR CHKCOM
02079  CF63  AA          DIM    TAX
02080  CF64  20 72 CF           JSR PTRGT1
02081  CF67  20 76 00           JSR CHRGOT
02082  CF6A  D0 F4              BNE DIM3
02083  CF6C  60                 RTS
02084  CF6D  A2 00       PTRGET LDX #0
02085  CF6F  20 76 00           JSR CHRGOT
02086  CF72  86 06       PTRGT1 STX DIMFLG
02087  CF74  85 42       PTRGT2 STA VARNAM
02088  CF76  20 76 00           JSR CHRGOT
02089  CF79  20 F7 CF           JSR ISLETC
02090  CF7C  B0 03              BCS PTRGT3
02091  CF7E  4C 03 CE    INTERR JMP SNERR
02092  CF81  A2 00       PTRGT3 LDX #0
02093  CF83  86 07              STX VALTYP
02094  CF85  86 08              STX INTFLG
02095  CF87  20 70 00           JSR CHRGET
02096  CF8A  90 05              BCC ISSEC
02097  CF8C  20 F7 CF           JSR ISLETC
02098  CF8F  90 0B              BCC NOSEC
02099  CF91  AA          ISSEC  TAX
02100  CF92  20 70 00    EATEM  JSR CHRGET
02101  CF95  90 FB              BCC EATEM
02102  CF97  20 F7 CF           JSR ISLETC
02103  CF9A  B0 F6              BCS EATEM
02104  CF9C  C9 24       NOSEC  CMP #'$
02105  CF9E  D0 06              BNE NOTSTR
02106  CFA0  A9 FF              LDA #$FF
02107  CFA2  85 07              STA VALTYP
02108  CFA4  D0 10              BNE TURNON
02109  CFA6  C9 25       NOTSTR CMP #'%
02110  CFA8  D0 13              BNE STRNAM
02111  CFAA  A5 0A              LDA SUBFLG
02112  CFAC  D0 D0              BNE INTERR
02113  CFAE  A9 80              LDA #128
02114  CFB0  85 08              STA INTFLG
02115  CFB2  05 42              ORA VARNAM
02116  CFB4  85 42              STA VARNAM
02117  CFB6  8A          TURNON TXA
02118  CFB7  09 80              ORA #128
02119  CFB9  AA                 TAX
02120  CFBA  20 70 00           JSR CHRGET
02121  CFBD  86 43       STRNAM STX VARNAM+1
02122  CFBF  38                 SEC
02123  CFC0  05 0A              ORA SUBFLG






CODE10......PAGE 002E

LINE# LOC   CODE        LINE


02124  CFC2  E9 28              SBC #40
02125  CFC4  D0 03              BNE *+5
02126  CFC6  4C AC D0           JMP ISARY
02127  CFC9  A9 00              LDA #0
02128  CFCB  85 0A              STA SUBFLG
02129  CFCD  A5 2A              LDA VARTAB
02130  CFCF  A6 2B              LDX VARTAB+1
02131  CFD1  A0 00              LDY #0
02132  CFD3  86 5D       STXFND STX LOWTR+1
02133  CFD5  85 5C       LOPFND STA LOWTR
02134  CFD7  E4 2D              CPX ARYTAB+1
02135  CFD9  D0 04              BNE LOPFN
02136  CFDB  C5 2C              CMP ARYTAB
02137  CFDD  F0 22              BEQ NOTFNS
02138  CFDF  A5 42       LOPFN  LDA VARNAM
02139  CFE1  D1 5C              CMP (LOWTR)Y
02140  CFE3  D0 08              BNE NOTIT
02141  CFE5  A5 43              LDA VARNAM+1
02142  CFE7  C8                 INY
02143  CFE8  D1 5C              CMP (LOWTR)Y
02144  CFEA  F0 7D              BEQ FINPTR
02145  CFEC  88          NXTPTR DEY
02146  CFED  18          NOTIT  CLC
02147  CFEE  A5 5C              LDA LOWTR
02148  CFF0  69 07              ADC #6+ADDPRC
02149  CFF2  90 E1              BCC LOPFND
02150  CFF4  E8                 INX
02151  CFF5  D0 DC              BNE STXFND
02152  CFF7  C9 41       ISLETC CMP #'A
02153  CFF9  90 05              BCC ISLRTS
02154  CFFB  E9 5B              SBC #$5B
02155  CFFD  38                 SEC
02156  CFFE  E9 A5              SBC #@245
02157  D000  60          ISLRTS RTS
02158  D001  68          NOTFNS PLA
02159  D002  48                 PHA
02160  D003              ZZ6=ISVRET-1
02161  D003  C9 11              CMP #<ZZ6
02162  D005  D0 05              BNE NOTEVL
02163  D007  A9 1F       LDZR   LDA #<ZERO
02164  D009  A0 DE              LDY #>ZERO
02165  D00B  60                 RTS
02166  D00C  A5 42       NOTEVL LDA VARNAM
02167  D00E  A4 43              LDY VARNAM+1
02168  D010  C9 54              CMP #'T
02169  D012  D0 0B              BNE QSTAVR
02170  D014  C0 C9              CPY #@311
02171  D016  F0 EF              BEQ LDZR
02172  D018  C0 49              CPY #@111
02173  D01A  D0 03              BNE QSTAVR
02174  D01C  4C 03 CE    GOBADV JMP SNERR
02175  D01F  C9 53       QSTAVR CMP #'S
02176  D021  D0 04              BNE VAROK
02177  D023  C0 54              CPY #'T
02178  D025  F0 F5              BEQ GOBADV






CODE10......PAGE 002F

LINE# LOC   CODE        LINE


02179  D027  A5 2C       VAROK  LDA ARYTAB
02180  D029  A4 2D              LDY ARYTAB+1
02181  D02B  85 5C              STA LOWTR
02182  D02D  84 5D              STY LOWTR+1
02183  D02F  A5 2E              LDA STREND
02184  D031  A4 2F              LDY STREND+1
02185  D033  85 57              STA HIGHTR
02186  D035  84 58              STY HIGHTR+1
02187  D037  18                 CLC
02188  D038  69 07              ADC #6+ADDPRC
02189  D03A  90 01              BCC NOTEVE
02190  D03C  C8                 INY
02191  D03D  85 55       NOTEVE STA HIGHDS
02192  D03F  84 56              STY HIGHDS+1
02193  D041  20 D8 C2           JSR BLTU
02194  D044  A5 55              LDA HIGHDS
02195  D046  A4 56              LDY HIGHDS+1
02196  D048  C8                 INY
02197  D049  85 2C              STA ARYTAB
02198  D04B  84 2D              STY ARYTAB+1
02199  D04D  A0 00       ARYDON LDY #0
02200  D04F  A5 42              LDA VARNAM
02201  D051  91 5C              STA (LOWTR)Y
02202  D053  C8                 INY
02203  D054  A5 43              LDA VARNAM+1
02204  D056  91 5C              STA (LOWTR)Y
02205  D058  A9 00              LDA #0
02206  D05A  C8                 INY
02207  D05B  91 5C              STA (LOWTR)Y
02208  D05D  C8                 INY
02209  D05E  91 5C              STA (LOWTR)Y
02210  D060  C8                 INY
02211  D061  91 5C              STA (LOWTR)Y
02212  D063  C8                 INY
02213  D064  91 5C              STA (LOWTR)Y
02214  D066  C8                 INY
02215  D067  91 5C              STA (LOWTR)Y
02216  D069  A5 5C       FINPTR LDA LOWTR
02217  D06B  18                 CLC
02218  D06C  69 02              ADC #2
02219  D06E  A4 5D              LDY LOWTR+1
02220  D070  90 01              BCC FINNOW
02221  D072  C8                 INY
02222  D073  85 44       FINNOW STA VARPNT
02223  D075  84 45              STY VARPNT+1
02224  D077  60                 RTS
02225  D078  A5 05       FMAPTR LDA COUNT
02226  D07A  0A                 ASL A
02227  D07B  69 05              ADC #5
02228  D07D  65 5C              ADC LOWTR
02229  D07F  A4 5D              LDY LOWTR+1
02230  D081  90 01              BCC JSRGM
02231  D083  C8                 INY
02232  D084  85 55       JSRGM  STA ARYPNT
02233  D086  84 56              STY ARYPNT+1






CODE10......PAGE 0030

LINE# LOC   CODE        LINE


02234  D088  60                 RTS
02235  D089              .FIL   CODE12
02236  D089              ;*****CODE12*****
02237  D089  90          N32768 .BYT 144,128,0,0
02237  D08A  80 
02237  D08B  00 
02237  D08C  00 
02238  D08D  20 70 00    INTIDX JSR CHRGET
02239  D090  20 9F CC           JSR FRMEVL
02240  D093  20 8E CC    POSINT JSR CHKNUM
02241  D096  A5 63              LDA FACSGN
02242  D098  30 0D              BMI NONONO
02243  D09A  A5 5E       AYINT  LDA FACEXP
02244  D09C  C9 90              CMP #144
02245  D09E  90 09              BCC QINTGO
02246  D0A0  A9 89              LDA #<N32768
02247  D0A2  A0 D0              LDY #>N32768
02248  D0A4  20 67 DB           JSR FCOMP
02249  D0A7  D0 7A       NONONO BNE FCERR
02250  D0A9  4C A7 DB    QINTGO JMP QINT
02251  D0AC  A5 06       ISARY  LDA DIMFLG
02252  D0AE  05 08              ORA INTFLG
02253  D0B0  48                 PHA
02254  D0B1  A5 07              LDA VALTYP
02255  D0B3  48                 PHA
02256  D0B4  A0 00              LDY #0
02257  D0B6  98          INDLOP TYA
02258  D0B7  48                 PHA
02259  D0B8  A5 43              LDA VARNAM+1
02260  D0BA  48                 PHA
02261  D0BB  A5 42              LDA VARNAM
02262  D0BD  48                 PHA
02263  D0BE  20 8D D0           JSR INTIDX
02264  D0C1  68                 PLA
02265  D0C2  85 42              STA VARNAM
02266  D0C4  68                 PLA
02267  D0C5  85 43              STA VARNAM+1
02268  D0C7  68                 PLA
02269  D0C8  A8                 TAY
02270  D0C9  BA                 TSX
02271  D0CA  BD 02 01           LDA 258,X
02272  D0CD  48                 PHA
02273  D0CE  BD 01 01           LDA 257,X
02274  D0D1  48                 PHA
02275  D0D2  A5 61              LDA INDICE
02276  D0D4  9D 02 01           STA 258,X
02277  D0D7  A5 62              LDA INDICE+1
02278  D0D9  9D 01 01           STA 257,X
02279  D0DC  C8                 INY
02280  D0DD  20 76 00           JSR CHRGOT
02281  D0E0  C9 2C              CMP #44
02282  D0E2  F0 D2              BEQ INDLOP
02283  D0E4  84 05              STY COUNT
02284  D0E6  20 F2 CD           JSR CHKCLS
02285  D0E9  68                 PLA






CODE10......PAGE 0031

LINE# LOC   CODE        LINE


02286  D0EA  85 07              STA VALTYP
02287  D0EC  68                 PLA
02288  D0ED  85 08              STA INTFLG
02289  D0EF  29 7F              AND #127
02290  D0F1  85 06              STA DIMFLG
02291  D0F3  A6 2C              LDX ARYTAB
02292  D0F5  A5 2D              LDA ARYTAB+1
02293  D0F7  86 5C       LOPFDA STX LOWTR
02294  D0F9  85 5D              STA LOWTR+1
02295  D0FB  C5 2F              CMP STREND+1
02296  D0FD  D0 04              BNE LOPFDV
02297  D0FF  E4 2E              CPX STREND
02298  D101  F0 39              BEQ NOTFDD
02299  D103  A0 00       LOPFDV LDY #0
02300  D105  B1 5C              LDA (LOWTR)Y
02301  D107  C8                 INY
02302  D108  C5 42              CMP VARNAM
02303  D10A  D0 06              BNE NMARY1
02304  D10C  A5 43              LDA VARNAM+1
02305  D10E  D1 5C              CMP (LOWTR)Y
02306  D110  F0 16              BEQ GOTARY
02307  D112  C8          NMARY1 INY
02308  D113  B1 5C              LDA (LOWTR)Y
02309  D115  18                 CLC
02310  D116  65 5C              ADC LOWTR
02311  D118  AA                 TAX
02312  D119  C8                 INY
02313  D11A  B1 5C              LDA (LOWTR)Y
02314  D11C  65 5D              ADC LOWTR+1
02315  D11E  90 D7              BCC LOPFDA
02316  D120  A2 6B       BSERR  LDX #ERRBS
02317  D122  2C                 .BYT $2C
02318  D123  A2 35       FCERR  LDX #ERRFC
02319  D125  4C 57 C3    ERRGO3 JMP ERROR
02320  D128  A2 78       GOTARY LDX #ERRDD
02321  D12A  A5 06              LDA DIMFLG
02322  D12C  D0 F7              BNE ERRGO3
02323  D12E  20 78 D0           JSR FMAPTR
02324  D131  A5 05              LDA COUNT
02325  D133  A0 04              LDY #4
02326  D135  D1 5C              CMP (LOWTR)Y
02327  D137  D0 E7              BNE BSERR
02328  D139  4C C6 D1           JMP GETDEF
02329  D13C  20 78 D0    NOTFDD JSR FMAPTR
02330  D13F  20 28 C3           JSR REASON
02331  D142  A9 00              LDA #0
02332  D144  A8                 TAY
02333  D145  85 6F              STA CURTOL+1
02334  D147  A2 05              LDX #5
02335  D149  A5 42              LDA VARNAM
02336  D14B  91 5C              STA (LOWTR)Y
02337  D14D  10 01              BPL NOTFLT
02338  D14F  CA                 DEX
02339  D150  C8          NOTFLT INY
02340  D151  A5 43              LDA VARNAM+1






CODE10......PAGE 0032

LINE# LOC   CODE        LINE


02341  D153  91 5C              STA (LOWTR)Y
02342  D155  10 02              BPL STOMLT
02343  D157  CA                 DEX
02344  D158  CA                 DEX
02345  D159  86 6E       STOMLT STX CURTOL
02346  D15B  A5 05              LDA COUNT
02347  D15D  C8                 INY
02348  D15E  C8                 INY
02349  D15F  C8                 INY
02350  D160  91 5C              STA (LOWTR)Y
02351  D162  A2 0B       LOPPTA LDX #11
02352  D164  A9 00              LDA #0
02353  D166  24 06              BIT DIMFLG
02354  D168  50 08              BVC NOTDIM
02355  D16A  68                 PLA
02356  D16B  18                 CLC
02357  D16C  69 01              ADC #1
02358  D16E  AA                 TAX
02359  D16F  68                 PLA
02360  D170  69 00              ADC #0
02361  D172  C8          NOTDIM INY
02362  D173  91 5C              STA (LOWTR)Y
02363  D175  C8                 INY
02364  D176  8A                 TXA
02365  D177  91 5C              STA (LOWTR)Y
02366  D179  20 28 D2           JSR UMULT
02367  D17C  86 6E              STX CURTOL
02368  D17E  85 6F              STA CURTOL+1
02369  D180  A4 1F              LDY INDEX
02370  D182  C6 05              DEC COUNT
02371  D184  D0 DC              BNE LOPPTA
02372  D186  65 56              ADC ARYPNT+1
02373  D188  B0 5D              BCS OMERR1
02374  D18A  85 56              STA ARYPNT+1
02375  D18C  A8                 TAY
02376  D18D  8A                 TXA
02377  D18E  65 55              ADC ARYPNT
02378  D190  90 03              BCC GREASE
02379  D192  C8                 INY
02380  D193  F0 52              BEQ OMERR1
02381  D195  20 28 C3    GREASE JSR REASON
02382  D198  85 2E              STA STREND
02383  D19A  84 2F              STY STREND+1
02384  D19C  A9 00              LDA #0
02385  D19E  E6 6F              INC CURTOL+1
02386  D1A0              .FIL   CODE13















CODE13......PAGE 0033

LINE# LOC   CODE        LINE


02388  D1A0  A4 6E              LDY CURTOL
02389  D1A2  F0 05              BEQ DECCUR
02390  D1A4  88          ZERITA DEY
02391  D1A5  91 55              STA (ARYPNT)Y
02392  D1A7  D0 FB              BNE ZERITA
02393  D1A9  C6 56       DECCUR DEC ARYPNT+1
02394  D1AB  C6 6F              DEC CURTOL+1
02395  D1AD  D0 F5              BNE ZERITA
02396  D1AF  E6 56              INC ARYPNT+1
02397  D1B1  38                 SEC
02398  D1B2  A5 2E              LDA STREND
02399  D1B4  E5 5C              SBC LOWTR
02400  D1B6  A0 02              LDY #2
02401  D1B8  91 5C              STA (LOWTR)Y
02402  D1BA  A5 2F              LDA STREND+1
02403  D1BC  C8                 INY
02404  D1BD  E5 5D              SBC LOWTR+1
02405  D1BF  91 5C              STA (LOWTR)Y
02406  D1C1  A5 06              LDA DIMFLG
02407  D1C3  D0 62              BNE DIMRTS
02408  D1C5  C8                 INY
02409  D1C6  B1 5C       GETDEF LDA (LOWTR)Y
02410  D1C8  85 05              STA COUNT
02411  D1CA  A9 00              LDA #0
02412  D1CC  85 6E              STA CURTOL
02413  D1CE  85 6F       INLPNM STA CURTOL+1
02414  D1D0  C8                 INY
02415  D1D1  68                 PLA
02416  D1D2  AA                 TAX
02417  D1D3  85 61              STA INDICE
02418  D1D5  68                 PLA
02419  D1D6  85 62              STA INDICE+1
02420  D1D8  D1 5C              CMP (LOWTR)Y
02421  D1DA  90 0E              BCC INLPN2
02422  D1DC  D0 06              BNE BSERR7
02423  D1DE  C8                 INY
02424  D1DF  8A                 TXA
02425  D1E0  D1 5C              CMP (LOWTR)Y
02426  D1E2  90 07              BCC INLPN1
02427  D1E4  4C 20 D1    BSERR7 JMP BSERR
02428  D1E7  4C 55 C3    OMERR1 JMP OMERR
02429  D1EA  C8          INLPN2 INY
02430  D1EB  A5 6F       INLPN1 LDA CURTOL+1
02431  D1ED  05 6E              ORA CURTOL
02432  D1EF  18                 CLC
02433  D1F0  F0 0A              BEQ ADDIND
02434  D1F2  20 28 D2           JSR UMULT
02435  D1F5  8A                 TXA
02436  D1F6  65 61              ADC INDICE
02437  D1F8  AA                 TAX
02438  D1F9  98                 TYA
02439  D1FA  A4 1F              LDY INDEX1
02440  D1FC  65 62       ADDIND ADC INDICE+1
02441  D1FE  86 6E              STX CURTOL
02442  D200  C6 05              DEC COUNT






CODE13......PAGE 0034

LINE# LOC   CODE        LINE


02443  D202  D0 CA              BNE INLPNM
02444  D204  85 6F              STA CURTOL+1
02445  D206  A2 05              LDX #5
02446  D208  A5 42              LDA VARNAM
02447  D20A  10 01              BPL NOTFL1
02448  D20C  CA                 DEX
02449  D20D  A5 43       NOTFL1 LDA VARNAM+1
02450  D20F  10 02              BPL STOML1
02451  D211  CA                 DEX
02452  D212  CA                 DEX
02453  D213  86 25       STOML1 STX ADDEND
02454  D215  A9 00              LDA #0
02455  D217  20 31 D2           JSR UMULTD
02456  D21A  8A                 TXA
02457  D21B  65 55              ADC ARYPNT
02458  D21D  85 44              STA VARPNT
02459  D21F  98                 TYA
02460  D220  65 56              ADC ARYPNT+1
02461  D222  85 45              STA VARPNT+1
02462  D224  A8                 TAY
02463  D225  A5 44              LDA VARPNT
02464  D227  60          DIMRTS RTS
02465  D228  84 1F       UMULT  STY INDEX
02466  D22A  B1 5C              LDA (LOWTR)Y
02467  D22C  85 25              STA ADDEND
02468  D22E  88                 DEY
02469  D22F  B1 5C              LDA (LOWTR)Y
02470  D231  85 26       UMULTD STA ADDEND+1
02471  D233  A9 10              LDA #16
02472  D235  85 5A              STA DECCNT
02473  D237  A2 00              LDX #0
02474  D239  A0 00              LDY #0
02475  D23B  8A          UMULTC TXA
02476  D23C  0A                 ASL A
02477  D23D  AA                 TAX
02478  D23E  98                 TYA
02479  D23F  2A                 ROL A
02480  D240  A8                 TAY
02481  D241  B0 A4              BCS OMERR1
02482  D243  06 6E              ASL CURTOL
02483  D245  26 6F              ROL CURTOL+1
02484  D247  90 0B              BCC UMLCNT
02485  D249  18                 CLC
02486  D24A  8A                 TXA
02487  D24B  65 25              ADC ADDEND
02488  D24D  AA                 TAX
02489  D24E  98                 TYA
02490  D24F  65 26              ADC ADDEND+1
02491  D251  A8                 TAY
02492  D252  B0 93              BCS OMERR1
02493  D254  C6 5A       UMLCNT DEC DECCNT
02494  D256  D0 E3              BNE UMULTC
02495  D258  60          UMLRTS RTS
02496  D259  A5 07       FRE    LDA VALTYP
02497  D25B  F0 03              BEQ NOFREF






CODE13......PAGE 0035

LINE# LOC   CODE        LINE


02498  D25D  20 80 D5           JSR FREFAC
02499  D260  20 00 D4    NOFREF JSR GARBA2
02500  D263  38                 SEC
02501  D264  A5 30              LDA FRETOP
02502  D266  E5 2E              SBC STREND
02503  D268  A8                 TAY
02504  D269  A5 31              LDA FRETOP+1
02505  D26B  E5 2F              SBC STREND+1
02506  D26D  A2 00       GIVAYF LDX #0
02507  D26F  86 07              STX VALTYP
02508  D271  85 5F              STA FACHO
02509  D273  84 60              STY FACHO+1
02510  D275  A2 90              LDX #144
02511  D277  4C 50 DB           JMP FLOATS
02512  D27A  A4 C6       POS    LDY TRMPOS
02513  D27C  A9 00       SNGFLT LDA #0
02514  D27E  F0 ED              BEQ GIVAYF
02515  D280  A6 37       ERRDIR LDX CURLIN+1
02516  D282  E8                 INX
02517  D283  D0 A2              BNE DIMRTS
02518  D285  A2 95              LDX #ERRID
02519  D287  2C                 .BYT $2C
02520  D288  A2 E9       ERRGUF LDX #ERRUF
02521  D28A  4C 57 C3           JMP ERROR
02522  D28D  20 BB D2    DEF    JSR GETFNM
02523  D290  20 80 D2           JSR ERRDIR
02524  D293  20 F5 CD           JSR CHKOPN
02525  D296  A9 80              LDA #128
02526  D298  85 0A              STA SUBFLG
02527  D29A  20 6D CF           JSR PTRGET
02528  D29D  20 8E CC           JSR CHKNUM
02529  D2A0  20 F2 CD           JSR CHKCLS
02530  D2A3  A9 B2              LDA #$B2
02531  D2A5  20 FA CD           JSR SYNCHR
02532  D2A8  48                 PHA
02533  D2A9  A5 45              LDA VARPNT+1
02534  D2AB  48                 PHA
02535  D2AC  A5 44              LDA VARPNT
02536  D2AE  48                 PHA
02537  D2AF  A5 78              LDA TXTPTR+1
02538  D2B1              .FIL   CODE14




















CODE14......PAGE 0036

LINE# LOC   CODE        LINE


02540  D2B1  48                 PHA
02541  D2B2  A5 77              LDA TXTPTR
02542  D2B4  48                 PHA
02543  D2B5  20 00 C8           JSR DATA
02544  D2B8  4C 29 D3           JMP DEFFIN
02545  D2BB  A9 A5       GETFNM LDA #FNTK
02546  D2BD  20 FA CD           JSR SYNCHR
02547  D2C0  09 80              ORA #128
02548  D2C2  85 0A              STA SUBFLG
02549  D2C4  20 74 CF           JSR PTRGT2
02550  D2C7  85 4B              STA DEFPNT
02551  D2C9  84 4C              STY DEFPNT+1
02552  D2CB  4C 8E CC           JMP CHKNUM
02553  D2CE  20 BB D2    FNDOER JSR GETFNM
02554  D2D1  A5 4C              LDA DEFPNT+1
02555  D2D3  48                 PHA
02556  D2D4  A5 4B              LDA DEFPNT
02557  D2D6  48                 PHA
02558  D2D7  20 EC CD           JSR PARCHK
02559  D2DA  20 8E CC           JSR CHKNUM
02560  D2DD  68                 PLA
02561  D2DE  85 4B              STA DEFPNT
02562  D2E0  68                 PLA
02563  D2E1  85 4C              STA DEFPNT+1
02564  D2E3  A0 02              LDY #2
02565  D2E5  B1 4B              LDA (DEFPNT)Y
02566  D2E7  85 44              STA VARPNT
02567  D2E9  AA                 TAX
02568  D2EA  C8                 INY
02569  D2EB  B1 4B              LDA (DEFPNT)Y
02570  D2ED  F0 99              BEQ ERRGUF
02571  D2EF  85 45              STA VARPNT+1
02572  D2F1  C8                 INY
02573  D2F2  B1 44       DEFSTF LDA (VARPNT)Y
02574  D2F4  48                 PHA
02575  D2F5  88                 DEY
02576  D2F6  10 FA              BPL DEFSTF
02577  D2F8  A4 45              LDY VARPNT+1
02578  D2FA  20 E0 DA           JSR MOVMF
02579  D2FD  A5 78              LDA TXTPTR+1
02580  D2FF  48                 PHA
02581  D300  A5 77              LDA TXTPTR
02582  D302  48                 PHA
02583  D303  B1 4B              LDA (DEFPNT)Y
02584  D305  85 77              STA TXTPTR
02585  D307  C8                 INY
02586  D308  B1 4B              LDA (DEFPNT)Y
02587  D30A  85 78              STA TXTPTR+1
02588  D30C  A5 45              LDA VARPNT+1
02589  D30E  48                 PHA
02590  D30F  A5 44              LDA VARPNT
02591  D311  48                 PHA
02592  D312  20 8B CC           JSR FRMNUM
02593  D315  68                 PLA
02594  D316  85 4B              STA DEFPNT






CODE14......PAGE 0037

LINE# LOC   CODE        LINE


02595  D318  68                 PLA
02596  D319  85 4C              STA DEFPNT+1
02597  D31B  20 76 00           JSR CHRGOT
02598  D31E  F0 03              BEQ *+5
02599  D320  4C 03 CE           JMP SNERR
02600  D323  68                 PLA
02601  D324  85 77              STA TXTPTR
02602  D326  68                 PLA
02603  D327  85 78              STA TXTPTR+1
02604  D329  A0 00       DEFFIN LDY #0
02605  D32B  68                 PLA
02606  D32C  91 4B              STA (DEFPNT)Y
02607  D32E  68                 PLA
02608  D32F  C8                 INY
02609  D330  91 4B              STA (DEFPNT)Y
02610  D332  68                 PLA
02611  D333  C8                 INY
02612  D334  91 4B              STA (DEFPNT)Y
02613  D336  68                 PLA
02614  D337  C8                 INY
02615  D338  91 4B              STA (DEFPNT)Y
02616  D33A  68                 PLA
02617  D33B  C8                 INY
02618  D33C  91 4B              STA (DEFPNT)Y
02619  D33E  60                 RTS
02620  D33F  20 8E CC    STRD   JSR CHKNUM
02621  D342  A0 00              LDY #0
02622  D344  20 EB DC           JSR FOUTC
02623  D347  68                 PLA
02624  D348  68                 PLA
02625  D349  A9 FF       TIMSTR LDA #<LOFBUF
02626  D34B  A0 00              LDY #>LOFBUF
02627  D34D  F0 12              BEQ STRLIT
02628  D34F  A6 61       STRINI LDX FACMO
02629  D351  A4 62              LDY FACMO+1
02630  D353  86 4D              STX DSCPNT
02631  D355  84 4E              STY DSCPNT+1
02632  D357  20 CE D3    STRSPA JSR GETSPA
02633  D35A  86 5F              STX DSCTMP+1
02634  D35C  84 60              STY DSCTMP+2
02635  D35E  85 5E              STA DSCTMP
02636  D360  60                 RTS
02637  D361  A2 22       STRLIT LDX #34
02638  D363  86 03              STX CHARAC
02639  D365  86 04              STX ENDCHR
02640  D367  85 6C       STRLT2 STA STRNG1
02641  D369  84 6D              STY STRNG1+1
02642  D36B  85 5F              STA DSCTMP+1
02643  D36D  84 60              STY DSCTMP+2
02644  D36F  A0 FF              LDY #255
02645  D371  C8          STRGET INY
02646  D372  B1 6C              LDA (STRNG1)Y
02647  D374  F0 0C              BEQ STRFI1
02648  D376  C5 03              CMP CHARAC
02649  D378  F0 04              BEQ STRFIN






CODE14......PAGE 0038

LINE# LOC   CODE        LINE


02650  D37A  C5 04              CMP ENDCHR
02651  D37C  D0 F3              BNE STRGET
02652  D37E  C9 22       STRFIN CMP #34
02653  D380  F0 01              BEQ STRFI2
02654  D382  18          STRFI1 CLC
02655  D383  84 5E       STRFI2 STY DSCTMP
02656  D385  98                 TYA
02657  D386  65 6C              ADC STRNG1
02658  D388  85 6E              STA STRNG2
02659  D38A  A6 6D              LDX STRNG1+1
02660  D38C  90 01              BCC STRST2
02661  D38E  E8                 INX
02662  D38F  86 6F       STRST2 STX STRNG2+1
02663  D391  A5 6D              LDA STRNG1+1
02664  D393  F0 04              BEQ STRCP
02665  D395  C9 02              CMP #BUFPAG
02666  D397  D0 0B              BNE PUTNEW
02667  D399  98          STRCP  TYA
02668  D39A  20 4F D3           JSR STRINI
02669  D39D  A6 6C              LDX STRNG1
02670  D39F  A4 6D              LDY STRNG1+1
02671  D3A1  20 62 D5           JSR MOVSTR
02672  D3A4  A6 13       PUTNEW LDX TEMPPT
02673  D3A6  E0 1F              CPX #TEMPST+STRSIZ+STRSIZ+STRSIZ
02674  D3A8  D0 05              BNE PUTNW1
02675  D3AA  A2 C8              LDX #ERRST
02676  D3AC  4C 57 C3    ERRGO2 JMP ERROR
02677  D3AF  A5 5E       PUTNW1 LDA DSCTMP
02678  D3B1  95 00              STA 0,X
02679  D3B3  A5 5F              LDA DSCTMP+1
02680  D3B5  95 01              STA 1,X
02681  D3B7  A5 60              LDA DSCTMP+2
02682  D3B9  95 02              STA 2,X
02683  D3BB  A0 00              LDY #0
02684  D3BD  86 61              STX FACMO
02685  D3BF  84 62              STY FACMO+1
02686  D3C1  84 6D              STY FACOV
02687  D3C3  88                 DEY
02688  D3C4  84 07              STY VALTYP
02689  D3C6  86 14              STX LASTPT
02690  D3C8  E8                 INX
02691  D3C9  E8                 INX
02692  D3CA  E8                 INX
02693  D3CB  86 13              STX TEMPPT
02694  D3CD  60                 RTS
02695  D3CE  46 09       GETSPA LSR GARBFL
02696  D3D0  48          TRYAG2 PHA
02697  D3D1  49 FF              EOR #255
02698  D3D3  38                 SEC
02699  D3D4  65 30              ADC FRETOP
02700  D3D6  A4 31              LDY FRETOP+1
02701  D3D8  B0 01              BCS TRYAG3
02702  D3DA  88                 DEY
02703  D3DB  C4 2F       TRYAG3 CPY STREND+1
02704  D3DD  90 11              BCC GARBAG






CODE14......PAGE 0039

LINE# LOC   CODE        LINE


02705  D3DF  D0 04              BNE STRFRE
02706  D3E1  C5 2E              CMP STREND
02707  D3E3  90 0B              BCC GARBAG
02708  D3E5  85 30       STRFRE STA FRETOP
02709  D3E7  84 31              STY FRETOP+1
02710  D3E9  85 32              STA FRESPC
02711  D3EB  84 33              STY FRESPC+1
02712  D3ED  AA                 TAX
02713  D3EE  68                 PLA
02714  D3EF  60                 RTS
02715  D3F0  A2 4D       GARBAG LDX #ERROM      ;OUT OF MEMORY
02716  D3F2  A5 09              LDA GARBFL
02717  D3F4  30 B6              BMI ERRGO2
02718  D3F6  20 00 D4           JSR GARBA2
02719  D3F9  A9 80              LDA #128
02720  D3FB  85 09              STA GARBFL
02721  D3FD  68                 PLA
02722  D3FE  D0 D0              BNE TRYAG2
02723  D400  A6 34       GARBA2 LDX MEMSIZ
02724  D402  A5 35              LDA MEMSIZ+1
02725  D404  86 30       FNDVAR STX FRETOP
02726  D406  85 31              STA FRETOP+1
02727  D408  A0 00              LDY #0
02728  D40A  84 4C              STY GRBPNT+1
02729  D40C  84 4B              STY GRBPNT
02730  D40E  A5 2E              LDA STREND
02731  D410  A6 2F              LDX STREND+1
02732  D412  85 5C              STA GRBTOP
02733  D414  86 5D              STX GRBTOP+1
02734  D416  A9 16              LDA #<TEMPST
02735  D418  A2 00              LDX #>TEMPST
02736  D41A  85 1F              STA INDEX1
02737  D41C  86 20              STX INDEX1+1
02738  D41E  C5 13       TVAR   CMP TEMPPT
02739  D420  F0 05              BEQ SVARS
02740  D422  20 A1 D4           JSR DVAR
02741  D425  F0 F7              BEQ TVAR
02742  D427  A9 07       SVARS  LDA #6+ADDPRC
02743  D429  85 50              STA FOUR6
02744  D42B  A5 2A              LDA VARTAB
02745  D42D  A6 2B              LDX VARTAB+1
02746  D42F              .FIL   CODE15



















CODE15......PAGE 003A

LINE# LOC   CODE        LINE


02748  D42F  85 1F              STA INDEX1
02749  D431  86 20              STX INDEX1+1
02750  D433  E4 2D       SVAR   CPX ARYTAB+1
02751  D435  D0 04              BNE SVARGO
02752  D437  C5 2C              CMP ARYTAB
02753  D439  F0 05              BEQ ARYVAR
02754  D43B  20 97 D4    SVARGO JSR DVARS
02755  D43E  F0 F3              BEQ SVAR
02756  D440  85 55       ARYVAR STA ARYPNT
02757  D442  86 56              STX ARYPNT+1
02758  D444  A9 03              LDA #STRSIZ
02759  D446  85 50              STA FOUR6
02760  D448  A5 55       ARYVA2 LDA ARYPNT
02761  D44A  A6 56              LDX ARYPNT+1
02762  D44C  E4 2F       ARYVA3 CPX STREND+1
02763  D44E  D0 07              BNE ARYVGO
02764  D450  C5 2E              CMP STREND
02765  D452  D0 03              BNE *+5
02766  D454  4C E0 D4           JMP GRBPAS
02767  D457  85 1F       ARYVGO STA INDEX1
02768  D459  86 20              STX INDEX1+1
02769  D45B  A0 00              LDY #1-ADDPRC
02770  D45D  B1 1F              LDA (INDEX1)Y
02771  D45F  AA                 TAX
02772  D460  C8                 INY
02773  D461  B1 1F              LDA (INDEX1)Y
02774  D463  08                 PHP
02775  D464  C8                 INY
02776  D465  B1 1F              LDA (INDEX1)Y
02777  D467  65 55              ADC ARYPNT
02778  D469  85 55              STA ARYPNT
02779  D46B  C8                 INY
02780  D46C  B1 1F              LDA (INDEX1)Y
02781  D46E  65 56              ADC ARYPNT+1
02782  D470  85 56              STA ARYPNT+1
02783  D472  28                 PLP
02784  D473  10 D3              BPL ARYVA2
02785  D475  8A                 TXA
02786  D476  30 D0              BMI ARYVA2
02787  D478  C8                 INY
02788  D479  B1 1F              LDA (INDEX1)Y
02789  D47B  A0 00              LDY #0
02790  D47D  0A                 ASL A
02791  D47E  69 05              ADC #5
02792  D480  65 1F              ADC INDEX1
02793  D482  85 1F              STA INDEX1
02794  D484  90 02              BCC ARYGET
02795  D486  E6 20              INC INDEX1+1
02796  D488  A6 20       ARYGET LDX INDEX1+1
02797  D48A  E4 56       ARYSTR CPX ARYPNT+1
02798  D48C  D0 04              BNE GOGO
02799  D48E  C5 55              CMP ARYPNT
02800  D490  F0 BA              BEQ ARYVA3
02801  D492  20 A1 D4    GOGO   JSR DVAR
02802  D495  F0 F3              BEQ ARYSTR






CODE15......PAGE 003B

LINE# LOC   CODE        LINE


02803  D497  B1 1F       DVARS  LDA (INDEX1)Y
02804  D499  30 35              BMI DVARTS
02805  D49B  C8                 INY
02806  D49C  B1 1F              LDA (INDEX1)Y
02807  D49E  10 30              BPL DVARTS
02808  D4A0  C8                 INY
02809  D4A1  B1 1F       DVAR   LDA (INDEX1)Y
02810  D4A3  F0 2B              BEQ DVARTS
02811  D4A5  C8                 INY
02812  D4A6  B1 1F              LDA (INDEX1)Y
02813  D4A8  AA                 TAX
02814  D4A9  C8                 INY
02815  D4AA  B1 1F              LDA (INDEX1)Y
02816  D4AC  C5 31              CMP FRETOP+1
02817  D4AE  90 06              BCC DVAR2
02818  D4B0  D0 1E              BNE DVARTS
02819  D4B2  E4 30              CPX FRETOP
02820  D4B4  B0 1A              BCS DVARTS
02821  D4B6  C5 5D       DVAR2  CMP GRBTOP+1
02822  D4B8  90 16              BCC DVARTS
02823  D4BA  D0 04              BNE DVAR3
02824  D4BC  E4 5C              CPX GRBTOP
02825  D4BE  90 10              BCC DVARTS
02826  D4C0  86 5C       DVAR3  STX GRBTOP
02827  D4C2  85 5D              STA GRBTOP+1
02828  D4C4  A5 1F              LDA INDEX1
02829  D4C6  A6 20              LDX INDEX1+1
02830  D4C8  85 4B              STA GRBPNT
02831  D4CA  86 4C              STX GRBPNT+1
02832  D4CC  A5 50              LDA FOUR6
02833  D4CE  85 52              STA SIZE
02834  D4D0  A5 50       DVARTS LDA FOUR6
02835  D4D2  18                 CLC
02836  D4D3  65 1F              ADC INDEX1
02837  D4D5  85 1F              STA INDEX1
02838  D4D7  90 02              BCC GRBRTS
02839  D4D9  E6 20              INC INDEX1+1
02840  D4DB  A6 20       GRBRTS LDX INDEX1+1
02841  D4DD  A0 00              LDY #0
02842  D4DF  60                 RTS
02843  D4E0  A5 4C       GRBPAS LDA GRBPNT+1
02844  D4E2  05 4B              ORA GRBPNT
02845  D4E4  F0 F5              BEQ GRBRTS
02846  D4E6  A5 52              LDA SIZE
02847  D4E8  29 04              AND #4
02848  D4EA  4A                 LSR A
02849  D4EB  A8                 TAY
02850  D4EC  85 52              STA SIZE
02851  D4EE  B1 4B              LDA (GRBPNT)Y
02852  D4F0  65 5C              ADC LOWTR
02853  D4F2  85 57              STA HIGHTR
02854  D4F4  A5 5D              LDA LOWTR+1
02855  D4F6  69 00              ADC #0
02856  D4F8  85 58              STA HIGHTR+1
02857  D4FA  A5 30              LDA FRETOP






CODE15......PAGE 003C

LINE# LOC   CODE        LINE


02858  D4FC  A6 31              LDX FRETOP+1
02859  D4FE  85 55              STA HIGHDS
02860  D500  86 56              STX HIGHDS+1
02861  D502  20 DF C2           JSR BLTUC
02862  D505  A4 52              LDY SIZE
02863  D507  C8                 INY
02864  D508  A5 55              LDA HIGHDS
02865  D50A  91 4B              STA (GRBPNT)Y
02866  D50C  AA                 TAX
02867  D50D  E6 56              INC HIGHDS+1
02868  D50F  A5 56              LDA HIGHDS+1
02869  D511  C8                 INY
02870  D512  91 4B              STA (GRBPNT)Y
02871  D514  4C 04 D4           JMP FNDVAR
02872  D517  A5 62       CAT    LDA FACLO
02873  D519  48                 PHA
02874  D51A  A5 61              LDA FACMO
02875  D51C  48                 PHA
02876  D51D  20 84 CD           JSR EVAL
02877  D520  20 90 CC           JSR CHKSTR
02878  D523  68                 PLA
02879  D524  85 6C              STA STRNG1
02880  D526  68                 PLA
02881  D527  85 6D              STA STRNG1+1
02882  D529  A0 00              LDY #0
02883  D52B  B1 6C              LDA (STRNG1)Y
02884  D52D  18                 CLC
02885  D52E  71 61              ADC (FACMO)Y
02886  D530  90 05              BCC SIZEOK
02887  D532  A2 B0              LDX #ERRLS
02888  D534  4C 57 C3           JMP ERROR
02889  D537  20 4F D3    SIZEOK JSR STRINI
02890  D53A  20 54 D5           JSR MOVINS
02891  D53D  A5 4D              LDA DSCPNT
02892  D53F  A4 4E              LDY DSCPNT+1
02893  D541  20 84 D5           JSR FRETMP
02894  D544  20 66 D5           JSR MOVDO
02895  D547  A5 6C              LDA STRNG1
02896  D549  A4 6D              LDY STRNG1+1
02897  D54B  20 84 D5           JSR FRETMP
02898  D54E  20 A4 D3           JSR PUTNEW
02899  D551  4C B9 CC           JMP TSTOP
02900  D554  A0 00       MOVINS LDY #0
02901  D556  B1 6C              LDA (STRNG1)Y
02902  D558  48                 PHA
02903  D559  C8                 INY
02904  D55A              .FIL   CODE16














CODE16......PAGE 003D

LINE# LOC   CODE        LINE


02906  D55A  B1 6C              LDA (STRNG1)Y
02907  D55C  AA                 TAX
02908  D55D  C8                 INY
02909  D55E  B1 6C              LDA (STRNG1)Y
02910  D560  A8                 TAY
02911  D561  68                 PLA
02912  D562  86 1F       MOVSTR STX INDEX
02913  D564  84 20              STY INDEX+1
02914  D566  A8          MOVDO  TAY
02915  D567  F0 0A              BEQ MVDONE
02916  D569  48                 PHA
02917  D56A  88          MOVLP  DEY
02918  D56B  B1 1F              LDA (INDEX)Y
02919  D56D  91 32              STA (FRESPC)Y
02920  D56F  98                 TYA
02921  D570  D0 F8              BNE MOVLP
02922  D572  68                 PLA
02923  D573  18          MVDONE CLC
02924  D574  65 32              ADC FRESPC
02925  D576  85 32              STA FRESPC
02926  D578  90 02              BCC MVSTRT
02927  D57A  E6 33              INC FRESPC+1
02928  D57C  60          MVSTRT RTS
02929  D57D  20 90 CC    FRESTR JSR CHKSTR
02930  D580  A5 61       FREFAC LDA FACMO
02931  D582  A4 62              LDY FACMO+1
02932  D584  85 1F       FRETMP STA INDEX
02933  D586  84 20              STY INDEX+1
02934  D588  20 B5 D5           JSR FRETMS
02935  D58B  08                 PHP
02936  D58C  A0 00              LDY #0
02937  D58E  B1 1F              LDA (INDEX),Y
02938  D590  48                 PHA
02939  D591  C8                 INY
02940  D592  B1 1F              LDA (INDEX),Y
02941  D594  AA                 TAX
02942  D595  C8                 INY
02943  D596  B1 1F              LDA (INDEX),Y
02944  D598  A8                 TAY
02945  D599  68                 PLA
02946  D59A  28                 PLP
02947  D59B  D0 13              BNE FRETRT
02948  D59D  C4 31              CPY FRETOP+1
02949  D59F  D0 0F              BNE FRETRT
02950  D5A1  E4 30              CPX FRETOP
02951  D5A3  D0 0B              BNE FRETRT
02952  D5A5              ;
02953  D5A5              ;STRING WAS LAST INTO STRING SFACE
02954  D5A5              ;SAVE GARBAGE COLLECTION SOME TIME
02955  D5A5              ;BY FREEING UP. (LENGTH + 2)
02956  D5A5              ;
02957  D5A5  48                 PHA             ;SAVE LENGTH ON STACK
02958  D5A6  18                 CLC
02959  D5A7  65 30              ADC FRETOP
02960  D5A9  85 30              STA FRETOP






CODE16......PAGE 003E

LINE# LOC   CODE        LINE


02961  D5AB  90 02              BCC FREPLA
02962  D5AD  E6 31              INC FRETOP+1
02963  D5AF  68          FREPLA PLA             ;PULL LENGTH OFF STACK
02964  D5B0  86 1F       FRETRT STX INDEX
02965  D5B2  84 20              STY INDEX+1
02966  D5B4  60                 RTS
02967  D5B5  C4 15       FRETMS CPY LASTPT+1
02968  D5B7  D0 0C              BNE FRERTS
02969  D5B9  C5 14              CMP LASTPT
02970  D5BB  D0 08              BNE FRERTS
02971  D5BD  85 13              STA TEMPPT
02972  D5BF  E9 03              SBC #STRSIZ
02973  D5C1  85 14              STA LASTPT
02974  D5C3  A0 00              LDY #0
02975  D5C5  60          FRERTS RTS
02976  D5C6  20 7B D6    CHRD   JSR CONINT
02977  D5C9  8A                 TXA
02978  D5CA  48                 PHA
02979  D5CB  A9 01              LDA #1
02980  D5CD  20 57 D3           JSR STRSPA
02981  D5D0  68                 PLA
02982  D5D1  A0 00              LDY #0
02983  D5D3  91 5F              STA (DSCTMP+1)Y
02984  D5D5  68                 PLA
02985  D5D6  68                 PLA
02986  D5D7  4C A4 D3           JMP PUTNEW
02987  D5DA  20 3B D6    LEFTD  JSR PREAM
02988  D5DD  D1 4D              CMP (DSCPNT)Y
02989  D5DF  98                 TYA
02990  D5E0  90 04       RLEFT  BCC RLEFT1
02991  D5E2  B1 4D              LDA (DSCPNT)Y
02992  D5E4  AA                 TAX
02993  D5E5  98                 TYA
02994  D5E6  48          RLEFT1 PHA
02995  D5E7  8A          RLEFT2 TXA
02996  D5E8  48          RLEFT3 PHA
02997  D5E9  20 57 D3           JSR STRSPA
02998  D5EC  A5 4D              LDA DSCPNT
02999  D5EE  A4 4E              LDY DSCPNT+1
03000  D5F0  20 84 D5           JSR FRETMP
03001  D5F3  68                 PLA
03002  D5F4  A8                 TAY
03003  D5F5  68                 PLA
03004  D5F6  18                 CLC
03005  D5F7  65 1F              ADC INDEX
03006  D5F9  85 1F              STA INDEX
03007  D5FB  90 02              BCC PULMOR
03008  D5FD  E6 20              INC INDEX+1
03009  D5FF  98          PULMOR TYA
03010  D600  20 66 D5           JSR MOVDO
03011  D603  4C A4 D3           JMP PUTNEW
03012  D606  20 3B D6    RIGHTD JSR PREAM
03013  D609  18                 CLC
03014  D60A  F1 4D              SBC (DSCPNT)Y
03015  D60C  49 FF              EOR #255






CODE16......PAGE 003F

LINE# LOC   CODE        LINE


03016  D60E  4C E0 D5           JMP RLEFT
03017  D611  A9 FF       MIDD   LDA #255
03018  D613  85 62              STA FACLO
03019  D615  20 76 00           JSR CHRGOT
03020  D618  C9 29              CMP #41
03021  D61A  F0 06              BEQ MID2
03022  D61C  20 F8 CD           JSR CHKCOM
03023  D61F  20 78 D6           JSR GETBYT
03024  D622  20 3B D6    MID2   JSR PREAM
03025  D625  F0 4B              BEQ GOFUC
03026  D627  CA                 DEX
03027  D628  8A                 TXA
03028  D629  48                 PHA
03029  D62A  18                 CLC
03030  D62B  A2 00              LDX #0
03031  D62D  F1 4D              SBC (DSCPNT)Y
03032  D62F  B0 B6              BCS RLEFT2
03033  D631  49 FF              EOR #255
03034  D633  C5 62              CMP FACLO
03035  D635  90 B1              BCC RLEFT3
03036  D637  A5 62              LDA FACLO
03037  D639  B0 AD              BCS RLEFT3
03038  D63B  20 F2 CD    PREAM  JSR CHKCLS
03039  D63E  68                 PLA
03040  D63F  A8                 TAY
03041  D640  68                 PLA
03042  D641  85 52              STA JMPER+1
03043  D643  68                 PLA
03044  D644  68                 PLA
03045  D645  68                 PLA
03046  D646  AA                 TAX
03047  D647  68                 PLA
03048  D648  85 4D              STA DSCPNT
03049  D64A  68                 PLA
03050  D64B  85 4E              STA DSCPNT+1
03051  D64D  A5 52              LDA JMPER+1
03052  D64F  48                 PHA
03053  D650  98                 TYA
03054  D651  48                 PHA
03055  D652  A0 00              LDY #0
03056  D654  8A                 TXA
03057  D655  60                 RTS
03058  D656  20 5C D6    LEN    JSR LEN1
03059  D659  4C 7C D2           JMP SNGFLT
03060  D65C  20 7D D5    LEN1   JSR FRESTR
03061  D65F  A2 00              LDX #0
03062  D661  86 07              STX VALTYP
03063  D663  A8                 TAY
03064  D664  60                 RTS
03065  D665  20 5C D6    ASC    JSR LEN1
03066  D668  F0 08              BEQ GOFUC
03067  D66A  A0 00              LDY #0
03068  D66C  B1 1F              LDA (INDEX1)Y
03069  D66E  A8                 TAY
03070  D66F  4C 7C D2           JMP SNGFLT






CODE16......PAGE 0040

LINE# LOC   CODE        LINE


03071  D672  4C 23 D1    GOFUC  JMP FCERR
03072  D675  20 70 00    GTBYTC JSR CHRGET
03073  D678              .FIL   CODE17
03074  D678              ;'CODE17'
03075  D678  20 8B CC    GETBYT JSR FRMNUM
03076  D67B  20 93 D0    CONINT JSR POSINT
03077  D67E  A6 61              LDX FACMO
03078  D680  D0 F0              BNE GOFUC
03079  D682  A6 62              LDX FACLO
03080  D684  4C 76 00           JMP CHRGOT
03081  D687  20 5C D6    VAL    JSR LEN1
03082  D68A  D0 03              BNE *+5
03083  D68C  4C 03 D8           JMP ZEROFC
03084  D68F  A6 77              LDX TXTPTR
03085  D691  A4 78              LDY TXTPTR+1
03086  D693  86 6E              STX STRNG2
03087  D695  84 6F              STY STRNG2+1
03088  D697  A6 1F              LDX INDEX1
03089  D699  86 77              STX TXTPTR
03090  D69B  18                 CLC
03091  D69C  65 1F              ADC INDEX1
03092  D69E  85 21              STA INDEX2
03093  D6A0  A6 20              LDX INDEX1+1
03094  D6A2  86 78              STX TXTPTR+1
03095  D6A4  90 01              BCC VAL2
03096  D6A6  E8                 INX 
03097  D6A7  86 22       VAL2   STX INDEX2+1
03098  D6A9  A0 00              LDY #0
03099  D6AB  B1 21              LDA (INDEX2)Y
03100  D6AD  48                 PHA
03101  D6AE  A9 00              LDA #0
03102  D6B0  91 21              STA (INDEX2)Y
03103  D6B2  20 76 00           JSR CHRGOT
03104  D6B5  20 FF DB           JSR FIN
03105  D6B8  68                 PLA
03106  D6B9  A0 00              LDY #0
03107  D6BB  91 21              STA (INDEX2)Y
03108  D6BD  A6 6E       ST2TXT LDX STRNG2
03109  D6BF  A4 6F              LDY STRNG2+1
03110  D6C1  86 77              STX TXTPTR
03111  D6C3  84 78              STY TXTPTR+1
03112  D6C5  60          VALRTS RTS
03113  D6C6  20 8B CC    GETNUM JSR FRMNUM
03114  D6C9  20 D2 D6           JSR GETADR
03115  D6CC  20 F8 CD    COMBYT JSR CHKCOM
03116  D6CF  4C 78 D6           JMP GETBYT
03117  D6D2  A5 63       GETADR LDA FACSGN
03118  D6D4  30 9C              BMI GOFUC
03119  D6D6  A5 5E              LDA FACEXP
03120  D6D8  C9 91              CMP #145
03121  D6DA  B0 96              BCS GOFUC
03122  D6DC  20 A7 DB           JSR QINT
03123  D6DF  A5 61              LDA FACMO
03124  D6E1  A4 62              LDY FACMO+1
03125  D6E3  84 11              STY POKER






CODE16......PAGE 0041

LINE# LOC   CODE        LINE


03126  D6E5  85 12              STA POKER+1
03127  D6E7  60                 RTS
03128  D6E8  A5 12       PEEK   LDA POKER+1
03129  D6EA  48                 PHA
03130  D6EB  A5 11              LDA POKER
03131  D6ED  48                 PHA
03132  D6EE  20 D2 D6           JSR GETADR
03133  D6F1  A0 00              LDY #0
03134  D6F3  EA                 NOP
03135  D6F4  EA                 NOP
03136  D6F5  EA                 NOP
03137  D6F6  EA                 NOP
03138  D6F7  EA                 NOP
03139  D6F8  EA                 NOP
03140  D6F9  EA                 NOP
03141  D6FA  EA                 NOP
03142  D6FB  B1 11       GETCON LDA (POKER)Y
03143  D6FD  A8                 TAY
03144  D6FE  68          DOSGFL PLA
03145  D6FF  85 11              STA POKER
03146  D701  68                 PLA
03147  D702  85 12              STA POKER+1
03148  D704  4C 7C D2           JMP SNGFLT
03149  D707  20 C6 D6    POKE   JSR GETNUM
03150  D70A  8A                 TXA
03151  D70B  A0 00              LDY #0
03152  D70D  91 11              STA (POKER)Y
03153  D70F  60                 RTS
03154  D710  20 C6 D6    FNWAIT JSR GETNUM
03155  D713  86 46              STX ANDMSK
03156  D715  A2 00              LDX #0
03157  D717  20 76 00           JSR CHRGOT
03158  D71A  F0 29              BEQ STORD1
03159  D71C  20 CC D6           JSR COMBYT
03160  D71F  86 47       STORDO STX EORMSK
03161  D721  A0 00              LDY #0
03162  D723  B1 11       WAITER LDA (POKER)Y
03163  D725  45 47              EOR EORMSK
03164  D727  25 46              AND ANDMSK
03165  D729  F0 F8              BEQ WAITER
03166  D72B  60          ZERRTS RTS
03167  D72C  A9 1D       FADDH  LDA #<FHALF
03168  D72E  A0 DE              LDY #>FHALF
03169  D730  4C 73 D7           JMP FADD
03170  D733  20 98 D9    FSUB   JSR CONUPK
03171  D736  A5 63       FSUBT  LDA FACSGN
03172  D738  49 FF              EOR #@377
03173  D73A  85 63              STA FACSGN
03174  D73C  45 6B              EOR ARGSGN
03175  D73E  85 6C              STA ARISGN
03176  D740  A5 5E              LDA FACEXP
03177  D742  4C 76 D7           JMP FADDT
03178  D745  A5 11       STORD1 LDA LINNUM
03179  D747  C9 66              CMP #$66
03180  D749  D0 D4              BNE STORDO






CODE16......PAGE 0042

LINE# LOC   CODE        LINE


03181  D74B  A5 12              LDA LINNUM+1
03182  D74D  E9 19              SBC #$19
03183  D74F  D0 CE              BNE STORDO
03184  D751  85 11              STA LINNUM
03185  D753  A8                 TAY
03186  D754  A9 80              LDA #$80
03187  D756  85 12              STA LINNUM+1
03188  D758  A2 0A       MRCHKR LDX #10
03189  D75A  BD 81 E0    MRCHR  LDA SINCON+30,X
03190  D75D  29 3F              AND #$3F
03191  D75F  91 11              STA (LINNUM),Y
03192  D761  C8                 INY
03193  D762  D0 02              BNE PKINC
03194  D764  E6 12              INC LINNUM+1
03195  D766  CA          PKINC  DEX
03196  D767  D0 F1              BNE MRCHR
03197  D769  C6 46              DEC LSTPNT
03198  D76B  D0 EB              BNE MRCHKR
03199  D76D  60                 RTS
03200  D76E  20 A5 D8    FADD5  JSR SHIFTR
03201  D771  90 3C              BCC FADD4
03202  D773  20 98 D9    FADD   JSR CONUPK
03203  D776  D0 03       FADDT  BNE *+5
03204  D778  4C 08 DB           JMP MOVFA
03205  D77B  A6 6D              LDX FACOV
03206  D77D  86 53              STX OLDOV
03207  D77F  A2 66              LDX #ARGEXP
03208  D781  A5 66              LDA ARGEXP
03209  D783  A8          FADDC  TAY
03210  D784  F0 A5              BEQ ZERRTS
03211  D786  38                 SEC
03212  D787  E5 5E              SBC FACEXP
03213  D789  F0 24              BEQ FADD4
03214  D78B  90 12              BCC FADDA
03215  D78D  84 5E              STY FACEXP
03216  D78F  A4 6B              LDY ARGSGN
03217  D791  84 63              STY FACSGN
03218  D793  49 FF              EOR #@377
03219  D795  69 00              ADC #0
03220  D797  A0 00              LDY #0
03221  D799  84 53              STY OLDOV
03222  D79B  A2 5E              LDX #FAC
03223  D79D  D0 04              BNE FADD1
03224  D79F  A0 00       FADDA  LDY #0
03225  D7A1  84 6D              STY FACOV
03226  D7A3  C9 F9       FADD1  CMP #$F9
03227  D7A5  30 C7              BMI FADD5
03228  D7A7  A8                 TAY
03229  D7A8  A5 6D              LDA FACOV
03230  D7AA  56 01              LSR 1,X
03231  D7AC  20 BC D8           JSR ROLSHF
03232  D7AF  24 6C       FADD4  BIT ARISGN
03233  D7B1  10 57              BPL FADD2
03234  D7B3  A0 5E              LDY #FACEXP
03235  D7B5  E0 66              CPX #ARGEXP






CODE16......PAGE 0043

LINE# LOC   CODE        LINE


03236  D7B7  F0 02              BEQ SUBIT
03237  D7B9  A0 66              LDY #ARGEXP
03238  D7BB  38          SUBIT  SEC
03239  D7BC  49 FF              EOR #@377
03240  D7BE  65 53              ADC OLDOV
03241  D7C0  85 6D              STA FACOV
03242  D7C2  B9 04 00           LDA 3+ADDPRC,Y
03243  D7C5  F5 04              SBC 3+ADDPRC,X
03244  D7C7  85 62              STA FACLO
03245  D7C9  B9 03 00           LDA ADDPRC+2,Y
03246  D7CC  F5 03              SBC 2+ADDPRC,X
03247  D7CE  85 61              STA FACMO
03248  D7D0  B9 02 00           LDA 2,Y
03249  D7D3  F5 02              SBC 2,X
03250  D7D5  85 60              STA FACMOH
03251  D7D7  B9 01 00           LDA 1,Y
03252  D7DA  F5 01              SBC 1,X
03253  D7DC  85 5F              STA FACHO
03254  D7DE  B0 03       FADFLT BCS NORMAL
03255  D7E0  20 53 D8           JSR NEGFAC
03256  D7E3  A0 00       NORMAL LDY #0
03257  D7E5  98                 TYA
03258  D7E6  18                 CLC
03259  D7E7  A6 5F       NORM3  LDX FACHO
03260  D7E9  D0 4A              BNE NORM1
03261  D7EB  A6 60              LDX FACHO+1
03262  D7ED  86 5F              STX FACHO
03263  D7EF  A6 61              LDX FACMOH+1
03264  D7F1              .FIL   CODE18
































CODE18......PAGE 0044

LINE# LOC   CODE        LINE


03266  D7F1  86 60              STX FACMOH
03267  D7F3  A6 62              LDX FACMO+1
03268  D7F5  86 61              STX FACMO
03269  D7F7  A6 6D              LDX FACOV
03270  D7F9  86 62              STX FACLO
03271  D7FB  84 6D              STY FACOV
03272  D7FD  69 08              ADC #@10
03273  D7FF              ADDPR2 =ADDPRC+ADDPRC
03274  D7FF              ADDPR4 =ADDPR2+ADDPR2
03275  D7FF              ADDPR8 =ADDPR4+ADDPR4
03276  D7FF  C9 20              CMP #@30+ADDPR8
03277  D801  D0 E4              BNE NORM3
03278  D803  A9 00       ZEROFC LDA #0
03279  D805  85 5E       ZEROF1 STA FACEXP
03280  D807  85 63       ZEROML STA FACSGN
03281  D809  60                 RTS
03282  D80A  65 53       FADD2  ADC OLDOV
03283  D80C  85 6D              STA FACOV
03284  D80E  A5 62              LDA FACLO
03285  D810  65 6A              ADC ARGLO
03286  D812  85 62              STA FACLO
03287  D814  A5 61              LDA FACMO
03288  D816  65 69              ADC ARGMO
03289  D818  85 61              STA FACMO
03290  D81A  A5 60              LDA FACMOH
03291  D81C  65 68              ADC ARGMOH
03292  D81E  85 60              STA FACMOH
03293  D820  A5 5F              LDA FACHO
03294  D822  65 67              ADC ARGHO
03295  D824  85 5F              STA FACHO
03296  D826  4C 42 D8           JMP SQUEEZ
03297  D829  69 01       NORM2  ADC #1
03298  D82B  06 6D              ASL FACOV
03299  D82D  26 62              ROL FACLO
03300  D82F  26 61              ROL FACMO
03301  D831  26 60              ROL FACMOH
03302  D833  26 5F              ROL FACHO
03303  D835  10 F2       NORM1  BPL NORM2
03304  D837  38                 SEC
03305  D838  E5 5E              SBC FACEXP
03306  D83A  B0 C7              BCS ZEROFC
03307  D83C  49 FF              EOR #@377
03308  D83E  69 01              ADC #1
03309  D840  85 5E              STA FACEXP
03310  D842  90 0E       SQUEEZ BCC RNDRTS
03311  D844  E6 5E       RNDSHF INC FACEXP
03312  D846  F0 42              BEQ OVERR
03313  D848  66 5F              ROR FACHO
03314  D84A  66 60              ROR FACMOH
03315  D84C  66 61              ROR FACMO
03316  D84E  66 62              ROR FACLO
03317  D850  66 6D              ROR FACOV
03318  D852  60          RNDRTS RTS
03319  D853  A5 63       NEGFAC LDA FACSGN
03320  D855  49 FF              EOR #@377






CODE18......PAGE 0045

LINE# LOC   CODE        LINE


03321  D857  85 63              STA FACSGN
03322  D859  A5 5F       NEGFCH LDA FACHO
03323  D85B  49 FF              EOR #@377
03324  D85D  85 5F              STA FACHO
03325  D85F  A5 60              LDA FACMOH
03326  D861  49 FF              EOR #@377
03327  D863  85 60              STA FACMOH
03328  D865  A5 61              LDA FACMO
03329  D867  49 FF              EOR #@377
03330  D869  85 61              STA FACMO
03331  D86B  A5 62              LDA FACLO
03332  D86D  49 FF              EOR #@377
03333  D86F  85 62              STA FACLO
03334  D871  A5 6D              LDA FACOV
03335  D873  49 FF              EOR #@377
03336  D875  85 6D              STA FACOV
03337  D877  E6 6D              INC FACOV
03338  D879  D0 0E              BNE INCFRT
03339  D87B  E6 62       INCFAC INC FACLO
03340  D87D  D0 0A              BNE INCFRT
03341  D87F  E6 61              INC FACMO
03342  D881  D0 06              BNE INCFRT
03343  D883  E6 60              INC FACMOH
03344  D885  D0 02              BNE INCFRT
03345  D887  E6 5F              INC FACHO
03346  D889  60          INCFRT RTS
03347  D88A  A2 45       OVERR  LDX #ERROV
03348  D88C  4C 57 C3           JMP ERROR
03349  D88F  A2 22       MULSHF LDX #RESHO-1
03350  D891  B4 04       SHFTR2 LDY 3+ADDPRC,X
03351  D893  84 6D              STY FACOV
03352  D895  B4 03              LDY 3,X
03353  D897  94 04              STY 4,X
03354  D899  B4 02              LDY 2,X
03355  D89B  94 03              STY 3,X
03356  D89D  B4 01              LDY 1,X
03357  D89F  94 02              STY 2,X
03358  D8A1  A4 65              LDY BITS
03359  D8A3  94 01              STY 1,X
03360  D8A5  69 08       SHIFTR ADC #@10
03361  D8A7  30 E8              BMI SHFTR2
03362  D8A9  F0 E6              BEQ SHFTR2
03363  D8AB  E9 08              SBC #@10
03364  D8AD  A8                 TAY
03365  D8AE  A5 6D              LDA FACOV
03366  D8B0  B0 14              BCS SHFTRT
03367  D8B2  16 01       SHFTR3 ASL 1,X
03368  D8B4  90 02              BCC SHFTR4
03369  D8B6  F6 01              INC 1,X
03370  D8B8  76 01       SHFTR4 ROR 1,X
03371  D8BA  76 01              ROR 1,X
03372  D8BC  76 02       ROLSHF ROR 2,X
03373  D8BE  76 03              ROR 3,X
03374  D8C0  76 04              ROR 4,X
03375  D8C2  6A                 ROR A






CODE18......PAGE 0046

LINE# LOC   CODE        LINE


03376  D8C3  C8                 INY
03377  D8C4  D0 EC              BNE SHFTR3
03378  D8C6  18          SHFTRT CLC
03379  D8C7  60                 RTS
03380  D8C8  81          FONE   .BYT @201,0,0,0,0
03380  D8C9  00 
03380  D8CA  00 
03380  D8CB  00 
03380  D8CC  00 
03381  D8CD  03          LOGCN2 .BYT 3,@177,@136,@126
03381  D8CE  7F 
03381  D8CF  5E 
03381  D8D0  56 
03382  D8D1  CB                 .BYT @313,@171,@200,@23
03382  D8D2  79 
03382  D8D3  80 
03382  D8D4  13 
03383  D8D5  9B                 .BYT @233,@13,@144,@200
03383  D8D6  0B 
03383  D8D7  64 
03383  D8D8  80 
03384  D8D9  76                 .BYT @166,@70,@223,@26
03384  D8DA  38 
03384  D8DB  93 
03384  D8DC  16 
03385  D8DD  82                 .BYT @202,@70,@252,@73,@40
03385  D8DE  38 
03385  D8DF  AA 
03385  D8E0  3B 
03385  D8E1  20 
03386  D8E2  80          SQR05  .BYT @200,@65,4,@363,@64
03386  D8E3  35 
03386  D8E4  04 
03386  D8E5  F3 
03386  D8E6  34 
03387  D8E7  81          SQR20  .BYT @201,@65,@4,@363,@64
03387  D8E8  35 
03387  D8E9  04 
03387  D8EA  F3 
03387  D8EB  34 
03388  D8EC  80          NEGHLF .BYT @200,@200,0,0,0
03388  D8ED  80 
03388  D8EE  00 
03388  D8EF  00 
03388  D8F0  00 
03389  D8F1  80          LOG2   .BYT @200,@61,@162,@27,@370
03389  D8F2  31 
03389  D8F3  72 
03389  D8F4  17 
03389  D8F5  F8 
03390  D8F6              .FIL   CODE19










CODE19......PAGE 0047

LINE# LOC   CODE        LINE


03392  D8F6  20 37 DB    LOG    JSR SIGN
03393  D8F9  F0 02              BEQ LOGERR
03394  D8FB  10 03              BPL LOG1
03395  D8FD  4C 23 D1    LOGERR JMP FCERR
03396  D900  A5 5E       LOG1   LDA FACEXP
03397  D902  E9 7F              SBC #@177
03398  D904  48                 PHA
03399  D905  A9 80              LDA #@200
03400  D907  85 5E              STA FACEXP
03401  D909  A9 E2              LDA #<SQR05
03402  D90B  A0 D8              LDY #>SQR05
03403  D90D  20 73 D7           JSR FADD
03404  D910  A9 E7              LDA #<SQR20
03405  D912  A0 D8              LDY #>SQR20
03406  D914  20 1B DA           JSR FDIV
03407  D917  A9 C8              LDA #<FONE
03408  D919  A0 D8              LDY #>FONE
03409  D91B  20 33 D7           JSR FSUB
03410  D91E  A9 CD              LDA #<LOGCN2
03411  D920  A0 D8              LDY #>LOGCN2
03412  D922  20 2D DF           JSR POLYX
03413  D925  A9 EC              LDA #<NEGHLF
03414  D927  A0 D8              LDY #>NEGHLF
03415  D929  20 73 D7           JSR FADD
03416  D92C  68                 PLA
03417  D92D  20 8A DC           JSR FINLOG
03418  D930  A9 F1              LDA #<LOG2
03419  D932  A0 D8              LDY #>LOG2
03420  D934  20 98 D9    FMULT  JSR CONUPK
03421  D937  D0 03       FMULTT BNE *+5
03422  D939  4C 97 D9           JMP MULTRT
03423  D93C  20 C3 D9           JSR MULDIV
03424  D93F  A9 00              LDA #0
03425  D941  85 23              STA RESHO
03426  D943  85 24              STA RESMOH
03427  D945  85 25              STA RESMO
03428  D947  85 26              STA RESLO
03429  D949  A5 6D              LDA FACOV
03430  D94B  20 65 D9           JSR MLTPLY
03431  D94E  A5 62              LDA FACLO
03432  D950  20 65 D9           JSR MLTPLY
03433  D953  A5 61              LDA FACMO
03434  D955  20 65 D9           JSR MLTPLY
03435  D958  A5 60              LDA FACMOH
03436  D95A  20 65 D9           JSR MLTPLY
03437  D95D  A5 5F              LDA FACHO
03438  D95F  20 6A D9           JSR MLTPL1
03439  D962  4C 9B DA           JMP MOVFR
03440  D965  D0 03       MLTPLY BNE *+5
03441  D967  4C 8F D8           JMP MULSHF
03442  D96A  4A          MLTPL1 LSR A
03443  D96B  09 80              ORA #@200
03444  D96D  A8          MLTPL2 TAY
03445  D96E  90 19              BCC MLTPL3
03446  D970  18                 CLC






CODE19......PAGE 0048

LINE# LOC   CODE        LINE


03447  D971  A5 26              LDA RESLO
03448  D973  65 6A              ADC ARGLO
03449  D975  85 26              STA RESLO
03450  D977  A5 25              LDA RESMO
03451  D979  65 69              ADC ARGMO
03452  D97B  85 25              STA RESMO
03453  D97D  A5 24              LDA RESMOH
03454  D97F  65 68              ADC ARGMOH
03455  D981  85 24              STA RESMOH
03456  D983  A5 23              LDA RESHO
03457  D985  65 67              ADC ARGHO
03458  D987  85 23              STA RESHO
03459  D989  66 23       MLTPL3 ROR RESHO
03460  D98B  66 24              ROR RESMOH
03461  D98D  66 25              ROR RESMO
03462  D98F  66 26              ROR RESLO
03463  D991  66 6D              ROR FACOV
03464  D993  98                 TYA
03465  D994  4A                 LSR A
03466  D995  D0 D6              BNE MLTPL2
03467  D997  60          MULTRT RTS
03468  D998  85 1F       CONUPK STA INDEX1
03469  D99A  84 20              STY INDEX1+1
03470  D99C  A0 04              LDY #4
03471  D99E  B1 1F              LDA (INDEX1)Y
03472  D9A0  85 6A              STA ARGLO
03473  D9A2  88                 DEY
03474  D9A3  B1 1F              LDA (INDEX)Y
03475  D9A5  85 69              STA ARGMO
03476  D9A7  88                 DEY
03477  D9A8  B1 1F              LDA (INDEX1)Y
03478  D9AA  85 68              STA ARGMOH
03479  D9AC  88                 DEY
03480  D9AD  B1 1F              LDA (INDEX1)Y
03481  D9AF  85 6B              STA ARGSGN
03482  D9B1  45 63              EOR FACSGN
03483  D9B3  85 6C              STA ARISGN
03484  D9B5  A5 6B              LDA ARGSGN
03485  D9B7  09 80              ORA #@200
03486  D9B9  85 67              STA ARGHO
03487  D9BB  88                 DEY
03488  D9BC  B1 1F              LDA (INDEX1)Y
03489  D9BE  85 66              STA ARGEXP
03490  D9C0  A5 5E              LDA FACEXP
03491  D9C2  60                 RTS
03492  D9C3  A5 66       MULDIV LDA ARGEXP
03493  D9C5  F0 1F       MLDEXP BEQ ZEREMV
03494  D9C7  18                 CLC
03495  D9C8  65 5E              ADC FACEXP
03496  D9CA  90 04              BCC TRYOFF
03497  D9CC  30 1D              BMI GOOVER
03498  D9CE  18                 CLC
03499  D9CF  2C                 .BYT $2C
03500  D9D0  10 14       TRYOFF BPL ZEREMV
03501  D9D2  69 80              ADC #@200






CODE19......PAGE 0049

LINE# LOC   CODE        LINE


03502  D9D4  85 5E              STA FACEXP
03503  D9D6  D0 03              BNE *+5
03504  D9D8  4C 07 D8           JMP ZEROML
03505  D9DB  A5 6C              LDA ARISGN
03506  D9DD  85 63              STA FACSGN
03507  D9DF  60                 RTS
03508  D9E0  A5 63       MLDVEX LDA FACSGN
03509  D9E2  49 FF              EOR #@377
03510  D9E4  30 05              BMI GOOVER
03511  D9E6  68          ZEREMV PLA
03512  D9E7  68                 PLA
03513  D9E8  4C 03 D8           JMP ZEROFC
03514  D9EB  4C 8A D8    GOOVER JMP OVERR
03515  D9EE  20 18 DB    MUL10  JSR MOVAF
03516  D9F1  AA                 TAX
03517  D9F2  F0 10              BEQ MUL10R
03518  D9F4  18                 CLC
03519  D9F5  69 02              ADC #2
03520  D9F7  B0 F2              BCS GOOVER
03521  D9F9  A2 00       FINML6 LDX #0
03522  D9FB  86 6C              STX ARISGN
03523  D9FD  20 83 D7           JSR FADDC
03524  DA00  E6 5E              INC FACEXP
03525  DA02  F0 E7              BEQ GOOVER
03526  DA04  60          MUL10R RTS
03527  DA05  84          TENC   .BYT @204,@40,0,0,0
03527  DA06  20 
03527  DA07  00 
03527  DA08  00 
03527  DA09  00 
03528  DA0A  20 18 DB    DIV10  JSR MOVAF
03529  DA0D  A9 05              LDA #<TENC
03530  DA0F  A0 DA              LDY #>TENC
03531  DA11  A2 00              LDX #0
03532  DA13  86 6C       FDIVF  STX ARISGN
03533  DA15  20 AE DA           JSR MOVFM
03534  DA18  4C 1E DA           JMP FDIVT
03535  DA1B  20 98 D9    FDIV   JSR CONUPK
03536  DA1E  F0 76       FDIVT  BEQ DV0ERR
03537  DA20  20 27 DB           JSR ROUND
03538  DA23  A9 00              LDA #0
03539  DA25  38                 SEC
03540  DA26  E5 5E              SBC FACEXP
03541  DA28  85 5E              STA FACEXP
03542  DA2A  20 C3 D9           JSR MULDIV
03543  DA2D  E6 5E              INC FACEXP
03544  DA2F  F0 BA              BEQ GOOVER
03545  DA31  A2 FC              LDX #$FC
03546  DA33  A9 01              LDA #1
03547  DA35  A4 67       DIVIDE LDY ARGHO
03548  DA37  C4 5F              CPY FACHO
03549  DA39  D0 10              BNE SAVQUO
03550  DA3B  A4 68              LDY ARGMOH
03551  DA3D  C4 60              CPY FACMOH
03552  DA3F  D0 0A              BNE SAVQUO






CODE19......PAGE 004A

LINE# LOC   CODE        LINE


03553  DA41  A4 69              LDY ARGMO
03554  DA43  C4 61              CPY FACMO
03555  DA45  D0 04              BNE SAVQUO
03556  DA47  A4 6A              LDY ARGLO
03557  DA49  C4 62              CPY FACLO
03558  DA4B  08          SAVQUO PHP
03559  DA4C  2A                 ROL A
03560  DA4D  90 09              BCC QSHFT
03561  DA4F  E8                 INX
03562  DA50  95 26              STA RESLO,X
03563  DA52  F0 32              BEQ LD100
03564  DA54  10 34              BPL DIVNRM
03565  DA56  A9 01              LDA #1
03566  DA58  28          QSHFT  PLP
03567  DA59  B0 0E              BCS DIVSUB
03568  DA5B  06 6A       SHFARG ASL ARGLO
03569  DA5D  26 69              ROL ARGMO
03570  DA5F  26 68              ROL ARGMOH
03571  DA61  26 67              ROL ARGHO
03572  DA63  B0 E6              BCS SAVQUO
03573  DA65  30 CE              BMI DIVIDE
03574  DA67  10 E2              BPL SAVQUO
03575  DA69  A8          DIVSUB TAY
03576  DA6A  A5 6A              LDA ARGLO
03577  DA6C  E5 62              SBC FACLO
03578  DA6E  85 6A              STA ARGLO
03579  DA70  A5 69              LDA ARGMO
03580  DA72  E5 61              SBC FACMO
03581  DA74  85 69              STA ARGMO
03582  DA76  A5 68              LDA ARGMOH
03583  DA78  E5 60              SBC FACMOH
03584  DA7A  85 68              STA ARGMOH
03585  DA7C  A5 67              LDA ARGHO
03586  DA7E  E5 5F              SBC FACHO
03587  DA80  85 67              STA ARGHO
03588  DA82  98                 TYA
03589  DA83  4C 5B DA           JMP SHFARG
03590  DA86  A9 40       LD100  LDA #@100
03591  DA88  D0 CE              BNE QSHFT
03592  DA8A  0A          DIVNRM ASL A
03593  DA8B  0A                 ASL A
03594  DA8C  0A                 ASL A
03595  DA8D  0A                 ASL A
03596  DA8E  0A                 ASL A
03597  DA8F  0A                 ASL A
03598  DA90  85 6D              STA FACOV
03599  DA92  28                 PLP
03600  DA93  4C 9B DA           JMP MOVFR
03601  DA96  A2 85       DV0ERR LDX #ERRDVO
03602  DA98  4C 57 C3           JMP ERROR
03603  DA9B              .FIL   CODE20










CODE20......PAGE 004B

LINE# LOC   CODE        LINE


03605  DA9B  A5 23       MOVFR  LDA RESHO
03606  DA9D  85 5F              STA FACHO
03607  DA9F  A5 24              LDA RESMOH
03608  DAA1  85 60              STA FACMOH
03609  DAA3  A5 25              LDA RESMO
03610  DAA5  85 61              STA FACMO
03611  DAA7  A5 26              LDA RESLO
03612  DAA9  85 62              STA FACLO
03613  DAAB  4C E3 D7           JMP NORMAL
03614  DAAE  85 1F       MOVFM  STA INDEX1
03615  DAB0  84 20              STY INDEX1+1
03616  DAB2  A0 04              LDY #3+ADDPRC
03617  DAB4  B1 1F              LDA (INDEX1)Y
03618  DAB6  85 62              STA FACLO
03619  DAB8  88                 DEY
03620  DAB9  B1 1F              LDA (INDEX1)Y
03621  DABB  85 61              STA FACMO
03622  DABD  88                 DEY
03623  DABE  B1 1F              LDA (INDEX1)Y
03624  DAC0  85 60              STA FACMOH
03625  DAC2  88                 DEY
03626  DAC3  B1 1F              LDA (INDEX1)Y
03627  DAC5  85 63              STA FACSGN
03628  DAC7  09 80              ORA #@200
03629  DAC9  85 5F              STA FACHO
03630  DACB  88                 DEY
03631  DACC  B1 1F              LDA (INDEX1)Y
03632  DACE  85 5E              STA FACEXP
03633  DAD0  84 6D              STY FACOV
03634  DAD2  60                 RTS
03635  DAD3  A2 59       MOV2F  LDX #TEMPF2
03636  DAD5  2C                 .BYT $2C
03637  DAD6  A2 54       MOV1F  LDX #TEMPF1
03638  DAD8  A0 00              LDY #0
03639  DADA  F0 04              BEQ MOVMF
03640  DADC  A6 46       MOVVF  LDX FORPNT
03641  DADE  A4 47              LDY FORPNT+1
03642  DAE0  20 27 DB    MOVMF  JSR ROUND
03643  DAE3  86 1F              STX INDEX1
03644  DAE5  84 20              STY INDEX1+1
03645  DAE7  A0 04              LDY #3+ADDPRC
03646  DAE9  A5 62              LDA FACLO
03647  DAEB  91 1F              STA (INDEX)Y
03648  DAED  88                 DEY
03649  DAEE  A5 61              LDA FACMO
03650  DAF0  91 1F              STA (INDEX)Y
03651  DAF2  88                 DEY
03652  DAF3  A5 60              LDA FACMOH
03653  DAF5  91 1F              STA (INDEX)Y
03654  DAF7  88                 DEY
03655  DAF8  A5 63              LDA FACSGN
03656  DAFA  09 7F              ORA #@177
03657  DAFC  25 5F              AND FACHO
03658  DAFE  91 1F              STA (INDEX)Y
03659  DB00  88                 DEY






CODE20......PAGE 004C

LINE# LOC   CODE        LINE


03660  DB01  A5 5E              LDA FACEXP
03661  DB03  91 1F              STA (INDEX)Y
03662  DB05  84 6D              STY FACOV
03663  DB07  60                 RTS
03664  DB08  A5 6B       MOVFA  LDA ARGSGN
03665  DB0A  85 63       MOVFA1 STA FACSGN
03666  DB0C  A2 05              LDX #4+ADDPRC
03667  DB0E  B5 65       MOVFAL LDA ARGEXP-1,X
03668  DB10  95 5D              STA FACEXP-1,X
03669  DB12  CA                 DEX
03670  DB13  D0 F9              BNE MOVFAL
03671  DB15  86 6D              STX FACOV
03672  DB17  60                 RTS
03673  DB18  20 27 DB    MOVAF  JSR ROUND
03674  DB1B  A2 06       MOVEF  LDX #5+ADDPRC
03675  DB1D  B5 5D       MOVAFL LDA FACEXP-1,X
03676  DB1F  95 65              STA ARGEXP-1,X
03677  DB21  CA                 DEX
03678  DB22  D0 F9              BNE MOVAFL
03679  DB24  86 6D              STX FACOV
03680  DB26  60          MOVRTS RTS
03681  DB27  A5 5E       ROUND  LDA FACEXP
03682  DB29  F0 FB              BEQ MOVRTS
03683  DB2B  06 6D              ASL FACOV
03684  DB2D  90 F7              BCC MOVRTS
03685  DB2F  20 7B D8    INCRND JSR INCFAC
03686  DB32  D0 F2              BNE MOVRTS
03687  DB34  4C 44 D8           JMP RNDSHF
03688  DB37  A5 5E       SIGN   LDA FACEXP
03689  DB39  F0 09              BEQ SIGNRT
03690  DB3B  A5 63       FCSIGN LDA FACSGN
03691  DB3D  2A          FCOMPS ROL A
03692  DB3E  A9 FF              LDA #$FF
03693  DB40  B0 02              BCS SIGNRT
03694  DB42  A9 01              LDA #1
03695  DB44  60          SIGNRT RTS
03696  DB45  20 37 DB    SGN    JSR SIGN
03697  DB48  85 5F       FLOAT  STA FACHO
03698  DB4A  A9 00              LDA #0
03699  DB4C  85 60              STA FACHO+1
03700  DB4E  A2 88              LDX #@210
03701  DB50  A5 5F       FLOATS LDA FACHO
03702  DB52  49 FF              EOR #@377
03703  DB54  2A                 ROL A
03704  DB55  A9 00       FLOATC LDA #0
03705  DB57  85 62              STA FACLO
03706  DB59  85 61              STA FACMO
03707  DB5B  86 5E       FLOATB STX FACEXP
03708  DB5D  85 6D              STA FACOV
03709  DB5F  85 63              STA FACSGN
03710  DB61  4C DE D7           JMP FADFLT
03711  DB64  46 63       ABS    LSR FACSGN
03712  DB66  60                 RTS
03713  DB67  85 21       FCOMP  STA INDEX2
03714  DB69  84 22       FCOMPN STY INDEX2+1






CODE20......PAGE 004D

LINE# LOC   CODE        LINE


03715  DB6B  A0 00              LDY #0
03716  DB6D  B1 21              LDA (INDEX2)Y
03717  DB6F  C8                 INY
03718  DB70  AA                 TAX
03719  DB71  F0 C4              BEQ SIGN
03720  DB73  B1 21              LDA (INDEX2)Y
03721  DB75  45 63              EOR FACSGN
03722  DB77  30 C2              BMI FCSIGN
03723  DB79  E4 5E              CPX FACEXP
03724  DB7B  D0 21              BNE FCOMPC
03725  DB7D  B1 21              LDA (INDEX2)Y
03726  DB7F  09 80              ORA #@200
03727  DB81  C5 5F              CMP FACHO
03728  DB83  D0 19              BNE FCOMPC
03729  DB85  C8                 INY
03730  DB86  B1 21              LDA (INDEX2)Y
03731  DB88  C5 60              CMP FACMOH
03732  DB8A  D0 12              BNE FCOMPC
03733  DB8C  C8                 INY
03734  DB8D  B1 21              LDA (INDEX2)Y
03735  DB8F  C5 61              CMP FACMO
03736  DB91  D0 0B              BNE FCOMPC
03737  DB93  C8                 INY
03738  DB94  A9 7F              LDA #@177
03739  DB96  C5 6D              CMP FACOV
03740  DB98  B1 21              LDA (INDEX2)Y
03741  DB9A  E5 62              SBC FACLO
03742  DB9C  F0 28              BEQ QINTRT
03743  DB9E  A5 63       FCOMPC LDA FACSGN
03744  DBA0  90 02              BCC FCOMPD
03745  DBA2  49 FF              EOR #@377
03746  DBA4  4C 3D DB    FCOMPD JMP FCOMPS
03747  DBA7              .FIL   CODE21




























CODE21......PAGE 004E

LINE# LOC   CODE        LINE


03749  DBA7  A5 5E       QINT   LDA FACEXP
03750  DBA9  F0 4A              BEQ CLRFAC
03751  DBAB  38                 SEC
03752  DBAC  E9 A0              SBC #ADDPR8+@230
03753  DBAE  24 63              BIT FACSGN
03754  DBB0  10 09              BPL QISHFT
03755  DBB2  AA                 TAX
03756  DBB3  A9 FF              LDA #@377
03757  DBB5  85 65              STA BITS
03758  DBB7  20 59 D8           JSR NEGFCH
03759  DBBA  8A                 TXA
03760  DBBB  A2 5E       QISHFT LDX #FAC
03761  DBBD  C9 F9              CMP #$F9
03762  DBBF  10 06              BPL QINT1
03763  DBC1  20 A5 D8           JSR SHIFTR
03764  DBC4  84 65              STY BITS
03765  DBC6  60          QINTRT RTS
03766  DBC7  A8          QINT1  TAY
03767  DBC8  A5 63              LDA FACSGN
03768  DBCA  29 80              AND #@200
03769  DBCC  46 5F              LSR FACHO
03770  DBCE  05 5F              ORA FACHO
03771  DBD0  85 5F              STA FACHO
03772  DBD2  20 BC D8           JSR ROLSHF
03773  DBD5  84 65              STY BITS
03774  DBD7  60                 RTS
03775  DBD8  A5 5E       INT    LDA FACEXP
03776  DBDA  C9 A0              CMP #ADDPR8+@230
03777  DBDC  B0 20              BCS INTRTS
03778  DBDE  20 A7 DB           JSR QINT
03779  DBE1  84 6D              STY FACOV
03780  DBE3  A5 63              LDA FACSGN
03781  DBE5  84 63              STY FACSGN
03782  DBE7  49 80              EOR #@200
03783  DBE9  2A                 ROL A
03784  DBEA  A9 A0              LDA #@230+8
03785  DBEC  85 5E              STA FACEXP
03786  DBEE  A5 62              LDA FACLO
03787  DBF0  85 03              STA INTEGR
03788  DBF2  4C DE D7           JMP FADFLT
03789  DBF5  85 5F       CLRFAC STA FACHO
03790  DBF7  85 60              STA FACMOH
03791  DBF9  85 61              STA FACMO
03792  DBFB  85 62              STA FACLO
03793  DBFD  A8                 TAY
03794  DBFE  60          INTRTS RTS
03795  DBFF  A0 00       FIN    LDY #@0
03796  DC01  A2 0A              LDX #@11+ADDPRC
03797  DC03  94 5A       FINZLP STY DECCNT,X
03798  DC05  CA                 DEX
03799  DC06  10 FB              BPL FINZLP
03800  DC08  90 0F              BCC FINDGQ
03801  DC0A  C9 2D              CMP #'-
03802  DC0C  D0 04              BNE QPLUS
03803  DC0E  86 64              STX SGNFLG






CODE21......PAGE 004F

LINE# LOC   CODE        LINE


03804  DC10  F0 04              BEQ FINC
03805  DC12  C9 2B       QPLUS  CMP #'+
03806  DC14  D0 05              BNE FIN1
03807  DC16  20 70 00    FINC   JSR CHRGET
03808  DC19  90 5B       FINDGQ BCC FINDIG
03809  DC1B  C9 2E       FIN1   CMP #'.
03810  DC1D  F0 2E              BEQ FINDP
03811  DC1F  C9 45              CMP #'E
03812  DC21  D0 30              BNE FINE
03813  DC23  20 70 00           JSR CHRGET
03814  DC26  90 17              BCC FNEDG1
03815  DC28  C9 AB              CMP #MINUTK
03816  DC2A  F0 0E              BEQ FINEC1
03817  DC2C  C9 2D              CMP #'-
03818  DC2E  F0 0A              BEQ FINEC1
03819  DC30  C9 AA              CMP #PLUSTK
03820  DC32  F0 08              BEQ FINEC
03821  DC34  C9 2B              CMP #'+
03822  DC36  F0 04              BEQ FINEC
03823  DC38  D0 07              BNE FINEC2
03824  DC3A  66 5D       FINEC1 ROR EXPSGN
03825  DC3C  20 70 00    FINEC  JSR CHRGET
03826  DC3F  90 5C       FNEDG1 BCC FINEDG
03827  DC41  24 5D       FINEC2 BIT EXPSGN
03828  DC43  10 0E              BPL FINE
03829  DC45  A9 00              LDA #0
03830  DC47  38                 SEC
03831  DC48  E5 5B              SBC TENEXP
03832  DC4A  4C 55 DC           JMP FINE1
03833  DC4D  66 5C       FINDP  ROR DPTFLG
03834  DC4F  24 5C              BIT DPTFLG
03835  DC51  50 C3              BVC FINC
03836  DC53  A5 5B       FINE   LDA TENEXP
03837  DC55  38          FINE1  SEC
03838  DC56  E5 5A              SBC DECCNT
03839  DC58  85 5B              STA TENEXP
03840  DC5A  F0 12              BEQ FINQNG
03841  DC5C  10 09              BPL FINMUL
03842  DC5E  20 0A DA    FINDIV JSR DIV10
03843  DC61  E6 5B              INC TENEXP
03844  DC63  D0 F9              BNE FINDIV
03845  DC65  F0 07              BEQ FINQNG
03846  DC67  20 EE D9    FINMUL JSR MUL10
03847  DC6A  C6 5B              DEC TENEXP
03848  DC6C  D0 F9              BNE FINMUL
03849  DC6E  A5 64       FINQNG LDA SGNFLG
03850  DC70  30 01              BMI NEGXQS
03851  DC72  60                 RTS
03852  DC73  4C A1 DE    NEGXQS JMP NEGOP
03853  DC76  48          FINDIG PHA
03854  DC77  24 5C              BIT DPTFLG
03855  DC79  10 02              BPL FINDG1
03856  DC7B  E6 5A              INC DECCNT
03857  DC7D  20 EE D9    FINDG1 JSR MUL10
03858  DC80  68                 PLA






CODE21......PAGE 0050

LINE# LOC   CODE        LINE


03859  DC81  38                 SEC
03860  DC82  E9 30              SBC #'0
03861  DC84  20 8A DC           JSR FINLOG
03862  DC87  4C 16 DC           JMP FINC
03863  DC8A  48          FINLOG PHA
03864  DC8B  20 18 DB           JSR MOVAF
03865  DC8E  68                 PLA
03866  DC8F  20 48 DB           JSR FLOAT
03867  DC92  A5 6B              LDA ARGSGN
03868  DC94  45 63              EOR FACSGN
03869  DC96  85 6C              STA ARISGN
03870  DC98  A6 5E              LDX FACEXP
03871  DC9A  4C 76 D7           JMP FADDT
03872  DC9D  A5 5B       FINEDG LDA TENEXP
03873  DC9F  C9 0A              CMP #@12
03874  DCA1  90 09              BCC MLEX10
03875  DCA3  A9 64              LDA #@144
03876  DCA5  24 5D              BIT EXPSGN
03877  DCA7  30 11              BMI MLEXMI
03878  DCA9  4C 8A D8           JMP OVERR
03879  DCAC  0A          MLEX10 ASL A
03880  DCAD  0A                 ASL A
03881  DCAE  18                 CLC
03882  DCAF  65 5B              ADC TENEXP
03883  DCB1  0A                 ASL A
03884  DCB2  18                 CLC
03885  DCB3  A0 00              LDY #0
03886  DCB5  71 77              ADC (TXTPTR)Y
03887  DCB7  38                 SEC
03888  DCB8  E9 30              SBC #'0
03889  DCBA  85 5B       MLEXMI STA TENEXP
03890  DCBC  4C 3C DC           JMP FINEC
03891  DCBF              .FIL   CODE22




























CODE22......PAGE 0051

LINE# LOC   CODE        LINE


03893  DCBF  9B          N0999  .BYT @233,@76,@274,@37,@375
03893  DCC0  3E 
03893  DCC1  BC 
03893  DCC2  1F 
03893  DCC3  FD 
03894  DCC4  9E          N9999  .BYT @236,@156,@153,@47,@375
03894  DCC5  6E 
03894  DCC6  6B 
03894  DCC7  27 
03894  DCC8  FD 
03895  DCC9  9E          NMIL   .BYT @236,@156,@153,@50,0
03895  DCCA  6E 
03895  DCCB  6B 
03895  DCCC  28 
03895  DCCD  00 
03896  DCCE  A9 92       INPRT  LDA #<INTXT
03897  DCD0  A0 C2              LDY #>INTXT
03898  DCD2  20 E6 DC           JSR STROU2
03899  DCD5  A5 37              LDA CURLIN+1
03900  DCD7  A6 36              LDX CURLIN
03901  DCD9  85 5F       LINPRT STA FACHO
03902  DCDB  86 60              STX FACHO+1
03903  DCDD  A2 90              LDX #@220
03904  DCDF  38                 SEC
03905  DCE0  20 55 DB           JSR FLOATC
03906  DCE3  20 E9 DC           JSR FOUT
03907  DCE6  4C 1C CA    STROU2 JMP STROUT
03908  DCE9  A0 01       FOUT   LDY #1
03909  DCEB  A9 20       FOUTC  LDA #' 
03910  DCED  24 63              BIT FACSGN
03911  DCEF  10 02              BPL FOUT1
03912  DCF1  A9 2D              LDA #'-
03913  DCF3  99 FF 00    FOUT1  STA FBUFFR-1,Y
03914  DCF6  85 63              STA FACSGN
03915  DCF8  84 6E              STY FBUFPT
03916  DCFA  C8                 INY
03917  DCFB  A9 30              LDA #'0
03918  DCFD  A6 5E              LDX FACEXP
03919  DCFF  D0 03              BNE *+5
03920  DD01  4C 10 DE           JMP FOUT19
03921  DD04  A9 00              LDA #0
03922  DD06  E0 80              CPX #@200
03923  DD08  F0 02              BEQ FOUT37
03924  DD0A  B0 09              BCS FOUT7
03925  DD0C  A9 C9       FOUT37 LDA #<NMIL
03926  DD0E  A0 DC              LDY #>NMIL
03927  DD10  20 34 D9           JSR FMULT
03928  DD13  A9 F7              LDA #250-ADDPR2-ADDPRC
03929  DD15  85 5A       FOUT7  STA DECCNT
03930  DD17  A9 C4       FOUT4  LDA #<N9999
03931  DD19  A0 DC              LDY #>N9999
03932  DD1B  20 67 DB           JSR FCOMP
03933  DD1E  F0 1E              BEQ BIGGES
03934  DD20  10 12              BPL FOUT9
03935  DD22  A9 BF       FOUT3  LDA #<N0999






CODE22......PAGE 0052

LINE# LOC   CODE        LINE


03936  DD24  A0 DC              LDY #>N0999
03937  DD26  20 67 DB           JSR FCOMP
03938  DD29  F0 02              BEQ FOUT38
03939  DD2B  10 0E              BPL FOUT5
03940  DD2D  20 EE D9    FOUT38 JSR MUL10
03941  DD30  C6 5A              DEC DECCNT
03942  DD32  D0 EE              BNE FOUT3
03943  DD34  20 0A DA    FOUT9  JSR DIV10
03944  DD37  E6 5A              INC DECCNT
03945  DD39  D0 DC              BNE FOUT4
03946  DD3B  20 2C D7    FOUT5  JSR FADDH
03947  DD3E  20 A7 DB    BIGGES JSR QINT
03948  DD41  A2 01              LDX #1
03949  DD43  A5 5A              LDA DECCNT
03950  DD45  18                 CLC
03951  DD46  69 0A              ADC #ADDPR2+ADDPRC+7
03952  DD48  30 09              BMI FOUTPI
03953  DD4A  C9 0B              CMP #ADDPR2+ADDPRC+@10
03954  DD4C  B0 06              BCS FOUT6
03955  DD4E  69 FF              ADC #$FF
03956  DD50  AA                 TAX
03957  DD51  A9 02              LDA #2
03958  DD53  38          FOUTPI SEC
03959  DD54  E9 02       FOUT6  SBC #2
03960  DD56  85 5B              STA TENEXP
03961  DD58  86 5A              STX DECCNT
03962  DD5A  8A                 TXA
03963  DD5B  F0 02              BEQ FOUT39
03964  DD5D  10 13              BPL FOUT8
03965  DD5F  A4 6E       FOUT39 LDY FBUFPT
03966  DD61  A9 2E              LDA #'.
03967  DD63  C8                 INY
03968  DD64  99 FF 00           STA FBUFFR-1,Y
03969  DD67  8A                 TXA
03970  DD68  F0 06              BEQ FOUT16
03971  DD6A  A9 30              LDA #'0
03972  DD6C  C8                 INY
03973  DD6D  99 FF 00           STA FBUFFR-1,Y
03974  DD70  84 6E       FOUT16 STY FBUFPT
03975  DD72  A0 00       FOUT8  LDY #0
03976  DD74  A2 80       FOUTIM LDX #@200
03977  DD76  A5 62       FOUT2  LDA FACLO
03978  DD78  18                 CLC
03979  DD79  79 25 DE           ADC FOUTBL+2+ADDPRC,Y
03980  DD7C  85 62              STA FACLO
03981  DD7E  A5 61              LDA FACMO
03982  DD80  79 24 DE           ADC FOUTBL+1+ADDPRC,Y
03983  DD83  85 61              STA FACMO
03984  DD85  A5 60              LDA FACMOH
03985  DD87  79 23 DE           ADC FOUTBL+1,Y
03986  DD8A  85 60              STA FACMOH
03987  DD8C  A5 5F              LDA FACHO
03988  DD8E  79 22 DE           ADC FOUTBL,Y
03989  DD91  85 5F              STA FACHO
03990  DD93  E8                 INX






CODE22......PAGE 0053

LINE# LOC   CODE        LINE


03991  DD94  B0 04              BCS FOUT41
03992  DD96  10 DE              BPL FOUT2
03993  DD98  30 02              BMI FOUT40
03994  DD9A  30 DA       FOUT41 BMI FOUT2
03995  DD9C  8A          FOUT40 TXA
03996  DD9D  90 04              BCC FOUTYP
03997  DD9F  49 FF              EOR #@377
03998  DDA1  69 0A              ADC #@12
03999  DDA3  69 2F       FOUTYP ADC #@57
04000  DDA5  C8                 INY
04001  DDA6  C8                 INY
04002  DDA7  C8                 INY
04003  DDA8  C8                 INY
04004  DDA9  84 44              STY FDECPT
04005  DDAB  A4 6E              LDY FBUFPT
04006  DDAD  C8                 INY
04007  DDAE  AA                 TAX
04008  DDAF  29 7F              AND #@177
04009  DDB1  99 FF 00           STA FBUFFR-1,Y
04010  DDB4  C6 5A              DEC DECCNT
04011  DDB6  D0 06              BNE STXBUF
04012  DDB8  A9 2E              LDA #'.
04013  DDBA  C8                 INY
04014  DDBB  99 FF 00           STA FBUFFR-1,Y
04015  DDBE  84 6E       STXBUF STY FBUFPT
04016  DDC0  A4 44              LDY FDECPT
04017  DDC2  8A                 TXA
04018  DDC3  49 FF              EOR #@377
04019  DDC5  29 80              AND #@200
04020  DDC7  AA                 TAX
04021  DDC8  C0 24              CPY #FDCEND-FOUTBL
04022  DDCA  F0 04              BEQ FOULDY
04023  DDCC  C0 3C              CPY #TIMEND-FOUTBL
04024  DDCE  D0 A6              BNE FOUT2
04025  DDD0  A4 6E       FOULDY LDY FBUFPT
04026  DDD2  B9 FF 00    FOUT11 LDA FBUFFR-1,Y
04027  DDD5  88                 DEY
04028  DDD6  C9 30              CMP #'0
04029  DDD8  F0 F8              BEQ FOUT11
04030  DDDA  C9 2E              CMP #'.
04031  DDDC  F0 01              BEQ FOUT12
04032  DDDE  C8                 INY
04033  DDDF  A9 2B       FOUT12 LDA #'+
04034  DDE1  A6 5B              LDX TENEXP
04035  DDE3  F0 2E              BEQ FOUT17
04036  DDE5  10 08              BPL FOUT14
04037  DDE7  A9 00              LDA #0
04038  DDE9  38                 SEC
04039  DDEA  E5 5B              SBC TENEXP
04040  DDEC  AA                 TAX
04041  DDED              .FIL   CODE23










CODE23......PAGE 0054

LINE# LOC   CODE        LINE


04043  DDED  A9 2D              LDA #'-
04044  DDEF  99 01 01    FOUT14 STA FBUFFR+1,Y
04045  DDF2  A9 45              LDA #'E
04046  DDF4  99 00 01           STA FBUFFR,Y
04047  DDF7  8A                 TXA
04048  DDF8  A2 2F              LDX #@57
04049  DDFA  38                 SEC
04050  DDFB  E8          FOUT15 INX
04051  DDFC  E9 0A              SBC #@12
04052  DDFE  B0 FB              BCS FOUT15
04053  DE00  69 3A              ADC #@72
04054  DE02  99 03 01           STA FBUFFR+3,Y
04055  DE05  8A                 TXA
04056  DE06  99 02 01           STA FBUFFR+2,Y
04057  DE09  A9 00              LDA #0
04058  DE0B  99 04 01           STA FBUFFR+4,Y
04059  DE0E  F0 08              BEQ FOUT20
04060  DE10  99 FF 00    FOUT19 STA FBUFFR-1,Y
04061  DE13  A9 00       FOUT17 LDA #0
04062  DE15  99 00 01           STA FBUFFR,Y
04063  DE18  A9 00       FOUT20 LDA #<FBUFFR
04064  DE1A  A0 01              LDY #>FBUFFR
04065  DE1C  60                 RTS
04066  DE1D  80          FHALF  .BYT @200,0
04066  DE1E  00 
04067  DE1F  00          ZERO   .BYT 0,0,0
04067  DE20  00 
04067  DE21  00 
04068  DE22  FA          FOUTBL .BYT @372,@12,@37,0,0
04068  DE23  0A 
04068  DE24  1F 
04068  DE25  00 
04068  DE26  00 
04069  DE27  98                 .BYT @230,@226,@200,@377
04069  DE28  96 
04069  DE29  80 
04069  DE2A  FF 
04070  DE2B  F0                 .BYT @360,@275,@300,0
04070  DE2C  BD 
04070  DE2D  C0 
04070  DE2E  00 
04071  DE2F  01                 .BYT 1,@206,@240,@377
04071  DE30  86 
04071  DE31  A0 
04071  DE32  FF 
04072  DE33  FF                 .BYT @377,@330,@360,0,0
04072  DE34  D8 
04072  DE35  F0 
04072  DE36  00 
04072  DE37  00 
04073  DE38  03                 .BYT 3,@350,@377,@377
04073  DE39  E8 
04073  DE3A  FF 
04073  DE3B  FF 
04074  DE3C  FF                 .BYT @377,@234,0,0,0,@12






CODE23......PAGE 0055

LINE# LOC   CODE        LINE


04074  DE3D  9C 
04074  DE3E  00 
04074  DE3F  00 
04074  DE40  00 
04074  DE41  0A 
04075  DE42  FF                 .BYT @377,@377,@377,@377
04075  DE43  FF 
04075  DE44  FF 
04075  DE45  FF 
04076  DE46  FF          FDCEND .BYT @377,@337,@12,@200
04076  DE47  DF 
04076  DE48  0A 
04076  DE49  80 
04077  DE4A  00                 .BYT 0,3,@113,@300,@377
04077  DE4B  03 
04077  DE4C  4B 
04077  DE4D  C0 
04077  DE4E  FF 
04078  DE4F  FF                 .BYT @377,@163,@140,0,0
04078  DE50  73 
04078  DE51  60 
04078  DE52  00 
04078  DE53  00 
04079  DE54  0E                 .BYT @16,@20,@377,@377
04079  DE55  10 
04079  DE56  FF 
04079  DE57  FF 
04080  DE58  FD                 .BYT @375,@250,0,0,0,@74
04080  DE59  A8 
04080  DE5A  00 
04080  DE5B  00 
04080  DE5C  00 
04080  DE5D  3C 
04081  DE5E              TIMEND
04082  DE5E  20 18 DB    SQR    JSR MOVAF
04083  DE61  A9 1D              LDA #<FHALF
04084  DE63  A0 DE              LDY #>FHALF
04085  DE65  20 AE DA           JSR MOVFM
04086  DE68  F0 70       FPWRT  BEQ EXP
04087  DE6A  A5 66              LDA ARGEXP
04088  DE6C  D0 03              BNE FPWRT1
04089  DE6E  4C 05 D8           JMP ZEROF1
04090  DE71  A2 4B       FPWRT1 LDX #<TEMPF3
04091  DE73  A0 00              LDY #>TEMPF3
04092  DE75  20 E0 DA           JSR MOVMF
04093  DE78  A5 6B              LDA ARGSGN
04094  DE7A  10 0F              BPL FPWR1
04095  DE7C  20 D8 DB           JSR INT
04096  DE7F  A9 4B              LDA #<TEMPF3
04097  DE81  A0 00              LDY #>TEMPF3
04098  DE83  20 67 DB           JSR FCOMP
04099  DE86  D0 03              BNE FPWR1
04100  DE88  98                 TYA
04101  DE89  A4 03              LDY INTEGR
04102  DE8B  20 0A DB    FPWR1  JSR MOVFA1






CODE23......PAGE 0056

LINE# LOC   CODE        LINE


04103  DE8E  98                 TYA
04104  DE8F  48                 PHA
04105  DE90  20 F6 D8           JSR LOG
04106  DE93  A9 4B              LDA #<TEMPF3
04107  DE95  A0 00              LDY #>TEMPF3
04108  DE97  20 34 D9           JSR FMULT
04109  DE9A  20 DA DE           JSR EXP
04110  DE9D  68                 PLA
04111  DE9E  4A                 LSR A
04112  DE9F  90 0A              BCC NEGRTS
04113  DEA1  A5 5E       NEGOP  LDA FACEXP
04114  DEA3  F0 06              BEQ NEGRTS
04115  DEA5  A5 63              LDA FACSGN
04116  DEA7  49 FF              EOR #@377
04117  DEA9  85 63              STA FACSGN
04118  DEAB  60          NEGRTS RTS
04119  DEAC              .FIL   CODE24












































CODE24......PAGE 0057

LINE# LOC   CODE        LINE


04121  DEAC  81          LOGEB2 .BYT @201,@70,@252,@73,@51
04121  DEAD  38 
04121  DEAE  AA 
04121  DEAF  3B 
04121  DEB0  29 
04122  DEB1  07          EXPCON .BYT 7,@161,@64,@130,@76
04122  DEB2  71 
04122  DEB3  34 
04122  DEB4  58 
04122  DEB5  3E 
04123  DEB6  56                 .BYT @126,@164,@26,@176
04123  DEB7  74 
04123  DEB8  16 
04123  DEB9  7E 
04124  DEBA  B3                 .BYT @263,@33,@167,@57
04124  DEBB  1B 
04124  DEBC  77 
04124  DEBD  2F 
04125  DEBE  EE                 .BYT @356,@343,@205,@172
04125  DEBF  E3 
04125  DEC0  85 
04125  DEC1  7A 
04126  DEC2  1D                 .BYT @35,@204,@34,@52
04126  DEC3  84 
04126  DEC4  1C 
04126  DEC5  2A 
04127  DEC6  7C                 .BYT @174,@143,@131,@130
04127  DEC7  63 
04127  DEC8  59 
04127  DEC9  58 
04128  DECA  0A                 .BYT @12,@176,@165,@375
04128  DECB  7E 
04128  DECC  75 
04128  DECD  FD 
04129  DECE  E7                 .BYT @347,@306,@200,@61
04129  DECF  C6 
04129  DED0  80 
04129  DED1  31 
04130  DED2  72                 .BYT @162,@30,@20,@201
04130  DED3  18 
04130  DED4  10 
04130  DED5  81 
04131  DED6  00                 .BYT 0,0,0,0
04131  DED7  00 
04131  DED8  00 
04131  DED9  00 
04132  DEDA  A9 AC       EXP    LDA #<LOGEB2
04133  DEDC  A0 DE              LDY #>LOGEB2
04134  DEDE  20 34 D9           JSR FMULT
04135  DEE1  A5 6D              LDA FACOV
04136  DEE3  69 50              ADC #@120
04137  DEE5  90 03              BCC STOLD
04138  DEE7  20 2F DB           JSR INCRND
04139  DEEA              .FIL   CODE25
04140  DEEA              ;CODE25






CODE24......PAGE 0058

LINE# LOC   CODE        LINE


04141  DEEA  85 53       STOLD  STA OLDOV
04142  DEEC  20 1B DB           JSR MOVEF
04143  DEEF  A5 5E              LDA FACEXP
04144  DEF1  C9 88              CMP #@210
04145  DEF3  90 03              BCC EXP1
04146  DEF5  20 E0 D9    GOMLDV JSR MLDVEX
04147  DEF8  20 D8 DB    EXP1   JSR INT
04148  DEFB  A5 03              LDA INTEGR
04149  DEFD  18                 CLC
04150  DEFE  69 81              ADC #@201
04151  DF00  F0 F3              BEQ GOMLDV
04152  DF02  38                 SEC
04153  DF03  E9 01              SBC #1
04154  DF05  48                 PHA
04155  DF06  A2 05              LDX #4+ADDPRC
04156  DF08  B5 66       SWAPLP LDA ARGEXP,X
04157  DF0A  B4 5E              LDY FACEXP,X
04158  DF0C  95 5E              STA FACEXP,X
04159  DF0E  94 66              STY ARGEXP,X
04160  DF10  CA                 DEX
04161  DF11  10 F5              BPL SWAPLP
04162  DF13  A5 53              LDA OLDOV
04163  DF15  85 6D              STA FACOV
04164  DF17  20 36 D7           JSR FSUBT
04165  DF1A  20 A1 DE           JSR NEGOP
04166  DF1D  A9 B1              LDA #<EXPCON
04167  DF1F  A0 DE              LDY #>EXPCON
04168  DF21  20 43 DF           JSR POLY
04169  DF24  A9 00              LDA #0
04170  DF26  85 6C              STA ARISGN
04171  DF28  68                 PLA
04172  DF29  20 C5 D9           JSR MLDEXP
04173  DF2C  60                 RTS
04174  DF2D  85 6E       POLYX  STA POLYPT
04175  DF2F  84 6F              STY POLYPT+1
04176  DF31  20 D6 DA           JSR MOV1F
04177  DF34  A9 54              LDA #TEMPF1
04178  DF36  20 34 D9           JSR FMULT
04179  DF39  20 47 DF           JSR POLY1
04180  DF3C  A9 54              LDA #<TEMPF1
04181  DF3E  A0 00              LDY #>TEMPF1
04182  DF40  4C 34 D9           JMP FMULT
04183  DF43  85 6E       POLY   STA POLYPT
04184  DF45  84 6F              STY POLYPT+1
04185  DF47  20 D3 DA    POLY1  JSR MOV2F
04186  DF4A  B1 6E              LDA (POLYPT)Y
04187  DF4C  85 64              STA DEGREE
04188  DF4E  A4 6E              LDY POLYPT
04189  DF50  C8                 INY
04190  DF51  98                 TYA
04191  DF52  D0 02              BNE POLY3
04192  DF54  E6 6F              INC POLYPT+1
04193  DF56  85 6E       POLY3  STA POLYPT
04194  DF58  A4 6F              LDY POLYPT+1
04195  DF5A  20 34 D9    POLY2  JSR FMULT






CODE24......PAGE 0059

LINE# LOC   CODE        LINE


04196  DF5D  A5 6E              LDA POLYPT
04197  DF5F  A4 6F              LDY POLYPT+1
04198  DF61  18                 CLC
04199  DF62  69 05              ADC #4+ADDPRC
04200  DF64  90 01              BCC POLY4
04201  DF66  C8                 INY
04202  DF67  85 6E       POLY4  STA POLYPT
04203  DF69  84 6F              STY POLYPT+1
04204  DF6B  20 73 D7           JSR FADD
04205  DF6E  A9 59              LDA #<TEMPF2
04206  DF70  A0 00              LDY #>TEMPF2
04207  DF72  C6 64              DEC DEGREE
04208  DF74  D0 E4              BNE POLY2
04209  DF76  60                 RTS
04210  DF77  98          RMULC  .BYT @230,@65,@104,@172
04210  DF78  35 
04210  DF79  44 
04210  DF7A  7A 
04211  DF7B  68          RADDC  .BYT @150,@50,@261,@106
04211  DF7C  28 
04211  DF7D  B1 
04211  DF7E  46 
04212  DF7F  20 37 DB    RND    JSR SIGN
04213  DF82  30 2E              BMI RND1
04214  DF84  D0 17              BNE QSETNR
04215  DF86  AD 44 E8           LDA CHTIM
04216  DF89  85 5F              STA FACHO
04217  DF8B  AD 48 E8           LDA CHTIM+4
04218  DF8E  85 60              STA FACMOH
04219  DF90  AD 45 E8           LDA CHTIM+1
04220  DF93  85 61              STA FACMO
04221  DF95  AD 49 E8           LDA CHTIM+5
04222  DF98  85 62              STA FACLO
04223  DF9A  4C C2 DF           JMP STRNEX
04224  DF9D  A9 88       QSETNR LDA #<RNDX
04225  DF9F  A0 00              LDY #>RNDX
04226  DFA1  20 AE DA           JSR MOVFM
04227  DFA4  A9 77              LDA #<RMULC
04228  DFA6  A0 DF              LDY #>RMULC
04229  DFA8  20 34 D9           JSR FMULT
04230  DFAB  A9 7B              LDA #<RADDC
04231  DFAD  A0 DF              LDY #>RADDC
04232  DFAF  20 73 D7           JSR FADD
04233  DFB2  A6 62       RND1   LDX FACLO
04234  DFB4  A5 5F              LDA FACHO
04235  DFB6  85 62              STA FACLO
04236  DFB8  86 5F              STX FACHO
04237  DFBA  A6 60              LDX FACMOH
04238  DFBC  A5 61              LDA FACMO
04239  DFBE  85 60              STA FACMOH
04240  DFC0  86 61              STX FACMO
04241  DFC2  A9 00       STRNEX LDA #0
04242  DFC4  85 63              STA FACSGN
04243  DFC6  A5 5E              LDA FACEXP
04244  DFC8  85 6D              STA FACOV






CODE24......PAGE 005A

LINE# LOC   CODE        LINE


04245  DFCA  A9 80              LDA #@200
04246  DFCC  85 5E              STA FACEXP
04247  DFCE  20 E3 D7           JSR NORMAL
04248  DFD1  A2 88              LDX #<RNDX
04249  DFD3  A0 00              LDY #>RNDX
04250  DFD5  4C E0 DA    GMOVMF JMP MOVMF
04251  DFD8  A9 54       COS    LDA #<PI2
04252  DFDA  A0 E0              LDY #>PI2
04253  DFDC  20 73 D7           JSR FADD
04254  DFDF  20 18 DB    SIN    JSR MOVAF
04255  DFE2  A9 59              LDA #<TWOPI
04256  DFE4  A0 E0              LDY #>TWOPI
04257  DFE6  A6 6B              LDX ARGSGN
04258  DFE8  20 13 DA           JSR FDIVF
04259  DFEB  20 18 DB           JSR MOVAF
04260  DFEE  20 D8 DB           JSR INT
04261  DFF1  A9 00              LDA #0
04262  DFF3  85 6C              STA ARISGN
04263  DFF5  20 36 D7           JSR FSUBT
04264  DFF8  A9 5E              LDA #<FR4
04265  DFFA  A0 E0              LDY #>FR4
04266  DFFC  20 33 D7           JSR FSUB
04267  DFFF  A5 63              LDA FACSGN
04268  E001  48                 PHA
04269  E002  10 0D              BPL SIN1
04270  E004  20 2C D7           JSR FADDH
04271  E007  A5 63              LDA FACSGN
04272  E009  30 09              BMI SIN2
04273  E00B  A5 0C              LDA TANSGN
04274  E00D  49 FF              EOR #$FF
04275  E00F  85 0C              STA TANSGN
04276  E011  20 A1 DE    SIN1   JSR NEGOP
04277  E014  A9 5E       SIN2   LDA #<FR4
04278  E016  A0 E0              LDY #>FR4
04279  E018  20 73 D7           JSR FADD
04280  E01B  68                 PLA
04281  E01C  10 03              BPL SIN3
04282  E01E  20 A1 DE           JSR NEGOP
04283  E021  A9 63       SIN3   LDA #<SINCON
04284  E023  A0 E0              LDY #>SINCON
04285  E025  4C 2D DF           JMP POLYX
04286  E028  20 D6 DA    TAN    JSR MOV1F
04287  E02B  A9 00              LDA #0
04288  E02D  85 0C              STA TANSGN
04289  E02F  20 DF DF           JSR SIN
04290  E032  A2 4B              LDX #<TEMPF3
04291  E034  A0 00              LDY #>TEMPF3
04292  E036  20 D5 DF           JSR GMOVMF
04293  E039  A9 54              LDA #<TEMPF1
04294  E03B  A0 00              LDY #>TEMPF1
04295  E03D  20 AE DA           JSR MOVFM
04296  E040  A9 00              LDA #0
04297  E042  85 63              STA FACSGN
04298  E044  A5 0C              LDA TANSGN
04299  E046  20 50 E0           JSR COSC






CODE24......PAGE 005B

LINE# LOC   CODE        LINE


04300  E049  A9 4B              LDA #<TEMPF3
04301  E04B  A0 00              LDY #>TEMPF3
04302  E04D  4C 1B DA           JMP FDIV
04303  E050  48          COSC   PHA
04304  E051  4C 11 E0           JMP SIN1
04305  E054  81          PI2    .BYT @201,@111,@17,@332,@242
04305  E055  49 
04305  E056  0F 
04305  E057  DA 
04305  E058  A2 
04306  E059  83          TWOPI  .BYT @203,@111,@17,@332,@242
04306  E05A  49 
04306  E05B  0F 
04306  E05C  DA 
04306  E05D  A2 
04307  E05E  7F          FR4    .BYT @177,0,0,0,0
04307  E05F  00 
04307  E060  00 
04307  E061  00 
04307  E062  00 
04308  E063  05          SINCON .BYT 5,@204,@346,@32,@55
04308  E064  84 
04308  E065  E6 
04308  E066  1A 
04308  E067  2D 
04309  E068  1B                 .BYT @33,@206,@50,@7,@373
04309  E069  86 
04309  E06A  28 
04309  E06B  07 
04309  E06C  FB 
04310  E06D  F8                 .BYT @370,@207,@231,@150,@211
04310  E06E  87 
04310  E06F  99 
04310  E070  68 
04310  E071  89 
04311  E072  01                 .BYT 1,@207,@43,@65,@337,@341
04311  E073  87 
04311  E074  23 
04311  E075  35 
04311  E076  DF 
04311  E077  E1 
04312  E078  86                 .BYT @206,@245,@135,@347,@50,@203
04312  E079  A5 
04312  E07A  5D 
04312  E07B  E7 
04312  E07C  28 
04312  E07D  83 
04313  E07E  49                 .BYT @111,@17,@332,@242
04313  E07F  0F 
04313  E080  DA 
04313  E081  A2 
04314  E082  A1          LE082  .BYT $A1,$54,$46,$8F,$13,$8F,$52,$43
04314  E083  54 
04314  E084  46 
04314  E085  8F 






CODE24......PAGE 005C

LINE# LOC   CODE        LINE


04314  E086  13 
04314  E087  8F 
04314  E088  52 
04314  E089  43 
04315  E08A  89                 .BYT $89,$CD
04315  E08B  CD 
04316  E08C  A5 63       ATN    LDA FACSGN
04317  E08E  48                 PHA
04318  E08F  10 03              BPL ATN1
04319  E091  20 A1 DE           JSR NEGOP
04320  E094  A5 5E       ATN1   LDA FACEXP
04321  E096  48                 PHA
04322  E097  C9 81              CMP #@201
04323  E099  90 07              BCC ATN2
04324  E09B  A9 C8              LDA #<FONE
04325  E09D  A0 D8              LDY #>FONE
04326  E09F  20 1B DA           JSR FDIV
04327  E0A2  A9 BC       ATN2   LDA #<ATNCON
04328  E0A4  A0 E0              LDY #>ATNCON
04329  E0A6  20 2D DF           JSR POLYX
04330  E0A9  68                 PLA
04331  E0AA  C9 81              CMP #@201
04332  E0AC  90 07              BCC ATN3
04333  E0AE  A9 54              LDA #<PI2
04334  E0B0  A0 E0              LDY #>PI2
04335  E0B2  20 33 D7           JSR FSUB
04336  E0B5  68          ATN3   PLA
04337  E0B6  10 03              BPL ATN4
04338  E0B8  4C A1 DE           JMP NEGOP
04339  E0BB  60          ATN4   RTS
04340  E0BC  0B          ATNCON .BYT @13,@166,@263,@203
04340  E0BD  76 
04340  E0BE  B3 
04340  E0BF  83 
04341  E0C0  BD                 .BYT @275,@323,@171,@36,@364
04341  E0C1  D3 
04341  E0C2  79 
04341  E0C3  1E 
04341  E0C4  F4 
04342  E0C5  A6                 .BYT @246,@365,@173,@203,@374
04342  E0C6  F5 
04342  E0C7  7B 
04342  E0C8  83 
04342  E0C9  FC 
04343  E0CA  B0                 .BYT @260,@20
04343  E0CB  10 
04344  E0CC  7C                 .BYT @174,@14,@37,@147,@312
04344  E0CD  0C 
04344  E0CE  1F 
04344  E0CF  67 
04344  E0D0  CA 
04345  E0D1  7C                 .BYT @174,@336,@123,@313,@301
04345  E0D2  DE 
04345  E0D3  53 
04345  E0D4  CB 






CODE24......PAGE 005D

LINE# LOC   CODE        LINE


04345  E0D5  C1 
04346  E0D6  7D                 .BYT @175,@24,@144,@160,@114
04346  E0D7  14 
04346  E0D8  64 
04346  E0D9  70 
04346  E0DA  4C 
04347  E0DB  7D                 .BYT @175,@267,@352,@121,@172
04347  E0DC  B7 
04347  E0DD  EA 
04347  E0DE  51 
04347  E0DF  7A 
04348  E0E0  7D                 .BYT @175,@143,@60,@210,@176
04348  E0E1  63 
04348  E0E2  30 
04348  E0E3  88 
04348  E0E4  7E 
04349  E0E5  7E                 .BYT @176,@222,@104,@231,@72
04349  E0E6  92 
04349  E0E7  44 
04349  E0E8  99 
04349  E0E9  3A 
04350  E0EA  7E                 .BYT @176,@114,@314,@221,@307
04350  E0EB  4C 
04350  E0EC  CC 
04350  E0ED  91 
04350  E0EE  C7 
04351  E0EF  7F                 .BYT @177,@252,@252,@252,@23
04351  E0F0  AA 
04351  E0F1  AA 
04351  E0F2  AA 
04351  E0F3  13 
04352  E0F4  81                 .BYT @201,0,0,0,0
04352  E0F5  00 
04352  E0F6  00 
04352  E0F7  00 
04352  E0F8  00 
04353  E0F9              .FIL   CODE26
























CODE26......PAGE 005E

LINE# LOC   CODE        LINE


04355  E0F9  E6 77       INITAT INC CHRGET+7
04356  E0FB  D0 02              BNE CHDGOT
04357  E0FD  E6 78              INC CHRGET+8
04358  E0FF  AD 60 EA    CHDGOT LDA 60000
04359  E102  C9 3A              CMP #':
04360  E104  B0 0A              BCS CHDRTS
04361  E106  C9 20              CMP #' 
04362  E108  F0 EF              BEQ INITAT
04363  E10A  38                 SEC
04364  E10B  E9 30              SBC #'0
04365  E10D  38                 SEC
04366  E10E  E9 D0              SBC #$D0
04367  E110  60          CHDRTS RTS
04368  E111  80                 .BYT 128,79,199,82,88
04368  E112  4F 
04368  E113  C7 
04368  E114  52 
04368  E115  58 
04369  E116  A2 FB       INIT   LDX #STKEND-256
04370  E118  9A                 TXS
04371  E119  A9 4C              LDA #76
04372  E11B  85 51              STA JMPER
04373  E11D  85 00              STA USRPOK
04374  E11F  A9 23              LDA #<FCERR
04375  E121  A0 D1              LDY #>FCERR
04376  E123  85 01              STA USRPOK+1
04377  E125  84 02              STY USRPOK+2
04378  E127  A9 28              LDA #40
04379  E129  85 0F              STA LINWID
04380  E12B  A9 1E              LDA #30
04381  E12D  85 10              STA NCMWFL
04382  E12F  A2 1C              LDX #RNDX+4-CHRGET
04383  E131  BD F8 E0    MOVCHG LDA INITAT-1,X
04384  E134  95 6F              STA CHRGET-1,X
04385  E136  CA                 DEX
04386  E137  D0 F8              BNE MOVCHG
04387  E139  A9 03              LDA #STRSIZ
04388  E13B  85 50              STA FOUR6
04389  E13D  8A                 TXA
04390  E13E  85 65              STA BITS
04391  E140  85 0E              STA CHANNL
04392  E142  85 15              STA LASTPT+1
04393  E144  48                 PHA
04394  E145  85 0D              STA CNTWFL
04395  E147  E8                 INX
04396  E148  8E FD 01           STX BUF-3
04397  E14B  8E FC 01           STX BUF-4
04398  E14E  A2 16              LDX #TEMPST
04399  E150  86 13              STX TEMPPT
04400  E152  A0 04              LDY #>RAMLOC
04401  E154  85 28              STA TXTTAB
04402  E156  84 29              STY TXTTAB+1
04403  E158  85 11              STA LINNUM
04404  E15A  84 12              STY LINNUM+1
04405  E15C  A8                 TAY






CODE26......PAGE 005F

LINE# LOC   CODE        LINE


04407  E15D  E6 11       LOOPMM INC LINNUM
04408  E15F  D0 04              BNE LOOPM1
04409  E161  E6 12              INC LINNUM+1
04410  E163  30 0F              BMI USEDEC
04411  E165  A9 55       LOOPM1 LDA #85
04412  E167  91 11              STA (LINNUM)Y
04413  E169  D1 11              CMP (LINNUM)Y
04414  E16B  D0 07              BNE USEDEC
04415  E16D  0A                 ASL A
04416  E16E  91 11              STA (LINNUM)Y
04417  E170  D1 11              CMP (LINNUM)Y
04418  E172  F0 E9              BEQ LOOPMM
04419  E174  A5 11       USEDEC LDA LINNUM
04420  E176  A4 12              LDY LINNUM+1
04421  E178  85 34       USEDEF STA MEMSIZ
04422  E17A  84 35              STY MEMSIZ+1
04423  E17C  85 30              STA FRETOP
04424  E17E  84 31              STY FRETOP+1
04425  E180  A2 00              LDX #<RAMLOC
04426  E182  A0 04              LDY #>RAMLOC
04427  E184  86 28              STX TXTTAB
04428  E186  84 29              STY TXTTAB+1
04429  E188  A0 00              LDY #0
04430  E18A  98                 TYA
04431  E18B  91 28              STA (TXTTAB)Y
04432  E18D  E6 28              INC TXTTAB
04433  E18F  A5 28              LDA TXTTAB
04434  E191  A4 29              LDY TXTTAB+1
04435  E193  20 28 C3           JSR REASON
04436  E196  A9 C4              LDA #<FREMES
04437  E198  A0 E1              LDY #>FREMES
04438  E19A  20 1C CA           JSR STROUT
04439  E19D  A5 34              LDA MEMSIZ
04440  E19F  38                 SEC
04441  E1A0  E5 28              SBC TXTTAB
04442  E1A2  AA                 TAX
04443  E1A3  A5 35              LDA MEMSIZ+1
04444  E1A5  E5 29              SBC TXTTAB+1
04445  E1A7  20 D9 DC           JSR LINPRT
04446  E1AA  A9 B7              LDA #<WORDS
04447  E1AC  A0 E1              LDY #>WORDS
04448  E1AE  20 1C CA           JSR STROUT
04449  E1B1  20 5D C5           JSR SCRTCH
04450  E1B4  4C 89 C3           JMP READY
04451  E1B7  20 42       WORDS  .BYT ' BYTES FREE',13,0
04451  E1C2  0D 
04451  E1C3  00 
04452  E1C4  23 23       FREMES .BYT '### COMMODORE BASIC ###'
04453  E1DB  0D                 .BYT 13,13,0
04453  E1DC  0D 
04453  E1DD  00 
04454  E1DE              LASTWR
04455  E1DE              .END








CODE26......PAGE 0060

LINE# LOC   CODE        LINE


ERRORS = 00000


SYMBOL TABLE

SYMBOL VALUE
 ABS      DB64    ADDEND   0025    ADDFRS   C2D0    ADDIND   D1FC
 ADDON    C803    ADDPR2   0002    ADDPR4   0004    ADDPR8   0008
 ADDPRC   0001    AFFRTS   C550    ANDMSK   0046    ANDOP    CECB
 ARGEXP   0066    ARGHO    0067    ARGLO    006A    ARGMO    0069
 ARGMOH   0068    ARGSGN   006B    ARISGN   006C    ARYDON   D04D
 ARYGET   D488    ARYPNT   0055    ARYSTR   D48A    ARYTAB   002C
 ARYVA2   D448    ARYVA3   D44C    ARYVAR   D440    ARYVGO   D457
 ASC      D665    ASPAC    CA0C    ATN      E08C    ATN1     E094
 ATN2     E0A2    ATN3     E0B5    ATN4     E0BB    ATNCON   E0BC
 AYINT    D09A    BIGGES   DD3E    BITS     0065    BLT1     C2FC
 BLTLP    C308    BLTU     C2D8    BLTUC    C2DF    BRKTXT   C2A2
 BSERR    D120    BSERR7   D1E4    BUF      0200    BUFFUL   CAED
 BUFLEN   0051    BUFOFS   0200    BUFPAG   0002    BUFPTR   006E
 CAT      D517    CCALL    FFE7    CCCHN    FFCC    CCLOS    FFC3
 CGETL    FFE4    CHANNL   000E    CHARAC   0003    CHDGOT   E0FF
 CHDRTS   E110    CHEAD    C44B    CHKCLS   CDF2    CHKCOM   CDF8
 CHKERR   CC9A    CHKNUM   CC8E    CHKOK    CC97    CHKOPN   CDF5
 CHKSTR   CC90    CHKVAL   CC91    CHRD     D5C6    CHRGET   0070
 CHRGOT   0076    CHRRTS   0087    CHTIM    E844    CINCH    FFCF
 CLEAR    C577    CLEARC   C579    CLMWID   000A    CLOAD    FFD5
 CLRFAC   DBF5    CLSCHN   FFCC    CMD      C991    CMPFOR   C2C4
 CMPSPC   C4A7    CNTWFL   000D    COIN     FFC6    COLIS    C4F5
 COMBYT   D6CC    COMPRT   C9EF    CONINT   D67B    CONT     C76B
 CONTRT   C784    CONUPK   D998    COOUT    FFC9    COPEN    FFC0
 COPFLT   C8DE    COPSTR   C8E1    COPY     C95D    COPYC    C973
 COS      DFD8    COSC     E050    COUNT    0005    CRDO     C9E2
 CRDONE   C522    CRFIN    C9EC    CRTSKP   CA40    CRUNCH   C495
 CSAVE    FFD8    CSTAT    0096    CSYS     FFDE    CTIMR    008D
 CURLIN   0036    CURTOL   006E    CVERF    FFDB    CZLOOP   C453
 DATA     C800    DATAN    C80E    DATATK   0083    DATBK    CB4E
 DATBK1   CB52    DATLIN   003C    DATLOP   CBB9    DATPTR   003E
 DECBLT   C313    DECCNT   005A    DECCUR   D1A9    DEF      D28D
 DEFFIN   D329    DEFPNT   004B    DEFSTF   D2F2    DEGREE   0064
 DIM      CF63    DIM3     CF60    DIMFLG   0006    DIMRTS   D227
 DIRCN1   C6E4    DIRCON   C6D4    DIRIS    C759    DIV10    DA0A
 DIVIDE   DA35    DIVNRM   DA8A    DIVSUB   DA69    DNTCPY   C956
 DOAGIN   CA6D    DOCMP    CF54    DOCO     C850    DOCOND   C848
 DOCSTR   CC98    DOMASK   000C    DOMIN    CE08    DOPRE1   CD21
 DOPREC   CCFA    DOREL    CEF8    DORES    0009    DOSGFL   D6FE
 DPTFLG   005C    DSCPNT   004D    DSCTMP   005E    DV0ERR   DA96
 DVAR     D4A1    DVAR2    D4B6    DVAR3    D4C0    DVARS    D497
 DVARTS   D4D0    EATEM    CF92    END      C741    ENDCHR   0004
 ENDCON   C75B    ENDREL   CCD8    ENDTK    0080    EORMSK   0047
 EPSGN    005D    EQULTK   00B2    ERR      C28B    ERRBD    00BF
 ERRBS    006B    ERRCN    00DB    ERRCRD   C364    ERRDD    0078
 ERRDIR   D280    ERRDVO   0085    ERRFC    0035    ERRFIN   C37E
 ERRGO2   D3AC    ERRGO3   D125    ERRGO4   CC9C    ERRGO5   CC34
 ERRGUF   D288    ERRID    0095    ERRLS    00B0    ERRNF    0000








SYMBOL TABLE

SYMBOL VALUE
 ERROD    002A    ERROM    004D    ERROR    C357    ERROV    0045
 ERRRG    0016    ERRSN    0010    ERRST    00C8    ERRTAB   C192
 ERRTM    00A3    ERRUF    00E9    ERRUS    005A    EVAL     CD84
 EVAL0    CD88    EVAL1    CD8D    EVAL2    CD90    EVAL3    CDC7
 EVAL4    CDDE    EXCHQT   C819    EXIGNT   CBFC    EXP      DEDA
 EXP1     DEF8    EXPCON   DEB1    EXPSGN   005D    FAC      005E
 FACEXP   005E    FACHO    005F    FACLO    0062    FACMO    0061
 FACMOH   0060    FACOV    006D    FACSGN   0063    FADD     D773
 FADD1    D7A3    FADD2    D80A    FADD4    D7AF    FADD5    D76E
 FADDA    D79F    FADDC    D783    FADDH    D72C    FADDT    D776
 FADFLT   D7DE    FBUFFR   0100    FBUFPT   006E    FCERR    D123
 FCERR2   C92F    FCOMP    DB67    FCOMPC   DB9E    FCOMPD   DBA4
 FCOMPN   DB69    FCOMPS   DB3D    FCSIGN   DB3B    FDCEND   DE46
 FDECPT   0044    FDIV     DA1B    FDIVF    DA13    FDIVT    DA1E
 FFLOOP   C2AF    FFRTS    C2D7    FHALF    DE1D    FIN      DBFF
 FIN1     DC1B    FINC     DC16    FINDG1   DC7D    FINDGQ   DC19
 FINDIG   DC76    FINDIV   DC5E    FINDP    DC4D    FINE     DC53
 FINE1    DC55    FINEC    DC3C    FINEC1   DC3A    FINEC2   DC41
 FINEDG   DC9D    FINGO    CEB8    FINI     C439    FININ1   C47E
 FININL   C9D5    FINLOG   DC8A    FINML6   D9F9    FINMUL   DC67
 FINNOW   D073    FINPTR   D069    FINQNG   DC6E    FINRE2   CD12
 FINREL   CD08    FINZLP   DC03    FLINRT   C559    FLNRTS   C55A
 FLOAD    C590    FLOAT    DB48    FLOATB   DB5B    FLOATC   DB55
 FLOATS   DB50    FMAPTR   D078    FMULT    D934    FMULTT   D937
 FNDFOR   C2AA    FNDLIN   C52C    FNDLNC   C530    FNDLO1   C547
 FNDOER   D2CE    FNDVAR   D404    FNEDG1   DC3F    FNTK     00A5
 FNWAIT   D710    FONE     D8C8    FOR      C658    FORPNT   0046
 FORPSH   CD44    FORSIZ   0012    FORTK    0081    FOULDY   DDD0
 FOUR6    0050    FOUT     DCE9    FOUT1    DCF3    FOUT11   DDD2
 FOUT12   DDDF    FOUT14   DDEF    FOUT15   DDFB    FOUT16   DD70
 FOUT17   DE13    FOUT19   DE10    FOUT2    DD76    FOUT20   DE18
 FOUT3    DD22    FOUT37   DD0C    FOUT38   DD2D    FOUT39   DD5F
 FOUT4    DD17    FOUT40   DD9C    FOUT41   DD9A    FOUT5    DD3B
 FOUT6    DD54    FOUT7    DD15    FOUT8    DD72    FOUT9    DD34
 FOUTBL   DE22    FOUTC    DCEB    FOUTIM   DD74    FOUTPI   DD53
 FOUTYP   DDA3    FPWR1    DE8B    FPWRT    DE68    FPWRT1   DE71
 FR4      E05E    FRE      D259    FREFAC   D580    FREMES   E1C4
 FREPLA   D5AF    FRERTS   D5C5    FRESPC   0032    FRESTR   D57D
 FRETMP   D584    FRETMS   D5B5    FRETOP   0030    FRETRT   D5B0
 FRMEV1   CCA5    FRMEVL   CC9F    FRMNUM   CC8B    FSUB     D733
 FSUBT    D736    FUNDSP   C046    GARBA2   D400    GARBAG   D3F0
 GARBFL   0009    GET      CA7D    GETADR   D6D2    GETAGN   CADA
 GETBPT   C4E0    GETBYT   D678    GETCMP   CF48    GETCON   D6FB
 GETDEF   D1C6    GETDTL   CA59    GETERR   C36A    GETFNM   D2BB
 GETFOR   CC26    GETNTH   CB4B    GETNUM   D6C6    GETSPA   D3CE
 GETSPT   C937    GETSTK   C31B    GETTIM   CE69    GETTTY   CA94
 GINLIN   CB04    GIVAYF   D26D    GLET     C717    GMOVMF   DFD5
 GOBADV   D01C    GOFLOT   CF5D    GOFUC    D672    GOGO     D492
 GOLST    C5BD    GOMLDV   DEF5    GOMOVF   CE82    GONE     C6F7
 GONE2    C702    GONE3    C700    GONPRC   CE0A    GOOO     CE43
 GOOOOO   CE54    GOOVER   D9EB    GORDY    C768    GORTS    C7D9
 GOSUB    C790    GOSUTK   008D    GOTARY   D128    GOTK     00CB
 GOTNUM   C932    GOTO     C7AD    GOTOTK   0089    GRBPAS   D4E0
 GRBPNT   004B    GRBRTS   D4DB    GRBTOP   005C    GREASE   D195
 GREATK   00B1    GRODY    C62D    GTBYTC   D675    HAVFOR   CC36








SYMBOL TABLE

SYMBOL VALUE
 HIGHDS   0055    HIGHTR   0057    IF       C830    INCFAC   D87B
 INCFRT   D889    INCHR    C481    INCRND   DB2F    INCRTS   C494
 INDEX    001F    INDEX1   001F    INDEX2   0021    INDICE   0061
 INDLOP   D0B6    INIT     E116    INITAT   E0F9    INLIN    C46F
 INLINC   C471    INLOOP   CB16    INLPN1   D1EB    INLPN2   D1EA
 INLPNM   D1CE    INPCO1   CB10    INPCOM   C8E2    INPCON   CB0E
 INPFLG   000B    INPPTR   0040    INPRT    DCCE    INPRTS   CBFB
 INPUT    CAC1    INPUTN   CAA7    INT      DBD8    INTEGR   0003
 INTERR   CF7E    INTFLG   0008    INTIDX   D08D    INTRTS   DBFE
 INTXT    C292    IODONE   CAB7    IORELE   CAB9    ISARY    D0AC
 ISCNTC   FFE1    ISCRTS   C73E    ISFUN    CE89    ISLETC   CFF7
 ISLRTS   D000    ISSEC    CF91    ISVAR    CE0F    ISVRET   CE12
 JMPER    0051    JSRGM    D084    KLOOP    C49B    KLOOP1   C4BD
 LASNUM   00C7    LASTPT   0014    LASTWR   E1DE    LD100    DA86
 LDFONE   C6A1    LDZR     D007    LE082    E082    LEFTD    D5DA
 LEN      D656    LEN1     D65C    LESSTK   00B3    LET      C8AD
 LINGET   C873    LINLEN   0028    LINNUM   0011    LINPRT   DCD9
 LINWID   000F    LIST     C5B5    LIST4    C5E2    LNKPRG   C442
 LNKRTS   C46E    LOFBUF   00FF    LOG      D8F6    LOG1     D900
 LOG2     D8F1    LOGCN2   D8CD    LOGEB2   DEAC    LOGERR   D8FD
 LOOPDN   CC79    LOOPM1   E165    LOOPMM   E15D    LOPFDA   D0F7
 LOPFDV   D103    LOPFN    CFDF    LOPFND   CFD5    LOPPTA   D162
 LOPREL   CCBC    LOWDS    005A    LOWTR    005C    LPOPER   CCAA
 LSTEND   C5D4    LSTPNT   0046    LUK4IT   C7C4    LUKALL   C7C8
 MAIN     C392    MAIN1    C3AB    MEMSIZ   0034    MID2     D622
 MIDD     D611    MINUTK   00AB    MLDEXP   D9C5    MLDVEX   D9E0
 MLEX10   DCAC    MLEXMI   DCBA    MLOOP    C3EE    MLTPL1   D96A
 MLTPL2   D96D    MLTPL3   D989    MLTPLY   D965    MORCO1   C9F2
 MOREN1   C30C    MORLIN   C879    MORSTS   C71A    MOV1F    DAD6
 MOV2F    DAD3    MOVAF    DB18    MOVAFL   DB1D    MOVCHG   E131
 MOVDO    D566    MOVEF    DB1B    MOVFA    DB08    MOVFA1   DB0A
 MOVFAL   DB0E    MOVFM    DAAE    MOVFR    DA9B    MOVINS   D554
 MOVLP    D56A    MOVMF    DAE0    MOVRTS   DB26    MOVSTR   D562
 MOVVF    DADC    MRCHKR   D758    MRCHR    D75A    MUL10    D9EE
 MUL10R   DA04    MULDIV   D9C3    MULSHF   D88F    MULTRT   D997
 MUSTCR   C4C5    MVDONE   D573    MVSTRT   D57C    N0999    DCBF
 N32768   D089    N9999    DCC4    NCMPOS   001E    NCMWFL   0010
 NEGFAC   D853    NEGFCH   D859    NEGHLF   D8EC    NEGOP    DEA1
 NEGPRC   CCFB    NEGRTS   DEAB    NEGTAB   C089    NEGXQS   DC73
 NEWCHR   C9A8    NEWSGO   CC76    NEWSTT   C6C4    NEXT     CC20
 NMARY1   D112    NMIL     DCC9    NODATT   C4F7    NODEL    C3FC
 NODELC   C417    NOFREF   D260    NOML6    C90F    NONONO   D0A7
 NORM1    D835    NORM2    D829    NORM3    D7E7    NORMAL   D7E3
 NOSEC    CF9C    NOTABR   CA11    NOTDIM   D172    NOTEVE   D03D
 NOTEVL   D00C    NOTFDD   D13C    NOTFL1   D20D    NOTFLT   D150
 NOTFNS   D001    NOTIT    CFED    NOTOL    C669    NOTOP    CDCF
 NOTQTI   CAD2    NOTSTR   CFA6    NOTTAB   C08C    NOTTK    00A8
 NOWGE1   CB7E    NOWGET   CB73    NOWLIN   CBD2    NTHIS    C50E
 NTHIS1   C512    NUMINS   CB8A    NUMLEV   0017    NXTCMP   CF3D
 NXTLGC   C8A7    NXTPTR   CFEC    OFFSET   8000    OKGOTO   C83F
 OKNORM   CEB3    OLDLIN   0038    OLDOV    0053    OLDTXT   003A
 OMERR    C355    OMERR1   D1E7    ONEFUN   00B4    ONEON    C6B5
 ONGLOP   C85F    ONGLP1   C867    ONGOTO   C853    ONGRTS   C872
 OPMASK   004A    OPPTR    0048    OPTAB    C074    OROP     CEC8
 OUTCH    FFD2    OUTDO    CA45    OUTQST   CA43    OUTRTS   CA4C








SYMBOL TABLE

SYMBOL VALUE
 OUTSPC   CA39    OVERR    D88A    PARCHK   CDEC    PEEK     D6E8
 PI       00FF    PI2      E054    PIVAL    CDA3    PKINC    D766
 PLOOP    C60C    PLOOP1   C619    PLUSTK   00AA    POKE     D707
 POKER    0011    POLY     DF43    POLY1    DF47    POLY2    DF5A
 POLY3    DF56    POLY4    DF67    POLYPT   006E    POLYX    DF2D
 POS      D27A    POSINT   D093    PREAM    D63B    PRINT    C9AB
 PRINTC   C9AD    PRINTK   0099    PRINTN   C98B    PRIT3    C64D
 PRIT4    C608    PRTRTS   C9EE    PTDORL   C08F    PTRGET   CF6D
 PTRGT1   CF72    PTRGT2   CF74    PTRGT3   CF81    PULMOR   D5FF
 PULSTK   CD67    PUSHF    CD39    PUSHF1   CD34    PUTNEW   D3A4
 PUTNW1   D3AF    QCHNUM   CD5E    QCOMP    CF43    QDATA    CB42
 QDECT1   C3E6    QDOT     CDA8    QINLIN   CAFA    QINT     DBA7
 QINT1    DBC7    QINTGO   D0A9    QINTGR   C8CA    QINTRT   DBC6
 QISHFT   DBBB    QNUM     007D    QOP      CD59    QOPGO    CD5C
 QOPRTS   CD81    QPLOP    C630    QPLUS    DC12    QPREC    CCF1
 QPREC1   CD1A    QSETNR   DF9D    QSHFT    DA58    QSTATV   CE75
 QSTAVR   D01F    QVARIA   C948    RADDC    DF7B    RAMLOC   0400
 READ     CB07    READY    C389    REARTS   C354    REASAV   C336
 REASON   C328    REASTO   C341    REDDY    C297    REM      C843
 REMER    C821    REMN     C811    REMRTS   C80D    REMTK    008F
 RESCON   C4D1    RESCR1   C645    RESER    C4CF    RESETC   CB72
 RESFIN   C73A    RESHO    0023    RESLO    0026    RESLST   C092
 RESMO    0025    RESMOH   0024    RESRCH   C642    RESTOR   C730
 RETU1    C7F3    RETURN   C7DA    RIGHTD   D606    RLEFT    D5E0
 RLEFT1   D5E6    RLEFT2   D5E7    RLEFT3   D5E8    RMULC    DF77
 RND      DF7F    RND1     DFB2    RNDRTS   D852    RNDSHF   D844
 RNDX     0088    ROLSHF   D8BC    ROMLOC   C000    ROUND    DB27
 RUN      C785    RUNC     C572    RUNC2    C7A4    SAVEIT   C99B
 SAVQUO   DA4B    SCRATH   C55B    SCRATK   00A2    SCRTCH   C55D
 SETQUT   CB66    SGN      DB45    SGNFLG   0064    SHFARG   DA5B
 SHFTR2   D891    SHFTR3   D8B2    SHFTR4   D8B8    SHFTRT   D8C6
 SHIFTR   D8A5    SIGN     DB37    SIGNRT   DB44    SIN      DFDF
 SIN1     E011    SIN2     E014    SIN3     E021    SINCON   E063
 SIZE     0052    SIZEOK   D537    SNERR    CE03    SNERR1   C71E
 SNERR2   C7F0    SNERR3   C85B    SNERR4   CA61    SNERR5   CD31
 SNERRX   C721    SNGFLT   D27C    SPCTK    00A6    SQR      DE5E
 SQR05    D8E2    SQR20    D8E7    SQUEEZ   D842    ST2TXT   D6BD
 STASGN   CF38    STCURL   CA5D    STEPTK   00A9    STKEND   01FB
 STKINI   C593    STKRTS   C5A6    STMDSP   C000    STOLD    DEEA
 STOLOP   C431    STOML1   D213    STOMLT   D159    STOP     C73F
 STOPC    C742    STORD1   D745    STORDO   D71F    STPEND   C751
 STR1     C4FE    STRCMP   CF10    STRCP    D399    STRD     D33F
 STRDN2   CB92    STRDON   C9A5    STREND   002E    STRFI1   D382
 STRFI2   D383    STRFIN   D37E    STRFRE   D3E5    STRGET   D371
 STRINI   D34F    STRLIT   D361    STRLT2   D367    STRNAM   CFBD
 STRNEX   DFC2    STRNG    C507    STRNG1   006C    STRNG2   006E
 STROU2   DCE6    STROUT   CA1C    STRPR2   CA26    STRPRT   CA1F
 STRRTS   CE42    STRSIZ   0003    STRSPA   D357    STRST2   D38F
 STRTX2   CDC1    STRTXT   CDB8    STUFFH   C4E2    STXBUF   DDBE
 STXFND   CFD3    STXFOR   CC29    STXTPT   C5A7    SUBFLG   000A
 SUBIT    D7BB    SVAR     D433    SVARGO   D43B    SVARS    D427
 SWAPLP   DF08    SYNCHR   CDFA    TABER    C9FC    TABTK    00A3
 TAN      E028    TANSGN   000C    TEMPF1   0054    TEMPF2   0059
 TEMPF3   004B    TEMPPT   0013    TEMPST   0016    TENC     DA05
 TENEXP   005B    THENTK   00A7    TIMELP   C8F5    TIMEND   DE5E








SYMBOL TABLE

SYMBOL VALUE
 TIMEST   C91F    TIMNUM   C928    TIMSTR   D349    TOTK     00A4
 TRMNO1   CA64    TRMNOK   CA4F    TRMOK    CB9E    TRMPOS   00C6
 TRYAG2   D3D0    TRYAG3   D3DB    TRYAGN   CC0D    TRYMOR   C332
 TRYOFF   D9D0    TSTDUN   C5FF    TSTOP    CCB9    TURNON   CFB6
 TVAR     D41E    TWOPI    E059    TXTPTR   0077    TXTTAB   0028
 TYPERR   C377    TYPLIN   C601    UMLCNT   D254    UMLRTS   D258
 UMULT    D228    UMULTC   D23B    UMULTD   D231    UNPRTS   CD83
 UNPSTK   CD65    USEDEC   E174    USEDEF   E178    USERR    C7EB
 USRLOC   C04C    USRPOK   0000    VAL      D687    VAL2     D6A7
 VALRTS   D6C5    VALTYP   0007    VAREND   CBDF    VARNAM   0042
 VAROK    D027    VARPNT   0044    VARTAB   002A    VARTXT   0048
 VARY0    CBEA    WAITER   D723    WORDS    E1B7    XSPAC    CA0D
 XSPAC1   CA17    XSPAC2   CA0E    ZEREMV   D9E6    ZERITA   D1A4
 ZERO     DE1F    ZEROF1   D805    ZEROFC   D803    ZEROML   D807
 ZERRTS   D72B    ZZ1      01FF    ZZ2      0201    ZZ3      0202
 ZZ4      01FF    ZZ5      01FF    ZZ6      CE11    ZZ7      008B


END OF ASSEMBLY
ossrc......PAGE 0001

LINE# LOC   CODE        LINE


00001  0000              ;**********************************
00002  0000              ;*                                *
00003  0000              ;* PET 2001 OPERATING SYSTEM      *
00004  0000              ;*                                *
00005  0000              ;* VERSION 2.0  AUGUST 2,1978     *
00006  0000              ;* VERSION 1.0  AUGUST 8,1977     *
00007  0000              ;*                                *
00008  0000              ;* ROMS PRODUCED: 901447-24       *
00009  0000              ;*                901465-03       *
00010  0000              ;* RECONSTR.: M.HOFFMANN-VETTER   *
00011  0000              ;*                                *
00012  0000              ;**********************************

00014  0000              OFFSET =$8000          ;FOR *** HARD MACHINE ***

00016  0000              ; LISTING DATE ??/??/??

00018  0000                     * =$8D
00019  008D              TIME   *=*+3           ;24 HR CLOCK IN 1/60 SEC
00020  0090              CINV   *=*+2           ;IRQ RAM VECTOR
00021  0092              CBINV  *=*+2           ;BRK INSTR RAM VECTOR
00022  0094              NMINV  *=*+2           ;NMI RAM VECTOR
00023  0096              SATUS  *=*+1           ;OPERATION STATUS BYTE
00024  0097              LSTX   *=*+1           ;INDEX TO CHAR IN KEYSCAN
00025  0098              SFST   *=*+1           ;KEYBOARD SHIFT FLAG
00026  0099              CRFAC  *=*+2           ;CORRECTION FACTOR TIME
00027  009B              STKEY  *=*+1           ;STOP KEY FLAG
00028  009C              SVXT   *=*+1           ;TEMPORARY
00029  009D              VERCK  *=*+1           ;LOAD OR VERIFY FLAG
00030  009E              NDX    *=*+1           ;INDEX TO KEYD QUEUE
00031  009F              RVS    *=*+1           ;REVERSE FIELD ENABLED
00032  00A0              C3P0   *=*+1           ;CASSETTE SERVQ CONSTANT
00033  00A1              INDX   *=*+1           ;
00034  00A2              SNSW   *=*+1           ;CASSETTE....
00035  00A3              LSXP   *=*+1           ;START GF SCREEN INPUT
00036  00A4              LSTP   *=*+1
00037  00A5              BSOUR  *=*+1           ;CHAR BUFFER FOR IEEE
00038  00A6              SFDX   *=*+1           ;SHIFT MODE FOR PRINT
00039  00A7              BLNSW  *=*+1           ;CURSOR BLINK ENABLE
00040  00A8              BLNCT  *=*+1           ;COUNTER TO FLIP CURSORBREAK
00041  00A9              GDBLN  *=*+1           ;O0LD CHAR BEFORE BLINK
00042  00AA              BLNON  *=*+1           ;ON/OFF BLINK FLAG
00043  00AB              SYNO   *=*+1           ;CASSETTE SYNC #
00044  00AC              CRSW   *=*+1           ;INPUT/GET FLAG
00045  00AD              XSAV   *=*+1           ;TEMP FOR BASIN
00046  00AE              LDTND  *=*+1           ;INDEX TO LOGICAL FILE
00047  00AF              DFLTN  *=*+1           ;DEFAULT INPUT DEVICE #
00048  00B0              DFLTO  *=*+1           ;DEFAULT QUTPUT DEVICE #
00049  00B1              PRTY   *=*+1           ;CASSETTE PARITY
00050  00B2              DPSW   *=*+1           ;CASSETTE DIPOLE SWITCH
00051  00B3              WSW    *=*+1           ;CASSETE WRITE ENABLE
00052  00B4              SAVX
00053  00B4              T1     *=*+1           ;TEMPORARY 1
00054  00B5              RCNT
00055  00B5              TMPC






ossrc......PAGE 0002

LINE# LOC   CODE        LINE


00056  00B5              T2     *=*+1           ;TEMPORARY 2
00057  00B6              TMPC2
00058  00B6              T3     *=*+1           ;TEMPORARY 3
00059  00B7              PCNTR  *=*+1           ;CASSETTE STUFF
00060  00B8              PTCH   *=*+1
00061  00B9              FIRT   *=*+1
00062  00BA              CNTDN  *=*+1           ;CASSETTE SYNC CQUNTDOWN
00063  00BB              BUFPT  *=*+2           ;POINTER TO ACTIVE CASSETTE BUFFE
00064  00BD              SHCNL  *=*+1           ;CASSETTE SHORT COUNT
00065  00BE              RER    *=*+1           ;CASSETTE READ ERROR
00066  00BF              REZ    *=*+1           ;CASSETE READING ZEROES
00067  00C0              PTR1   *=*+1           ;CASSETTE ERROR PASS1
00068  00C1              PTR2   *=*+1           ;CASSETTE ERROR PASS2
00069  00C2              RDFLG  *=*+1           ;CASSETTE READ MODE
00070  00C3              SHCNH  *=*+1           ;CASSETTE SHORT CNT
00071  00C4              PNT    *=*+1
00072  00C5              POINT  *=*+1
00073  00C6              PNTR   *=*+1
00074  00C7              SAL    *=*+1
00075  00C8              SAH    *=*+1
00076  00C9              EAL    *=*+1
00077  00CA              EAH    *=*+1
00078  00CB              CMP0   *=*+1
00079  00CC              TEMP   *=*+1
00080  00CD              QTSW   *=*+1
00081  00CE              SNSW1  *=*+1
00082  00CF              DIFF   *=*+1
00083  00D0              PRP    *=*+1
00084  00D1              FNLEN  *=*+1           ;LENGTH CURRENT FILE N STR
00085  00D2              LA     *=*+1           ;CURRENT FILE LOGICAL ADDR
00086  00D3              SA     *=*+1           ;CURRENT FILE 2ND ADDR
00087  00D4              FA     *=*+1           ;CURRENT FILE PRIMARY ADDR
00088  00D5              LNMX   *=*+1
00089  00D6              TBUF   *=*+2
00090  00D8              TBLX   *=*+1
00091  00D9              DATA   *=*+1
00092  00DA              FNADR  *=*+2           ;ADDR CURRENT FILE NAME STR
00093  00DC              INSRT  *=*+1
00094  00DD              OCHAR  *=*+1
00095  00DE              WRAP
00096  00DE              FSBLK  *=*+1           ;CASSETTE READ BLOCK COUNT
00097  00DF              MYCH   *=*+1
00098  00E0              LDTB1  *=*+25
00099  00F9              CAS1   *=*+1
00100  00FA              CAS2   *=*+1
00101  00FB              TMP0
00102  00FB              STAL   *=*+1
00103  00FC              STAH   *=*+1
00104  00FD              TMP2   *=*+2
00105  00FF                     *=$100
00106  0100              BAD    *=*+1
00107  0101                     *=$200
00108  0200              BUF                    ;BASIC INPUT BUFFER
00109  0200              ;VIRTUAL REGS FOR MACHINE LANGUAGE MONITOR
00110  0200              PCH    *=*+1






ossrc......PAGE 0003

LINE# LOC   CODE        LINE


00111  0201              PCL    *=*+1
00112  0202              FLGS   *=*+1
00113  0203              ACC    *=*+1
00114  0204              XR     *=*+1
00115  0205              YR     *=*+1
00116  0206              SP     *=*+1
00117  0207              SAVNAM                 ;BUFFER
00118  0207              INVH   *=*+1           ;USER MODIFIABLE IRQ
00119  0208              INVL   *=*+1
00120  0209                     *=*+72
00121  0251              ;TABLES FOR OPEN FILES
00122  0251              LAT    *=*+10          ;LOGICAL FILE NUMBERS
00123  025B              FAT    *=*+10          ;PRIMARY DEVICE NUMBERS
00124  0265              SAT    *=*+10          ;SECONDARY ADDRESSES
00125  026F              KEYD   *=*+10
00126  0279                     *=*+1
00127  027A              TAPE1  *=*+192
00128  033A              TAPE2  *=*+192         ;192 BYTES RESERVED
00129  03FA              ;RAM VECTOR FOR USER INTERP OF MONITOR CMDS
00130  03FA              USRCMD *=*+2
00131  03FC                     *=$E810
00132  E810              PIAL   *=*+1
00133  E811              PIAL1  *=*+1
00134  E812              PIAK   *=*+1
00135  E813              PIAS   *=*+1
00136  E814                     *=$E820
00137  E820              IEEI   *=*+1
00138  E821              IEEIS  *=*+1
00139  E822              IEEO   *=*+1
00140  E823              IEEOS  *=*+1
00141  E824                     *=$E840
00142  E840              PIA    *=*+1
00143  E841              SYNC   *=*+1
00144  E842              P2DB   *=*+1
00145  E843              P2DA   *=*+1
00146  E844              TIL    *=*+1
00147  E845              TIH    *=*+1
00148  E846              TILL   *=*+1
00149  E847              TILH   *=*+1
00150  E848              T2L    *=*+1
00151  E849              T2H    *=*+1
00152  E84A              SR     *=*+1
00153  E84B              ACR    *=*+1
00154  E84C              PCR    *=*+1
00155  E84D              IFR    *=*+1
00156  E84E              IER    *=*+1
00157  E84F              SYNC1  *=*+1





00159  E850              ;CONSTANTS FROM BASIC
00160  E850              CHANL  =$000E
00161  E850              READY  =$C389+OFFSET-$8000






ossrc......PAGE 0004

LINE# LOC   CODE        LINE


00162  E850              INIT   =$E116+OFFSET-$8000
00163  E850              FRMNUM =$CC8B+OFFSET-$8000
00164  E850              GETADR =$D6D2+OFFSET-$8000
00165  E850              LINNUM =$0011
00166  E850              TXTPTR =$0077
00167  E850              FINI   =$C439+OFFSET-$8000
00168  E850              STXTPT =$C5A7+OFFSET-$8000
00169  E850              FLOAD  =$C590+OFFSET-$8000
00170  E850              VARTAB =$002A
00171  E850              GETBYT =$D678+OFFSET-$8000
00172  E850              SNERR  =$CE03+OFFSET-$8000
00173  E850              CHRGOT =$0076
00174  E850              TYPERR =$C377+OFFSET-$8000
00175  E850              CHKCOM =$CDF8+OFFSET-$8000
00176  E850              FRESTR =$D57D+OFFSET-$8000
00177  E850              FRMEVL =$CC9F+OFFSET-$8000
00178  E850              CHRGET =$0070
00179  E850              BSTOP  =$C73F+OFFSET-$8000 ;BASIC SYMB STOP
00180  E850              INDEX1 =$001F
00181  E850              TXTTAB =$0028
00182  E850              LASTWR =$E1DE+OFFSET-$8000





00184  E850              ;TAPE BLOCK TYPES
00185  E850              EOT=5
00186  E850              BLF=1
00187  E850              BDF=2
00188  E850              BDFH=4
00189  E850              BUFSZ=192
00190  E850              CR     =$D
00191  E850              .FILE  OA1SRC



























SCREEN EDITOR & I/O......PAGE 0005

LINE# LOC   CODE        LINE


00193  E850                     *=LASTWR
00194  E1DE              ;*** SOFT MACHINE ******
00195  E1DE  A9 7F       CINT   LDA #$7F
00196  E1E0  8D 4E E8           STA IER
00197  E1E3  A2 6D              LDX #CAS2-TIME
00198  E1E5  A9 00              LDA #0
00199  E1E7  95 8D       PX1    STA TIME,X
00200  E1E9  CA                 DEX
00201  E1EA  10 FB              BPL PX1
00202  E1EC  A9 2E              LDA #<KEY
00203  E1EE  85 90              STA CINV
00204  E1F0  A9 E6              LDA #>KEY
00205  E1F2  85 91              STA CINV+1
00206  E1F4  A9 03              LDA #3
00207  E1F6  85 B0              STA DFLTO
00208  E1F8  A9 0F              LDA #$F
00209  E1FA  8D 10 E8           STA PIAL
00210  E1FD  0A                 ASL A
00211  E1FE  8D 40 E8           STA PIA
00212  E201  8D 42 E8           STA P2DB
00213  E204  8E 22 E8           STX IEEO
00214  E207  8E 45 E8           STX TIH
00215  E20A  A9 3D              LDA #$3D
00216  E20C  8D 13 E8           STA PIAS
00217  E20F  2C 12 E8           BIT PIAK
00218  E212  A9 3C              LDA #$3C
00219  E214  8D 21 E8           STA IEEIS
00220  E217  8D 23 E8           STA IEEOS
00221  E21A  8D 11 E8           STA PIAL1
00222  E21D  8E 22 E8           STX IEEO
00223  E220  A9 0C              LDA #$C
00224  E222  8D 4C E8           STA PCR
00225  E225  85 A8              STA BLNCT
00226  E227  85 A7              STA BLNSW
00227  E229  A0 83       CLSR   LDY #$83
00228  E22B  A2 18              LDX #24
00229  E22D  94 E0       LPS1   STY LDTB1,X
00230  E22F  E0 14              CPX #20
00231  E231  F0 08              BEQ LPS2
00232  E233  E0 0D              CPX #13
00233  E235  F0 04              BEQ LPS2
00234  E237  E0 07              CPX #7
00235  E239  D0 01              BNE LPS3
00236  E23B  88          LPS2   DEY
00237  E23C  CA          LPS3   DEX
00238  E23D  10 EE              BPL LPS1
00239  E23F  84 C5              STY POINT
00240  E241  E8                 INX
00241  E242  86 9F              STX RVS
00242  E244  86 C4              STX POINT-1
00243  E246  A9 20              LDA #' 
00244  E248  9D 00 80    LPS4   STA $8000,X
00245  E24B  9D 00 81           STA $8100,X
00246  E24E  9D 00 82           STA $8200,X
00247  E251  9D 00 83           STA $8300,X






SCREEN EDITOR & I/O......PAGE 0006

LINE# LOC   CODE        LINE


00248  E254  CA                 DEX
00249  E255  D0 F1              BNE LPS4
00250  E257  A0 00       NXTD   LDY #0
00251  E259  84 C6              STY PNTR
00252  E25B  84 D8              STY TBLX
00253  E25D  A6 D8       STUPT  LDX TBLX
00254  E25F  B5 E0              LDA LDTB1,X
00255  E261  09 80              ORA #$80
00256  E263  85 C5              STA POINT
00257  E265  BD 48 E7           LDA LDTB2,X
00258  E268  85 C4              STA PNT
00259  E26A  A9 27              LDA #39
00260  E26C  85 D5              STA LNMX
00261  E26E  E0 18              CPX #24
00262  E270  F0 08              BEQ STUPZ
00263  E272  B5 E1              LDA LDTB1+1,X
00264  E274  30 04              BMI STUPZ
00265  E276  A9 4F              LDA #79
00266  E278  85 D5              STA LNMX
00267  E27A  A5 C6       STUPZ  LDA PNTR
00268  E27C  C9 28              CMP #40
00269  E27E  90 04              BCC STUPR
00270  E280  E9 28              SBC #40
00271  E282  85 C6              STA PNTR
00272  E284  60          STUPR  RTS
00273  E285  AC 6F 02    LP2    LDY KEYD
00274  E288  A2 00              LDX #0
00275  E28A  BD 70 02    LP1    LDA KEYD+1,X
00276  E28D  9D 6F 02           STA KEYD,X
00277  E290  E8                 INX
00278  E291  E4 9E              CPX NDX
00279  E293  D0 F5              BNE LP1
00280  E295  C6 9E              DEC NDX
00281  E297  98                 TYA
00282  E298  58                 CLI
00283  E299  60                 RTS
00284  E29A  20 D8 E3    LOOP4  JSR PRT
00285  E29D  A5 9E       LOOP3  LDA NDX
00286  E29F  85 A7              STA BLNSW
00287  E2A1  F0 FA              BEQ LOOP3
00288  E2A3  78                 SEI
00289  E2A4  A5 AA              LDA BLNON
00290  E2A6  F0 09              BEQ LP21
00291  E2A8  A5 A9              LDA GDBLN
00292  E2AA  A0 00              LDY #0
00293  E2AC  84 AA              STY BLNON
00294  E2AE  20 EA E6           JSR DSPP
00295  E2B1  20 85 E2    LP21   JSR LP2
00296  E2B4  C9 83              CMP #$83
00297  E2B6  D0 10              BNE LP22
00298  E2B8  78                 SEI
00299  E2B9  A2 09              LDX #9
00300  E2BB  86 9E              STX NDX
00301  E2BD  BD 60 E7    LP23   LDA RUNTB-1,X
00302  E2C0  9D 6E 02           STA KEYD-1,X






SCREEN EDITOR & I/O......PAGE 0007

LINE# LOC   CODE        LINE


00303  E2C3  CA                 DEX
00304  E2C4  D0 F7              BNE LP23
00305  E2C6  F0 D5              BEQ LOOP3
00306  E2C8  C9 0D       LP22   CMP #$D
00307  E2CA  D0 CE              BNE LOOP4
00308  E2CC  A4 D5              LDY LNMX
00309  E2CE  84 AC              STY CRSW
00310  E2D0  B1 C4       CLP5   LDA (PNT)Y
00311  E2D2  C9 20              CMP #' 
00312  E2D4  D0 03              BNE CLP6
00313  E2D6  88                 DEY
00314  E2D7  D0 F7              BNE CLP5
00315  E2D9  C8          CLP6   INY
00316  E2DA  84 A1              STY INDX
00317  E2DC  A0 00              LDY #0
00318  E2DE  84 C6              STY PNTR
00319  E2E0  84 CD              STY QTSW
00320  E2E2  A5 A3              LDA LSXP
00321  E2E4  30 16              BMI LOP5
00322  E2E6  C5 D8              CMP TBLX
00323  E2E8  D0 12              BNE LOP5
00324  E2EA  A5 A4              LDA LSTP
00325  E2EC  85 C6              STA PNTR
00326  E2EE  C5 A1              CMP INDX
00327  E2F0  90 0A              BCC LOP5
00328  E2F2  B0 2B              BCS CLP2
00329  E2F4  98          LOOP5  TYA
00330  E2F5  48                 PHA
00331  E2F6  8A                 TXA
00332  E2F7  48                 PHA
00333  E2F8  A5 AC              LDA CRSW
00334  E2FA  F0 A1              BEQ LOOP3
00335  E2FC  A4 C6       LOP5   LDY PNTR
00336  E2FE  B1 C4              LDA (PNT)Y
00337  E300  85 D9              STA DATA
00338  E302  29 3F       LOP51  AND #$3F
00339  E304  06 D9              ASL DATA
00340  E306  24 D9              BIT DATA
00341  E308  10 02              BPL LOP54
00342  E30A  09 80              ORA #$80
00343  E30C  90 04       LOP54  BCC LOP52
00344  E30E  A6 CD              LDX QTSW
00345  E310  D0 04              BNE LOP53
00346  E312  70 02       LOP52  BVS LOP53
00347  E314  09 40              ORA #$40
00348  E316  E6 C6       LOP53  INC PNTR
00349  E318  20 3F E3           JSR QTSWC
00350  E31B  C4 A1              CPY INDX
00351  E31D  D0 11              BNE CLP1
00352  E31F  A9 00       CLP2   LDA #0
00353  E321  85 AC              STA CRSW
00354  E323  A9 0D              LDA #$D
00355  E325  A6 B0              LDX DFLTO
00356  E327  E0 03              CPX #3
00357  E329  F0 03              BEQ CLP21






SCREEN EDITOR & I/O......PAGE 0008

LINE# LOC   CODE        LINE


00358  E32B  20 D8 E3    CLP2A  JSR PRT
00359  E32E  A9 0D       CLP21  LDA #$D
00360  E330  85 D9       CLP1   STA DATA
00361  E332  68                 PLA
00362  E333  AA                 TAX
00363  E334  68                 PLA
00364  E335  A8                 TAY
00365  E336  A5 D9              LDA DATA
00366  E338  C9 DE              CMP #$DE
00367  E33A  D0 02              BNE CLP7
00368  E33C  A9 FF              LDA #$FF
00369  E33E  60          CLP7   RTS
00370  E33F  C9 22       QTSWC  CMP #$22
00371  E341  D0 08              BNE QTSWL
00372  E343  A5 CD              LDA QTSW
00373  E345  49 01              EOR #$1
00374  E347  85 CD              STA QTSW
00375  E349  A9 22              LDA #$22
00376  E34B  60          QTSWL  RTS
00377  E34C  09 40       NXT33  ORA #$40
00378  E34E  A6 9F       NXT3   LDX RVS
00379  E350  F0 02              BEQ NVS
00380  E352  09 80       NC3    ORA #$80
00381  E354  A6 DC       NVS    LDX INSRT
00382  E356  F0 02              BEQ NVS1
00383  E358  C6 DC              DEC INSRT
00384  E35A  20 EA E6    NVS1   JSR DSPP
00385  E35D  E6 C6       JSTS   INC PNTR
00386  E35F  A4 D5              LDY LNMX
00387  E361  C4 C6              CPY PNTR
00388  E363  B0 19              BCS LOOP2
00389  E365  A6 D8              LDX TBLX
00390  E367  C0 4F              CPY #79
00391  E369  D0 0C              BNE JSTS1
00392  E36B  20 8B E3           JSR JSTSX
00393  E36E  20 19 E5           JSR NXLN
00394  E371  A9 00              LDA #0
00395  E373  85 C6              STA PNTR
00396  E375  F0 07              BEQ LOOP2
00397  E377  E0 18       JSTS1  CPX #24
00398  E379  D0 1B              BNE JTS2
00399  E37B  20 9C E3           JSR SCRL
00400  E37E  68          LOOP2  PLA
00401  E37F  A8                 TAY
00402  E380  A5 DC              LDA INSRT
00403  E382  F0 02              BEQ LOP2
00404  E384  46 CD              LSR QTSW
00405  E386  68          LOP2   PLA
00406  E387  AA                 TAX
00407  E388  68                 PLA
00408  E389  58                 CLI
00409  E38A  60                 RTS
00410  E38B  E0 17       JSTSX  CPX #23
00411  E38D  B0 06              BCS JSXB
00412  E38F  B5 E2              LDA LDTB1+2,X






SCREEN EDITOR & I/O......PAGE 0009

LINE# LOC   CODE        LINE


00413  E391  09 80              ORA #$80
00414  E393  95 E2              STA LDTB1+2,X
00415  E395  60          JSXB   RTS
00416  E396  20 A3 E3    JTS2   JSR JSTS2
00417  E399  4C 7E E3           JMP LOOP2
00418  E39C  20 3F E5    SCRL   JSR SCROL
00419  E39F  C6 D8              DEC TBLX
00420  E3A1  A6 D8              LDX TBLX
00421  E3A3  16 E1       JSTS2  ASL LDTB1+1,X
00422  E3A5  56 E1              LSR LDTB1+1,X
00423  E3A7  20 8B E3           JSR JSTSX
00424  E3AA  A5 C6              LDA PNTR
00425  E3AC  48                 PHA
00426  E3AD  20 5D E2           JSR STUPT
00427  E3B0  68                 PLA
00428  E3B1  85 C6              STA PNTR
00429  E3B3  60                 RTS
00430  E3B4  A0 27       BKLN   LDY #39
00431  E3B6  A6 D8              LDX TBLX
00432  E3B8  D0 06              BNE BKLN1
00433  E3BA  86 C6              STX PNTR
00434  E3BC  68                 PLA
00435  E3BD  68                 PLA
00436  E3BE  D0 BE              BNE LOOP2
00437  E3C0  B5 DF       BKLN1  LDA LDTB1-1,X
00438  E3C2  30 05              BMI NTCN2
00439  E3C4  CA                 DEX
00440  E3C5  B5 DF              LDA LDTB1-1,X
00441  E3C7  A0 4F              LDY #79
00442  E3C9  CA          NTCN2  DEX
00443  E3CA  86 D8              STX TBLX
00444  E3CC  85 C5              STA POINT
00445  E3CE  BD 48 E7           LDA LDTB2,X
00446  E3D1  85 C4              STA PNT
00447  E3D3  84 C6              STY PNTR
00448  E3D5  84 D5              STY LNMX
00449  E3D7  60                 RTS
00450  E3D8  48          PRT    PHA
00451  E3D9  85 D9              STA DATA
00452  E3DB  8A                 TXA
00453  E3DC  48                 PHA
00454  E3DD  98                 TYA
00455  E3DE  48                 PHA
00456  E3DF  A9 00              LDA #0
00457  E3E1  85 AC              STA CRSW
00458  E3E3  A4 C6              LDY PNTR
00459  E3E5  A5 D9              LDA DATA
00460  E3E7  10 03              BPL *+5
00461  E3E9  4C 7A E4           JMP NXTX
00462  E3EC  C9 0D              CMP #$D
00463  E3EE  D0 03              BNE NJT1
00464  E3F0  4C 2F E5           JMP NXT1
00465  E3F3  C9 20       NJT1   CMP #' 
00466  E3F5  90 08              BCC NTCN
00467  E3F7  29 3F              AND #$3F






SCREEN EDITOR & I/O......PAGE 000A

LINE# LOC   CODE        LINE


00468  E3F9  20 3F E3           JSR QTSWC
00469  E3FC  4C 4E E3           JMP NXT3
00470  E3FF  A6 DC       NTCN   LDX INSRT
00471  E401  F0 03              BEQ CNC3X
00472  E403  4C 52 E3           JMP NC3
00473  E406  C9 14       CNC3X  CMP #$14
00474  E408  D0 1C              BNE NTCN1
00475  E40A  88                 DEY
00476  E40B  84 C6              STY PNTR
00477  E40D  10 06              BPL BK1
00478  E40F  20 B4 E3           JSR BKLN
00479  E412  4C 20 E4           JMP BK2
00480  E415  C8          BK1    INY
00481  E416  B1 C4              LDA (PNT)Y
00482  E418  88                 DEY
00483  E419  91 C4              STA (PNT)Y
00484  E41B  C8                 INY
00485  E41C  C4 D5              CPY LNMX
00486  E41E  D0 F5              BNE BK1
00487  E420  A9 20       BK2    LDA #' 
00488  E422  91 C4              STA (PNT)Y
00489  E424  D0 3C              BNE JPL3
00490  E426  A6 CD       NTCN1  LDX QTSW
00491  E428  F0 03              BEQ NC3W
00492  E42A  4C 52 E3    CNC3   JMP NC3
00493  E42D  C9 12       NC3W   CMP #$12
00494  E42F  D0 02              BNE NC1
00495  E431  85 9F              STA RVS
00496  E433  C9 13       NC1    CMP #$13
00497  E435  D0 03              BNE NC2
00498  E437  20 57 E2           JSR NXTD
00499  E43A  C9 1D       NC2    CMP #$1D
00500  E43C  D0 12              BNE NCX2
00501  E43E  C8                 INY
00502  E43F  84 C6              STY PNTR
00503  E441  88                 DEY
00504  E442  C4 D5              CPY LNMX
00505  E444  90 07              BCC NCZ2
00506  E446  20 19 E5           JSR NXLN
00507  E449  A0 00              LDY #0
00508  E44B  84 C6       JPL4   STY PNTR
00509  E44D  4C 7E E3    NCZ2   JMP LOOP2
00510  E450  C9 11       NCX2   CMP #$11
00511  E452  D0 0E              BNE JPL3
00512  E454  18                 CLC
00513  E455  98                 TYA
00514  E456  69 28              ADC #40
00515  E458  A8                 TAY
00516  E459  C5 D5              CMP LNMX
00517  E45B  90 EE              BCC JPL4
00518  E45D  F0 EC              BEQ JPL4
00519  E45F  20 19 E5           JSR NXLN
00520  E462  4C 7E E3    JPL3   JMP LOOP2
00521  E465  E8          PRT1   INX
00522  E466  85 D8              STA TBLX






SCREEN EDITOR & I/O......PAGE 000B

LINE# LOC   CODE        LINE


00523  E468  98                 TYA
00524  E469  E9 28              SBC #40
00525  E46B  85 C6              STA PNTR
00526  E46D  E6 D8       PRT2   INC TBLX
00527  E46F  AD 48 E7           LDA LDTB2
00528  E472  85 C4              STA PNT
00529  E474  A5 E0              LDA LDTB1
00530  E476  85 C5              STA POINT
00531  E478  D0 E8              BNE JPL3
00532  E47A  29 7F       NXTX   AND #$7F
00533  E47C  C9 7F              CMP #$7F
00534  E47E  D0 02              BNE NXTX1
00535  E480  A9 5E              LDA #$5E
00536  E482  C9 20       NXTX1  CMP #' 
00537  E484  90 03              BCC *+5
00538  E486  4C 4C E3           JMP NXT33
00539  E489  C9 0D              CMP #$D
00540  E48B  D0 03              BNE UP5
00541  E48D  4C 2F E5           JMP NXT1
00542  E490  A6 CD       UP5    LDX  QTSW
00543  E492  D0 30              BNE UP6
00544  E494  C9 14              CMP #$14
00545  E496  D0 28              BNE UP9
00546  E498  A4 D5              LDY LNMX
00547  E49A  B1 C4              LDA (PNT)Y
00548  E49C  C9 20              CMP #' 
00549  E49E  D0 04              BNE INS3
00550  E4A0  C4 C6              CPY PNTR
00551  E4A2  D0 07              BNE INS1
00552  E4A4  C0 4F       INS3   CPY #79
00553  E4A6  F0 BA              BEQ JPL3
00554  E4A8  20 BA E5           JSR NEWLN
00555  E4AB  A4 D5       INS1   LDY LNMX
00556  E4AD  88          INS2   DEY
00557  E4AE  B1 C4              LDA (PNT)Y
00558  E4B0  C8                 INY
00559  E4B1  91 C4              STA (PNT)Y
00560  E4B3  88                 DEY
00561  E4B4  C4 C6              CPY PNTR
00562  E4B6  D0 F5              BNE INS2
00563  E4B8  A9 20              LDA #$20
00564  E4BA  91 C4              STA (PNT)Y
00565  E4BC  E6 DC              INC INSRT
00566  E4BE  D0 56              BNE JLP2
00567  E4C0  A6 DC       UP9    LDX INSRT
00568  E4C2  F0 05              BEQ UP2
00569  E4C4  09 40       UP6    ORA #$40
00570  E4C6  4C 52 E3           JMP NC3
00571  E4C9  C9 11       UP2    CMP #$11
00572  E4CB  D0 2B              BNE NXT2
00573  E4CD  A5 C6              LDA PNTR
00574  E4CF  C9 28              CMP #40
00575  E4D1  90 06              BCC UP1
00576  E4D3  E9 28              SBC #40
00577  E4D5  85 C6              STA PNTR






SCREEN EDITOR & I/O......PAGE 000C

LINE# LOC   CODE        LINE


00578  E4D7  B0 3D              BCS JLP2
00579  E4D9  A6 D8       UP1    LDX TBLX
00580  E4DB  F0 39              BEQ JLP2
00581  E4DD  B5 DF              LDA LDTB1-1,X
00582  E4DF  10 07              BPL UP3
00583  E4E1  C6 D8              DEC TBLX
00584  E4E3  20 5D E2           JSR STUPT
00585  E4E6  90 2E              BCC JLP2
00586  E4E8  CA          UP3    DEX
00587  E4E9  CA                 DEX
00588  E4EA  86 D8              STX TBLX
00589  E4EC  20 5D E2           JSR STUPT
00590  E4EF  A5 C6              LDA PNTR
00591  E4F1  18                 CLC
00592  E4F2  69 28              ADC #40
00593  E4F4  85 C6              STA PNTR
00594  E4F6  D0 1E              BNE JLP2
00595  E4F8  C9 12       NXT2   CMP #$12
00596  E4FA  D0 04              BNE NXT6
00597  E4FC  A9 00              LDA #0
00598  E4FE  85 9F              STA RVS
00599  E500  C9 1D       NXT6   CMP #$1D
00600  E502  D0 0B              BNE NXT61
00601  E504  88                 DEY
00602  E505  84 C6              STY PNTR
00603  E507  10 0D              BPL JLP2
00604  E509  20 B4 E3           JSR BKLN
00605  E50C  4C 7E E3           JMP LOOP2
00606  E50F  C9 13       NXT61  CMP #$13
00607  E511  D0 03              BNE JLP2
00608  E513  20 29 E2           JSR CLSR
00609  E516  4C 7E E3    JLP2   JMP LOOP2
00610  E519  38          NXLN   SEC
00611  E51A  46 A3              LSR LSXP
00612  E51C  A6 D8              LDX TBLX
00613  E51E  E8          NXLN2  INX
00614  E51F  E0 19              CPX #25
00615  E521  D0 03              BNE NXLN1
00616  E523  20 3F E5           JSR SCROL
00617  E526  B5 E0       NXLN1  LDA LDTB1,X
00618  E528  10 F4              BPL NXLN2
00619  E52A  86 D8              STX TBLX
00620  E52C  4C 5D E2           JMP STUPT
00621  E52F  A9 00       NXT1   LDA #0
00622  E531  85 DC              STA INSRT
00623  E533  85 9F              STA RVS
00624  E535  85 CD              STA QTSW
00625  E537  85 C6              STA PNTR
00626  E539  20 19 E5           JSR NXLN
00627  E53C  4C 7E E3           JMP LOOP2
00628  E53F              .FILE  OA2SRC










SCREEN EDITOR & I/O......PAGE 000D

LINE# LOC   CODE        LINE


00630  E53F  78          SCROL  SEI
00631  E540  A0 00              LDY #0
00632  E542  84 C4              STY POINT-1
00633  E544  A9 80              LDA #$80
00634  E546  85 C8              STA SAH
00635  E548  85 C5              STA POINT
00636  E54A  A9 28              LDA #40
00637  E54C  24 E1              BIT LDTB1+1
00638  E54E  30 02              BMI SCRL1
00639  E550  A9 50              LDA #80
00640  E552  85 C7       SCRL1  STA SAL
00641  E554  A9 34              LDA #$34
00642  E556  8D 11 E8           STA PIAL1
00643  E559  B1 C7       MLP1   LDA (SAL)Y
00644  E55B  91 C4              STA (POINT-1)Y
00645  E55D  C8                 INY
00646  E55E  D0 F9              BNE MLP1
00647  E560  E6 C8              INC SAH
00648  E562  E6 C5              INC POINT
00649  E564  A9 84              LDA #$84
00650  E566  C5 C8              CMP SAH
00651  E568  D0 EF              BNE MLP1
00652  E56A  A9 E8              LDA #232
00653  E56C  85 C4              STA PNT
00654  E56E  C6 C5              DEC POINT
00655  E570  A9 20              LDA #' 
00656  E572  C6 C4       MLP2   DEC PNT
00657  E574  C6 C7              DEC SAL
00658  E576  91 C4              STA (PNT)Y
00659  E578  D0 F8              BNE MLP2
00660  E57A  A2 19              LDX #25
00661  E57C  86 D8              STX TBLX
00662  E57E  A2 00       SCRL4  LDX #0
00663  E580  C6 D8              DEC TBLX
00664  E582  B5 E0       SCRL5  LDA LDTB1,X
00665  E584  29 7F              AND #$7F
00666  E586  B4 E1              LDY LDTB1+1,X
00667  E588  10 02              BPL SCRL3
00668  E58A  09 80              ORA #$80
00669  E58C  95 E0       SCRL3  STA LDTB1,X
00670  E58E  E8                 INX
00671  E58F  E0 19              CPX #25
00672  E591  D0 EF              BNE SCRL5
00673  E593  A9 83              LDA #$83
00674  E595  85 F8              STA LDTB1+24
00675  E597  A5 E0              LDA LDTB1
00676  E599  10 E3              BPL SCRL4
00677  E59B  A9 3C              LDA #$3C
00678  E59D  8D 11 E8           STA PIAL1
00679  E5A0  58                 CLI
00680  E5A1  A9 FE              LDA #$FE
00681  E5A3  CD 12 E8           CMP PIAK
00682  E5A6  D0 0F              BNE MLP42
00683  E5A8  A0 08              LDY #8
00684  E5AA  8D 45 E8    MLP4   STA TIH






SCREEN EDITOR & I/O......PAGE 000E

LINE# LOC   CODE        LINE


00685  E5AD  2C 4D E8    MLP41  BIT IFR
00686  E5B0  50 FB              BVC MLP41
00687  E5B2  88                 DEY
00688  E5B3  D0 F5              BNE MLP4
00689  E5B5  84 9E              STY NDX
00690  E5B7  A6 D8       MLP42  LDX TBLX
00691  E5B9  60                 RTS
00692  E5BA  A6 D8       NEWLN  LDX TBLX
00693  E5BC  E8                 INX
00694  E5BD  78                 SEI
00695  E5BE  A9 34              LDA #$34
00696  E5C0  8D 11 E8           STA PIAL1
00697  E5C3  E0 18              CPX #24
00698  E5C5  F0 33              BEQ BLKLN
00699  E5C7  90 03              BCC NEWLX
00700  E5C9  4C 9C E3           JMP SCRL
00701  E5CC  A2 17       NEWLX  LDX #23
00702  E5CE  B5 E1       NEWL1  LDA LDTB1+1,X
00703  E5D0  09 80              ORA #$80
00704  E5D2  85 C8              STA SAH
00705  E5D4  B4 E0              LDY LDTB1,X
00706  E5D6  30 02              BMI NEWLA
00707  E5D8  29 7F              AND #$7F
00708  E5DA  95 E1       NEWLA  STA LDTB1+1,X
00709  E5DC  98                 TYA
00710  E5DD  09 80              ORA #$80
00711  E5DF  85 C5              STA POINT
00712  E5E1  A0 27              LDY #39
00713  E5E3  BD 49 E7           LDA LDTB2+1,X
00714  E5E6  85 C7              STA SAL
00715  E5E8  BD 48 E7           LDA LDTB2,X
00716  E5EB  85 C4              STA PNT
00717  E5ED  B1 C4       NELL   LDA (PNT)Y
00718  E5EF  91 C7              STA (SAL)Y
00719  E5F1  88                 DEY
00720  E5F2  10 F9              BPL NELL
00721  E5F4  CA                 DEX
00722  E5F5  E4 D8              CPX TBLX
00723  E5F7  D0 D5              BNE NEWL1
00724  E5F9  E8                 INX
00725  E5FA  B5 E0       BLKLN  LDA LDTB1,X
00726  E5FC  09 80              ORA #$80
00727  E5FE  85 C5              STA POINT
00728  E600  29 7F              AND #$7F
00729  E602  95 E0              STA LDTB1,X
00730  E604  BD 48 E7           LDA LDTB2,X
00731  E607  85 C4              STA PNT
00732  E609  A0 27              LDY #39
00733  E60B  A9 20              LDA #' 
00734  E60D  91 C4       BLKL   STA (PNT)Y
00735  E60F  88                 DEY
00736  E610  10 FB              BPL BLKL
00737  E612  A9 3C              LDA #$3C
00738  E614  8D 11 E8           STA PIAL1
00739  E617  58                 CLI






SCREEN EDITOR & I/O......PAGE 000F

LINE# LOC   CODE        LINE


00740  E618  4C 5D E2           JMP STUPT
00741  E61B  48          PULS   PHA
00742  E61C  8A                 TXA
00743  E61D  48                 PHA
00744  E61E  98                 TYA
00745  E61F  48                 PHA
00746  E620  BA                 TSX
00747  E621  BD 04 01           LDA $104,X
00748  E624  29 10              AND #$10
00749  E626  F0 03              BEQ PULS1
00750  E628  6C 92 00           JMP (CBINV)
00751  E62B  6C 90 00    PULS1  JMP (CINV)
00752  E62E  20 EA FF    KEY    JSR KUDTIM
00753  E631  A5 A7              LDA BLNSW
00754  E633  D0 18              BNE KEY4
00755  E635  C6 A8              DEC BLNCT
00756  E637  D0 14              BNE KEY4
00757  E639  A9 14              LDA #20
00758  E63B  85 A8              STA BLNCT
00759  E63D  A4 C6              LDY PNTR
00760  E63F  46 AA              LSR BLNON
00761  E641  B1 C4              LDA (POINT-1)Y
00762  E643  B0 04              BCS KEY5
00763  E645  E6 AA              INC BLNON
00764  E647  85 A9              STA GDBLN
00765  E649  49 80       KEY5   EOR #$80
00766  E64B  91 C4              STA (POINT-1)Y
00767  E64D  A2 FF       KEY4   LDX #$FF
00768  E64F  86 A6              STX SFDX
00769  E651  E8                 INX
00770  E652  86 98              STX SFST
00771  E654  A2 50              LDX #80
00772  E656  AD 10 E8           LDA PIAL
00773  E659  29 F0              AND #$F0
00774  E65B  8D 10 E8           STA PIAL
00775  E65E  A0 00              LDY #0
00776  E660  AD 10 E8           LDA PIAL
00777  E663  0A                 ASL A
00778  E664  0A                 ASL A
00779  E665  0A                 ASL A
00780  E666  10 06              BPL KEY3
00781  E668  84 F9              STY CAS1
00782  E66A  A9 3D              LDA #$3D
00783  E66C  D0 06              BNE KL24
00784  E66E  A5 F9       KEY3   LDA CAS1
00785  E670  D0 05              BNE KL2
00786  E672  A9 35              LDA #$35
00787  E674  8D 13 E8    KL24   STA PIAS
00788  E677  90 09       KL2    BCC KL23
00789  E679  84 FA              STY CAS2
00790  E67B  AD 40 E8           LDA PIA
00791  E67E  09 10              ORA #$10
00792  E680  D0 09              BNE KL25
00793  E682  A5 FA       KL23   LDA CAS2
00794  E684  D0 08              BNE KL22






SCREEN EDITOR & I/O......PAGE 0010

LINE# LOC   CODE        LINE


00795  E686  AD 40 E8           LDA PIA
00796  E689  29 EF              AND #$EF
00797  E68B  8D 40 E8    KL25   STA PIA
00798  E68E  A0 08       KL22   LDY #8
00799  E690  AD 12 E8           LDA PIAK
00800  E693  CD 12 E8           CMP PIAK
00801  E696  D0 F6              BNE KL22
00802  E698  4A          KL1    LSR A
00803  E699  B0 1C              BCS CKIT
00804  E69B  48                 PHA
00805  E69C  BD F7 E6           LDA CHAR-1,X
00806  E69F  D0 06              BNE CKIS1
00807  E6A1  A9 01              LDA #1
00808  E6A3  85 98              STA SFST
00809  E6A5  D0 0F              BNE CKUT
00810  E6A7  C9 FF       CKIS1  CMP #$FF
00811  E6A9  F0 0B              BEQ CKUT
00812  E6AB  C9 3C              CMP #$3C
00813  E6AD  D0 05              BNE SPCK
00814  E6AF  2C 11 E8           BIT PIAL1
00815  E6B2  30 02              BMI CKUT
00816  E6B4  86 A6       SPCK   STX SFDX
00817  E6B6  68          CKUT   PLA
00818  E6B7  CA          CKIT   DEX
00819  E6B8  F0 08              BEQ CKIT1
00820  E6BA  88                 DEY
00821  E6BB  D0 DB              BNE KL1
00822  E6BD  EE 10 E8           INC PIAL
00823  E6C0  D0 CC              BNE KL22
00824  E6C2  A5 A6       CKIT1  LDA SFDX
00825  E6C4  C5 97              CMP LSTX
00826  E6C6  F0 1C              BEQ PREND
00827  E6C8  85 97              STA LSTX
00828  E6CA  AA                 TAX
00829  E6CB  30 17              BMI PREND
00830  E6CD  BD F7 E6           LDA CHAR-1,X
00831  E6D0  46 98              LSR SFST
00832  E6D2  90 02              BCC KN1
00833  E6D4  09 80              ORA #$80
00834  E6D6  A6 9E       KN1    LDX NDX
00835  E6D8  9D 6F 02           STA KEYD,X
00836  E6DB  E8                 INX
00837  E6DC  E0 0A              CPX #10
00838  E6DE  D0 02              BNE KEYF
00839  E6E0  A2 00              LDX #0
00840  E6E2  86 9E       KEYF   STX NDX
00841  E6E4  68          PREND  PLA
00842  E6E5  A8                 TAY
00843  E6E6  68                 PLA
00844  E6E7  AA                 TAX
00845  E6E8  68                 PLA
00846  E6E9  40                 RTI
00847  E6EA  A8          DSPP   TAY
00848  E6EB  AD 40 E8    DSPP1  LDA PIA
00849  E6EE  29 20              AND #$20






SCREEN EDITOR & I/O......PAGE 0011

LINE# LOC   CODE        LINE


00850  E6F0  D0 F9              BNE DSPP1
00851  E6F2  98                 TYA
00852  E6F3  A4 C6              LDY PNTR
00853  E6F5  91 C4              STA (POINT-1)Y
00854  E6F7  60                 RTS
00855  E6F8  3D          CHAR   .BYT $3D,$2E
00855  E6F9  2E 
00856  E6FA  FF                 .BYT $FF,$3,$3C,$20,$5B,$12
00856  E6FB  03 
00856  E6FC  3C 
00856  E6FD  20 
00856  E6FE  5B 
00856  E6FF  12 
00857  E700  2D                 .BYT $2D,$30,0,$3E,$FF,$5D,$40,0
00857  E701  30 
00857  E702  00 
00857  E703  3E 
00857  E704  FF 
00857  E705  5D 
00857  E706  40 
00857  E707  00 
00858  E708  2B                 .BYT $2B,$32,$FF,$3F,$2C,$4E,$56,$58
00858  E709  32 
00858  E70A  FF 
00858  E70B  3F 
00858  E70C  2C 
00858  E70D  4E 
00858  E70E  56 
00858  E70F  58 
00859  E710  33                 .BYT $33,$31,$D,$3B,$4D,$42,$43,$5A
00859  E711  31 
00859  E712  0D 
00859  E713  3B 
00859  E714  4D 
00859  E715  42 
00859  E716  43 
00859  E717  5A 
00860  E718  2A                 .BYT $2A,$35,$FF,$3A,$4B,$48,$46,$53
00860  E719  35 
00860  E71A  FF 
00860  E71B  3A 
00860  E71C  4B 
00860  E71D  48 
00860  E71E  46 
00860  E71F  53 
00861  E720  36                 .BYT $36,$34,$FF,$4C,$4A,$47,$44,$41
00861  E721  34 
00861  E722  FF 
00861  E723  4C 
00861  E724  4A 
00861  E725  47 
00861  E726  44 
00861  E727  41 
00862  E728  2F                 .BYT $2F,$38,$FF,$50,$49,$59,$52,$57
00862  E729  38 






SCREEN EDITOR & I/O......PAGE 0012

LINE# LOC   CODE        LINE


00862  E72A  FF 
00862  E72B  50 
00862  E72C  49 
00862  E72D  59 
00862  E72E  52 
00862  E72F  57 
00863  E730  39                 .BYT $39,$37,$5E,$4F,$55,$54,$45,$51
00863  E731  37 
00863  E732  5E 
00863  E733  4F 
00863  E734  55 
00863  E735  54 
00863  E736  45 
00863  E737  51 
00864  E738  14                 .BYT $14,$11,$FF,$29,$5C,$27,$24,$22
00864  E739  11 
00864  E73A  FF 
00864  E73B  29 
00864  E73C  5C 
00864  E73D  27 
00864  E73E  24 
00864  E73F  22 
00865  E740  1D                 .BYT $1D,$13,$5F,$28,$26,$25,$23,$21
00865  E741  13 
00865  E742  5F 
00865  E743  28 
00865  E744  26 
00865  E745  25 
00865  E746  23 
00865  E747  21 
00866  E748  00          LDTB2  .BYT 0,40,80,120,160,200
00866  E749  28 
00866  E74A  50 
00866  E74B  78 
00866  E74C  A0 
00866  E74D  C8 
00867  E74E  F0                 .BYT 240,280-256,320-256,360-256
00867  E74F  18 
00867  E750  40 
00867  E751  68 
00868  E752  90                 .BYT 400-256,440-256,480-256
00868  E753  B8 
00868  E754  E0 
00869  E755  08                 .BYT 520-512,560-512
00869  E756  30 
00870  E757  58                 .BYT 600-512,640-512,680-512
00870  E758  80 
00870  E759  A8 
00871  E75A  D0                 .BYT 720-512,760-512,800-768
00871  E75B  F8 
00871  E75C  20 
00872  E75D  48                 .BYT 840-768,880-768,920-768,960-768
00872  E75E  70 
00872  E75F  98 
00872  E760  C0 






SCREEN EDITOR & I/O......PAGE 0013

LINE# LOC   CODE        LINE


00873  E761  4C 4F       RUNTB  .BYT 'LOAD',$D,'RUN',$D
00873  E765  0D 
00873  E766  52 55 4E 
00873  E769  0D 
00874  E76A              ;
00875  E76A              .FILE  UTILIT























































UTILITIES......PAGE 0014

LINE# LOC   CODE        LINE


00877  E76A              ;WRITE ADR FROM TMPO STORES
00878  E76A  A2 01       WROA   LDX #1
00879  E76C  B5 FA       WROA1  LDA TMP0-1,X
00880  E76E  48                 PHA
00881  E76F  B5 FB              LDA TMP0,X
00882  E771  20 75 E7           JSR WROB
00883  E774  68                 PLA
00884  E775              ;WRITE BYTE --- A = BYTE
00885  E775              ;UNPACK BYTE DATA INTO TWO ASCII
00886  E775              ;CHARACTERS. A=BYTE; X,A=CHARS
00887  E775  48          WROB   PHA
00888  E776  4A                 LSR A
00889  E777  4A                 LSR A
00890  E778  4A                 LSR A
00891  E779  4A                 LSR A
00892  E77A  20 8D E7           JSR ASCII       ;CONVERT TO ASCII
00893  E77D  AA                 TAX
00894  E77E  68                 PLA
00895  E77F  29 0F              AND #$0F
00896  E781  20 8D E7           JSR ASCII
00897  E784              ;WRITE 2 CHARS--X,A=CHARS
00898  E784  48          WRTWO  PHA
00899  E785  8A                 TXA
00900  E786  20 D2 FF           JSR KBSOUT
00901  E789  68                 PLA
00902  E78A  4C D2 FF           JMP KBSOUT
00903  E78D  18          ASCII  CLC
00904  E78E  69 F6              ADC #$F6
00905  E790  90 02              BCC ASC1
00906  E792  69 06              ADC #$06
00907  E794  69 3A       ASC1   ADC #$3A
00908  E796  60                 RTS
00909  E797  A2 02       T2T2   LDX #2
00910  E799  B5 FA       T2T21  LDA TMP0-1,X
00911  E79B  48                 PHA
00912  E79C  B5 FC              LDA TMP2-1,X
00913  E79E  95 FA              STA TMP0-1,X
00914  E7A0  68                 PLA
00915  E7A1  95 FC              STA TMP2-1,X
00916  E7A3  CA                 DEX
00917  E7A4  D0 F3              BNE T2T21
00918  E7A6  60                 RTS
00919  E7A7              ;READ HEX ADR,RETURN HI IN TMP0,
00920  E7A7              ;LO IN TMPO+1,AND CY=1
00921  E7A7              ;IF SP CY=0
00922  E7A7  20 B6 E7    RDOA   JSR RDOB        ;READ 2-CHAR BYTE
00923  E7AA  90 02              BCC RDOA2       ;SPACE
00924  E7AC  85 FC              STA TMP0+1
00925  E7AE  20 B6 E7    RDOA2  JSR RDOB
00926  E7B1  90 02              BCC RDEXIT      ;SP
00927  E7B3  85 FB              STA TMP0
00928  E7B5  60          RDEXIT RTS
00929  E7B6              ;READ HEX BYTE AND RETURN IN A
00930  E7B6              ;AND CY=1 IF SP CY=0
00931  E7B6  A9 00       RDOB   LDA #0          ;SPACE






UTILITIES......PAGE 0015

LINE# LOC   CODE        LINE


00932  E7B8  8D 00 01           STA BAD         ;READ NEXT CHAR
00933  E7BB  20 EB E7           JSR RDOC
00934  E7BE  C9 20       RDOB1  CMP #' 
00935  E7C0  D0 09              BNE RDOB2
00936  E7C2  20 EB E7           JSR RDOC        ;READ NEXT CHAR
00937  E7C5  C9 20              CMP #' 
00938  E7C7  D0 0F              BNE RDOB3
00939  E7C9  18                 CLC             ;CY=0
00940  E7CA  60                 RTS
00941  E7CB  20 E0 E7    RDOB2  JSR HEXIT       ;TO HEX
00942  E7CE  0A                 ASL A
00943  E7CF  0A                 ASL A
00944  E7D0  0A                 ASL A
00945  E7D1  0A                 ASL A
00946  E7D2  8D 00 01           STA BAD
00947  E7D5  20 EB E7           JSR RDOC        ;2ND CHAR ASSUMED HEX
00948  E7D8  20 E0 E7    RDOB3  JSR HEXIT
00949  E7DB  0D 00 01           ORA BAD
00950  E7DE  38                 SEC             ;CY=1
00951  E7DF  60                 RTS
00952  E7E0  C9 3A       HEXIT  CMP #$3A
00953  E7E2  08                 PHP             ;SAVE FLAGS
00954  E7E3  29 0F              AND #$0F
00955  E7E5  28                 PLP
00956  E7E6  90 02              BCC HEX09       ;0-9
00957  E7E8  69 08              ADC #8          ;ALPHA ADD 8+CY=9
00958  E7EA  60          HEX09  RTS
00959  E7EB  20 CF FF    RDOC   JSR KBASIN       ;READ CHAR
00960  E7EE  C9 0D              CMP #$0D        ;IS IT A CR
00961  E7F0  D0 F8              BNE HEX09       ;NO,RTS
00962  E7F2  68                 PLA
00963  E7F3  68                 PLA             ;YES, CLEAN STACK,EXIT
00964  E7F4              ;       JMP STRT
00965  E7F4  4C 54 FD           JMP LFD54
00966  E7F7  A9 3F       ERROPR LDA #$3F
00967  E7F9  20 D2 FF           JSR KBSOUT
00968  E7FC  4C 56 FD           JMP STRT
00969  E7FF              .FIL   OB1SRC























MESSAGES & IEEE......PAGE 0016

LINE# LOC   CODE        LINE


00971  E7FF                     *=$7000+OFFSET  ;SOFT OFFSET
00972  F000  54 4F       MS1    .BYT 'TOO MANY FILE',$D3
00972  F00D  D3 
00973  F00E  46 49       MS2    .BYT 'FILE OPE',$CE
00973  F016  CE 
00974  F017  46 49       MS3    .BYT 'FILE NOT OPE',$CE
00974  F023  CE 
00975  F024  46 49       MS4    .BYT 'FILE NOT FOUN',$C4
00975  F031  C4 
00976  F032  0D          MS5    .BYT $D,'SEARCH'
00976  F033  53 45 
00977  F039  49 4E 47    MS20   .BYT 'ING',$A0
00977  F03C  A0 
00978  F03D  46 4F 52    MS6    .BYT 'FOR',$A0
00978  F040  A0 
00979  F041  0D          MS7    .BYT $D,'PRESS PLAY',$A0
00979  F042  50 52 
00979  F04C  A0 
00980  F04D  26 20       MS8    .BYT '& RECORD',$A0
00980  F055  A0 
00981  F056  4F 4E       MS9    .BYT 'ON TAPE ',$A3
00981  F05E  A3 
00982  F05F  0D          MS10   .BYT $D
00983  F060  4C 4F 41    MS22   .BYT 'LOA',$C4
00983  F063  C4 
00984  F064  0D          MS11   .BYT $D,'WRITING',$A0
00984  F065  57 52 
00984  F06C  A0 
00985  F06D  0D          MS21   .BYT $D
00986  F06E  56 45       MS12   .BYT 'VERIF',$D9
00986  F073  D9 
00987  F074  44 45       MS13   .BYT 'DEVICE NOT PRESEN',$D4
00987  F085  D4 
00988  F086  4E 4F       MS15   .BYT 'NOT INPUT FIL',$C5
00988  F093  C5 
00989  F094  4E 4F       MS16   .BYT 'NOT OUTPUT FIL',$C5
00989  F0A2  C5 
00990  F0A3  0D          MS17   .BYT $D,'FOUND',$A0
00990  F0A4  46 4F 
00990  F0A9  A0 
00991  F0AA  0D          MS18   .BYT $D,'OK',$8D
00991  F0AB  4F 4B 
00991  F0AD  8D 
00992  F0AE  0D          MS19   .BYT $D,'READY.',$8D
00992  F0AF  52 45 
00992  F0B5  8D 
00993  F0B6  A9 40       TALK   LDA #$40
00994  F0B8  D0 02              BNE LIST1
00995  F0BA  A9 20       LISTN  LDA #' 
00996  F0BC  48          LIST1  PHA
00997  F0BD  AD 40 E8           LDA PIA
00998  F0C0  09 02              ORA #2
00999  F0C2  8D 40 E8           STA PIA
01000  F0C5  A9 3C              LDA #$3C
01001  F0C7  8D 21 E8           STA IEEIS






MESSAGES & IEEE......PAGE 0017

LINE# LOC   CODE        LINE


01002  F0CA  24 A0              BIT C3P0
01003  F0CC  F0 11              BEQ LIST2
01004  F0CE  A9 34              LDA #$34
01005  F0D0  8D 11 E8           STA PIAL1
01006  F0D3  20 EE F0           JSR ISOUR
01007  F0D6  A9 00              LDA #0
01008  F0D8  85 A0              STA C3P0
01009  F0DA  A9 3C              LDA #$3C
01010  F0DC  8D 11 E8           STA PIAL1
01011  F0DF  68          LIST2  PLA
01012  F0E0  05 D4              ORA FA
01013  F0E2  85 A5              STA BSOUR
01014  F0E4  AD 40 E8    LIST4  LDA PIA
01015  F0E7  10 FB              BPL LIST4
01016  F0E9  29 FB              AND #$FB
01017  F0EB  8D 40 E8           STA PIA
01018  F0EE  A9 3C       ISOUR  LDA #$3C
01019  F0F0  8D 23 E8           STA IEEOS
01020  F0F3  AD 40 E8           LDA PIA
01021  F0F6  29 41              AND #$41
01022  F0F8  C9 41              CMP #$41
01023  F0FA  F0 41              BEQ ERRP7
01024  F0FC  A5 A5              LDA BSOUR
01025  F0FE  49 FF              EOR #$FF
01026  F100  8D 22 E8           STA IEEO
01027  F103  2C 40 E8    ISR1   BIT PIA
01028  F106  50 FB              BVC ISR1
01029  F108  A9 34              LDA #$34
01030  F10A  8D 23 E8           STA IEEOS
01031  F10D  A9 FF       ISR0   LDA #$FF
01032  F10F  8D 45 E8           STA TIH
01033  F112  AD 40 E8    ISR2   LDA PIA
01034  F115  2C 4D E8           BIT IFR
01035  F118  70 1C              BVS ERRP0
01036  F11A  4A                 LSR A
01037  F11B  90 F5              BCC ISR2
01038  F11D  A9 3C       ISR3   LDA #$3C
01039  F11F  8D 23 E8           STA IEEOS
01040  F122  A9 FF              LDA #$FF
01041  F124  8D 22 E8           STA IEEO
01042  F127  60                 RTS
01043  F128  85 A5       SECND  STA BSOUR
01044  F12A  20 EE F0           JSR ISOUR
01045  F12D  AD 40 E8    SCATN  LDA PIA
01046  F130  09 04              ORA #4
01047  F132  8D 40 E8           STA PIA
01048  F135  60                 RTS
01049  F136  A9 01       ERRP0  LDA #1
01050  F138  20 7F FB    ERR01  JSR UDST
01051  F13B  D0 E0              BNE ISR3
01052  F13D  A9 80       ERRP7  LDA #$80
01053  F13F  30 F7              BMI ERR01
01054  F141  A9 02       ERRP1  LDA #2
01055  F143  20 7F FB           JSR UDST
01056  F146  AD 40 E8    ER001  LDA PIA






MESSAGES & IEEE......PAGE 0018

LINE# LOC   CODE        LINE


01057  F149  29 FD              AND #$FD
01058  F14B  8D 40 E8           STA PIA
01059  F14E  A9 34              LDA #$34
01060  F150  8D 21 E8           STA IEEIS
01061  F153  A9 0D              LDA #$0D
01062  F155  60                 RTS
01063  F156  B9 00 F0    MSG    LDA MS1,Y
01064  F159  08                 PHP
01065  F15A  29 7F              AND #$7F
01066  F15C  20 D8 E3           JSR PRT
01067  F15F  C8                 INY
01068  F160  28                 PLP
01069  F161  10 F3              BPL MSG
01070  F163  60                 RTS
01071  F164  85 A5       TKSA   STA BSOUR
01072  F166  20 EE F0           JSR ISOUR
01073  F169  20 46 F1    TKATN  JSR ER001
01074  F16C  4C 2D F1           JMP SCATN
01075  F16F  24 A0       CIOUT  BIT C3P0
01076  F171  30 04              BMI CI2
01077  F173  C6 A0              DEC C3P0
01078  F175  D0 05              BNE CI4
01079  F177  48          CI2    PHA
01080  F178  20 EE F0           JSR ISOUR
01081  F17B  68                 PLA
01082  F17C  85 A5       CI4    STA BSOUR
01083  F17E  60                 RTS
01084  F17F  A9 5F       UNTLK  LDA #$5F
01085  F181  D0 02              BNE UNLSN1
01086  F183  A9 3F       UNLSN  LDA #$3F
01087  F185  EA          UNLSN1 NOP
01088  F186  EA                 NOP
01089  F187  20 BC F0           JSR LIST1
01090  F18A  D0 A1              BNE SCATN
01091  F18C  A9 34       ACPTR  LDA #$34
01092  F18E  8D 21 E8           STA IEEIS
01093  F191  AD 40 E8           LDA PIA
01094  F194  09 02              ORA #2
01095  F196  8D 40 E8           STA PIA
01096  F199  A9 FF       ACP00  LDA #$FF
01097  F19B  8D 45 E8           STA TIH
01098  F19E  2C 4D E8    ACP01  BIT IFR
01099  F1A1  70 9E              BVS ERRP1
01100  F1A3  2C 40 E8           BIT PIA
01101  F1A6  30 F6              BMI ACP01
01102  F1A8  AD 40 E8           LDA PIA
01103  F1AB  29 FD              AND #$FD
01104  F1AD  8D 40 E8           STA PIA
01105  F1B0  2C 10 E8           BIT PIAL
01106  F1B3  70 05              BVS ACP03
01107  F1B5  A9 40              LDA #$40
01108  F1B7  20 7F FB           JSR UDST
01109  F1BA  AD 20 E8    ACP03  LDA IEEI
01110  F1BD  49 FF              EOR #$FF
01111  F1BF  48                 PHA






MESSAGES & IEEE......PAGE 0019

LINE# LOC   CODE        LINE


01112  F1C0  A9 3C              LDA #$3C
01113  F1C2  8D 21 E8           STA IEEIS
01114  F1C5  2C 40 E8    ACP05  BIT PIA
01115  F1C8  10 FB              BPL ACP05
01116  F1CA  A9 34              LDA #$34
01117  F1CC  8D 21 E8           STA IEEIS
01118  F1CF  68                 PLA
01119  F1D0  60                 RTS
01120  F1D1  A9 00       GETIN  LDA #0
01121  F1D3  85 96              STA SATUS
01122  F1D5  A5 AF              LDA DFLTN
01123  F1D7  D0 17              BNE BN10
01124  F1D9  A5 9E              LDA NDX
01125  F1DB  F0 51              BEQ BN32
01126  F1DD  78                 SEI
01127  F1DE  4C 85 E2           JMP LP2
01128  F1E1  A5 AF       BASIN  LDA DFLTN
01129  F1E3  D0 0B              BNE BN10 .
01130  F1E5  A5 C6              LDA PNTR
01131  F1E7  85 A4              STA LSTP
01132  F1E9  A5 D8              LDA TBLX
01133  F1EB  85 A3              STA LSXP
01134  F1ED  4C F4 E2           JMP LOOP5
01135  F1F0  C9 03       BN10   CMP #3
01136  F1F2  D0 09              BNE BN20
01137  F1F4  85 AC              STA CRSW
01138  F1F6  A5 D5              LDA LNMX
01139  F1F8  85 A1              STA INDX
01140  F1FA  4C F4 E2           JMP LOOP5
01141  F1FD  B0 29       BN20   BCS BN30
01142  F1FF  86 AD              STX XSAV
01143  F201  20 15 F2           JSR JTGET
01144  F204  48                 PHA
01145  F205  20 15 F2           JSR JTGET
01146  F208  D0 05              BNE JTG35
01147  F20A  A9 40              LDA #64
01148  F20C  20 7F FB           JSR UDST
01149  F20F  D6 BA       JTG35  DEC BUFPT-1,X
01150  F211  A6 AD              LDX XSAV
01151  F213  68                 PLA
01152  F214  60                 RTS
01153  F215  20 06 F8    JTGET  JSR JTP20
01154  F218  D0 0B              BNE JTG10
01155  F21A  20 55 F8           JSR RBLK
01156  F21D  A6 D4              LDX FA
01157  F21F  A9 00              LDA #0
01158  F221  95 BA              STA BUFPT-1,X
01159  F223  F0 F0              BEQ JTGET
01160  F225  B1 D6       JTG10  LDA (TBUF)Y
01161  F227  60                 RTS
01162  F228  A5 96       BN30   LDA SATUS
01163  F22A  F0 03              BEQ BN35
01164  F22C  A9 0D              LDA #$D
01165  F22E  60          BN32   RTS
01166  F22F  4C 8C F1    BN35   JMP ACPTR






MESSAGES & IEEE......PAGE 001A

LINE# LOC   CODE        LINE


01167  F232  48          BSOUT  PHA
01168  F233  A5 B0              LDA DFLTO
01169  F235  C9 03              CMP #3
01170  F237  D0 04              BNE BO10
01171  F239  68                 PLA
01172  F23A  4C D8 E3           JMP PRT
01173  F23D  30 04       BO10   BMI BO20
01174  F23F  68                 PLA
01175  F240  4C 6F F1           JMP CIOUT
01176  F243  68          BO20   PLA
01177  F244  85 B4       BO21   STA T1
01178  F246  C9 0A              CMP #$A
01179  F248  F0 E4              BEQ BN32
01180  F24A  48                 PHA
01181  F24B  8A                 TXA
01182  F24C  48                 PHA
01183  F24D  98                 TYA
01184  F24E  48                 PHA
01185  F24F  20 06 F8           JSR JTP20
01186  F252  D0 10              BNE JTP10
01187  F254  20 86 F8           JSR WBLK
01188  F257  A6 D4              LDX FA
01189  F259  A9 01              LDA #1
01190  F25B  95 BA              STA BUFPT-1,X
01191  F25D  A0 00              LDY #0
01192  F25F  A9 02              LDA #BDF
01193  F261  91 D6              STA (TBUF)Y
01194  F263  C8                 INY
01195  F264  A5 B4       JTP10  LDA T1
01196  F266  91 D6              STA (TBUF)Y
01197  F268  68          RSTOR  PLA
01198  F269  A8                 TAY
01199  F26A  68                 PLA
01200  F26B  AA                 TAX
01201  F26C  68                 PLA
01202  F26D  60                 RTS
01203  F26E  A9 00       CLALL  LDA #0
01204  F270  85 AE              STA LDTND
01205  F272              CLRCHN
01206  F272  A5 B0       CLRCH  LDA DFLTO
01207  F274  C9 04              CMP #4
01208  F276  90 03              BCC JX750
01209  F278  20 83 F1           JSR UNLSN
01210  F27B  A5 AF       JX750  LDA DFLTN
01211  F27D  C9 04              CMP #4
01212  F27F  90 03              BCC JX770
01213  F281  20 7F F1           JSR UNTLK
01214  F284  A9 03       JX770  LDA #3
01215  F286  85 B0              STA DFLTO
01216  F288  A9 00              LDA #0
01217  F28A  85 AF              STA DFLTN
01218  F28C  60                 RTS
01219  F28D  A6 AE       JLTLK  LDX LDTND
01220  F28F  CA          JX600  DEX
01221  F290  30 16              BMI JZ101






MESSAGES & IEEE......PAGE 001B

LINE# LOC   CODE        LINE


01222  F292  DD 51 02           CMP LAT,X
01223  F295  F0 11              BEQ JZ101
01224  F297  D0 F6              BNE JX600
01225  F299  BD 51 02    JZ100  LDA LAT,X
01226  F29C  85 D2              STA LA
01227  F29E  BD 5B 02           LDA FAT,X
01228  F2A1  85 D4              STA FA
01229  F2A3  BD 65 02           LDA SAT,X
01230  F2A6  85 D3              STA SA
01231  F2A8  60          JZ101  RTS
01232  F2A9              .FILE  OB2SRC


















































CLOSE-LOAD-OPEN......PAGE 001C

LINE# LOC   CODE        LINE


01234  F2A9  20 CE F4    CLOSE  JSR PARS2
01235  F2AC  A5 D2              LDA LA
01236  F2AE              CLOS5                  ;DOUBLE LABEL
01237  F2AE  20 8D F2    FCLOSE JSR JLTLK
01238  F2B1  D0 4D              BNE JX170
01239  F2B3  20 99 F2    CLOS10 JSR JZ100
01240  F2B6  8A                 TXA
01241  F2B7  48                 PHA
01242  F2B8  A5 D4              LDA FA
01243  F2BA  F0 28              BEQ JX150
01244  F2BC  C9 03              CMP #3
01245  F2BE  F0 24              BEQ JX150
01246  F2C0  B0 1F              BCS JX120
01247  F2C2  A5 D3              LDA SA          ;READ?
01248  F2C4  29 0F              AND #$F
01249  F2C6  F0 1C              BEQ JX150       ;YES
01250  F2C8  20 56 F6           JSR ZZZ         ;NO    .IT IS WRITE
01251  F2CB  A9 00              LDA #0
01252  F2CD  20 44 F2           JSR BO21
01253  F2D0  20 86 F8           JSR WBLK        ;EMPTY LAST BUFFER
01254  F2D3  A5 D3              LDA SA
01255  F2D5  C9 62              CMP #$62        ;WRITE END OF TAPE BLOCK
01256  F2D7  D0 0B              BNE JX150
01257  F2D9  A9 05              LDA #EOT        ;YES
01258  F2DB  20 DA F5           JSR TAPEH
01259  F2DE  4C E4 F2           JMP JX150
01260  F2E1  20 F0 F6    JX120  JSR CLSE1
01261  F2E4              ;
01262  F2E4              ;ENTRY TO REMOVE A GIVE LOGICAL FILE
01263  F2E4              ;FROM TABLE OF LOGICAL, PRIMARY,
01264  F2E4              ;AND SECONDARY ADDRESSES
01265  F2E4              ;
01266  F2E4  68          JX150  PLA
01267  F2E5  AA                 TAX
01268  F2E6  C6 AE              DEC LDTND
01269  F2E8  E4 AE              CPX LDTND
01270  F2EA  F0 14              BEQ JX170
01271  F2EC  A4 AE              LDY LDTND
01272  F2EE  B9 51 02           LDA LAT,Y
01273  F2F1  9D 51 02           STA LAT,X
01274  F2F4  B9 5B 02           LDA FAT,Y
01275  F2F7  9D 5B 02           STA FAT,X
01276  F2FA  B9 65 02           LDA SAT,Y
01277  F2FD  9D 65 02           STA SAT,X
01278  F300  60          JX170  RTS
01279  F301  A5 9B       STOP1  LDA STKEY
01280  F303  C9 EF              CMP #$EF
01281  F305  D0 07              BNE STOP2
01282  F307  08                 PHP
01283  F308  20 72 F2           JSR CLRCH
01284  F30B  85 9E              STA NDX
01285  F30D  28                 PLP
01286  F30E  60          STOP2  RTS
01287  F30F  20 01 F3    STOP   JSR STOP1
01288  F312  4C 3F C7           JMP BSTOP






CLOSE-LOAD-OPEN......PAGE 001D

LINE# LOC   CODE        LINE


01289  F315  20 1D F3    SPMSG  JSR TXTST
01290  F318  D0 F4              BNE STOP2
01291  F31A  4C 56 F1           JMP MSG
01292  F31D  A5 78       TXTST  LDA TXTPTR+1
01293  F31F  C9 02              CMP #2
01294  F321  60          TXTRT  RTS
01295  F322  A5 D4       LD15   LDA FA ***MONITOR ENTRY
01296  F324  D0 03              BNE *+5
01297  F326  4C 03 CE    LD20   JMP SNERR
01298  F329  C9 03              CMP #3
01299  F32B  F0 F9              BEQ LD20
01300  F32D  90 66              BCC LD100
01301  F32F  A9 60              LDA #$60
01302  F331  85 D3              STA SA
01303  F333  A4 D1              LDY FNLEN
01304  F335  D0 03              BNE *+5
01305  F337  4C 03 CE           JMP SNERR
01306  F33A  20 0A F4           JSR LD300
01307  F33D  20 66 F4           JSR OPENI
01308  F340  20 B6 F0           JSR TALK
01309  F343  A5 D3              LDA SA
01310  F345  20 28 F1           JSR SECND
01311  F348  20 8C F1           JSR ACPTR
01312  F34B  85 FB              STA STAL
01313  F34D  20 8C F1           JSR ACPTR
01314  F350  85 FC              STA STAH
01315  F352  20 2E F4    LD30   JSR LD400

01317  F355  A9 FD       LD40   LDA #$FD        ;MASK OFF TIMEOUT
01318  F357  25 96              AND SATUS
01319  F359  85 96              STA SATUS
01320  F35B  20 0F F3           JSR STOP        ;EXIT ON STOP KEY
01321  F35E  20 8C F1           JSR ACPTR       ;GET BYTE OFF IEEE
01322  F361  AA                 TAX
01323  F362  A5 96              LDA SATUS       ;WAS THERE A TIMEOUT?
01324  F364  4A                 LSR A
01325  F365  4A                 LSR A
01326  F366  B0 ED              BCS LD40        ;YES... RETRY

01328  F368  8A                 TXA
01329  F369  A4 9D              LDY VERCK       ;PERFORMING VERIFY?
01330  F36B  F0 0B              BEQ LD50        ;NO...A LOAD
01331  F36D  88                 DEY             ;.Y IS A 1...MAKE IT 0
01332  F36E  D1 FB              CMP (STAL)Y     ;COMPARE TO MEMORY
01333  F370  F0 08              BEQ LD60        ;VERIFIES O.K.
01334  F372  A2 10              LDX #SPERR      ;NO GOOD... VERIFY ERROR
01335  F374  86 96              STX SATUS
01336  F376  D0 02              BNE LD60
01337  F378  91 FB       LD50   STA (STAL)Y
01338  F37A  E6 FB       LD60   INC STAL        ;INCREMENT POINTER
01339  F37C  D0 02              BNE LD64
01340  F37E  E6 FC              INC STAH
01341  F380  24 96       LD64   BIT SATUS       ;EOI ?
01342  F382  50 D1              BVC LD40        ;NO... CONTINUE LOAD







CLOSE-LOAD-OPEN......PAGE 001E

LINE# LOC   CODE        LINE


01344  F384  EA                 NOP
01345  F385  EA                 NOP
01346  F386  EA                 NOP
01347  F387  A5 FB       LD65   LDA STAL
01348  F389  85 C9              STA EAL
01349  F38B  A5 FC              LDA STAH
01350  F38D  85 CA              STA EAH
01351  F38F  20 7F F1           JSR UNTLK
01352  F392  4C F0 F6           JMP CLSE1
01353  F395  20 56 F6    LD100  JSR ZZZ
01354  F398  20 12 F8           JSR CSTE1
01355  F39B  20 0A F4           JSR LD300
01356  F39E  A5 D1       LD112  LDA FNLEN
01357  F3A0  F0 08              BEQ LD150
01358  F3A2  20 94 F4           JSR FAF
01359  F3A5  D0 08              BNE LD170
01360  F3A7  4C 6E F5    LD120  JMP OP160
01361  F3AA  20 A6 F5    LD150  JSR FAH
01362  F3AD  F0 F8              BEQ LD120
01363  F3AF  E0 01       LD170  CPX #BLF
01364  F3B1  D0 EB              BNE LD112
01365  F3B3  A5 96              LDA SATUS
01366  F3B5  29 10              AND #SPERR
01367  F3B7  D0 74              BNE LD115
01368  F3B9  20 3C F6           JSR LDAD2
01369  F3BC  20 2E F4           JSR LD400
01370  F3BF  4C 5E F8           JMP TRD
01371  F3C2  A9 00       LOAD   LDA #0
01372  F3C4  85 9D              STA VERCK
01373  F3C6  20 3E F4    LD10   JSR PARS1 ***VERIFY ENTRY
01374  F3C9  20 8D F6    LOADNP JSR SV60
01375  F3CC  A9 FF              LDA #$FF
01376  F3CE  C5 9B       LD11   CMP STKEY
01377  F3D0  D0 FC              BNE LD11
01378  F3D2  C5 9B              CMP STKEY
01379  F3D4  D0 F8              BNE LD11
01380  F3D6  20 22 F3           JSR LD15
01381  F3D9  A5 9D              LDA VERCK
01382  F3DB  D0 50              BNE LD115
01383  F3DD  20 E6 F8           JSR TWAIT
01384  F3E0  A5 96              LDA SATUS
01385  F3E2  29 10              AND #SPERR
01386  F3E4  F0 09              BEQ LD210
01387  F3E6  A0 00       LD209  LDY #0
01388  F3E8  84 9E              STY NDX
01389  F3EA  A0 60              LDY #MS22-MS1
01390  F3EC  4C 70 F5           JMP ERMSG
01391  F3EF  A0 AE       LD210  LDY #MS19-MS1
01392  F3F1  20 15 F3           JSR SPMSG
01393  F3F4  20 1D F3           JSR TXTST
01394  F3F7  D0 0B              BNE LD205
01395  F3F9  A5 CA              LDA EAH
01396  F3FB  85 2B              STA VARTAB+1
01397  F3FD  A5 C9              LDA EAL
01398  F3FF  85 2A              STA VARTAB






CLOSE-LOAD-OPEN......PAGE 001F

LINE# LOC   CODE        LINE


01399  F401  4C 39 C4           JMP FINI
01400  F404  20 A7 C5    LD205  JSR STXTPT
01401  F407  4C 90 C5           JMP FLOAD
01402  F40A  20 1D F3    LD300  JSR TXTST
01403  F40D  D0 1E              BNE LD115
01404  F40F  A0 32              LDY #MS5-MS1
01405  F411  20 56 F1           JSR MSG
01406  F414  A5 D1              LDA FNLEN
01407  F416  F0 15              BEQ LD115
01408  F418  A0 3D              LDY #MS6-MS1
01409  F41A  20 56 F1           JSR MSG
01410  F41D  A4 D1       LD105  LDY FNLEN
01411  F41F  F0 0C              BEQ LD115
01412  F421  A0 00              LDY #0
01413  F423  B1 DA       LD110  LDA (FNADR)Y
01414  F425  20 D2 FF           JSR KBSOUT
01415  F428  C8                 INY
01416  F429  C4 D1              CPY FNLEN
01417  F42B  D0 F6              BNE LD110
01418  F42D  60          LD115  RTS
01419  F42E  A0 5F       LD400  LDY #MS10-MS1
01420  F430  A5 9D              LDA VERCK
01421  F432  F0 02              BEQ LD410
01422  F434  A0 6D              LDY #MS21-MS1
01423  F436  20 15 F3    LD410  JSR SPMSG
01424  F439  A0 39              LDY #MS20-MS1
01425  F43B  4C 15 F3           JMP SPMSG
01426  F43E              ;USES BASIC ROUTINES TO PARSE
01427  F43E              ;LOAD,SAVE,VERIFY STATEMENTS
01428  F43E              ;     LOAD
01429  F43E              ;          (FILE NAME OPTION)
01430  F43E              ;          (OPT DEVICE #) DFLT=1
01431  F43E              ;          (EOT CMD) DFLT=0=NO
01432  F43E  A2 00       PARS1  LDX #0
01433  F440  86 96              STX SATUS
01434  F442  86 D1              STX FNLEN
01435  F444  86 D3              STX SA
01436  F446  E8                 INX
01437  F447  86 D4              STX FA
01438  F449  20 0E F5           JSR PR140
01439  F44C  20 FD F4           JSR PR200
01440  F44F  20 0E F5           JSR PR140
01441  F452  20 60 F4           JSR PR070
01442  F455  86 D4              STX FA
01443  F457  20 0E F5           JSR PR140
01444  F45A  20 60 F4           JSR PR070
01445  F45D  86 D3              STX SA
01446  F45F  60          PR060  RTS
01447  F460  20 16 F5    PR070  JSR PR150
01448  F463  4C 78 D6           JMP GETBYT
01449  F466  A5 D3       OPENI  LDA SA
01450  F468  30 F5              BMI PR060
01451  F46A  A4 D1              LDY FNLEN
01452  F46C  F0 F1              BEQ PR060
01453  F46E  20 BA F0           JSR LISTN






CLOSE-LOAD-OPEN......PAGE 0020

LINE# LOC   CODE        LINE


01454  F471  A5 D3              LDA SA
01455  F473  09 F0              ORA #$F0
01456  F475  20 28 F1    OPENIB JSR SECND
01457  F478  A5 96              LDA SATUS
01458  F47A  10 05              BPL OP35
01459  F47C  A0 74       OP37   LDY #MS13-MS1
01460  F47E  4C 70 F5           JMP ERMSG
01461  F481  A5 D1       OP35   LDA FNLEN
01462  F483  F0 0C              BEQ OP45
01463  F485  A0 00              LDY #0
01464  F487  B1 DA       OP40   LDA (FNADR)Y
01465  F489  20 6F F1           JSR CIOUT
01466  F48C  C8                 INY
01467  F48D  C4 D1              CPY FNLEN
01468  F48F  D0 F6              BNE OP40
01469  F491  4C 83 F1    OP45   JMP UNLSN
01470  F494  20 A6 F5    FAF    JSR FAH
01471  F497  F0 1D              BEQ FAF40
01472  F499  A0 05              LDY #5
01473  F49B  84 B5              STY T2
01474  F49D  A0 00              LDY #0
01475  F49F  84 B4              STY T1
01476  F4A1  C4 D1       FAF20  CPY FNLEN
01477  F4A3  F0 10              BEQ FAF30
01478  F4A5  B1 DA              LDA (FNADR)Y
01479  F4A7  A4 B5              LDY T2
01480  F4A9  D1 D6              CMP (TBUF)Y
01481  F4AB  D0 E7              BNE FAF
01482  F4AD  E6 B4              INC T1
01483  F4AF  E6 B5              INC T2
01484  F4B1  A4 B4              LDY T1
01485  F4B3  D0 EC              BNE FAF20
01486  F4B5  98          FAF30  TYA
01487  F4B6  60          FAF40  RTS
01488  F4B7  A9 01       VER    LDA #1
01489  F4B9  85 9D              STA VERCK
01490  F4BB  20 C6 F3           JSR LD10
01491  F4BE  A5 96              LDA SATUS
01492  F4C0  29 10              AND #SPERR
01493  F4C2  F0 05              BEQ VER10
01494  F4C4  A0 6E              LDY #MS12-MS1
01495  F4C6  4C 70 F5           JMP ERMSG
01496  F4C9  A0 AA       VER10  LDY #MS18-MS1
01497  F4CB  4C 56 F1           JMP MSG
01498  F4CE              ;USES BASIC ROUTINES TO PARSE
01499  F4CE              ;OPEN,CLOSE
01500  F4CE              ;     OPEN LFN (NO DEFAULT)
01501  F4CE              ;          DEV # (DFLT=1)
01502  F4CE              ;         2ND ADR (DFLT=0 OR NONE)
01503  F4CE              ;          FILE NM STRNG (DEF=NUL)
01504  F4CE  A2 00       PARS2  LDX #0
01505  F4D0  86 D3              STX SA
01506  F4D2  86 96              STX SATUS
01507  F4D4  86 D1              STX FNLEN
01508  F4D6  E8                 INX






CLOSE-LOAD-OPEN......PAGE 0021

LINE# LOC   CODE        LINE


01509  F4D7  86 D4              STX FA
01510  F4D9  20 19 F5           JSR PR130
01511  F4DC  20 78 D6           JSR GETBYT
01512  F4DF  86 D2              STX LA
01513  F4E1  20 0E F5           JSR PR140
01514  F4E4  20 60 F4           JSR PR070
01515  F4E7  86 D4              STX FA
01516  F4E9  E0 03              CPX #3
01517  F4EB  90 02              BCC PR100
01518  F4ED  C6 D3              DEC SA
01519  F4EF  20 0E F5    PR100  JSR PR140
01520  F4F2  20 60 F4           JSR PR070
01521  F4F5  86 D3              STX SA
01522  F4F7  20 0E F5    PR111  JSR PR140
01523  F4FA  20 16 F5           JSR PR150
01524  F4FD  20 9F CC    PR200  JSR FRMEVL
01525  F500  20 7D D5           JSR FRESTR
01526  F503  85 D1              STA FNLEN
01527  F505  A5 1F              LDA INDEX1
01528  F507  85 DA              STA FNADR
01529  F509  A5 20              LDA INDEX1+1
01530  F50B  85 DB              STA FNADR+1
01531  F50D  60                 RTS
01532  F50E  20 76 00    PR140  JSR CHRGOT
01533  F511  D0 02              BNE PR147
01534  F513  68                 PLA
01535  F514  68                 PLA
01536  F515  60          PR147  RTS
01537  F516  20 F8 CD    PR150  JSR CHKCOM
01538  F519  20 76 00    PR130  JSR CHRGOT
01539  F51C  D0 F7              BNE PR147
01540  F51E  4C 03 CE    PR135  JMP SNERR
01541  F521  20 CE F4    OPEN   JSR PARS2
01542  F524  A5 D2              LDA LA
01543  F526  F0 F6       FOPEN  BEQ PR135
01544  F528  A0 0E       OP98   LDY #MS2-MS1
01545  F52A  20 8D F2           JSR JLTLK
01546  F52D  F0 41              BEQ ERMSG
01547  F52F  A6 AE       OP100  LDX LDTND
01548  F531  A0 00              LDY #0
01549  F533  84 96              STY SATUS
01550  F535  E0 0A              CPX #10
01551  F537  F0 37              BEQ ERMSG
01552  F539  E6 AE              INC LDTND
01553  F53B              ;STORE GPEN FILE PARMS INTO TABLE
01554  F53B  A5 D2              LDA LA
01555  F53D  9D 51 02           STA LAT,X
01556  F540  A5 D3              LDA SA
01557  F542  09 60              ORA #$60
01558  F544  85 D3              STA SA
01559  F546  9D 65 02           STA SAT,X
01560  F549  A5 D4              LDA FA
01561  F54B  9D 5B 02           STA FAT,X
01562  F54E  F0 55              BEQ OP175
01563  F550  C9 03              CMP #3






CLOSE-LOAD-OPEN......PAGE 0022

LINE# LOC   CODE        LINE


01564  F552  F0 51              BEQ OP175
01565  F554  90 03              BCC OP150
01566  F556  4C 66 F4           JMP OPENI
01567  F559  A5 D3       OP150  LDA SA
01568  F55B  29 0F              AND #$F
01569  F55D  D0 2B              BNE OP200
01570  F55F  20 12 F8           JSR CSTE1
01571  F562  20 0A F4           JSR LD300
01572  F565  A5 D1              LDA FNLEN
01573  F567  F0 1A              BEQ OP170
01574  F569  20 94 F4           JSR FAF
01575  F56C  D0 24              BNE OP171
01576  F56E  A0 24       OP160  LDY #MS4-MS1
01577  F570  20 6E F2    ERMSG  JSR CLALL
01578  F573  A9 0D              LDA #$D
01579  F575  20 D2 FF           JSR KBSOUT
01580  F578  A9 3F              LDA #$3F
01581  F57A  20 D2 FF           JSR KBSOUT
01582  F57D  20 56 F1           JSR MSG
01583  F580  4C 77 C3           JMP TYPERR
01584  F583  20 A6 F5    OP170  JSR FAH
01585  F586  F0 E6              BEQ OP160
01586  F588  D0 08              BNE OP171
01587  F58A  20 47 F8    OP200  JSR CSTE2
01588  F58D  A9 04              LDA #BDFH
01589  F58F  20 DA F5           JSR TAPEH
01590  F592  A6 D4       OP171  LDX FA
01591  F594  A9 BF              LDA #BUFSZ-1
01592  F596  A4 D3              LDY SA
01593  F598  C0 60              CPY #$60        ;OPEN FOR READ?
01594  F59A  F0 07              BEQ OP172
01595  F59C  A0 00              LDY #0
01596  F59E  A9 02              LDA #BDF
01597  F5A0  91 D6              STA (TBUF)Y
01598  F5A2  98                 TYA
01599  F5A3  95 BA       OP172  STA BUFPT-1,X
01600  F5A5  60          OP175  RTS
01601  F5A6              .FILE  OB3SRC























SAVE-SYS-TIME......PAGE 0023

LINE# LOC   CODE        LINE


01603  F5A6  A5 9D       FAH    LDA VERCK
01604  F5A8  48                 PHA
01605  F5A9  20 55 F8    FAH30  JSR RBLK
01606  F5AC  A0 00              LDY #0
01607  F5AE  B1 D6              LDA (TBUF)Y
01608  F5B0  C9 05              CMP #EOT
01609  F5B2  F0 21              BEQ FAH40
01610  F5B4  C9 01              CMP #BLF
01611  F5B6  F0 04              BEQ FAH50
01612  F5B8  C9 04              CMP #BDFH
01613  F5BA  D0 ED              BNE FAH30
01614  F5BC  AA          FAH50  TAX
01615  F5BD  20 1D F3           JSR TXTST
01616  F5C0  D0 11              BNE FAH45
01617  F5C2  A0 A3              LDY #MS17-MS1
01618  F5C4  20 56 F1           JSR MSG
01619  F5C7  A0 05              LDY #5
01620  F5C9  B1 D6       FAH55  LDA (TBUF)Y
01621  F5CB  20 D2 FF           JSR $FFD2
01622  F5CE  C8                 INY
01623  F5CF  C0 15              CPY #21
01624  F5D1  D0 F6              BNE FAH55
01625  F5D3  A0 01       FAH45  LDY #1
01626  F5D5  68          FAH40  PLA
01627  F5D6  85 9D              STA VERCK
01628  F5D8  98                 TYA
01629  F5D9  60                 RTS
01630  F5DA  85 B4       TAPEH  STA T1
01631  F5DC  20 56 F6           JSR ZZZ
01632  F5DF  A5 FC              LDA STAH
01633  F5E1  48                 PHA
01634  F5E2  A5 FB              LDA STAL
01635  F5E4  48                 PHA
01636  F5E5  A5 CA              LDA EAH
01637  F5E7  48                 PHA
01638  F5E8  A5 C9              LDA EAL
01639  F5EA  48                 PHA
01640  F5EB  A0 BF              LDY #BUFSZ-1
01641  F5ED  A9 20              LDA #' 
01642  F5EF  91 D6       BLNK2  STA (TBUF)Y
01643  F5F1  88                 DEY
01644  F5F2  D0 FB              BNE BLNK2
01645  F5F4  A5 B4              LDA T1
01646  F5F6  91 D6              STA (TBUF)Y
01647  F5F8  C8                 INY
01648  F5F9  A5 FB              LDA STAL
01649  F5FB  91 D6              STA (TBUF)Y
01650  F5FD  C8                 INY
01651  F5FE  A5 FC              LDA STAH
01652  F600  91 D6              STA (TBUF)Y
01653  F602  C8                 INY
01654  F603  A5 C9              LDA EAL
01655  F605  91 D6              STA (TBUF)Y
01656  F607  C8                 INY
01657  F608  A5 CA              LDA EAH






SAVE-SYS-TIME......PAGE 0024

LINE# LOC   CODE        LINE


01658  F60A  91 D6              STA (TBUF)Y
01659  F60C  C8                 INY
01660  F60D  84 B5              STY T2
01661  F60F  A0 00              LDY #0
01662  F611  84 B4              STY T1
01663  F613  A4 B4       TH20   LDY T1
01664  F615  C4 D1              CPY FNLEN
01665  F617  F0 0C              BEQ TH30
01666  F619  B1 DA              LDA (FNADR)Y
01667  F61B  A4 B5              LDY T2
01668  F61D  91 D6              STA (TBUF)Y
01669  F61F  E6 B4              INC T1
01670  F621  E6 B5              INC T2
01671  F623  D0 EE              BNE TH20
01672  F625  20 6C F6    TH30   JSR LDAD1
01673  F628  A9 69              LDA #$69
01674  F62A  85 C3              STA SHCNH
01675  F62C  20 90 F8           JSR TWRT2
01676  F62F  68                 PLA
01677  F630  85 C9              STA EAL
01678  F632  68                 PLA
01679  F633  85 CA              STA EAH
01680  F635  68                 PLA
01681  F636  85 FB              STA STAL
01682  F638  68                 PLA
01683  F639  85 FC              STA STAH
01684  F63B  60                 RTS
01685  F63C  20 E6 F8    LDAD2  JSR TWAIT
01686  F63F  A2 00              LDX #0
01687  F641  A0 01              LDY #1
01688  F643  B1 D6       LDAD3  LDA (TBUF)Y
01689  F645  95 C7              STA SAL,X
01690  F647  E8                 INX
01691  F648  C8                 INY
01692  F649  E0 04              CPX #4
01693  F64B  D0 F6              BNE LDAD3
01694  F64D  A5 C7              LDA SAL
01695  F64F  85 FB              STA STAL
01696  F651  A5 C8              LDA SAH
01697  F653  85 FC              STA STAH
01698  F655  60                 RTS
01699  F656  A9 7A       ZZZ    LDA #<TAPE1
01700  F658  85 D6              STA TBUF
01701  F65A  A9 02              LDA #>TAPE1
01702  F65C  85 D7              STA TBUF+1
01703  F65E  A5 D4              LDA FA
01704  F660  4A                 LSR A
01705  F661  B0 08              BCS ZZ10
01706  F663  A9 3A              LDA #<TAPE2
01707  F665  85 D6              STA TBUF
01708  F667  A9 03              LDA #>TAPE2
01709  F669  85 D7              STA TBUF+1
01710  F66B  60          ZZ10   RTS
01711  F66C  20 E6 F8    LDAD1  JSR TWAIT
01712  F66F  20 56 F6           JSR ZZZ






SAVE-SYS-TIME......PAGE 0025

LINE# LOC   CODE        LINE


01713  F672  A5 D6              LDA TBUF
01714  F674  85 FB              STA STAL
01715  F676  18                 CLC
01716  F677  69 C0              ADC #BUFSZ
01717  F679  85 C9              STA EAL
01718  F67B  A5 D7              LDA TBUF+1
01719  F67D  85 FC              STA STAH
01720  F67F  69 00              ADC #0
01721  F681  85 CA              STA EAH
01722  F683  60                 RTS
01723  F684  20 8B CC    SYS    JSR FRMNUM
01724  F687  20 D2 D6           JSR GETADR
01725  F68A  6C 11 00           JMP (LINNUM)
01726  F68D  A5 2A       SV60   LDA VARTAB
01727  F68F  85 C9              STA EAL
01728  F691  A5 2B              LDA VARTAB+1
01729  F693  85 CA              STA EAH
01730  F695  A5 29              LDA TXTTAB+1
01731  F697  85 FC              STA STAH
01732  F699  A5 28              LDA TXTTAB
01733  F69B  85 FB              STA STAL
01734  F69D  60                 RTS
01735  F69E  20 3E F4    SAVE   JSR PARS1
01736  F6A1  20 8D F6    SV3    JSR SV60
01737  F6A4  A5 D4       SV5    LDA FA ***MONITOR ENTRY
01738  F6A6  D0 05              BNE SV20
01739  F6A8  A0 74       SV10   LDY #MS13-MS1
01740  F6AA  4C 70 F5           JMP ERMSG
01741  F6AD  C9 03       SV20   CMP #3
01742  F6AF  F0 F7              BEQ SV10
01743  F6B1  90 50              BCC SV100
01744  F6B3  A9 61              LDA #$61
01745  F6B5  85 D3              STA SA
01746  F6B7  A4 D1              LDY FNLEN
01747  F6B9  D0 03              BNE *+5
01748  F6BB  4C 03 CE           JMP SNERR
01749  F6BE  20 66 F4           JSR OPENI
01750  F6C1  20 BA F0           JSR LISTN
01751  F6C4  A5 D3              LDA SA
01752  F6C6  20 28 F1           JSR SECND
01753  F6C9  A0 00              LDY #0
01754  F6CB  20 76 FB           JSR RD300
01755  F6CE  A5 C7              LDA SAL
01756  F6D0  20 6F F1           JSR CIOUT
01757  F6D3  A5 C8              LDA SAH
01758  F6D5  20 6F F1           JSR CIOUT
01759  F6D8  20 C6 FC    SV30   JSR WRT62
01760  F6DB  F0 10              BEQ SV50
01761  F6DD  B1 C7              LDA (SAL)Y
01762  F6DF  20 6F F1           JSR CIOUT
01763  F6E2  20 0F F3           JSR STOP
01764  F6E5  E6 C7              INC SAL
01765  F6E7  D0 EF              BNE SV30
01766  F6E9  E6 C8              INC SAH
01767  F6EB  D0 EB              BNE SV30






SAVE-SYS-TIME......PAGE 0026

LINE# LOC   CODE        LINE


01768  F6ED  20 83 F1    SV50   JSR UNLSN
01769  F6F0  24 D3       CLSE1  BIT SA
01770  F6F2  30 78              BMI UD65
01771  F6F4  20 BA F0           JSR LISTN
01772  F6F7  A5 D3              LDA SA
01773  F6F9  29 EF              AND #$EF
01774  F6FB  09 E0              ORA #$E0
01775  F6FD  20 28 F1           JSR SECND
01776  F700  4C 83 F1           JMP UNLSN
01777  F703  20 56 F6    SV100  JSR ZZZ
01778  F706  20 47 F8           JSR CSTE2
01779  F709  20 1D F3           JSR TXTST
01780  F70C  D0 08              BNE SV105
01781  F70E  A0 64              LDY #MS11-MS1
01782  F710  20 56 F1           JSR MSG
01783  F713  20 1D F4           JSR LD105
01784  F716  A9 01       SV105  LDA #BLF
01785  F718  20 DA F5           JSR TAPEH
01786  F71B  20 89 F8           JSR TWRT
01787  F71E  A5 D3              LDA SA
01788  F720  29 02              AND #2
01789  F722  F0 48              BEQ UD65
01790  F724  A9 05              LDA #EOT
01791  F726  4C DA F5           JMP TAPEH
01792  F729  E6 99       UDTIM  INC CRFAC
01793  F72B  A5 99              LDA CRFAC
01794  F72D  D0 02              BNE UD10
01795  F72F  E6 9A              INC CRFAC+1
01796  F731  C9 6F       UD10   CMP #$6F
01797  F733  D0 06              BNE UD20
01798  F735  A5 9A              LDA CRFAC+1
01799  F737  C9 02              CMP #2
01800  F739  F0 21              BEQ UD50
01801  F73B  E6 8F       UD20   INC TIME+2
01802  F73D  D0 06              BNE UD30
01803  F73F  E6 8E              INC TIME+1
01804  F741  D0 02              BNE UD30
01805  F743  E6 8D              INC TIME
01806  F745  A2 00       UD30   LDX #0
01807  F747  B5 8D       UD40   LDA TIME,X
01808  F749  DD 6D F7           CMP UD70,X
01809  F74C  90 14              BCC UD60
01810  F74E  E8                 INX
01811  F74F  E0 03              CPX #3
01812  F751  D0 F4              BNE UD40
01813  F753  A9 00              LDA #0
01814  F755  95 8C       UD45   STA TIME-1,X
01815  F757  CA                 DEX
01816  F758  D0 FB              BNE UD45
01817  F75A  F0 06              BEQ UD60
01818  F75C  A9 00       UD50   LDA #0
01819  F75E  85 99              STA CRFAC
01820  F760  85 9A              STA CRFAC+1
01821  F762  AD 12 E8    UD60   LDA PIAK
01822  F765  CD 12 E8           CMP PIAK






SAVE-SYS-TIME......PAGE 0027

LINE# LOC   CODE        LINE


01823  F768  D0 F8              BNE UD60
01824  F76A  85 9B              STA STKEY
01825  F76C  60          UD65   RTS
01826  F76D  4F          UD70   .BYT $4F,$1A,1
01826  F76E  1A 
01826  F76F  01 
01827  F770              .FILE  OB4SRC






















































O/C CHAN,R/W TAPE......PAGE 0028

LINE# LOC   CODE        LINE


01829  F770  48          CHKIN  PHA
01830  F771  8A                 TXA
01831  F772  48                 PHA
01832  F773  98                 TYA
01833  F774  48                 PHA
01834  F775  A9 00              LDA #0
01835  F777  85 96              STA SATUS
01836  F779  8A                 TXA
01837  F77A  20 8D F2           JSR JLTLK
01838  F77D  F0 05              BEQ JX310
01839  F77F  A0 17       JX300  LDY #MS3-MS1
01840  F781  4C 70 F5    JX305  JMP ERMSG
01841  F784  20 99 F2    JX310  JSR JZ100
01842  F787  A5 D4              LDA FA
01843  F789  F0 10              BEQ JX320
01844  F78B  C9 03              CMP #3
01845  F78D  F0 0C              BEQ JX320
01846  F78F  B0 0F              BCS JX330
01847  F791  A6 D3              LDX SA
01848  F793  E0 60              CPX #$60
01849  F795  F0 04              BEQ JX320
01850  F797  A0 86              LDY #MS15-MS1
01851  F799  D0 E6              BNE JX305
01852  F79B  85 AF       JX320  STA DFLTN
01853  F79D  4C 68 F2           JMP RSTOR
01854  F7A0  48          JX330  PHA
01855  F7A1  20 B6 F0    JX3301 JSR TALK
01856  F7A4  A5 D3              LDA SA
01857  F7A6  10 06              BPL JX340
01858  F7A8  20 69 F1           JSR TKATN
01859  F7AB  4C B1 F7           JMP JX350
01860  F7AE  20 64 F1    JX340  JSR TKSA
01861  F7B1  A5 96       JX350  LDA SATUS
01862  F7B3  10 03              BPL *+5
01863  F7B5  4C 7C F4           JMP OP37
01864  F7B8  68                 PLA
01865  F7B9  4C 9B F7           JMP JX320
01866  F7BC              CHKOUT
01867  F7BC  48          CKOUT  PHA
01868  F7BD  8A                 TXA
01869  F7BE  48                 PHA
01870  F7BF  98                 TYA
01871  F7C0  48                 PHA
01872  F7C1  A9 00              LDA #0
01873  F7C3  85 96              STA SATUS
01874  F7C5  8A                 TXA
01875  F7C6  20 8D F2           JSR JLTLK
01876  F7C9  D0 B4              BNE JX300
01877  F7CB  20 99 F2           JSR JZ100
01878  F7CE  A5 D4              LDA FA
01879  F7D0  D0 04              BNE CK10
01880  F7D2  A0 94              LDY #MS16-MS1
01881  F7D4  D0 AB              BNE JX305
01882  F7D6  C9 03       CK10   CMP #3
01883  F7D8  F0 0C              BEQ JX360






O/C CHAN,R/W TAPE......PAGE 0029

LINE# LOC   CODE        LINE


01884  F7DA  10 0F              BPL JX370
01885  F7DC  A6 D3              LDX SA
01886  F7DE  E0 60              CPX #$60
01887  F7E0  D0 04              BNE JX360
01888  F7E2  A0 94              LDY #MS16-MS1
01889  F7E4  D0 9B              BNE JX305
01890  F7E6  85 B0       JX360  STA DFLTO
01891  F7E8  4C 68 F2           JMP RSTOR
01892  F7EB  48          JX370  PHA
01893  F7EC  20 BA F0           JSR LISTN
01894  F7EF  A5 D3              LDA SA
01895  F7F1  10 05              BPL JX380
01896  F7F3  20 2D F1           JSR SCATN
01897  F7F6  D0 03              BNE JX390
01898  F7F8  20 28 F1    JX380  JSR SECND
01899  F7FB  A5 96       JX390  LDA SATUS
01900  F7FD  10 03              BPL *+5
01901  F7FF  4C 7C F4           JMP OP37
01902  F802  68                 PLA
01903  F803  4C E6 F7           JMP JX360
01904  F806  20 56 F6    JTP20  JSR ZZZ
01905  F809  A6 D4              LDX FA
01906  F80B  F6 BA              INC BUFPT-1,X
01907  F80D  B4 BA              LDY BUFPT-1,X
01908  F80F  C0 C0              CPY #BUFSZ
01909  F811  60                 RTS
01910  F812              ;STAYS IN ROUTINE TILL PLAY SWITCH
01911  F812  20 35 F8    CSTE1  JSR CS10
01912  F815  F0 2F              BEQ CS25
01913  F817  A0 41              LDY #MS7-MS1    ;"PRESS PLAY"
01914  F819  20 56 F1    CS30   JSR MSG
01915  F81C  A0 56              LDY #MS9-MS1    ;"ON CASSETTE #"
01916  F81E  20 56 F1           JSR MSG
01917  F821  A5 D4              LDA FA
01918  F823  09 30              ORA #'0
01919  F825  20 D8 E3           JSR PRT         ;PRINT CASSETTE #
01920  F828  20 F0 F8    CS40   JSR TSTOP       ;WATCH FOR STOP KEY
01921  F82B  20 35 F8           JSR CS10        ;WATCH CASSETTE SWITCHES
01922  F82E  D0 F8              BNE CS40
01923  F830  A0 AA              LDY #MS18-MS1   ;"OK"
01924  F832  4C 56 F1           JMP MSG
01925  F835              ;SUBR RETURNS <> FOR CASSETTE SWITCH
01926  F835  A9 10       CS10   LDA #$10        ;ASSUME CASSETTE #1
01927  F837  A6 D4              LDX FA
01928  F839  CA                 DEX             ;REALLY CASSETTE 1
01929  F83A  F0 02              BEQ CS20        ;YES.   .
01930  F83C  A9 20              LDA #$20        ;NO. . .CASSETTE #2
01931  F83E  2C 10 E8    CS20   BIT PIAL        ;CLOSED
01932  F841  D0 03              BNE CS25        ;NO. . .
01933  F843  2C 10 E8           BIT PIAL        ;CHECK AGAIN TO DEBOUNCE
01934  F846  60          CS25   RTS
01935  F847              ;CHECKS FOR PLAY & RECORD
01936  F847  20 35 F8    CSTE2  JSR CS10
01937  F84A  F0 FA              BEQ CS25
01938  F84C  A0 41              LDY #MS7-MS1    ;"PRESS PLAY AND"






O/C CHAN,R/W TAPE......PAGE 002A

LINE# LOC   CODE        LINE


01939  F84E  20 56 F1           JSR MSG
01940  F851  A0 4D              LDY #MS8-MS1    ;"RECORD"
01941  F853  D0 C4              BNE CS30
01942  F855  A9 00       RBLK   LDA #0
01943  F857  85 96              STA SATUS
01944  F859  85 9D              STA VERCK
01945  F85B  20 6C F6           JSR LDAD1
01946  F85E  20 E6 F8    TRD    JSR TWAIT
01947  F861  20 12 F8           JSR CSTE1
01948  F864  78                 SEI
01949  F865  A9 00              LDA #0
01950  F867  85 C2              STA RDFLG
01951  F869  85 CE              STA SNSW1
01952  F86B  85 CB              STA CMP0
01953  F86D  85 C0              STA PTR1
01954  F86F  85 C1              STA PTR2
01955  F871  85 B2              STA DPSW
01956  F873  A6 D4              LDX FA
01957  F875  CA                 DEX
01958  F876  F0 07              BEQ TRD2
01959  F878  A9 90              LDA #$90
01960  F87A  8D 4E E8           STA IER
01961  F87D  D0 03              BNE TRD3
01962  F87F  EE 11 E8    TRD2   INC PIAL1
01963  F882  A2 0E       TRD3   LDX #14
01964  F884  D0 15              BNE TAPE
01965  F886  20 6C F6    WBLK   JSR LDAD1
01966  F889  20 E6 F8    TWRT   JSR TWAIT
01967  F88C  A9 14              LDA #20
01968  F88E  85 C3              STA SHCNH
01969  F890  20 47 F8    TWRT2  JSR CSTE2
01970  F893  78                 SEI
01971  F894  A9 A0              LDA #$A0
01972  F896  8D 4E E8           STA IER
01973  F899  A2 08              LDX #8
01974  F89B  20 9B FC    TAPE   JSR BSIV
01975  F89E  A9 02              LDA #2
01976  F8A0  85 DE              STA FSBLK
01977  F8A2  20 84 FB           JSR NEWCH
01978  F8A5  CE 13 E8           DEC PIAS
01979  F8A8  A6 D4              LDX FA
01980  F8AA  CA                 DEX
01981  F8AB  D0 09              BNE TP20
01982  F8AD  A9 34              LDA #$34
01983  F8AF  8D 13 E8           STA PIAS
01984  F8B2  85 F9              STA CAS1
01985  F8B4  D0 0A              BNE TP30
01986  F8B6  AD 40 E8    TP20   LDA PIA
01987  F8B9  86 FA              STX CAS2
01988  F8BB  29 EF              AND #$EF
01989  F8BD  8D 40 E8           STA PIA
01990  F8C0  A2 FF       TP30   LDX #$FF
01991  F8C2  A0 FF       TP32   LDY #$FF
01992  F8C4  88          TP35   DEY
01993  F8C5  D0 FD              BNE TP35






O/C CHAN,R/W TAPE......PAGE 002B

LINE# LOC   CODE        LINE


01994  F8C7  CA                 DEX
01995  F8C8  D0 F8              BNE TP32
01996  F8CA  8D 49 E8           STA T2H
01997  F8CD  58                 CLI
01998  F8CE  A9 E6       TP40   LDA #>KEY
01999  F8D0  C5 91              CMP CINV+1
02000  F8D2  F0 11              BEQ TP50
02001  F8D4  20 F0 F8           JSR TSTOP
02002  F8D7  2C 13 E8           BIT PIAS
02003  F8DA  10 F2              BPL TP40
02004  F8DC  2C 12 E8           BIT PIAK
02005  F8DF  20 29 F7           JSR UDTIM
02006  F8E2  4C CE F8           JMP TP40
02007  F8E5  60          TP50   RTS
02008  F8E6  20 F0 F8    TWAIT  JSR TSTOP
02009  F8E9  A9 E6              LDA #>KEY
02010  F8EB  C5 91              CMP CINV+1
02011  F8ED  D0 F7              BNE TWAIT
02012  F8EF  60                 RTS
02013  F8F0  20 01 F3    TSTOP  JSR STOP1
02014  F8F3  D0 08              BNE STOP3
02015  F8F5  20 7B FC           JSR TNIF
02016  F8F8  20 84 F2           JSR JX770
02017  F8FB  85 0E              STA CHANL
02018  F8FD  4C 3F C7    STOP3  JMP BSTOP
02019  F900  86 CC       STT1   STX TEMP
02020  F902  A5 CB              LDA CMP0
02021  F904  0A                 ASL A
02022  F905  0A                 ASL A
02023  F906  18                 CLC
02024  F907  65 CB              ADC CMP0
02025  F909  18                 CLC
02026  F90A  65 CC              ADC TEMP
02027  F90C  85 CC              STA TEMP
02028  F90E  A9 00              LDA #0
02029  F910  24 CB              BIT CMP0
02030  F912  30 01              BMI STT2
02031  F914  2A                 ROL A
02032  F915  06 CC       STT2   ASL TEMP
02033  F917  2A                 ROL A
02034  F918  06 CC              ASL TEMP
02035  F91A  2A                 ROL A
02036  F91B  AA                 TAX
02037  F91C  AD 48 E8    STT3   LDA T2L
02038  F91F  C9 15              CMP #21
02039  F921  90 F9              BCC STT3
02040  F923  65 CC              ADC TEMP
02041  F925  8D 44 E8           STA TIL
02042  F928  8A                 TXA
02043  F929  6D 49 E8           ADC T2H
02044  F92C  8D 45 E8           STA TIH
02045  F92F  58                 CLI
02046  F930  60                 RTS
02047  F931              .FILE  OB5SRC







CASSETTE READ......PAGE 002C

LINE# LOC   CODE        LINE


02049  F931  AE 49 E8    READ   LDX T2H
02050  F934  A0 FF              LDY #$FF
02051  F936  98                 TYA
02052  F937  ED 48 E8           SBC T2L
02053  F93A  EC 49 E8           CPX T2H
02054  F93D  D0 F2              BNE READ
02055  F93F  86 CC       RD1    STX TEMP
02056  F941  AA                 TAX
02057  F942  8C 48 E8           STY T2L
02058  F945  8C 49 E8           STY T2H
02059  F948  98                 TYA
02060  F949  E5 CC              SBC TEMP
02061  F94B  86 CC              STX TEMP
02062  F94D  4A                 LSR A
02063  F94E  66 CC              ROR TEMP
02064  F950  4A                 LSR A
02065  F951  66 CC       RADS   ROR TEMP
02066  F953  A5 CB       RD3    LDA CMP0
02067  F955  18                 CLC
02068  F956  69 3C              ADC #60
02069  F958  2C 40 E8           BIT PIA
02070  F95B  2C 10 E8           BIT PIAL
02071  F95E  C5 CC              CMP TEMP
02072  F960  B0 4A              BCS RDBK
02073  F962  A6 B2              LDX DPSW
02074  F964  F0 03              BEQ RJDJ
02075  F966  4C 57 FA    JRADJ  JMP RADJ
02076  F969  A6 B7       RJDJ   LDX PCNTR
02077  F96B  30 1B              BMI JRAD2
02078  F96D  A2 00              LDX #0
02079  F96F  69 30              ADC #48
02080  F971  65 CB              ADC CMP0
02081  F973  C5 CC              CMP TEMP
02082  F975  B0 1C              BCS RADX2
02083  F977  E8                 INX
02084  F978  69 26              ADC #38
02085  F97A  65 CB              ADC CMP0
02086  F97C  C5 CC              CMP TEMP
02087  F97E  B0 17              BCS RADL
02088  F980  69 2C              ADC #44
02089  F982  65 CB              ADC CMP0
02090  F984  C5 CC              CMP TEMP
02091  F986  90 03              BCC SRER
02092  F988  4C 07 FA    JRAD2  JMP RAD2
02093  F98B  A5 CE       SRER   LDA SNSW1
02094  F98D  F0 1D              BEQ RDBK
02095  F98F  85 BE              STA RER
02096  F991  D0 19              BNE RDBK
02097  F993  E6 BF       RADX2  INC REZ
02098  F995  B0 02              BCS RAD5
02099  F997  C6 BF       RADL   DEC REZ
02100  F999  38          RAD5   SEC
02101  F99A  E9 13              SBC #19
02102  F99C  E5 CC              SBC TEMP
02103  F99E  65 9C              ADC SVXT






CASSETTE READ......PAGE 002D

LINE# LOC   CODE        LINE


02104  F9A0  85 9C              STA SVXT
02105  F9A2  A5 B9              LDA FIRT
02106  F9A4  49 01              EOR #1
02107  F9A6  85 B9              STA FIRT
02108  F9A8  F0 21              BEQ RAD3
02109  F9AA  86 D9              STX DATA
02110  F9AC  A5 CE       RDBK   LDA SNSW1
02111  F9AE  F0 18              BEQ RADBK
02112  F9B0  2C 4D E8           BIT IFR
02113  F9B3  50 13              BVC RADBK
02114  F9B5  A9 00              LDA #0
02115  F9B7  85 B9              STA FIRT
02116  F9B9  A5 B7              LDA PCNTR
02117  F9BB  10 31              BPL RAD4
02118  F9BD  30 C9              BMI JRAD2
02119  F9BF  A2 A6       RADP   LDX #166
02120  F9C1  20 00 F9           JSR STT1
02121  F9C4  A5 B1              LDA PRTY
02122  F9C6  D0 C3              BNE SRER
02123  F9C8  4C E4 E6    RADBK  JMP PREND
02124  F9CB  A5 9C       RAD3   LDA SVXT
02125  F9CD  F0 08              BEQ ROUT1
02126  F9CF  30 04              BMI ROUT2
02127  F9D1  C6 CB              DEC CMP0
02128  F9D3  C6 CB              DEC CMP0
02129  F9D5  E6 CB       ROUT2  INC CMP0
02130  F9D7  A9 00       ROUT1  LDA #0
02131  F9D9  85 9C              STA SVXT
02132  F9DB  E4 D9              CPX DATA
02133  F9DD  D0 0F              BNE RAD4
02134  F9DF  8A                 TXA
02135  F9E0  D0 A9              BNE SRER
02136  F9E2  A5 BF              LDA REZ
02137  F9E4  30 C6              BMI RDBK
02138  F9E6  C9 10              CMP #16
02139  F9E8  90 C2              BCC RDBK
02140  F9EA  85 AB       RAD3G  STA SYNO
02141  F9EC  B0 BE              BCS RDBK
02142  F9EE  8A          RAD4   TXA
02143  F9EF  45 B1              EOR PRTY
02144  F9F1  85 B1              STA PRTY
02145  F9F3  A5 CE              LDA SNSW1
02146  F9F5  F0 D1              BEQ RADBK
02147  F9F7  C6 B7              DEC PCNTR
02148  F9F9  30 C4              BMI RADP
02149  F9FB  46 D9              LSR DATA
02150  F9FD  66 DF              ROR MYCH
02151  F9FF  A2 DA              LDX #218
02152  FA01  20 00 F9           JSR STT1
02153  FA04  4C E4 E6           JMP PREND
02154  FA07  A5 AB       RAD2   LDA SYNO
02155  FA09  F0 04              BEQ RAD2Y
02156  FA0B  A5 CE              LDA SNSW1
02157  FA0D  F0 07              BEQ RAD2X
02158  FA0F  A5 B7       RAD2Y  LDA PCNTR






CASSETTE READ......PAGE 002E

LINE# LOC   CODE        LINE


02159  FA11  30 03              BMI RAD2X
02160  FA13  4C 97 F9           JMP RADL
02161  FA16  46 CC       RAD2X  LSR TEMP
02162  FA18  A9 93              LDA #147
02163  FA1A  38                 SEC
02164  FA1B  E5 CC              SBC TEMP
02165  FA1D  65 CB              ADC CMP0
02166  FA1F  0A                 ASL A
02167  FA20  AA                 TAX
02168  FA21  20 00 F9           JSR STT1
02169  FA24  E6 B2              INC DPSW
02170  FA26  A5 CE       RADQ   LDA SNSW1
02171  FA28  D0 11              BNE RADQ2
02172  FA2A  A5 AB       RADQ1  LDA SYNO
02173  FA2C  F0 26              BEQ RDBK2
02174  FA2E  85 BE              STA RER
02175  FA30  A9 00              LDA #0
02176  FA32  85 AB              STA SYNO
02177  FA34  A9 C0              LDA #$C0
02178  FA36  8D 4E E8           STA IER
02179  FA39  85 CE              STA SNSW1
02180  FA3B  A5 AB       RADQ2  LDA SYNO
02181  FA3D  85 CF              STA DIFF
02182  FA3F  F0 09              BEQ RADK
02183  FA41  A9 00              LDA #0
02184  FA43  85 CE              STA SNSW1
02185  FA45  A9 40              LDA #$40
02186  FA47  8D 4E E8           STA IER
02187  FA4A  A5 DF       RADK   LDA MYCH
02188  FA4C  85 DD              STA OCHAR
02189  FA4E  A5 BE              LDA RER
02190  FA50  05 BF       RADR1  ORA REZ
02191  FA52  85 D0              STA PRP
02192  FA54  4C E4 E6    RDBK2  JMP PREND
02193  FA57  20 84 FB    RADJ   JSR NEWCH
02194  FA5A  85 B2              STA DPSW
02195  FA5C  A2 DA              LDX #218
02196  FA5E  20 00 F9           JSR STT1
02197  FA61  A5 DE              LDA FSBLK
02198  FA63  F0 02              BEQ RD15
02199  FA65  85 BD              STA SHCNL
02200  FA67              SPERR=16
02201  FA67              CKERR=32
02202  FA67              SBERR=4
02203  FA67              LBERR=8
02204  FA67  A9 0F       RD15   LDA #$F
02205  FA69  24 C2              BIT RDFLG
02206  FA6B  10 17              BPL RD20
02207  FA6D  A5 CF              LDA DIFF
02208  FA6F  D0 0C              BNE RD12
02209  FA71  A6 DE              LDX FSBLK
02210  FA73  CA                 DEX
02211  FA74  D0 0B              BNE RD10
02212  FA76              ;LONG BLOCK ERROR
02213  FA76  A9 08              LDA #LBERR






CASSETTE READ......PAGE 002F

LINE# LOC   CODE        LINE


02214  FA78  20 7F FB           JSR UDST
02215  FA7B  D0 04              BNE RD10
02216  FA7D  A9 00       RD12   LDA #0
02217  FA7F  85 C2              STA RDFLG
02218  FA81  4C E4 E6    RD10   JMP PREND
02219  FA84  70 31       RD20   BVS RD60
02220  FA86  D0 18              BNE RD200
02221  FA88  A5 CF              LDA DIFF
02222  FA8A  D0 F5              BNE RD10
02223  FA8C  A5 D0              LDA PRP
02224  FA8E  D0 F1              BNE RD10
02225  FA90  A5 BD              LDA SHCNL
02226  FA92  4A                 LSR A
02227  FA93  A5 DD              LDA OCHAR
02228  FA95  30 03              BMI RD22
02229  FA97  90 18              BCC RD40
02230  FA99  18                 CLC
02231  FA9A  B0 15       RD22   BCS RD40
02232  FA9C  29 0F              AND #$F
02233  FA9E  85 C2              STA RDFLG
02234  FAA0  C6 C2       RD200  DEC RDFLG
02235  FAA2  D0 DD              BNE RD10
02236  FAA4  A9 40              LDA #$40
02237  FAA6  85 C2              STA RDFLG
02238  FAA8  20 76 FB           JSR RD300
02239  FAAB  A9 00              LDA #0
02240  FAAD  85 C3              STA SHCNH
02241  FAAF  F0 D0              BEQ RD10
02242  FAB1  A9 80       RD40   LDA #$80
02243  FAB3  85 C2              STA RDFLG
02244  FAB5  D0 CA              BNE RD10
02245  FAB7  A5 CF       RD60   LDA DIFF
02246  FAB9  F0 0A              BEQ RD70
02247  FABB  A9 04              LDA #SBERR
02248  FABD              ; SHORT BLOCK ERROR
02249  FABD  20 7F FB           JSR UDST
02250  FAC0  A9 00              LDA #0
02251  FAC2  4C 46 FB           JMP RD161
02252  FAC5  20 C6 FC    RD70   JSR WRT62
02253  FAC8  D0 03              BNE *+5
02254  FACA  4C 44 FB           JMP RD160
02255  FACD  A6 BD              LDX SHCNL
02256  FACF  CA                 DEX
02257  FAD0  F0 2D              BEQ RD58
02258  FAD2  A5 9D              LDA VERCK
02259  FAD4  F0 0C              BEQ RD80
02260  FAD6  A0 00              LDY #0
02261  FAD8  A5 DD              LDA OCHAR
02262  FADA  D1 C7              CMP (SAL)Y
02263  FADC  F0 04              BEQ RD80
02264  FADE  A9 01              LDA #1
02265  FAE0  85 D0              STA PRP
02266  FAE2  A5 D0       RD80   LDA PRP
02267  FAE4  F0 4C              BEQ RD59
02268  FAE6  A2 3D              LDX #61






CASSETTE READ......PAGE 0030

LINE# LOC   CODE        LINE


02269  FAE8  E4 C0              CPX PTR1
02270  FAEA  90 3F              BCC RD55
02271  FAEC  A6 C0       RD56   LDX PTR1
02272  FAEE  A5 C8              LDA SAH
02273  FAF0  9D 01 01           STA BAD+1,X
02274  FAF3  A5 C7              LDA SAL
02275  FAF5  9D 00 01           STA BAD,X
02276  FAF8  E8                 INX
02277  FAF9  E8                 INX
02278  FAFA  86 C0              STX PTR1
02279  FAFC  4C 32 FB           JMP RD59
02280  FAFF  A6 C1       RD58   LDX PTR2
02281  FB01  E4 C0              CPX PTR1
02282  FB03  F0 37              BEQ RD90
02283  FB05  A5 C7              LDA SAL
02284  FB07  DD 00 01           CMP BAD,X
02285  FB0A  D0 30              BNE RD90
02286  FB0C  A5 C8              LDA SAH
02287  FB0E  DD 01 01           CMP BAD+1,X
02288  FB11  D0 29              BNE RD90
02289  FB13  E6 C1              INC PTR2
02290  FB15  E6 C1              INC PTR2
02291  FB17  A5 9D              LDA VERCK
02292  FB19  F0 0C              BEQ RD52
02293  FB1B  A5 DD              LDA OCHAR
02294  FB1D  A0 00              LDY #0
02295  FB1F  D1 C7              CMP (SAL)Y
02296  FB21  F0 19              BEQ RD90
02297  FB23  A9 01              LDA #1
02298  FB25  85 D0              STA PRP
02299  FB27  A5 D0       RD52   LDA PRP
02300  FB29  F0 07              BEQ RD59
02301  FB2B              ;SECOND PASS ERR
02302  FB2B  A9 10       RD55   LDA #SPERR
02303  FB2D  20 7F FB           JSR UDST
02304  FB30  D0 0A              BNE RD90
02305  FB32  A5 9D       RD59   LDA VERCK
02306  FB34  D0 06              BNE RD90
02307  FB36  A5 DD              LDA OCHAR
02308  FB38  A0 00              LDY #0
02309  FB3A  91 C7              STA (SAL)Y
02310  FB3C  E6 C7       RD90   INC SAL
02311  FB3E  D0 33              BNE RD180
02312  FB40  E6 C8              INC SAH
02313  FB42  D0 2F              BNE RD180
02314  FB44  A9 80       RD160  LDA #$80
02315  FB46  85 C2       RD161  STA RDFLG
02316  FB48  A6 DE              LDX FSBLK
02317  FB4A  CA                 DEX
02318  FB4B  30 02              BMI RD167
02319  FB4D  86 DE              STX FSBLK
02320  FB4F  C6 BD       RD167  DEC SHCNL
02321  FB51  F0 08              BEQ RD175
02322  FB53  A5 C0              LDA PTR1
02323  FB55  D0 1C              BNE RD180






CASSETTE READ......PAGE 0031

LINE# LOC   CODE        LINE


02324  FB57  85 DE              STA FSBLK
02325  FB59  F0 18              BEQ RD180
02326  FB5B  20 7B FC    RD175  JSR TNIF
02327  FB5E  20 76 FB           JSR RD300
02328  FB61  A0 00              LDY #0
02329  FB63  84 C3              STY SHCNH
02330  FB65  20 B4 FC           JSR VPRTY
02331  FB68  A5 C3              LDA SHCNH
02332  FB6A  45 DD              EOR OCHAR
02333  FB6C  F0 05              BEQ RD180
02334  FB6E  A9 20              LDA #CKERR
02335  FB70              ;CHKSUM ERROR
02336  FB70  20 7F FB           JSR UDST
02337  FB73  4C E4 E6    RD180  JMP PREND
02338  FB76  A5 FC       RD300  LDA STAH
02339  FB78  85 C8              STA SAH
02340  FB7A  A5 FB              LDA STAL
02341  FB7C  85 C7              STA SAL
02342  FB7E  60                 RTS
02343  FB7F  05 96       UDST   ORA SATUS
02344  FB81  85 96              STA SATUS
02345  FB83  60                 RTS
02346  FB84  A9 08       NEWCH  LDA #8
02347  FB86  85 B7              STA PCNTR
02348  FB88  A9 00              LDA #0
02349  FB8A  85 B9              STA FIRT
02350  FB8C  85 BE              STA RER
02351  FB8E  85 B1              STA PRTY
02352  FB90  85 BF              STA REZ
02353  FB92  60                 RTS
02354  FB93              .FILE  OB6SRC






























TAPE WRITE & INIT......PAGE 0032

LINE# LOC   CODE        LINE


02356  FB93  A5 DD       WRITE  LDA OCHAR
02357  FB95  4A                 LSR A
02358  FB96  A9 60              LDA #96
02359  FB98  90 02              BCC WRT1
02360  FB9A  A9 B0       WRTW   LDA #176
02361  FB9C  A2 00       WRT1   LDX #0
02362  FB9E  8D 48 E8    WRTX   STA T2L
02363  FBA1  8E 49 E8           STX T2H
02364  FBA4  AD 40 E8           LDA PIA
02365  FBA7  49 08              EOR #8
02366  FBA9  8D 40 E8           STA PIA
02367  FBAC  29 08              AND #8
02368  FBAE  60                 RTS
02369  FBAF  38          WRTL3  SEC
02370  FBB0  66 C8              ROR SAH
02371  FBB2  30 3C              BMI WRT3
02372  FBB4  A5 BE       WRTN   LDA RER
02373  FBB6  D0 12              BNE WRTN1
02374  FBB8  A9 10              LDA #16
02375  FBBA  A2 01              LDX #1
02376  FBBC  20 9E FB           JSR WRTX
02377  FBBF  D0 2F              BNE WRT3
02378  FBC1  E6 BE              INC RER
02379  FBC3  A5 C8              LDA SAH
02380  FBC5  10 29              BPL WRT3
02381  FBC7  4C 41 FC           JMP WRNC
02382  FBCA  A5 BF       WRTN1  LDA REZ
02383  FBCC  D0 09              BNE WRTN2
02384  FBCE  20 9A FB           JSR WRTW
02385  FBD1  D0 1D              BNE WRT3
02386  FBD3  E6 BF              INC REZ
02387  FBD5  D0 19              BNE WRT3
02388  FBD7  20 93 FB    WRTN2  JSR WRITE
02389  FBDA  D0 14              BNE WRT3
02390  FBDC  A5 B9              LDA FIRT
02391  FBDE  49 01              EOR #1
02392  FBE0  85 B9              STA FIRT
02393  FBE2  F0 0F              BEQ WRT2
02394  FBE4  A5 DD              LDA OCHAR
02395  FBE6  49 01              EOR #1
02396  FBE8  85 DD              STA OCHAR
02397  FBEA  29 01              AND #1
02398  FBEC  45 B1              EOR PRTY
02399  FBEE  85 B1              STA PRTY
02400  FBF0  4C E4 E6    WRT3   JMP PREND
02401  FBF3  46 DD       WRT2   LSR OCHAR
02402  FBF5  C6 B7              DEC PCNTR
02403  FBF7  A5 B7              LDA PCNTR
02404  FBF9  F0 3D              BEQ WRT4
02405  FBFB  10 F3              BPL WRT3
02406  FBFD  20 84 FB    WRTS   JSR NEWCH
02407  FC00  58                 CLI
02408  FC01  A5 BA              LDA CNTDN
02409  FC03  F0 12              BEQ WRT6
02410  FC05  A2 00              LDX #0






TAPE WRITE & INIT......PAGE 0033

LINE# LOC   CODE        LINE


02411  FC07  86 D9              STX DATA
02412  FC09  C6 BA       WRTS1  DEC CNTDN
02413  FC0B  A6 DE              LDX FSBLK
02414  FC0D  E0 02              CPX #2
02415  FC0F  D0 02              BNE WRT61
02416  FC11  09 80              ORA #$80
02417  FC13  85 DD       WRT61  STA OCHAR
02418  FC15  D0 D9              BNE WRT3
02419  FC17  20 C6 FC    WRT6   JSR WRT62
02420  FC1A  90 0A              BCC WRT7 
02421  FC1C  D0 91              BNE WRTL3
02422  FC1E  E6 C8              INC SAH
02423  FC20  A5 D9              LDA DATA
02424  FC22  85 DD              STA OCHAR
02425  FC24  B0 CA              BCS WRT3
02426  FC26  A0 00       WRT7   LDY #0
02427  FC28  B1 C7              LDA (SAL)Y
02428  FC2A  85 DD              STA OCHAR
02429  FC2C  45 D9              EOR DATA
02430  FC2E  85 D9              STA DATA
02431  FC30  E6 C7              INC SAL
02432  FC32  D0 BC              BNE WRT3
02433  FC34  E6 C8              INC SAH
02434  FC36  D0 B8              BNE WRT3
02435  FC38  A5 B1       WRT4   LDA PRTY
02436  FC3A  49 01              EOR #1
02437  FC3C  85 DD              STA OCHAR
02438  FC3E  4C E4 E6    WRTBK  JMP PREND
02439  FC41  C6 DE       WRNC   DEC FSBLK
02440  FC43  D0 03              BNE WREND
02441  FC45  20 A6 FC           JSR TNOF
02442  FC48  A9 50       WREND  LDA #80
02443  FC4A  85 BD              STA SHCNL
02444  FC4C  A2 08              LDX #8
02445  FC4E  78                 SEI
02446  FC4F  20 9B FC           JSR BSIV
02447  FC52  D0 EA              BNE WRTBK
02448  FC54  A9 78       WRTZ   LDA #120
02449  FC56  20 9C FB           JSR WRT1
02450  FC59  D0 E3              BNE WRTBK
02451  FC5B  C6 BD              DEC SHCNL
02452  FC5D  D0 DF              BNE WRTBK
02453  FC5F  20 84 FB           JSR NEWCH
02454  FC62  C6 C3              DEC SHCNH
02455  FC64  10 D8              BPL WRTBK
02456  FC66  A2 0A              LDX #10
02457  FC68  20 9B FC           JSR BSIV
02458  FC6B  58                 CLI
02459  FC6C  E6 C3              INC SHCNH
02460  FC6E  A5 DE              LDA FSBLK
02461  FC70  F0 24              BEQ STKY
02462  FC72  20 76 FB           JSR RD300
02463  FC75  A2 09              LDX #9
02464  FC77  86 BA              STX CNTDN
02465  FC79  D0 82              BNE WRTS






TAPE WRITE & INIT......PAGE 0034

LINE# LOC   CODE        LINE


02466  FC7B  08          TNIF   PHP
02467  FC7C  78                 SEI
02468  FC7D  20 A6 FC           JSR TNOF
02469  FC80  A9 7F              LDA #$7F
02470  FC82  8D 4E E8           STA IER
02471  FC85  A9 3C              LDA #$3C
02472  FC87  8D 11 E8           STA PIAL1
02473  FC8A  A9 3D              LDA #$3D
02474  FC8C  8D 13 E8           STA PIAS
02475  FC8F  A2 0C              LDX #12
02476  FC91  20 9B FC           JSR BSIV
02477  FC94  28                 PLP
02478  FC95  60                 RTS
02479  FC96  20 7B FC    STKY   JSR TNIF
02480  FC99  F0 A3              BEQ WRTBK
02481  FC9B  BD 01 FD    BSIV   LDA BSIT,X
02482  FC9E  85 90              STA CINV
02483  FCA0  BD 02 FD           LDA BSIT+1,X
02484  FCA3  85 91              STA CINV+1
02485  FCA5  60                 RTS
02486  FCA6  A9 3C       TNOF   LDA #$3C
02487  FCA8  8D 13 E8           STA PIAS
02488  FCAB  AD 40 E8           LDA PIA
02489  FCAE  09 10              ORA #$10
02490  FCB0  8D 40 E8           STA PIA
02491  FCB3  60                 RTS
02492  FCB4  B1 C7       VPRTY  LDA (SAL)Y
02493  FCB6  45 C3              EOR SHCNH
02494  FCB8  85 C3              STA SHCNH
02495  FCBA  E6 C7              INC SAL
02496  FCBC  D0 02              BNE VP10
02497  FCBE  E6 C8              INC SAH
02498  FCC0  20 C6 FC    VP10   JSR WRT62
02499  FCC3  D0 EF              BNE VPRTY
02500  FCC5  60                 RTS
02501  FCC6  A5 C8       WRT62  LDA SAH
02502  FCC8  C5 CA              CMP EAH
02503  FCCA  D0 04              BNE WRT64
02504  FCCC  A5 C7              LDA SAL
02505  FCCE  C5 C9              CMP EAL
02506  FCD0  60          WRT64  RTS
02507  FCD1  A2 FF       START  LDX #$FF
02508  FCD3  9A                 TXS
02509  FCD4  D8                 CLD
02510  FCD5  20 DE E1           JSR CINT
02511  FCD8  A9 89              LDA #<READY
02512  FCDA  85 94              STA NMINV
02513  FCDC  A9 C3              LDA #>READY
02514  FCDE  85 95              STA NMINV+1
02515  FCE0  A9 17              LDA #<BRKE
02516  FCE2  85 92              STA CBINV
02517  FCE4  A9 FD              LDA #>BRKE
02518  FCE6  85 93              STA CBINV+1
02519  FCE8  A9 F7              LDA #<ERROPR
02520  FCEA  8D FA 03           STA USRCMD






TAPE WRITE & INIT......PAGE 0035

LINE# LOC   CODE        LINE


02521  FCED  A9 E7              LDA #>ERROPR
02522  FCEF  8D FB 03           STA USRCMD+1
02523  FCF2  58                 CLI
02524  FCF3  AD 10 E8           LDA PIAL
02525  FCF6  30 03              BMI *+5
02526  FCF8  4C 11 FD           JMP CALLE
02527  FCFB  4C 16 E1           JMP INIT
02528  FCFE  6C 94 00    NMI    JMP (NMINV)
02529  FD01  00 00       BSIT   .WOR 0,0,0,0    ;BSYI1,BCI1,0,BCI2
02529  FD03  00 00 
02529  FD05  00 00 
02529  FD07  00 00 
02530  FD09  54 FC              .WOR WRTZ,WRTN,KEY,READ
02530  FD0B  B4 FB 
02530  FD0D  2E E6 
02530  FD0F  31 F9 
02531  FD11              .FIL   CALLE












































PET RESIDENT MONITOR......PAGE 0036

LINE# LOC   CODE        LINE


02533  FD11              NCMDS  =8
02534  FD11  A9 43       CALLE  LDA #'C         ;SET A=C TO INDICATE
02535  FD13  85 B5              STA TMPC
02536  FD15  D0 16              BNE B3          ;CALL ENTRY, THEN JMP TO B3
02537  FD17  A9 42       BRKE   LDA #'B
02538  FD19  85 B5              STA TMPC
02539  FD1B  D8                 CLD
02540  FD1C  4A                 LSR A           ;SET CY FOR PC CORRECTION
02541  FD1D  68                 PLA
02542  FD1E  8D 05 02           STA YR          ;SAVE Y
02543  FD21  68                 PLA
02544  FD22  8D 04 02           STA XR          ;AND X
02545  FD25  68                 PLA
02546  FD26  8D 03 02           STA ACC         ;AND ACCUMULATOR
02547  FD29  68                 PLA
02548  FD2A  8D 02 02           STA FLGS        ;AND FLAGS
02549  FD2D  68          B3     PLA
02550  FD2E  69 FF              ADC #$FF        ;CY SET TO PC-1 FOR BREAK
02551  FD30  8D 01 02           STA PCL
02552  FD33  68                 PLA
02553  FD34  69 FF              ADC #$FF
02554  FD36  8D 00 02           STA PCH
02555  FD39  A5 90              LDA CINV
02556  FD3B  8D 08 02           STA INVL
02557  FD3E  A5 91              LDA CINV+1
02558  FD40  8D 07 02           STA INVH
02559  FD43  BA                 TSX
02560  FD44  8E 06 02           STX SP          ;SAVE ORIGINAL SP
02561  FD47  58                 CLI             ;CLBAR INTS
02562  FD48  20 D0 FD    B5     JSR CRLF
02563  FD4B  A6 B5              LDX TMPC        ;SET X EQUAL TO B OR C
02564  FD4D  A9 2A              LDA #'*
02565  FD4F  20 84 E7           JSR WRTWO
02566  FD52  A9 52              LDA #'R         ;SET FOR R DISPLAY TO
02567  FD54              ;                      PERMIT IMMEDIATE
02568  FD54              ;                      ALTER FOLLOWING
02569  FD54              ;                      BREAKPOINT
02570  FD54  D0 1A       LFD54  BNE S0
02571  FD56  A9 02       STRT   LDA #2          ;NEXT COMMAND FROM USER
02572  FD58  85 77              STA TXTPTR
02573  FD5A  A9 00              LDA #0
02574  FD5C  85 DE              STA WRAP        ;CLEAR ADR WRAPZAROUND FLAG
02575  FD5E  A2 0D              LDX #CR
02576  FD60  A9 2E              LDA #'.         ;TYPE A PROMPTING '. '
02577  FD62  20 84 E7           JSR WRTWO
02578  FD65  20 EB E7    ST1    JSR RDOC        ;READ COMMAND. CHARACTER
02579  FD68              ;                      IS RETURNED IN A
02580  FD68  C9 2E              CMP #'.         ;IGNORE PROMPTING '. '
02581  FD6A  F0 F9              BEQ ST1
02582  FD6C  C9 20              CMP #$20        ;IGNORE SPACES
02583  FD6E  F0 F5              BEQ ST1
02584  FD70  A2 07       S0     LDX #NCMDS-1    ;LOOKUP COMMAND
02585  FD72  DD E0 FD    S1     CMP CMDS,X
02586  FD75  D0 0B              BNE S2
02587  FD77  86 B4              STX SAVX        ;SAVE CURRENT COMMAND INDEX






PET RESIDENT MONITOR......PAGE 0037

LINE# LOC   CODE        LINE


02588  FD79              ;INDIRECT JMP FROM TABLE BY
02589  FD79              ; PUSHING TARGET ADDRESS-1
02590  FD79              ;  THEN RTS
02591  FD79  BD E8 FD           LDA ADRH,X
02592  FD7C  48                 PHA
02593  FD7D  BD F0 FD           LDA ADRL,X
02594  FD80  48                 PHA
02595  FD81  60                 RTS
02596  FD82  CA          S2     DEX
02597  FD83  10 ED              BPL S1          ;LOOP FOR ALL. COMMANDS
02598  FD85  6C FA 03           JMP (USRCMD)
02599  FD88  A5 FB       PUTP   LDA TMP0        ;MOVE TMP0 TO PCH,PCL
02600  FD8A  8D 01 02           STA PCL
02601  FD8D  A5 FC              LDA TMP0+1
02602  FD8F  8D 00 02           STA PCH
02603  FD92  60                 RTS
02604  FD93              ;
02605  FD93              ;DISPLAY MEM SUBR. SET AR=NUMBER
02606  FD93              ;OF MEMORY BYTES DISPLAYED.
02607  FD93              ;TMP0=ADR OF MEM DISPLAYED
02608  FD93              ;
02609  FD93  85 B5       DM     STA TMPC
02610  FD95  A0 00              LDY #0
02611  FD97  20 CD FD    DM1    JSR SPACE       ;WR N BYTES
02612  FD9A  B1 FB              LDA (TMP0),Y    ;(TMP0)=ADR
02613  FD9C  20 75 E7           JSR WROB
02614  FD9F  20 D5 FD           JSR INCTMP
02615  FDA2  C6 B5              DEC TMPC
02616  FDA4  D0 F1              BNE DM1
02617  FDA6  60                 RTS
02618  FDA7              ;READ AND STORE BYTE.
02619  FDA7              ;NO STORE IF SPACE OR TMPC = O.
02620  FDA7  20 B6 E7    BYTE   JSR RDOB        ;CHAR IN A, CY=O0 IF SP
02621  FDAA  90 0D              BCC BY3         ;SPACE
02622  FDAC  A2 00              LDX #0          ;STORE BYTE
02623  FDAE  81 FB              STA (TMP0,X)
02624  FDB0  C1 FB              CMP (TMP0,X)    ;TEST FOR VALID WRITE (RAM)
02625  FDB2  F0 05              BEQ BY3
02626  FDB4  68                 PLA             ;ERROR: CLEAR JSR ADR IN STACK
02627  FDB5  68                 PLA
02628  FDB6  4C F7 E7           JMP ERROPR
02629  FDB9  20 D5 FD    BY3    JSR INCTMP      ;GO INC TMPO ADR
02630  FDBC  C6 B5              DEC TMPC
02631  FDBE  60                 RTS
02632  FDBF  A9 02       SETR   LDA #<FLGS      ;SET TO ACCESS REGS
02633  FDC1  85 FB              STA TMP0
02634  FDC3  A9 02              LDA #>FLGS
02635  FDC5  85 FC              STA TMP0+1
02636  FDC7  A9 05              LDA #5
02637  FDC9  60                 RTS
02638  FDCA  20 CD FD    SPAC2  JSR SPACE
02639  FDCD  A9 20       SPACE  LDA #$20
02640  FDCF  2C                 .BYT $2C
02641  FDD0  A9 0D       CRLF   LDA #$D
02642  FDD2  4C D2 FF           JMP KBSOUT






PET RESIDENT MONITOR......PAGE 0038

LINE# LOC   CODE        LINE


02643  FDD5              ;INCREMENT (TMP0,TMP0+1) BY 1
02644  FDD5  E6 FB       INCTMP INC TMP0        ;LOW BYTE
02645  FDD7  D0 06              BNE SETWR
02646  FDD9  E6 FC              INC TMP0+1      ;HIGH BYTE
02647  FDDB  D0 02              BNE SETWR
02648  FDDD  E6 DE              INC WRAP
02649  FDDF  60          SETWR  RTS






















































COMMAND & ADDR TABLE......PAGE 0039

LINE# LOC   CODE        LINE


02651  FDE0  3A          CMDS   .BYT ':'        ;MODIFY MEMORY
02652  FDE1  3B                 .BYT ';'        ;ALTER REGISTERS
02653  FDE2  52                 .BYT 'R'        ;DIGPLAY REGS
02654  FDE3  4D                 .BYT 'M'        ;DISPLAY MEMORY
02655  FDE4  47                 .BYT 'G'        ;START EXECUTION
02656  FDE5  58                 .BYT 'X'        ;WARM START BASIC
02657  FDE6  4C                 .BYT 'L'        ;LOAD MEMORY
02658  FDE7  53                 .BYT 'S'        ;SAVE MEMORY
02659  FDE8  FE          ADRH   .BYT >ZZ1
02660  FDE9  FE                 .BYT >ZZ2
02661  FDEA  FE                 .BYT >ZZ3
02662  FDEB  FE                 .BYT >ZZ4
02663  FDEC  FE                 .BYT >ZZ5
02664  FDED  FF                 .BYT >ZZ6
02665  FDEE  FF                 .BYT >ZZ7
02666  FDEF  FF                 .BYT >ZZ8
02667  FDF0  B8          ADRL   .BYT <ZZ1
02668  FDF1  96                 .BYT <ZZ2
02669  FDF2  22                 .BYT <ZZ3
02670  FDF3  57                 .BYT <ZZ4
02671  FDF4  CE                 .BYT <ZZ5
02672  FDF5  06                 .BYT <ZZ6
02673  FDF6  10                 .BYT <ZZ7
02674  FDF7  10                 .BYT <ZZ8





































PET MONITOR 13.1......PAGE 003A

LINE# LOC   CODE        LINE


02676  FDF8  0D          REGK   .BYT CR,$20,$20,$20,$20 ;4 SPACES
02676  FDF9  20 
02676  FDFA  20 
02676  FDFB  20 
02676  FDFC  20 
02677  FDFD  20 50              .BYT ' PC ',' IRQ ',' SR AC XR YR SP'
02677  FE01  20 49 
02677  FE06  20 53 
02678  FE15  98          ALTRIT TYA
02679  FE16  48                 PHA
02680  FE17  20 D0 FD           JSR CRLF
02681  FE1A  68                 PLA
02682  FE1B  A2 2E              LDX #'.
02683  FE1D  20 84 E7           JSR WRTWO
02684  FE20  4C CA FD           JMP SPAC2

02686  FE23  A2 00       DSPLYR LDX #0
02687  FE25  BD F8 FD    D2     LDA REGK,X
02688  FE28  20 D2 FF           JSR KBSOUT
02689  FE2B  E8                 INX
02690  FE2C  E0 1D              CPX #29
02691  FE2E  D0 F5              BNE D2
02692  FE30  A0 3B              LDY #';
02693  FE32  20 15 FE           JSR ALTRIT
02694  FE35  AD 00 02           LDA PCH
02695  FE38  20 75 E7           JSR WROB
02696  FE3B  AD 01 02           LDA PCL
02697  FE3E  20 75 E7           JSR WROB
02698  FE41  20 CD FD           JSR SPACE
02699  FE44  AD 07 02           LDA INVH
02700  FE47  20 75 E7           JSR WROB
02701  FE4A  AD 08 02           LDA INVL
02702  FE4D  20 75 E7           JSR WROB
02703  FE50  20 BF FD           JSR SETR
02704  FE53  20 93 FD           JSR DM          ;USE DM SUBR.
02705  FE56  F0 39              BEQ BEQS1
02706  FE58  20 EB E7    DSPLYM JSR RDOC
02707  FE5B  20 A7 E7           JSR RDOA        ;READ START ADR
02708  FE5E  90 34              BCC ERRS1       ;ERR IF NO SA
02709  FE60  20 97 E7           JSR T2T2        ;SA TO TMP2
02710  FE63  20 EB E7           JSR RDOC        ;SKIP DELIMITER
02711  FE66  20 A7 E7           JSR RDOA        ;READ END ADR
02712  FE69  90 29              BCC ERRS1       ;ERR IF NO EA
02713  FE6B  20 97 E7           JSR T2T2        ;SA TO TMP0, EA TO TMP2
02714  FE6E  20 01 F3    DSP1   JSR STOP1       ;TEST FOR STOP KEY
02715  FE71  F0 1E              BEQ BEQS1
02716  FE73  A6 DE              LDX WRAP
02717  FE75  D0 1A              BNE BEQS1
02718  FE77  38                 SEC             ;DOUBLE BYTE COMPARE
02719  FE78  A5 FD              LDA TMP2
02720  FE7A  E5 FB              SBC TMP0
02721  FE7C  A5 FE              LDA TMP2+1
02722  FE7E  E5 FC              SBC TMP0+1
02723  FE80  90 0F              BCC BEQS1       ;STOP IF EA LESS THAN SA
02724  FE82  A0 3A              LDY #':






PET MONITOR 13.1......PAGE 003B

LINE# LOC   CODE        LINE


02725  FE84  20 15 FE           JSR ALTRIT
02726  FE87  20 6A E7           JSR WROA
02727  FE8A  A9 08              LDA #8
02728  FE8C  20 93 FD           JSR DM          ;DIGPLAY 8, INCR TMPO
02729  FE8F  F0 DD              BEQ DSP1
02730  FE91  4C 56 FD    BEQS1  JMP STRT
02731  FE94  4C F7 E7    ERRS1  JMP ERROPR
02732  FE97              ;ALTER REGISTERS
02733  FE97  20 B6 E7    ALTR   JSR RDOB        ;SKIP 2 SPACES
02734  FE9A  20 A7 E7           JSR RDOA        ;CY=0 IF SP
02735  FE9D  90 03              BCC AL2         ;SPACE
02736  FE9F  20 88 FD           JSR PUTP        ;ALTER PC
02737  FEA2  20 CF FF    AL2    JSR KBASIN
02738  FEA5  20 A7 E7           JSR RDOA
02739  FEA8  90 0A              BCC AL3
02740  FEAA  A5 FB              LDA TMP0
02741  FEAC  8D 08 02           STA INVL
02742  FEAF  A5 FC              LDA TMP0+1
02743  FEB1  8D 07 02           STA INVH
02744  FEB4  20 BF FD    AL3    JSR SETR        ;SET TO ALTER R'S
02745  FEB7  D0 0A              BNE A4
02746  FEB9              ; ALTER MEMORY - READ ADR AND DATA
02747  FEB9  20 B6 E7    ALTM   JSR RDOB        ;SKIP 2 SPACES
02748  FEBC  20 A7 E7           JSR RDOA        ;READ MEM ALTER ADR
02749  FEBF  90 D3              BCC ERRS1       ;CY=0, IF SPACE,ERR
02750  FEC1  A9 08              LDA #8          ;SET CNT = 8
02751  FEC3  85 B5       A4     STA TMPC
02752  FEC5  20 EB E7    A5     JSR RDOC
02753  FEC8  20 A7 FD           JSR BYTE
02754  FECB  D0 F8              BNE A5
02755  FECD  F0 C2       A9     BEQ BEQS1
02756  FECF  20 CF FF    GO     JSR KBASIN
02757  FED2  C9 0D              CMP #$0D        ;IF CR, EXIT
02758  FED4  F0 0C              BEQ G1
02759  FED6  C9 20              CMP #$20        ;1F NOT SPACE, ERR
02760  FED8  D0 BA              BNE ERRS1
02761  FEDA  20 A7 E7           JSR RDOA
02762  FEDD  90 03              BCC G1
02763  FEDF  20 88 FD           JSR PUTP
02764  FEE2  AE 06 02    G1     LDX SP
02765  FEE5  9A                 TXS             ;ORIG OR NEW SP VALUE TO SP
02766  FEE6  78                 SEI
02767  FEE7  AD 07 02           LDA INVH
02768  FEEA  85 91              STA CINV+1
02769  FEEC  AD 08 02           LDA INVL
02770  FEEF  85 90              STA CINV
02771  FEF1  AD 00 02           LDA PCH
02772  FEF4  48                 PHA
02773  FEF5  AD 01 02           LDA PCL
02774  FEF8  48                 PHA
02775  FEF9  AD 02 02           LDA FLGS
02776  FEFC  48                 PHA
02777  FEFD  AD 03 02           LDA ACC
02778  FF00  AE 04 02           LDX XR
02779  FF03  AC 05 02           LDY YR






PET MONITOR 13.1......PAGE 003C

LINE# LOC   CODE        LINE


02780  FF06  40                 RTI
02781  FF07  AE 06 02    EXIT   LDX SP
02782  FF0A  9A                 TXS
02783  FF0B  4C 89 C3           JMP READY       ;EXIT TO BASIC WARM START
02784  FF0E  4C F7 E7    ERRL   JMP ERROPR
02785  FF11              ZZZ1   =SAVNAM         ;PLACE TO PUT NAME
02786  FF11  A0 01       LD     LDY #1
02787  FF13  84 D4              STY FA          ;DEFAULT DEVICE #1
02788  FF15  88                 DEY
02789  FF16  84 D1              STY FNLEN
02790  FF18  84 9D              STY VERCK
02791  FF1A  A9 02              LDA #>ZZZ1      ;PLACE TO STORE NAME
02792  FF1C  85 DB              STA FNADR+1
02793  FF1E  A9 07              LDA #<ZZZ1
02794  FF20  85 DA              STA FNADR
02795  FF22  20 CF FF    L1     JSR KBASIN
02796  FF25  C9 20              CMP #' 
02797  FF27  F0 F9              BEQ L1          ;SPAN BLANKS
02798  FF29  C9 0D              CMP #CR
02799  FF2B  F0 1A              BEQ L5          ;DEFAULT TO LOAD
02800  FF2D  C9 22              CMP #'"
02801  FF2F  D0 DD       L2     BNE ERRL        ;FILE NAME MUST BE NEXT
02802  FF31  20 CF FF    L3     JSR KBASIN
02803  FF34  C9 22              CMP #'"
02804  FF36  F0 24              BEQ L8          ;END OF NAME
02805  FF38  C9 0D              CMP #CR         ;DEFAULT A LOAD
02806  FF3A  F0 0B              BEQ L5
02807  FF3C  91 DA              STA (FNADR)Y
02808  FF3E  E6 D1              INC FNLEN
02809  FF40  C8                 INY
02810  FF41  C0 10              CPY #16
02811  FF43  F0 C9       L4     BEQ ERRL        ;FILE NAME TOO LONG
02812  FF45  D0 EA              BNE L3
02813  FF47  A5 B4       L5     LDA SAVX
02814  FF49  C9 06              CMP #6
02815  FF4B  D0 E2       L6     BNE L2          ;NOT A LOAD
02816  FF4D  20 22 F3           JSR LD15
02817  FF50  20 E6 F8           JSR TWAIT
02818  FF53  A5 96              LDA SATUS
02819  FF55  29 10              AND #SPERR
02820  FF57  D0 F2       L7     BNE L6          ;LOAD ERROR
02821  FF59  4C 56 FD           JMP STRT
02822  FF5C  20 CF FF    L8     JSR KBASIN
02823  FF5F  C9 0D              CMP #CR
02824  FF61  F0 E4              BEQ L5          ;DEFUALT LOAD
02825  FF63  C9 2C              CMP #',
02826  FF65  D0 F0       L9     BNE L7          ;BAD SYNTAX
02827  FF67  20 B6 E7           JSR RDOB
02828  FF6A  29 0F              AND #$F
02829  FF6C  F0 D5       L10    BEQ L4          ;DEVICE 0
02830  FF6E  C9 03              CMP #3
02831  FF70  F0 FA       L11    BEQ L10         ;DEVICE 3
02832  FF72  85 D4              STA FA
02833  FF74  20 CF FF           JSR KBASIN
02834  FF77  C9 0D              CMP #CR






PET MONITOR 13.1......PAGE 003D

LINE# LOC   CODE        LINE


02835  FF79  F0 CC              BEQ L5          ;DEFAULT LOAD
02836  FF7B  C9 2C              CMP #',
02837  FF7D  D0 E6       L12    BNE L9          ;BAD SYNTAX
02838  FF7F  20 A7 E7           JSR RDOA
02839  FF82  20 97 E7           JSR T2T2
02840  FF85  20 CF FF           JSR KBASIN
02841  FF88  C9 2C              CMP #',
02842  FF8A  D0 F1       L13    BNE L12         ;MISSING END ADDR
02843  FF8C  20 A7 E7           JSR RDOA
02844  FF8F  A5 FB              LDA TMP0
02845  FF91  85 C9              STA EAL
02846  FF93  A5 FC              LDA TMP0+1
02847  FF95  85 CA              STA EAH
02848  FF97  20 97 E7           JSR T2T2
02849  FF9A  20 CF FF    L20    JSR KBASIN
02850  FF9D  C9 20              CMP #$20
02851  FF9F  F0 F9              BEQ L20
02852  FFA1  C9 0D              CMP #CR
02853  FFA3  D0 E5       L14    BNE L13         ;MISSING CR AT END
02854  FFA5  A5 B4              LDA SAVX
02855  FFA7  C9 07              CMP #7
02856  FFA9  D0 F8              BNE L14
02857  FFAB  20 A4 F6           JSR SV5
02858  FFAE  4C 56 FD           JMP STRT
02859  FFB1              ZZ1=ALTM-1
02860  FFB1              ZZ2=ALTR-1
02861  FFB1              ZZ3=DSPLYR-1
02862  FFB1              ZZ4=DSPLYM-1
02863  FFB1              ZZ5=GO-1
02864  FFB1              ZZ6=EXIT-1
02865  FFB1              ZZ7=LD-1
02866  FFB1              ZZ8=LD-1
02867  FFB1              .FIL   OB7SRC
02868  FFB1  43 2E              .BYT 'C. 0978 CBM'
02869  FFBC  20                 .BYT $20
02870  FFBD                     *=$7FC0+OFFSET
02871  FFC0  4C 21 F5           JMP OPEN
02872  FFC3  4C A9 F2           JMP CLOSE
02873  FFC6  4C 70 F7           JMP CHKIN
02874  FFC9  4C BC F7           JMP CKOUT
02875  FFCC  4C 72 F2           JMP CLRCH
02876  FFCF  4C E1 F1    KBASIN JMP BASIN
02877  FFD2  4C 32 F2    KBSOUT JMP BSOUT
02878  FFD5  4C C2 F3           JMP LOAD
02879  FFD8  4C 9E F6           JMP SAVE
02880  FFDB  4C B7 F4           JMP VER
02881  FFDE  4C 84 F6           JMP SYS
02882  FFE1  4C 0F F3           JMP STOP
02883  FFE4  4C D1 F1           JMP GETIN
02884  FFE7  4C 6E F2           JMP CLALL
02885  FFEA  4C 29 F7    KUDTIM JMP UDTIM
02886  FFED                     *=$FFFA
02887  FFFA  FE FC              .WOR NMI
02888  FFFC  D1 FC              .WOR START
02889  FFFE  1B E6              .WOR PULS






PET MONITOR 13.1......PAGE 003E

LINE# LOC   CODE        LINE


02890  0000              .END


ERRORS = 00000


SYMBOL TABLE

SYMBOL VALUE
 A4       FEC3    A5       FEC5    A9       FECD    ACC      0203
 ACP00    F199    ACP01    F19E    ACP03    F1BA    ACP05    F1C5
 ACPTR    F18C    ACR      E84B    ADRH     FDE8    ADRL     FDF0
 AL2      FEA2    AL3      FEB4    ALTM     FEB9    ALTR     FE97
 ALTRIT   FE15    ASC1     E794    ASCII    E78D    B3       FD2D
 B5       FD48    BAD      0100    BASIN    F1E1    BDF      0002
 BDFH     0004    BEQS1    FE91    BK1      E415    BK2      E420
 BKLN     E3B4    BKLN1    E3C0    BLF      0001    BLKL     E60D
 BLKLN    E5FA    BLNCT    00A8    BLNK2    F5EF    BLNON    00AA
 BLNSW    00A7    BN10     F1F0    BN20     F1FD    BN30     F228
 BN32     F22E    BN35     F22F    BO10     F23D    BO20     F243
 BO21     F244    BRKE     FD17    BSIT     FD01    BSIV     FC9B
 BSOUR    00A5    BSOUT    F232    BSTOP    C73F    BUF      0200
 BUFPT    00BB    BUFSZ    00C0    BY3      FDB9    BYTE     FDA7
 C3P0     00A0    CALLE    FD11    CAS1     00F9    CAS2     00FA
 CBINV    0092    CHANL    000E    CHAR     E6F8    CHKCOM   CDF8
 CHKIN    F770    CHKOUT   F7BC    CHRGET   0070    CHRGOT   0076
 CI2      F177    CI4      F17C    CINT     E1DE    CINV     0090
 CIOUT    F16F    CK10     F7D6    CKERR    0020    CKIS1    E6A7
 CKIT     E6B7    CKIT1    E6C2    CKOUT    F7BC    CKUT     E6B6
 CLALL    F26E    CLOS10   F2B3    CLOS5    F2AE    CLOSE    F2A9
 CLP1     E330    CLP2     E31F    CLP21    E32E    CLP2A    E32B
 CLP5     E2D0    CLP6     E2D9    CLP7     E33E    CLRCH    F272
 CLRCHN   F272    CLSE1    F6F0    CLSR     E229    CMDS     FDE0
 CMP0     00CB    CNC3     E42A    CNC3X    E406    CNTDN    00BA
 CR       000D    CRFAC    0099    CRLF     FDD0    CRSW     00AC
 CS10     F835    CS20     F83E    CS25     F846    CS30     F819
 CS40     F828    CSTE1    F812    CSTE2    F847    D2       FE25
 DATA     00D9    DFLTN    00AF    DFLTO    00B0    DIFF     00CF
 DM       FD93    DM1      FD97    DPSW     00B2    DSP1     FE6E
 DSPLYM   FE58    DSPLYR   FE23    DSPP     E6EA    DSPP1    E6EB
 EAH      00CA    EAL      00C9    EOT      0005    ER001    F146
 ERMSG    F570    ERR01    F138    ERRL     FF0E    ERROPR   E7F7
 ERRP0    F136    ERRP1    F141    ERRP7    F13D    ERRS1    FE94
 EXIT     FF07    FA       00D4    FAF      F494    FAF20    F4A1
 FAF30    F4B5    FAF40    F4B6    FAH      F5A6    FAH30    F5A9
 FAH40    F5D5    FAH45    F5D3    FAH50    F5BC    FAH55    F5C9
 FAT      025B    FCLOSE   F2AE    FINI     C439    FIRT     00B9
 FLGS     0202    FLOAD    C590    FNADR    00DA    FNLEN    00D1
 FOPEN    F526    FRESTR   D57D    FRMEVL   CC9F    FRMNUM   CC8B
 FSBLK    00DE    G1       FEE2    GDBLN    00A9    GETADR   D6D2
 GETBYT   D678    GETIN    F1D1    GO       FECF    HEX09    E7EA
 HEXIT    E7E0    IEEI     E820    IEEIS    E821    IEEO     E822
 IEEOS    E823    IER      E84E    IFR      E84D    INCTMP   FDD5
 INDEX1   001F    INDX     00A1    INIT     E116    INS1     E4AB








SYMBOL TABLE

SYMBOL VALUE
 INS2     E4AD    INS3     E4A4    INSRT    00DC    INVH     0207
 INVL     0208    ISOUR    F0EE    ISR0     F10D    ISR1     F103
 ISR2     F112    ISR3     F11D    JLP2     E516    JLTLK    F28D
 JPL3     E462    JPL4     E44B    JRAD2    F988    JRADJ    F966
 JSTS     E35D    JSTS1    E377    JSTS2    E3A3    JSTSX    E38B
 JSXB     E395    JTG10    F225    JTG35    F20F    JTGET    F215
 JTP10    F264    JTP20    F806    JTS2     E396    JX120    F2E1
 JX150    F2E4    JX170    F300    JX300    F77F    JX305    F781
 JX310    F784    JX320    F79B    JX330    F7A0    JX3301   F7A1
 JX340    F7AE    JX350    F7B1    JX360    F7E6    JX370    F7EB
 JX380    F7F8    JX390    F7FB    JX600    F28F    JX750    F27B
 JX770    F284    JZ100    F299    JZ101    F2A8    KBASIN   FFCF
 KBSOUT   FFD2    KEY      E62E    KEY3     E66E    KEY4     E64D
 KEY5     E649    KEYD     026F    KEYF     E6E2    KL1      E698
 KL2      E677    KL22     E68E    KL23     E682    KL24     E674
 KL25     E68B    KN1      E6D6    KUDTIM   FFEA    L1       FF22
 L10      FF6C    L11      FF70    L12      FF7D    L13      FF8A
 L14      FFA3    L2       FF2F    L20      FF9A    L3       FF31
 L4       FF43    L5       FF47    L6       FF4B    L7       FF57
 L8       FF5C    L9       FF65    LA       00D2    LASTWR   E1DE
 LAT      0251    LBERR    0008    LD       FF11    LD10     F3C6
 LD100    F395    LD105    F41D    LD11     F3CE    LD110    F423
 LD112    F39E    LD115    F42D    LD120    F3A7    LD15     F322
 LD150    F3AA    LD170    F3AF    LD20     F326    LD205    F404
 LD209    F3E6    LD210    F3EF    LD30     F352    LD300    F40A
 LD40     F355    LD400    F42E    LD410    F436    LD50     F378
 LD60     F37A    LD64     F380    LD65     F387    LDAD1    F66C
 LDAD2    F63C    LDAD3    F643    LDTB1    00E0    LDTB2    E748
 LDTND    00AE    LFD54    FD54    LINNUM   0011    LIST1    F0BC
 LIST2    F0DF    LIST4    F0E4    LISTN    F0BA    LNMX     00D5
 LOAD     F3C2    LOADNP   F3C9    LOOP2    E37E    LOOP3    E29D
 LOOP4    E29A    LOOP5    E2F4    LOP2     E386    LOP5     E2FC
 LOP51    E302    LOP52    E312    LOP53    E316    LOP54    E30C
 LP1      E28A    LP2      E285    LP21     E2B1    LP22     E2C8
 LP23     E2BD    LPS1     E22D    LPS2     E23B    LPS3     E23C
 LPS4     E248    LSTP     00A4    LSTX     0097    LSXP     00A3
 MLP1     E559    MLP2     E572    MLP4     E5AA    MLP41    E5AD
 MLP42    E5B7    MS1      F000    MS10     F05F    MS11     F064
 MS12     F06E    MS13     F074    MS15     F086    MS16     F094
 MS17     F0A3    MS18     F0AA    MS19     F0AE    MS2      F00E
 MS20     F039    MS21     F06D    MS22     F060    MS3      F017
 MS4      F024    MS5      F032    MS6      F03D    MS7      F041
 MS8      F04D    MS9      F056    MSG      F156    MYCH     00DF
 NC1      E433    NC2      E43A    NC3      E352    NC3W     E42D
 NCMDS    0008    NCX2     E450    NCZ2     E44D    NDX      009E
 NELL     E5ED    NEWCH    FB84    NEWL1    E5CE    NEWLA    E5DA
 NEWLN    E5BA    NEWLX    E5CC    NJT1     E3F3    NMI      FCFE
 NMINV    0094    NTCN     E3FF    NTCN1    E426    NTCN2    E3C9
 NVS      E354    NVS1     E35A    NXLN     E519    NXLN1    E526
 NXLN2    E51E    NXT1     E52F    NXT2     E4F8    NXT3     E34E
 NXT33    E34C    NXT6     E500    NXT61    E50F    NXTD     E257
 NXTX     E47A    NXTX1    E482    OCHAR    00DD    OFFSET   8000
 OP100    F52F    OP150    F559    OP160    F56E    OP170    F583
 OP171    F592    OP172    F5A3    OP175    F5A5    OP200    F58A
 OP35     F481    OP37     F47C    OP40     F487    OP45     F491








SYMBOL TABLE

SYMBOL VALUE
 OP98     F528    OPEN     F521    OPENI    F466    OPENIB   F475
 P2DA     E843    P2DB     E842    PARS1    F43E    PARS2    F4CE
 PCH      0200    PCL      0201    PCNTR    00B7    PCR      E84C
 PIA      E840    PIAK     E812    PIAL     E810    PIAL1    E811
 PIAS     E813    PNT      00C4    PNTR     00C6    POINT    00C5
 PR060    F45F    PR070    F460    PR100    F4EF    PR111    F4F7
 PR130    F519    PR135    F51E    PR140    F50E    PR147    F515
 PR150    F516    PR200    F4FD    PREND    E6E4    PRP      00D0
 PRT      E3D8    PRT1     E465    PRT2     E46D    PRTY     00B1
 PTCH     00B8    PTR1     00C0    PTR2     00C1    PULS     E61B
 PULS1    E62B    PUTP     FD88    PX1      E1E7    QTSW     00CD
 QTSWC    E33F    QTSWL    E34B    RAD2     FA07    RAD2X    FA16
 RAD2Y    FA0F    RAD3     F9CB    RAD3G    F9EA    RAD4     F9EE
 RAD5     F999    RADBK    F9C8    RADJ     FA57    RADK     FA4A
 RADL     F997    RADP     F9BF    RADQ     FA26    RADQ1    FA2A
 RADQ2    FA3B    RADR1    FA50    RADS     F951    RADX2    F993
 RBLK     F855    RCNT     00B5    RD1      F93F    RD10     FA81
 RD12     FA7D    RD15     FA67    RD160    FB44    RD161    FB46
 RD167    FB4F    RD175    FB5B    RD180    FB73    RD20     FA84
 RD200    FAA0    RD22     FA9A    RD3      F953    RD300    FB76
 RD40     FAB1    RD52     FB27    RD55     FB2B    RD56     FAEC
 RD58     FAFF    RD59     FB32    RD60     FAB7    RD70     FAC5
 RD80     FAE2    RD90     FB3C    RDBK     F9AC    RDBK2    FA54
 RDEXIT   E7B5    RDFLG    00C2    RDOA     E7A7    RDOA2    E7AE
 RDOB     E7B6    RDOB1    E7BE    RDOB2    E7CB    RDOB3    E7D8
 RDOC     E7EB    READ     F931    READY    C389    REGK     FDF8
 RER      00BE    REZ      00BF    RJDJ     F969    ROUT1    F9D7
 ROUT2    F9D5    RSTOR    F268    RUNTB    E761    RVS      009F
 S0       FD70    S1       FD72    S2       FD82    SA       00D3
 SAH      00C8    SAL      00C7    SAT      0265    SATUS    0096
 SAVE     F69E    SAVNAM   0207    SAVX     00B4    SBERR    0004
 SCATN    F12D    SCRL     E39C    SCRL1    E552    SCRL3    E58C
 SCRL4    E57E    SCRL5    E582    SCROL    E53F    SECND    F128
 SETR     FDBF    SETWR    FDDF    SFDX     00A6    SFST     0098
 SHCNH    00C3    SHCNL    00BD    SNERR    CE03    SNSW     00A2
 SNSW1    00CE    SP       0206    SPAC2    FDCA    SPACE    FDCD
 SPCK     E6B4    SPERR    0010    SPMSG    F315    SR       E84A
 SRER     F98B    ST1      FD65    STAH     00FC    STAL     00FB
 START    FCD1    STKEY    009B    STKY     FC96    STOP     F30F
 STOP1    F301    STOP2    F30E    STOP3    F8FD    STRT     FD56
 STT1     F900    STT2     F915    STT3     F91C    STUPR    E284
 STUPT    E25D    STUPZ    E27A    STXTPT   C5A7    SV10     F6A8
 SV100    F703    SV105    F716    SV20     F6AD    SV3      F6A1
 SV30     F6D8    SV5      F6A4    SV50     F6ED    SV60     F68D
 SVXT     009C    SYNC     E841    SYNC1    E84F    SYNO     00AB
 SYS      F684    T1       00B4    T2       00B5    T2H      E849
 T2L      E848    T2T2     E797    T2T21    E799    T3       00B6
 TALK     F0B6    TAPE     F89B    TAPE1    027A    TAPE2    033A
 TAPEH    F5DA    TBLX     00D8    TBUF     00D6    TEMP     00CC
 TH20     F613    TH30     F625    TIH      E845    TIL      E844
 TILH     E847    TILL     E846    TIME     008D    TKATN    F169
 TKSA     F164    TMP0     00FB    TMP2     00FD    TMPC     00B5
 TMPC2    00B6    TNIF     FC7B    TNOF     FCA6    TP20     F8B6
 TP30     F8C0    TP32     F8C2    TP35     F8C4    TP40     F8CE
 TP50     F8E5    TRD      F85E    TRD2     F87F    TRD3     F882








SYMBOL TABLE

SYMBOL VALUE
 TSTOP    F8F0    TWAIT    F8E6    TWRT     F889    TWRT2    F890
 TXTPTR   0077    TXTRT    F321    TXTST    F31D    TXTTAB   0028
 TYPERR   C377    UD10     F731    UD20     F73B    UD30     F745
 UD40     F747    UD45     F755    UD50     F75C    UD60     F762
 UD65     F76C    UD70     F76D    UDST     FB7F    UDTIM    F729
 UNLSN    F183    UNLSN1   F185    UNTLK    F17F    UP1      E4D9
 UP2      E4C9    UP3      E4E8    UP5      E490    UP6      E4C4
 UP9      E4C0    USRCMD   03FA    VARTAB   002A    VER      F4B7
 VER10    F4C9    VERCK    009D    VP10     FCC0    VPRTY    FCB4
 WBLK     F886    WRAP     00DE    WREND    FC48    WRITE    FB93
 WRNC     FC41    WROA     E76A    WROA1    E76C    WROB     E775
 WRT1     FB9C    WRT2     FBF3    WRT3     FBF0    WRT4     FC38
 WRT6     FC17    WRT61    FC13    WRT62    FCC6    WRT64    FCD0
 WRT7     FC26    WRTBK    FC3E    WRTL3    FBAF    WRTN     FBB4
 WRTN1    FBCA    WRTN2    FBD7    WRTS     FBFD    WRTS1    FC09
 WRTW     FB9A    WRTWO    E784    WRTX     FB9E    WRTZ     FC54
 WSW      00B3    XR       0204    XSAV     00AD    YR       0205
 ZZ1      FEB8    ZZ10     F66B    ZZ2      FE96    ZZ3      FE22
 ZZ4      FE57    ZZ5      FECE    ZZ6      FF06    ZZ7      FF10
 ZZ8      FF10    ZZZ      F656    ZZZ1     0207   

END OF ASSEMBLY
