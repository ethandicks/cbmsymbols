bassrc......PAGE 0001

LINE# LOC   CODE        LINE


00001  0000              ;**********************************
00002  0000              ;*COMMODORE PET BASIC             *
00003  0000              ;*                                *
00004  0000              ;*VERSION 4                       *
00005  0000              ;*COPYRIGHT 1979 BY               *
00006  0000              ;*COMMODORE INTERNATIONAL LIMITED *
00007  0000              ;*ROMS PRODUCED: 901465-19        *
00008  0000              ;*               901465-20        *
00009  0000              ;*               901465-21        *
00010  0000              ;*RECONSTRUCTED: M.HOFFMANN-VETTER*
00011  0000              ;**********************************

00013  0000              OFFSET =$8000          ;RAM/ROM SWITCH
00014  0000              ROMLOC =$3000+OFFSET   ;START THIS VERSION

00016  0000              ;VERSION 1 - AUGUST 1977
00017  0000              ;     ORIGINAL MICROSOFT RELEASE
00018  0000              ;VERSION 2 - AUGUST 1978
00019  0000              ;     FIXED MANY BUGS SOME ARE:
00020  0000              ;     1) ARRAYS LIMITED TO 255
00021  0000              ;     2) NON-INTERRUPTABLE CODE
00022  0000              ;     3) GARBAGE COLLECT STRINGS
00023  0000              ;VERSION 3 - MAY 1979
00024  0000              ;     FASTER GARBAGE COLLECT
00025  0000              ;VERSION 4 - JULY 1979
00026  0000              ;     1) EXPAND RESERVED WORDS
00027  0000              ;     2) ADD DISK COMMANDS
00028  0000              ;     3) ADD DISK STATUS VARS.



00030  0000              ;*****LISTING DATE: ??? ??, ????*****



00032  0000              ;CONSTANTS FROM PET OS
00033  0000              CTIMR  =$8D            ;(TIME)
00034  0000              CSTAT  =$96            ;(SATUS)
00035  0000              CHTIM  =$E844          ;(TIL)
00036  0000              TRMPOS =$C6            ;(PNTR)
00037  0000              SIGNON =$DEA4



00039  0000              ;OS ROUTINES IN JUMP TABLE
00040  0000                     * =$7F93+OFFSET
00041  FF93              CONCAT *=*+3           ;LINK TWO FILES
00042  FF96              DOPEN  *=*+3           ;OPEN DISK FILE
00043  FF99              DCLOSE *=*+3           ;CLOSE DISK FILE(S)
00044  FF9C              RECORD *=*+3           ;POSITION REL. RECORD
00045  FF9F              FORMAT *=*+3           ;PREPARE MEDIA
00046  FFA2              COLECT *=*+3           ;VERIFY DISK BAM
00047  FFA5              BACKUP *=*+3           ;COPY WHOLE DISK
00048  FFA8              DCOPY  *=*+3           ;COPY ONE FILE
00049  FFAB              APPEND *=*+3           ;OPEN TO ADD TO FILE






bassrc......PAGE 0002

LINE# LOC   CODE        LINE


00050  FFAE              DSAVE  *=*+3           ;5AVE ERSIC PRG
00051  FFB1              DLOAD  *=*+3           ;LOAD BASIC PRG
00052  FFB4              DCAT   *=*+3           ;LIST DIRECTORY
00053  FFB7              RENAME *=*+3           ;CHANGE FILE NAME
00054  FFBA              SCRATC *=*+3           ;SCRATCH DISK FILE
00055  FFBD              READDS *=*+3           ;READ DISK STATUS
00056  FFC0              COPEN  *=*+3           ;OPEN FILE
00057  FFC3              CCLOS  *=*+3           ;CLOSE FILE
00058  FFC6              COIN   *=*+3           ;OPEN INPUT CHAHNEL
00059  FFC9              COOUT  *=*+3           ;OPEN OUTPUT CHAHHEL
00060  FFCC              CLSCHN
00061  FFCC              CCCHN  *=*+3           ;CLOSE I/O CHANNELS
00062  FFCF              INCHR
00063  FFCF              CINCH  *=*+3           ;INPUT CHARACTER(S)
00064  FFD2              OUTCH  *=*+3           ;OUTPUT CHARACTER
00065  FFD5              CLOAD  *=*+3           ;CASSETTE LOAD
00066  FFD8              CSAVE  *=*+3           ;CASSETTE SAVE
00067  FFDB              CVERF  *=*+3           ;CASSETTE VERIFY
00068  FFDE              CSYS   *=*+3           ;SYS FUNCTION
00069  FFE1              ISCNTC *=*+3           ;SCAN STOP KEY
00070  FFE4              CGETL  *=*+3           ;GET CHARACTER
00071  FFE7              CCALL  *=*+3           ;CLOSE ALL FILES





00073  FFEA              LINLEN =40
00074  FFEA              FORSIZ =@22
00075  FFEA              BUFLEN =81
00076  FFEA              ADDPRC =1
00077  FFEA              BUFPAG =2
00078  FFEA              BUF    =512
00079  FFEA              STKEND =507
00080  FFEA              CLMWID =10
00081  FFEA              PI     =255
00082  FFEA              NUMLEV =23
00083  FFEA              STRSIZ =3
00084  FFEA              RAMLOC =$0400





00086  FFEA              ;ZERO PAGE STORAGE
00087  FFEA                     * =0
00088  0000              USRPOK *=*+3
00089  0003              INTEGR
00090  0003              CHARAC *=*+1
00091  0004              ENDCHR *=*+1
00092  0005              COUNT  *=*+1
00093  0006              DIMFLG *=*+1
00094  0007              VALTYP *=*+1
00095  0008              INTFLG *=*+1
00096  0009              GARBFL 






bassrc......PAGE 0003

LINE# LOC   CODE        LINE


00097  0009              DORES  *=*+1
00098  000A              SUBFLG *=*+1
00099  000B              INPFLG *=*+1
00100  000C              DOMASK
00101  000C              TANSGN *=*+1
00102  000D              DSDESC *=*+3           ;DISK STATUS STRING
00103  0010              CHANNL *=*+1
00104  0011              POKER
00105  0011              LINNUM *=*+2
00106  0013              TEMPPT *=*+1
00107  0014              LASTPT *=*+2
00108  0016              TEMPST *=*+9
00109  001F              INDEX
00110  001F              INDEX1 *=*+2
00111  0021              INDEX2 *=*+2
00112  0023              RESHO  *=*+1
00113  0024              RESMOH *=*+1
00114  0025              ADDEND
00115  0025              RESMO  *=*+1
00116  0026              RESLO  *=*+1
00117  0027                     *=*+1
00118  0028              TXTTAB *=*+2
00119  002A              VARTAB *=*+2
00120  002C              ARYTAB *=*+2
00121  002E              STREND *=*+2
00122  0030              FRETOP *=*+2
00123  0032              FRESPC *=*+2
00124  0034              MEMSIZ *=*+2
00125  0036              CURLIN *=*+2
00126  0038              OLDLIN *=*+2
00127  003A              OLDTXT *=*+2
00128  003C              DATLIN *=*+2
00129  003E              DATPTR *=*+2
00130  0040              INPPTR *=*+2
00131  0042              VARNAM *=*+2
00132  0044              FDECPT
00133  0044              VARPNT *=*+2
00134  0046              LSTPNT
00135  0046              ANDMSK
00136  0046              FORPNT *=*+2
00137  0048              EORMSK =FORPNT+1
00138  0048              VARTXT
00139  0048              OPPTR  *=*+2
00140  004A              OPMASK *=*+1
00141  004B              GRBPNT
00142  004B              TEMPF3
00143  004B              DEFPNT *=*+2
00144  004D              DSCPNT *=*+2
00145  004F                     *=*+1
00146  0050              FOUR6  *=*+1
00147  0051              JMPER  *=*+1
00148  0052              SIZE   *=*+1
00149  0053              OLDOV  *=*+1
00150  0054              TEMPF1 *=*+1
00151  0055              ARYPNT






bassrc......PAGE 0004

LINE# LOC   CODE        LINE


00152  0055              HIGHDS *=*+2
00153  0057              HIGHTR *=*+2
00154  0059              TEMPF2 *=*+1
00155  005A              DECCNT
00156  005A              LOWDS  *=*+2
00157  005C              GRBTOP
00158  005C              DPTFLG
00159  005C              LOWTR  *=*+1
00160  005D              EXPSGN *=*+1
00161  005E              TENEXP =LOWDS+1
00162  005E              EPSGN  =LOWTR+1
00163  005E              DSCTMP
00164  005E              FAC
00165  005E              FACEXP *=*+1
00166  005F              FACHO  *=*+1
00167  0060              FACMOH *=*+1
00168  0061              INDICE
00169  0061              FACMO  *=*+1
00170  0062              FACLO  *=*+1
00171  0063              FACSGN *=*+1
00172  0064              DEGREE
00173  0064              SGNFLG *=*+1
00174  0065              BITS   *=*+1
00175  0066              ARGEXP *=*+1
00176  0067              ARGHO  *=*+1
00177  0068              ARGMOH *=*+1
00178  0069              ARGMO  *=*+1
00179  006A              ARGLO  *=*+1
00180  006B              ARGSGN *=*+1
00181  006C              STRNG1
00182  006C              ARISGN *=*+1
00183  006D              FACOV  *=*+1
00184  006E              BUFPTR
00185  006E              STRNG2
00186  006E              POLYPT
00187  006E              CURTOL
00188  006E              FBUFPT *=*+2
00189  0070              CHRGET *=*+6
00190  0076              CHRGOT *=*+1
00191  0077              TXTPTR *=*+6
00192  007D              QNUM   *=*+10
00193  0087              CHRRTS *=*+1
00194  0088              RNDX   *=*+5





00196  008D                     * =$FF
00197  00FF              LOFBUF *=*+1
00198  0100              FBUFFR *=*+1
00199  0101              .FIL   TOKENS









bassrc......PAGE 0005

LINE# LOC   CODE        LINE


00201  0101              ;STATEMENT DISPATCH TABLE
00202  0101                     * =ROMLOC



























































bassrc......PAGE 0006

LINE# LOC   CODE        LINE


00204  B000  C7 B7       STMDSP .WOR END-1
00205  B002  DD B6              .WOR FOR-1
00206  B004  18 BD              .WOR NEXT-1
00207  B006  82 B8              .WOR DATA-1
00208  B008  A3 BB              .WOR INPUTN-1
00209  B00A  BD BB              .WOR INPUT-1
00210  B00C  20 C1              .WOR DIM-1
00211  B00E  01 BC              .WOR READ-1
00212  B010  2F B9              .WOR LET-1
00213  B012  2F B8              .WOR GOTO-1
00214  B014  07 B8              .WOR RUN-1
00215  B016  B2 B8              .WOR IF-1
00216  B018  B6 B7              .WOR RESTOR-1
00217  B01A  12 B8              .WOR GOSUB-1
00218  B01C  5C B8              .WOR RETURN-1
00219  B01E  C5 B8              .WOR REM-1
00220  B020  C5 B7              .WOR STOP-1
00221  B022  D5 B8              .WOR ONGOTO-1
00222  B024  62 C9              .WOR FNWAIT-1
00223  B026  D4 FF              .WOR CLOAD-1
00224  B028  D7 FF              .WOR CSAVE-1
00225  B02A  DA FF              .WOR CVERF-1
00226  B02C  DB C4              .WOR DEF-1
00227  B02E  59 C9              .WOR POKE-1
00228  B030  87 BA              .WOR PRINTN-1
00229  B032  A7 BA              .WOR PRINT-1
00230  B034  ED B7              .WOR CONT-1
00231  B036  2F B6              .WOR LIST-1
00232  B038  ED B5              .WOR CLEAR-1
00233  B03A  8D BA              .WOR CMD-1
00234  B03C  DD FF              .WOR CSYS-1
00235  B03E  BF FF              .WOR COPEN-1
00236  B040  C2 FF              .WOR CCLOS-1
00237  B042  79 BB              .WOR GET-1
00238  B044  D1 B5              .WOR SCRATH-1
00239  B046  AB B7              .WOR GO-1
00240  B048              ;DISK COMMANLS 6/28/79
00241  B048  92 FF              .WOR CONCAT-1
00242  B04A  95 FF              .WOR DOPEN-1
00243  B04C  98 FF              .WOR DCLOSE-1
00244  B04E  9B FF              .WOR RECORD-1
00245  B050  9E FF              .WOR FORMAT-1
00246  B052  A1 FF              .WOR COLECT-1
00247  B054  A4 FF              .WOR BACKUP-1
00248  B056  A7 FF              .WOR DCOPY-1
00249  B058  AA FF              .WOR APPEND-1
00250  B05A  AD FF              .WOR DSAVE-1
00251  B05C  B0 FF              .WOR DLOAD-1
00252  B05E  B3 FF              .WOR DCAT-1
00253  B060  B6 FF              .WOR RENAME-1
00254  B062  B9 FF              .WOR SCRATC-1
00255  B064  B3 FF              .WOR DCAT-1
00256  B066  6F CD       FUNDSP .WOR SGN
00257  B068  02 CE              .WOR INT
00258  B06A  8E CD              .WOR ABS






bassrc......PAGE 0007

LINE# LOC   CODE        LINE


00259  B06C  00 00       USRLOC .WOR USRPOK
00260  B06E  A8 C4              .WOR FRE
00261  B070  C9 C4              .WOR POS
00262  B072  08 D1              .WOR SQR
00263  B074  29 D2              .WOR RND
00264  B076  20 CB              .WOR LOG
00265  B078  84 D1              .WOR EXP
00266  B07A  82 D2              .WOR COS
00267  B07C  89 D2              .WOR SIN
00268  B07E  D2 D2              .WOR TAN
00269  B080  2C D3              .WOR ATN
00270  B082  43 C9              .WOR PEEK
00271  B084  B2 C8              .WOR LEN
00272  B086  8E C5              .WOR STRD
00273  B088  E3 C8              .WOR VAL
00274  B08A  C1 C8              .WOR ASC
00275  B08C  22 C8              .WOR CHRD
00276  B08E  36 C8              .WOR LEFTD
00277  B090  62 C8              .WOR RIGHTD
00278  B092  6D C8              .WOR MIDD
00279  B094  79          OPTAB  .BYT 121
00280  B095  9F C9              .WOR FADDT-1
00281  B097  79                 .BYT 121
00282  B098  88 C9              .WOR FSUBT-1
00283  B09A  7B                 .BYT 123
00284  B09B  60 CB              .WOR FMULTT-1
00285  B09D  7B                 .BYT 123
00286  B09E  47 CC              .WOR FDIVT-1
00287  B0A0  7F                 .BYT 127
00288  B0A1  11 D1              .WOR FPWRT-1
00289  B0A3  50                 .BYT 80
00290  B0A4  88 C0              .WOR ANDOP-1
00291  B0A6  46                 .BYT 70
00292  B0A7  85 C0              .WOR OROP-1
00293  B0A9  7D          NEGTAB .BYT 125
00294  B0AA  4A D1              .WOR NEGOP-1
00295  B0AC  5A          NOTTAB .BYT 90
00296  B0AD  CB BE              .WOR NOTOP-1
00297  B0AF  64          PTDORL .BYT 100
00298  B0B0  B5 C0              .WOR DOREL-1





00300  B0B2              ;RESERVED WORD LIST

00302  B0B2  45 4E       RESLST .BYT 'EN',$C4
00302  B0B4  C4 
00303  B0B5              ENDTK  =@200
00304  B0B5  46 4F              .BYT 'FO',$D2
00304  B0B7  D2 
00305  B0B8              FORTK  =@201
00306  B0B8  4E 45 58           .BYT 'NEX',$D4
00306  B0BB  D4 






bassrc......PAGE 0008

LINE# LOC   CODE        LINE


00307  B0BC  44 41 54           .BYT 'DAT',$C1
00307  B0BF  C1 
00308  B0C0              DATATK =@203
00309  B0C0  49 4E              .BYT 'INPUT',$A3
00309  B0C5  A3 
00310  B0C6  49 4E              .BYT 'INPU',$D4
00310  B0CA  D4 
00311  B0CB  44 49              .BYT 'DI',$CD
00311  B0CD  CD 
00312  B0CE  52 45 41           .BYT 'REA',$C4
00312  B0D1  C4 
00313  B0D2  4C 45              .BYT 'LE',$D4
00313  B0D4  D4 
00314  B0D5  47 4F 54           .BYT 'GOT',$CF
00314  B0D8  CF 
00315  B0D9              GOTOTK =@211
00316  B0D9  52 55              .BYT 'RU',$CE
00316  B0DB  CE 
00317  B0DC  49                 .BYT 'I',$C6
00317  B0DD  C6 
00318  B0DE  52 45              .BYT 'RESTOR',$C5
00318  B0E4  C5 
00319  B0E5  47 4F              .BYT 'GOSU',$C2
00319  B0E9  C2 
00320  B0EA              GOSUTK =@215
00321  B0EA  52 45              .BYT 'RETUR',$CE
00321  B0EF  CE 
00322  B0F0  52 45              .BYT 'RE',$CD
00322  B0F2  CD 
00323  B0F3              REMTK  =@217
00324  B0F3  53 54 4F           .BYT 'STO',$D0
00324  B0F6  D0 
00325  B0F7  4F                 .BYT 'O',$CE
00325  B0F8  CE 
00326  B0F9  57 41 49           .BYT 'WAI',$D4
00326  B0FC  D4 
00327  B0FD  4C 4F 41           .BYT 'LOA',$C4
00327  B100  C4 
00328  B101  53 41 56           .BYT 'SAV',$C5
00328  B104  C5 
00329  B105  56 45              .BYT 'VERIF',$D9
00329  B10A  D9 
00330  B10B  44 45              .BYT 'DE',$C6
00330  B10D  C6 
00331  B10E  50 4F 4B           .BYT 'POK',$C5
00331  B111  C5 
00332  B112  50 52              .BYT 'PRINT',$A3
00332  B117  A3 
00333  B118  50 52              .BYT 'PRIN',$D4
00333  B11C  D4 
00334  B11D              PRINTK =@231
00335  B11D  43 4F 4E           .BYT 'CON',$D4
00335  B120  D4 
00336  B121  4C 49 53           .BYT 'LIS',$D4
00336  B124  D4 






bassrc......PAGE 0009

LINE# LOC   CODE        LINE


00337  B125  43 4C              .BYT 'CL',$D2
00337  B127  D2 
00338  B128  43 4D              .BYT 'CM',$C4
00338  B12A  C4 
00339  B12B  53 59              .BYT 'SY',$D3
00339  B12D  D3 
00340  B12E  4F 50 45           .BYT 'OPE',$CE
00340  B131  CE 
00341  B132  43 4C              .BYT 'CLOS',$C5
00341  B136  C5 
00342  B137  47 45              .BYT 'GE',$D4
00342  B139  D4 
00343  B13A  4E 45              .BYT 'NE',$D7
00343  B13C  D7 
00344  B13D              SCRATK =@242
00345  B13D              .FIL   TOKEN2
00346  B13D              ;TOKEN2
00347  B13D  54 41 42           .BYT 'TAB',$A8
00347  B140  A8 
00348  B141              TABTK  =@243
00349  B141  54                 .BYT 'T',$CF
00349  B142  CF 
00350  B143              TOTK   =@244
00351  B143  46                 .BYT 'F',$CE
00351  B144  CE 
00352  B145              FNTK   =@245
00353  B145  53 50 43           .BYT 'SPC',$A8
00353  B148  A8 
00354  B149              SPCTK  =@246
00355  B149  54 48 45           .BYT 'THE',$CE
00355  B14C  CE 
00356  B14D              THENTK =@247
00357  B14D  4E 4F              .BYT 'NO',$D4
00357  B14F  D4 
00358  B150              NOTTK  =@250
00359  B150  53 54 45           .BYT 'STE',$D0
00359  B153  D0 
00360  B154              STEPTK =@251
00361  B154  AB                 .BYT $AB
00362  B155              PLUSTK =@252
00363  B155  AD                 .BYT $AD
00364  B156              MINUTK =@253
00365  B156  AA                 .BYT $AA
00366  B157  AF                 .BYT $AF
00367  B158  DE                 .BYT $DE
00368  B159  41 4E              .BYT 'AN',$C4
00368  B15B  C4 
00369  B15C  4F                 .BYT 'O',$D2
00369  B15D  D2 
00370  B15E  BE                 .BYT 190
00371  B15F              GREATK =@261
00372  B15F  BD                 .BYT $BD
00373  B160              EQULTK =@262
00374  B160  BC                 .BYT 188
00375  B161              LESSTK =@263






bassrc......PAGE 000A

LINE# LOC   CODE        LINE


00376  B161  53 47              .BYT 'SG',$CE
00376  B163  CE 
00377  B164              ONEFUN =@264
00378  B164  49 4E              .BYT 'IN',$D4
00378  B166  D4 
00379  B167  41 42              .BYT 'AB',$D3
00379  B169  D3 
00380  B16A  55 53              .BYT 'US',$D2
00380  B16C  D2 
00381  B16D  46 52              .BYT 'FR',$C5
00381  B16F  C5 
00382  B170  50 4F              .BYT 'PO',$D3
00382  B172  D3 
00383  B173  53 51              .BYT 'SQ',$D2
00383  B175  D2 
00384  B176  52 4E              .BYT 'RN',$C4
00384  B178  C4 
00385  B179  4C 4F              .BYT 'LO',$C7
00385  B17B  C7 
00386  B17C  45 58              .BYT 'EX',$D0
00386  B17E  D0 
00387  B17F  43 4F              .BYT 'CO',$D3
00387  B181  D3 
00388  B182  53 49              .BYT 'SI',$CE
00388  B184  CE 
00389  B185  54 41              .BYT 'TA',$CE
00389  B187  CE 
00390  B188  41 54              .BYT 'AT',$CE
00390  B18A  CE 
00391  B18B  50 45 45           .BYT 'PEE',$CB
00391  B18E  CB 
00392  B18F  4C 45              .BYT 'LE',$CE
00392  B191  CE 
00393  B192  53 54 52           .BYT 'STR',$A4
00393  B195  A4 
00394  B196  56 41              .BYT 'VA',$CC
00394  B198  CC 
00395  B199  41 53              .BYT 'AS',$C3
00395  B19B  C3 
00396  B19C  43 48 52           .BYT 'CHR',$A4
00396  B19F  A4 
00397  B1A0              LASNUM =@307
00398  B1A0  4C 45              .BYT 'LEFT',$A4
00398  B1A4  A4 
00399  B1A5  52 49              .BYT 'RIGHT',$A4
00399  B1AA  A4 
00400  B1AB  4D 49 44           .BYT 'MID',$A4
00400  B1AE  A4 
00401  B1AF  47                 .BYT 'G',$CF
00401  B1B0  CF 
00402  B1B1              GOTK   =@313
00403  B1B1  43 4F              .BYT 'CONCA',$D4
00403  B1B6  D4 
00404  B1B7  44 4F              .BYT 'DOPE',$CE
00404  B1BB  CE 






bassrc......PAGE 000B

LINE# LOC   CODE        LINE


00405  B1BC  44 43              .BYT 'DCLOS',$C5
00405  B1C1  C5 
00406  B1C2  52 45              .BYT 'RECOR',$C4
00406  B1C7  C4 
00407  B1C8  48 45              .BYT 'HEADE',$D2
00407  B1CD  D2 
00408  B1CE  43 4F              .BYT 'COLLEC',$D4
00408  B1D4  D4 
00409  B1D5  42 41              .BYT 'BACKU',$D0
00409  B1DA  D0 
00410  B1DB  43 4F 50           .BYT 'COP',$D9
00410  B1DE  D9 
00411  B1DF  41 50              .BYT 'APPEN',$C4
00411  B1E4  C4 
00412  B1E5  44 53              .BYT 'DSAV',$C5
00412  B1E9  C5 
00413  B1EA  44 4C              .BYT 'DLOA',$C4
00413  B1EE  C4 
00414  B1EF  43 41              .BYT 'CATALO',$C7
00414  B1F5  C7 
00415  B1F6  52 45              .BYT 'RENAM',$C5
00415  B1FB  C5 
00416  B1FC  53 43              .BYT 'SCRATC',$C8
00416  B202  C8 
00417  B203  44 49              .BYT 'DIRECTOR', $D9
00417  B20B  D9 
00418  B20C  00                 .BYT 0

00420  B20D              ;BASIC ERROR MESSAGES

00422  B20D  4E 45       ERRTAB .BYT 'NEXT WITHOUT FO',$D2
00422  B21C  D2 
00423  B21D              ERRNF  =@0
00424  B21D  53 59              .BYT 'SYNTA',$D8
00424  B222  D8 
00425  B223              ERRSN  =@20
00426  B223  52 45              .BYT 'RETURN WITHOUT GOSU',$C2
00426  B236  C2 
00427  B237              ERRRG  =@26
00428  B237  4F 55              .BYT 'OUT OF DAT',$C1
00428  B241  C1 
00429  B242              ERROD  =@52
00430  B242  49 4C              .BYT 'ILLEGAL QUANTIT',$D9
00430  B251  D9 
00431  B252              ERRFC  =@65
00432  B252  4F 56              .BYT 'OVERFLO',$D7
00432  B259  D7 
00433  B25A              ERROV  =@105
00434  B25A  4F 55              .BYT 'OUT OF MEMOR',$D9
00434  B266  D9 
00435  B267              ERROM  =@115
00436  B267  55 4E              .BYT 'UNDEF',$27
00436  B26C  27 
00437  B26D  44 20              .BYT 'D STATEMEN',$D4
00437  B277  D4 






bassrc......PAGE 000C

LINE# LOC   CODE        LINE


00438  B278              ERRUS  =@132
00439  B278  42 41              .BYT 'BAD SUBSCRIP',$D4
00439  B284  D4 
00440  B285              ERRBS  =@153
00441  B285  52 45              .BYT 'REDIM',$27,'D ARRA',$D9
00441  B28A  27 
00441  B28B  44 20 
00441  B291  D9 
00442  B292              ERRDD  =@170
00443  B292  44 49              .BYT 'DIVISION BY ZER',$CF
00443  B2A1  CF 
00444  B2A2              ERRDVO =@205
00445  B2A2  49 4C              .BYT 'ILLEGAL DIREC',$D4
00445  B2AF  D4 
00446  B2B0              ERRID  =@225
00447  B2B0  54 59              .BYT 'TYPE MISMATC',$C8
00447  B2BC  C8 
00448  B2BD              ERRTM  =@243
00449  B2BD  53 54              .BYT 'STRING TOO LON',$C7
00449  B2CB  C7 
00450  B2CC              ERRLS  =@260
00451  B2CC  46 49              .BYT 'FILE DAT',$C1
00451  B2D4  C1 
00452  B2D5              ERRBD  =@277
00453  B2D5  46 4F              .BYT 'FORMULA TOO COMPLE',$D8
00453  B2E7  D8 
00454  B2E8              ERRST  =@310
00455  B2E8  43 41 4E           .BYT 'CAN',$27,'T CONTINU',$C5
00455  B2EB  27 
00455  B2EC  54 20 
00455  B2F5  C5 
00456  B2F6              ERRCN  =@333
00457  B2F6  55 4E              .BYT 'UNDEF',$27,'D FUNCTIO',$CE
00457  B2FB  27 
00457  B2FC  44 20 
00457  B305  CE 
00458  B306              ERRUF  =@351
00459  B306  20 45       ERR    .BYT ' ERROR',0
00459  B30C  00 
00460  B30D  20 49       INTXT  .BYT ' IN ',0
00460  B311  00 
00461  B312  0D          REDDY  .BYT $D,'READY.',$D,0
00461  B313  52 45 
00461  B319  0D 
00461  B31A  00 
00462  B31B  0D          BRKTXT .BYT $D,'BREAK',0
00462  B31C  42 52 
00462  B321  00 













PET BASIC......PAGE 000D

LINE# LOC   CODE        LINE


00464  B322              ;START OF INTERPRETER CODE
00465  B322  BA          FNDFOR TSX
00466  B323  E8                 INX
00467  B324  E8                 INX
00468  B325  E8                 INX
00469  B326  E8                 INX
00470  B327  BD 01 01    FFLOOP LDA 257,X
00471  B32A  C9 81              CMP #FORTK
00472  B32C  D0 21              BNE FFRTS
00473  B32E  A5 47              LDA FORPNT+1
00474  B330  D0 0A              BNE CMPFOR
00475  B332  BD 02 01           LDA 258,X
00476  B335  85 46              STA FORPNT
00477  B337  BD 03 01           LDA 259,X
00478  B33A  85 47              STA FORPNT+1
00479  B33C  DD 03 01    CMPFOR CMP 259,X
00480  B33F  D0 07              BNE ADDFRS
00481  B341  A5 46              LDA FORPNT
00482  B343  DD 02 01           CMP 258,X
00483  B346  F0 07              BEQ FFRTS
00484  B348  8A          ADDFRS TXA
00485  B349  18                 CLC
00486  B34A  69 12              ADC #FORSIZ
00487  B34C  AA                 TAX
00488  B34D  D0 D8              BNE FFLOOP
00489  B34F  60          FFRTS  RTS
00490  B350  20 A0 B3    BLTU   JSR REASON
00491  B353  85 2E              STA STREND
00492  B355  84 2F              STY STREND+1
00493  B357  38          BLTUC  SEC
00494  B358  A5 57              LDA HIGHTR
00495  B35A  E5 5C              SBC LOWTR
00496  B35C  85 1F              STA INDEX
00497  B35E  A8                 TAY
00498  B35F  A5 58              LDA HIGHTR+1
00499  B361  E5 5D              SBC LOWTR+1
00500  B363  AA                 TAX
00501  B364  E8                 INX
00502  B365  98                 TYA
00503  B366  F0 23              BEQ DECBLT
00504  B368  A5 57              LDA HIGHTR
00505  B36A  38                 SEC
00506  B36B  E5 1F              SBC INDEX
00507  B36D  85 57              STA HIGHTR
00508  B36F  B0 03              BCS BLT1
00509  B371  C6 58              DEC HIGHTR+1
00510  B373  38                 SEC
00511  B374  A5 55       BLT1   LDA HIGHDS
00512  B376  E5 1F              SBC INDEX
00513  B378  85 55              STA HIGHDS
00514  B37A  B0 08              BCS MOREN1
00515  B37C  C6 56              DEC HIGHDS+1
00516  B37E  90 04              BCC MOREN1
00517  B380  B1 57       BLTLP  LDA (HIGHTR)Y
00518  B382  91 55              STA (HIGHDS)Y






PET BASIC......PAGE 000E

LINE# LOC   CODE        LINE


00519  B384  88          MOREN1 DEY
00520  B385  D0 F9              BNE BLTLP
00521  B387  B1 57              LDA (HIGHTR),Y
00522  B389  91 55              STA (HIGHDS),Y
00523  B38B  C6 58       DECBLT DEC HIGHTR+1
00524  B38D  C6 56              DEC HIGHDS+1
00525  B38F  CA                 DEX
00526  B390  D0 F2              BNE MOREN1
00527  B392  60                 RTS
00528  B393  0A          GETSTK ASL A
00529  B394  69 3E              ADC #NUMLEV+NUMLEV+16
00530  B396  B0 35              BCS OMERR
00531  B398  85 1F              STA INDEX
00532  B39A  BA                 TSX
00533  B39B  E4 1F              CPX INDEX
00534  B39D  90 2E              BCC OMERR
00535  B39F  60                 RTS
00536  B3A0  C4 31       REASON CPY FRETOP+1
00537  B3A2  90 28              BCC REARTS
00538  B3A4  D0 04              BNE TRYMOR
00539  B3A6  C5 30              CMP FRETOP
00540  B3A8  90 22              BCC REARTS
00541  B3AA  48          TRYMOR PHA
00542  B3AB  A2 09              LDX #8+ADDPRC
00543  B3AD  98                 TYA
00544  B3AE  48          REASAV PHA
00545  B3AF  B5 54              LDA HIGHDS-1,X
00546  B3B1  CA                 DEX
00547  B3B2  10 FA              BPL REASAV
00548  B3B4  20 6A C6           JSR GARBA2
00549  B3B7  A2 F7              LDX #248-ADDPRC
00550  B3B9  68          REASTO PLA
00551  B3BA  95 5E              STA HIGHDS+8+ADDPRC,X
00552  B3BC  E8                 INX
00553  B3BD  30 FA              BMI REASTO
00554  B3BF  68                 PLA
00555  B3C0  A8                 TAY
00556  B3C1  68                 PLA
00557  B3C2  C4 31              CPY FRETOP+1
00558  B3C4  90 06              BCC REARTS
00559  B3C6  D0 05              BNE OMERR
00560  B3C8  C5 30              CMP FRETOP
00561  B3CA  B0 01              BCS OMERR
00562  B3CC  60          REARTS RTS
00563  B3CD              .FIL   CODE1
00564  B3CD              ;*****CODE1*****
00565  B3CD  A2 4D       OMERR  LDX #ERROM



00567  B3CF  A5 10       ERROR  LDA CHANNL
00568  B3D1  F0 07              BEQ ERRCRD
00569  B3D3  20 CC FF           JSR CLSCHN
00570  B3D6  A9 00              LDA #0
00571  B3D8  85 10              STA CHANNL






PET BASIC......PAGE 000F

LINE# LOC   CODE        LINE


00572  B3DA  20 DF BA    ERRCRD JSR CRDO
00573  B3DD  20 44 BB           JSR OUTQST
00574  B3E0  BD 0D B2    GETERR LDA ERRTAB,X
00575  B3E3  48                 PHA
00576  B3E4  29 7F              AND #127
00577  B3E6  20 46 BB           JSR OUTDO
00578  B3E9  E8                 INX
00579  B3EA  68                 PLA
00580  B3EB  10 F3              BPL GETERR
00581  B3ED  20 0E B6    TYPERR JSR STKINI
00582  B3F0  A9 06              LDA #<ERR
00583  B3F2  A0 B3              LDY #>ERR
00584  B3F4  20 1D BB    ERRFIN JSR STROUT
00585  B3F7  A4 37              LDY CURLIN+1
00586  B3F9  C8                 INY
00587  B3FA  F0 03              BEQ READY
00588  B3FC  20 78 CF           JSR INPRT



00590  B3FF  A9 12       READY  LDA #<REDDY
00591  B401  A0 B3              LDY #>REDDY
00592  B403  20 1D BB           JSR STROUT



00594  B406  20 E2 B4    MAIN   JSR INLIN
00595  B409  86 77              STX TXTPTR
00596  B40B  84 78              STY TXTPTR+1
00597  B40D  20 70 00           JSR CHRGET
00598  B410  AA                 TAX
00599  B411  F0 F3              BEQ MAIN
00600  B413  A2 FF              LDX #255
00601  B415  86 37              STX CURLIN+1
00602  B417  90 06              BCC MAIN1
00603  B419  20 FB B4           JSR CRUNCH
00604  B41C  4C 7C B7           JMP GONE
00605  B41F  20 F6 B8    MAIN1  JSR LINGET
00606  B422  20 FB B4           JSR CRUNCH
00607  B425  84 05              STY COUNT
00608  B427  20 A3 B5           JSR FNDLIN
00609  B42A  90 44              BCC NODEL
00610  B42C  A0 01              LDY #1
00611  B42E  B1 5C              LDA (LOWTR)Y
00612  B430  85 20              STA INDEX1+1
00613  B432  A5 2A              LDA VARTAB
00614  B434  85 1F              STA INDEX1
00615  B436  A5 5D              LDA LOWTR+1
00616  B438  85 22              STA INDEX2+1
00617  B43A  A5 5C              LDA LOWTR
00618  B43C  88                 DEY
00619  B43D  F1 5C              SBC (LOWTR)Y
00620  B43F  18                 CLC
00621  B440  65 2A              ADC VARTAB
00622  B442  85 2A              STA VARTAB






PET BASIC......PAGE 0010

LINE# LOC   CODE        LINE


00623  B444  85 21              STA INDEX2
00624  B446  A5 2B              LDA VARTAB+1
00625  B448  69 FF              ADC #255
00626  B44A  85 2B              STA VARTAB+1
00627  B44C  E5 5D              SBC LOWTR+1
00628  B44E  AA                 TAX
00629  B44F  38                 SEC
00630  B450  A5 5C              LDA LOWTR
00631  B452  E5 2A              SBC VARTAB
00632  B454  A8                 TAY
00633  B455  B0 03              BCS QDECT1
00634  B457  E8                 INX
00635  B458  C6 22              DEC INDEX2+1
00636  B45A  18          QDECT1 CLC
00637  B45B  65 1F              ADC INDEX1
00638  B45D  90 03              BCC MLOOP
00639  B45F  C6 20              DEC INDEX1+1
00640  B461  18                 CLC
00641  B462  B1 1F       MLOOP  LDA (INDEX1)Y
00642  B464  91 21              STA (INDEX2)Y
00643  B466  C8                 INY
00644  B467  D0 F9              BNE MLOOP
00645  B469  E6 20              INC INDEX1+1
00646  B46B  E6 22              INC INDEX2+1
00647  B46D  CA                 DEX
00648  B46E  D0 F2              BNE MLOOP
00649  B470  20 E9 B5    NODEL  JSR RUNC
00650  B473  20 B6 B4           JSR LNKPRG
00651  B476  AD 00 02           LDA BUF
00652  B479  F0 8B              BEQ MAIN
00653  B47B  18                 CLC
00654  B47C  A5 2A              LDA VARTAB
00655  B47E  85 57              STA HIGHTR
00656  B480  65 05              ADC COUNT
00657  B482  85 55              STA HIGHDS
00658  B484  A4 2B              LDY VARTAB+1
00659  B486  84 58              STY HIGHTR+1
00660  B488  90 01              BCC NODELC
00661  B48A  C8                 INY
00662  B48B  84 56       NODELC STY HIGHDS+1
00663  B48D  20 50 B3           JSR BLTU
00664  B490  A5 11              LDA LINNUM
00665  B492  A4 12              LDY LINNUM+1
00666  B494  8D FE 01           STA BUF-2
00667  B497  8C FF 01           STY BUF-1
00668  B49A  A5 2E              LDA STREND
00669  B49C  A4 2F              LDY STREND+1
00670  B49E  85 2A              STA VARTAB
00671  B4A0  84 2B              STY VARTAB+1
00672  B4A2  A4 05              LDY COUNT
00673  B4A4  88                 DEY
00674  B4A5  B9 FC 01    STOLOP LDA BUF-4,Y
00675  B4A8  91 5C              STA (LOWTR)Y
00676  B4AA  88                 DEY
00677  B4AB  10 F8              BPL STOLOP






PET BASIC......PAGE 0011

LINE# LOC   CODE        LINE


00678  B4AD  20 E9 B5    FINI   JSR RUNC
00679  B4B0  20 B6 B4           JSR LNKPRG
00680  B4B3  4C 06 B4           JMP MAIN
00681  B4B6  A5 28       LNKPRG LDA TXTTAB
00682  B4B8  A4 29              LDY TXTTAB+1
00683  B4BA  85 1F              STA INDEX
00684  B4BC  84 20              STY INDEX+1
00685  B4BE  18                 CLC
00686  B4BF  A0 01       CHEAD  LDY #1
00687  B4C1  B1 1F              LDA (INDEX)Y
00688  B4C3  F0 1C              BEQ LNKRTS
00689  B4C5  A0 04              LDY #4
00690  B4C7  C8          CZLOOP INY
00691  B4C8  B1 1F              LDA (INDEX)Y
00692  B4CA  D0 FB              BNE CZLOOP
00693  B4CC  C8                 INY
00694  B4CD  98                 TYA
00695  B4CE  65 1F              ADC INDEX
00696  B4D0  AA                 TAX
00697  B4D1  A0 00              LDY #0
00698  B4D3  91 1F              STA (INDEX)Y
00699  B4D5  98                 TYA
00700  B4D6  65 20              ADC INDEX+1
00701  B4D8  C8                 INY
00702  B4D9  91 1F              STA (INDEX)Y
00703  B4DB  86 1F              STX INDEX
00704  B4DD  85 20              STA INDEX+1
00705  B4DF  90 DE              BCC CHEAD
00706  B4E1  60          LNKRTS RTS
00707  B4E2  A2 00       INLIN  LDX #0
00708  B4E4  20 CF FF    INLINC JSR INCHR
00709  B4E7  C9 0D              CMP #13
00710  B4E9  F0 0D              BEQ FININ1
00711  B4EB  9D 00 02           STA BUF,X
00712  B4EE  E8                 INX
00713  B4EF  E0 51              CPX #81
00714  B4F1  D0 F1              BNE INLINC
00715  B4F3  A2 B0              LDX #ERRLS
00716  B4F5  4C CF B3           JMP ERROR
00717  B4F8  4C D2 BA    FININ1 JMP FININL
00718  B4FB              .FIL   CODE2
00719  B4FB              ;*****CODE2*****
00720  B4FB              BUFOFS =@1000
00721  B4FB  A6 77       CRUNCH LDX TXTPTR
00722  B4FD  A0 04              LDY #4
00723  B4FF  84 09              STY DORES
00724  B501  BD 00 02    KLOOP  LDA BUFOFS,X
00725  B504  10 07              BPL CMPSPC
00726  B506  C9 FF              CMP #PI
00727  B508  F0 4A              BEQ STUFFH
00728  B50A  E8                 INX
00729  B50B  D0 F4              BNE KLOOP
00730  B50D  C9 20       CMPSPC CMP #' 
00731  B50F  F0 43              BEQ STUFFH
00732  B511  85 04              STA ENDCHR






PET BASIC......PAGE 0012

LINE# LOC   CODE        LINE


00733  B513  C9 22              CMP #34
00734  B515  F0 62              BEQ STRNG
00735  B517  24 09              BIT DORES
00736  B519  70 39              BVS STUFFH
00737  B51B  C9 3F              CMP #'?
00738  B51D  D0 04              BNE KLOOP1
00739  B51F  A9 99              LDA #PRINTK
00740  B521  D0 31              BNE STUFFH
00741  B523  C9 30       KLOOP1 CMP #'0
00742  B525  90 04              BCC MUSTCR
00743  B527  C9 3C              CMP #60
00744  B529  90 29              BCC STUFFH
00745  B52B  84 6E       MUSTCR STY BUFPTR
00746  B52D  A0 00              LDY #0
00747  B52F  84 05              STY COUNT
00748  B531  86 77              STX TXTPTR
00749  B533  A9 B0              LDA #>RESLST
00750  B535  85 20              STA INDEX1+1
00751  B537  A9 B2              LDA #<RESLST
00752  B539  85 1F              STA INDEX1
00753  B53B  D0 07              BNE RESCON      ;BRANCH ALWAYS



00755  B53D  E8          RESER  INX
00756  B53E  E6 1F              INC INDEX1
00757  B540  D0 02              BNE RESCON
00758  B542  E6 20              INC INDEX1+1
00759  B544  BD 00 02    RESCON LDA BUFOFS,X
00760  B547  38                 SEC
00761  B548  F1 1F              SBC (INDEX1)Y
00762  B54A  F0 F1              BEQ RESER
00763  B54C  C9 80              CMP #128
00764  B54E  D0 30              BNE NTHIS
00765  B550  05 05              ORA COUNT
00766  B552  A4 6E       GETBPT LDY BUFPTR
00767  B554  E8          STUFFH INX
00768  B555  C8                 INY
00769  B556  99 FB 01           STA BUF-5,Y
00770  B559  B9 FB 01           LDA BUF-5,Y
00771  B55C  F0 3B              BEQ CRDONE
00772  B55E  38                 SEC
00773  B55F  E9 3A              SBC #':
00774  B561  F0 04              BEQ COLIS
00775  B563  C9 49              CMP #DATATK-$3A
00776  B565  D0 02              BNE NODATT
00777  B567  85 09       COLIS  STA DORES
00778  B569  38          NODATT SEC
00779  B56A  E9 55              SBC #REMTK-$3A
00780  B56C  D0 93              BNE KLOOP
00781  B56E  85 04              STA ENDCHR
00782  B570  BD 00 02    STR1   LDA BUFOFS,X
00783  B573  F0 DF              BEQ STUFFH
00784  B575  C5 04              CMP ENDCHR
00785  B577  F0 DB              BEQ STUFFH






PET BASIC......PAGE 0013

LINE# LOC   CODE        LINE


00786  B579  C8          STRNG  INY
00787  B57A  99 FB 01           STA BUF-5,Y
00788  B57D  E8                 INX
00789  B57E  D0 F0              BNE STR1
00790  B580  A6 77       NTHIS  LDX TXTPTR
00791  B582  E6 05              INC COUNT



00793  B584              ;LOOK FOR END OF RESERVED WORD
00794  B584  B1 1F       NTHIS1 LDA (INDEX1)Y
00795  B586  08                 PHP
00796  B587  E6 1F              INC INDEX1
00797  B589  D0 02              BNE NTHIS2
00798  B58B  E6 20              INC INDEX1+1
00799  B58D  28          NTHIS2 PLP
00800  B58E  10 F4              BPL NTHIS1



00802  B590              ;LOOK FOR END OF RESLST
00803  B590  B1 1F              LDA (INDEX1)Y
00804  B592  D0 B0              BNE RESCON
00805  B594  BD 00 02           LDA BUFOFS,X
00806  B597  10 B9              BPL GETBPT



00808  B599  99 FD 01    CRDONE STA BUF-3,Y
00809  B59C  C6 78              DEC TXTPTR+1
00810  B59E              ZZ1    =BUF-1
00811  B59E  A9 FF              LDA #<ZZ1
00812  B5A0  85 77              STA TXTPTR
00813  B5A2  60                 RTS
00814  B5A3  A5 28       FNDLIN LDA TXTTAB
00815  B5A5  A6 29              LDX TXTTAB+1
00816  B5A7  A0 01       FNDLNC LDY #1
00817  B5A9  85 5C              STA LOWTR
00818  B5AB  86 5D              STX LOWTR+1
00819  B5AD  B1 5C              LDA (LOWTR)Y
00820  B5AF  F0 1F              BEQ FLINRT
00821  B5B1  C8                 INY
00822  B5B2  C8                 INY
00823  B5B3  A5 12              LDA LINNUM+1
00824  B5B5  D1 5C              CMP (LOWTR)Y
00825  B5B7  90 18              BCC FLNRTS
00826  B5B9  F0 03              BEQ FNDLO1
00827  B5BB  88                 DEY
00828  B5BC  D0 09              BNE AFFRTS
00829  B5BE  A5 11       FNDLO1 LDA LINNUM
00830  B5C0  88                 DEY
00831  B5C1  D1 5C              CMP (LOWTR)Y
00832  B5C3  90 0C              BCC FLNRTS
00833  B5C5  F0 0A              BEQ FLNRTS
00834  B5C7  88          AFFRTS DEY






PET BASIC......PAGE 0014

LINE# LOC   CODE        LINE


00835  B5C8  B1 5C              LDA (LOWTR)Y
00836  B5CA  AA                 TAX
00837  B5CB  88                 DEY
00838  B5CC  B1 5C              LDA (LOWTR)Y
00839  B5CE  B0 D7              BCS FNDLNC
00840  B5D0  18          FLINRT CLC
00841  B5D1  60          FLNRTS RTS
00842  B5D2  D0 FD       SCRATH BNE FLNRTS
00843  B5D4  A9 00       SCRTCH LDA #0
00844  B5D6  A8                 TAY
00845  B5D7  91 28              STA (TXTTAB)Y
00846  B5D9  C8                 INY
00847  B5DA  91 28              STA (TXTTAB)Y
00848  B5DC  A5 28              LDA TXTTAB
00849  B5DE  18                 CLC
00850  B5DF  69 02              ADC #2
00851  B5E1  85 2A              STA VARTAB
00852  B5E3  A5 29              LDA TXTTAB+1
00853  B5E5  69 00              ADC #0
00854  B5E7  85 2B              STA VARTAB+1
00855  B5E9  20 22 B6    RUNC   JSR STXTPT
00856  B5EC  A9 00              LDA #0
00857  B5EE  D0 31       CLEAR  BNE STKRTS
00858  B5F0  A5 34       CLEARC LDA MEMSIZ
00859  B5F2  A4 35              LDY MEMSIZ+1
00860  B5F4  85 30              STA FRETOP
00861  B5F6  84 31              STY FRETOP+1
00862  B5F8  A9 00              LDA #0
00863  B5FA  85 0D              STA DSDESC
00864  B5FC  20 E7 FF           JSR CCALL
00865  B5FF  A5 2A              LDA VARTAB
00866  B601  A4 2B              LDY VARTAB+1
00867  B603  85 2C              STA ARYTAB
00868  B605  84 2D              STY ARYTAB+1
00869  B607  85 2E              STA STREND
00870  B609  84 2F              STY STREND+1
00871  B60B  20 B7 B7    FLOAD  JSR RESTOR
00872  B60E  A2 16       STKINI LDX #TEMPST
00873  B610  86 13              STX TEMPPT
00874  B612  68                 PLA
00875  B613  A8                 TAY
00876  B614  68                 PLA
00877  B615  A2 FA              LDX #STKEND-257
00878  B617  9A                 TXS
00879  B618  48                 PHA
00880  B619  98                 TYA
00881  B61A  48                 PHA
00882  B61B  A9 00              LDA #0
00883  B61D  85 3B              STA OLDTXT+1
00884  B61F  85 0A              STA SUBFLG
00885  B621  60          STKRTS RTS
00886  B622  18          STXTPT CLC
00887  B623  A5 28              LDA TXTTAB
00888  B625  69 FF              ADC #255
00889  B627  85 77              STA TXTPTR






PET BASIC......PAGE 0015

LINE# LOC   CODE        LINE


00890  B629  A5 29              LDA TXTTAB+1
00891  B62B  69 FF              ADC #255
00892  B62D  85 78              STA TXTPTR+1
00893  B62F  60                 RTS
00894  B630              .FIL   CODE3
00895  B630              ;*****CODE3*****
00896  B630  90 06       LIST   BCC GOLST
00897  B632  F0 04              BEQ GOLST
00898  B634  C9 AB              CMP #MINUTK
00899  B636  D0 E9              BNE STKRTS
00900  B638  20 F6 B8    GOLST  JSR LINGET
00901  B63B  20 A3 B5           JSR FNDLIN
00902  B63E  20 76 00           JSR CHRGOT
00903  B641  F0 0C              BEQ LSTEND
00904  B643  C9 AB              CMP #MINUTK
00905  B645  D0 8A              BNE FLNRTS
00906  B647  20 70 00           JSR CHRGET
00907  B64A  20 F6 B8           JSR LINGET
00908  B64D  D0 82              BNE FLNRTS
00909  B64F  68          LSTEND PLA
00910  B650  68                 PLA
00911  B651  A5 11              LDA LINNUM
00912  B653  05 12              ORA LINNUM+1
00913  B655  D0 06              BNE LIST4
00914  B657  A9 FF              LDA #255
00915  B659  85 11              STA LINNUM
00916  B65B  85 12              STA LINNUM+1
00917  B65D  A0 01       LIST4  LDY #1
00918  B65F  84 09              STY DORES
00919  B661  B1 5C              LDA (LOWTR)Y
00920  B663  F0 43              BEQ GRODY
00921  B665  20 E1 FF           JSR ISCNTC
00922  B668  20 DF BA           JSR CRDO
00923  B66B  C8                 INY
00924  B66C  B1 5C              LDA (LOWTR)Y
00925  B66E  AA                 TAX
00926  B66F  C8                 INY
00927  B670  B1 5C              LDA (LOWTR)Y
00928  B672  C5 12              CMP LINNUM+1
00929  B674  D0 04              BNE TSTDUN
00930  B676  E4 11              CPX LINNUM
00931  B678  F0 02              BEQ TYPLIN
00932  B67A  B0 2C       TSTDUN BCS GRODY
00933  B67C  84 46       TYPLIN STY LSTPNT
00934  B67E  20 83 CF           JSR LINPRT
00935  B681  A9 20              LDA #' 
00936  B683  A4 46       PRIT4  LDY LSTPNT
00937  B685  29 7F              AND #127
00938  B687  20 46 BB    PLOOP  JSR OUTDO
00939  B68A  C9 22              CMP #34
00940  B68C  D0 06              BNE PLOOP1
00941  B68E  A5 09              LDA DORES
00942  B690  49 FF              EOR #@377
00943  B692  85 09              STA DORES
00944  B694  C8          PLOOP1 INY






PET BASIC......PAGE 0016

LINE# LOC   CODE        LINE


00945  B695  F0 11              BEQ GRODY
00946  B697  B1 5C              LDA (LOWTR)Y
00947  B699  D0 10              BNE QPLOP
00948  B69B  A8                 TAY
00949  B69C  B1 5C              LDA (LOWTR)Y
00950  B69E  AA                 TAX
00951  B69F  C8                 INY
00952  B6A0  B1 5C              LDA (LOWTR)Y
00953  B6A2  86 5C              STX LOWTR
00954  B6A4  85 5D              STA LOWTR+1
00955  B6A6  D0 B5              BNE LIST4
00956  B6A8  4C FF B3    GRODY  JMP READY
00957  B6AB  10 DA       QPLOP  BPL PLOOP
00958  B6AD  C9 FF              CMP #PI
00959  B6AF  F0 D6              BEQ PLOOP
00960  B6B1  24 09              BIT DORES
00961  B6B3  30 D2              BMI PLOOP
00962  B6B5  AA                 TAX
00963  B6B6  84 46              STY LSTPNT



00965  B6B8  A0 B0              LDY #>RESLST
00966  B6BA  84 20              STY INDEX1+1
00967  B6BC  A0 B2              LDY #<RESLST
00968  B6BE  84 1F              STY INDEX1
00969  B6C0  A0 00              LDY #0
00970  B6C2  0A                 ASL A
00971  B6C3  F0 10              BEQ PRIT3B



00973  B6C5              ;POINT INDEX1 AT START OF WORD
00974  B6C5  CA          RESRCH DEX
00975  B6C6  10 0C              BPL PRIT3
00976  B6C8  E6 1F       RESCR1 INC INDEX1
00977  B6CA  D0 02              BNE RESCR2
00978  B6CC  E6 20              INC INDEX1+1
00979  B6CE  B1 1F       RESCR2 LDA (INDEX1)Y
00980  B6D0  10 F6              BPL RESCR1
00981  B6D2  30 F1              BMI RESRCH



00983  B6D4              ;LIST WORD INDEXING BY Y
00984  B6D4  C8          PRIT3  INY
00985  B6D5  B1 1F       PRIT3B LDA (INDEX1)Y
00986  B6D7  30 AA              BMI PRIT4
00987  B6D9  20 46 BB           JSR OUTDO
00988  B6DC  D0 F6              BNE PRIT3



00990  B6DE  A9 80       FOR    LDA #128
00991  B6E0  85 0A              STA SUBFLG






PET BASIC......PAGE 0017

LINE# LOC   CODE        LINE


00992  B6E2  20 30 B9           JSR LET
00993  B6E5  20 22 B3           JSR FNDFOR
00994  B6E8  D0 05              BNE NOTOL
00995  B6EA  8A                 TXA
00996  B6EB  69 0F              ADC #FORSIZ-3
00997  B6ED  AA                 TAX
00998  B6EE  9A                 TXS
00999  B6EF  68          NOTOL  PLA
01000  B6F0  68                 PLA
01001  B6F1  A9 09              LDA #8+ADDPRC
01002  B6F3  20 93 B3           JSR GETSTK
01003  B6F6  20 91 B8           JSR DATAN
01004  B6F9  18                 CLC
01005  B6FA  98                 TYA
01006  B6FB  65 77              ADC TXTPTR
01007  B6FD  48                 PHA
01008  B6FE  A5 78              LDA TXTPTR+1
01009  B700  69 00              ADC #0
01010  B702  48                 PHA
01011  B703  A5 37              LDA CURLIN+1
01012  B705  48                 PHA
01013  B706  A5 36              LDA CURLIN
01014  B708  48                 PHA
01015  B709  A9 A4              LDA #TOTK
01016  B70B  20 F7 BE           JSR SYNCHR
01017  B70E  20 87 BD           JSR CHKNUM
01018  B711  20 84 BD           JSR FRMNUM
01019  B714  A5 63              LDA FACSGN
01020  B716  09 7F              ORA #127
01021  B718  25 5F              AND FACHO
01022  B71A  85 5F              STA FACHO
01023  B71C  A9 27              LDA #<LDFONE
01024  B71E  A0 B7              LDY #>LDFONE
01025  B720  85 1F              STA INDEX1
01026  B722  84 20              STY INDEX1+1
01027  B724  4C 41 BE           JMP FORPSH
01028  B727  A9 F2       LDFONE LDA #<FONE
01029  B729  A0 CA              LDY #>FONE
01030  B72B  20 D8 CC           JSR MOVFM
01031  B72E  20 76 00           JSR CHRGOT
01032  B731  C9 A9              CMP #STEPTK
01033  B733  D0 06              BNE ONEON
01034  B735  20 70 00           JSR CHRGET
01035  B738  20 84 BD           JSR FRMNUM
01036  B73B  20 61 CD    ONEON  JSR SIGN
01037  B73E  20 32 BE           JSR PUSHF
01038  B741  A5 47              LDA FORPNT+1
01039  B743  48                 PHA
01040  B744  A5 46              LDA FORPNT
01041  B746  48                 PHA
01042  B747  A9 81              LDA #FORTK
01043  B749  48                 PHA
01044  B74A              .FIL   CODE4








CODE4......PAGE 0018

LINE# LOC   CODE        LINE


01046  B74A  20 E1 FF    NEWSTT JSR ISCNTC
01047  B74D  A5 77              LDA TXTPTR
01048  B74F  A4 78              LDY TXTPTR+1
01049  B751  C0 02              CPY #BUFPAG
01050  B753  F0 04              BEQ DIRCON
01051  B755  85 3A              STA OLDTXT
01052  B757  84 3B              STY OLDTXT+1
01053  B759  A0 00       DIRCON LDY #0
01054  B75B  B1 77              LDA (TXTPTR)Y
01055  B75D  D0 46              BNE MORSTS
01056  B75F  A0 02              LDY #2
01057  B761  B1 77              LDA (TXTPTR)Y
01058  B763  18                 CLC
01059  B764  D0 03              BNE DIRCN1
01060  B766  4C E2 B7           JMP ENDCON
01061  B769  C8          DIRCN1 INY
01062  B76A  B1 77              LDA (TXTPTR)Y
01063  B76C  85 36              STA CURLIN
01064  B76E  C8                 INY
01065  B76F  B1 77              LDA (TXTPTR)Y
01066  B771  85 37              STA CURLIN+1
01067  B773  98                 TYA
01068  B774  65 77              ADC TXTPTR
01069  B776  85 77              STA TXTPTR
01070  B778  90 02              BCC GONE
01071  B77A  E6 78              INC TXTPTR+1
01072  B77C  20 70 00    GONE   JSR CHRGET
01073  B77F  20 85 B7           JSR GONE3
01074  B782  4C 4A B7           JMP NEWSTT
01075  B785  F0 3E       GONE3  BEQ ISCRTS
01076  B787  E9 80       GONE2  SBC #ENDTK
01077  B789  90 17              BCC GLET
01078  B78B  C9 23              CMP #SCRATK-ENDTK+1
01079  B78D  90 06              BCC GONE4
01080  B78F  C9 4B              CMP #GOTK-ENDTK
01081  B791  90 16              BCC SNERR1
01082  B793  E9 28              SBC #GOTK-SCRATK-1
01083  B795  0A          GONE4  ASL A
01084  B796  A8                 TAY
01085  B797  B9 01 B0           LDA STMDSP+1,Y 
01086  B79A  48                 PHA
01087  B79B  B9 00 B0           LDA STMDSP,Y
01088  B79E  48                 PHA
01089  B79F  4C 70 00           JMP CHRGET
01090  B7A2  4C 30 B9    GLET   JMP LET
01091  B7A5  C9 3A       MORSTS CMP #':
01092  B7A7  F0 D3              BEQ GONE
01093  B7A9  4C 00 BF    SNERR1 JMP SNERR



01095  B7AC  20 76 00    GO     JSR CHRGOT
01096  B7AF  A9 A4              LDA #TOTK
01097  B7B1  20 F7 BE           JSR SYNCHR
01098  B7B4  4C 30 B8           JMP GOTO






CODE4......PAGE 0019

LINE# LOC   CODE        LINE


01099  B7B7  38          RESTOR SEC
01100  B7B8  A5 28              LDA TXTTAB
01101  B7BA  E9 01              SBC #1
01102  B7BC  A4 29              LDY TXTTAB+1
01103  B7BE  B0 01              BCS RESFIN
01104  B7C0  88                 DEY
01105  B7C1  85 3E       RESFIN STA DATPTR
01106  B7C3  84 3F              STY DATPTR+1
01107  B7C5  60          ISCRTS RTS
01108  B7C6  B0 01       STOP   BCS STOPC
01109  B7C8  18          END    CLC
01110  B7C9  D0 3C       STOPC  BNE CONTRT
01111  B7CB  A5 77              LDA TXTPTR
01112  B7CD  A4 78              LDY TXTPTR+1
01113  B7CF  A6 37              LDX CURLIN+1
01114  B7D1  E8                 INX
01115  B7D2  F0 0C              BEQ DIRIS
01116  B7D4  85 3A              STA OLDTXT
01117  B7D6  84 3B              STY OLDTXT+1
01118  B7D8  A5 36       STPEND LDA CURLIN
01119  B7DA  A4 37              LDY CURLIN+1
01120  B7DC  85 38              STA OLDLIN
01121  B7DE  84 39              STY OLDLIN+1
01122  B7E0  68          DIRIS  PLA
01123  B7E1  68                 PLA
01124  B7E2  A9 1B       ENDCON LDA #<BRKTXT
01125  B7E4  A0 B3              LDY #>BRKTXT
01126  B7E6  90 03              BCC GORDY
01127  B7E8  4C F4 B3           JMP ERRFIN
01128  B7EB  4C FF B3    GORDY  JMP READY
01129  B7EE  D0 17       CONT   BNE CONTRT
01130  B7F0  A2 DB              LDX #ERRCN
01131  B7F2  A4 3B              LDY OLDTXT+1
01132  B7F4  D0 03              BNE *+5
01133  B7F6  4C CF B3           JMP ERROR
01134  B7F9  A5 3A              LDA OLDTXT
01135  B7FB  85 77              STA TXTPTR
01136  B7FD  84 78              STY TXTPTR+1
01137  B7FF  A5 38              LDA OLDLIN
01138  B801  A4 39              LDY OLDLIN+1
01139  B803  85 36              STA CURLIN
01140  B805  84 37              STY CURLIN+1
01141  B807  60          CONTRT RTS
01142  B808  D0 03       RUN    BNE *+5
01143  B80A  4C E9 B5           JMP RUNC
01144  B80D  20 F0 B5           JSR CLEARC
01145  B810  4C 27 B8           JMP RUNC2
01146  B813  A9 03       GOSUB  LDA #3
01147  B815  20 93 B3           JSR GETSTK
01148  B818  A5 78              LDA TXTPTR+1
01149  B81A  48                 PHA
01150  B81B  A5 77              LDA TXTPTR
01151  B81D  48                 PHA
01152  B81E  A5 37              LDA CURLIN+1
01153  B820  48                 PHA






CODE4......PAGE 001A

LINE# LOC   CODE        LINE


01154  B821  A5 36              LDA CURLIN
01155  B823  48                 PHA
01156  B824  A9 8D              LDA #GOSUTK
01157  B826  48                 PHA
01158  B827  20 76 00    RUNC2  JSR CHRGOT
01159  B82A  20 30 B8           JSR GOTO
01160  B82D  4C 4A B7           JMP NEWSTT
01161  B830  20 F6 B8    GOTO   JSR LINGET
01162  B833  20 94 B8           JSR REMN
01163  B836  A5 37              LDA CURLIN+1
01164  B838  C5 12              CMP LINNUM+1
01165  B83A  B0 0B              BCS LUK4IT
01166  B83C  98                 TYA
01167  B83D  38                 SEC
01168  B83E  65 77              ADC TXTPTR
01169  B840  A6 78              LDX TXTPTR+1
01170  B842  90 07              BCC LUKALL
01171  B844  E8                 INX
01172  B845  B0 04              BCS LUKALL
01173  B847  A5 28       LUK4IT LDA TXTTAB
01174  B849  A6 29              LDX TXTTAB+1
01175  B84B  20 A7 B5    LUKALL JSR FNDLNC
01176  B84E  90 1E              BCC USERR
01177  B850  A5 5C              LDA LOWTR
01178  B852  E9 01              SBC #1
01179  B854              .FIL   CODE5



































CODE5......PAGE 001B

LINE# LOC   CODE        LINE


01181  B854  85 77              STA TXTPTR
01182  B856  A5 5D              LDA LOWTR+1
01183  B858  E9 00              SBC #0
01184  B85A  85 78              STA TXTPTR+1
01185  B85C  60          GORTS  RTS
01186  B85D  D0 FD       RETURN BNE GORTS
01187  B85F  A9 FF              LDA #255
01188  B861  85 47              STA FORPNT+1
01189  B863  20 22 B3           JSR FNDFOR
01190  B866  9A                 TXS
01191  B867  C9 8D              CMP #GOSUTK
01192  B869  F0 0B              BEQ RETU1
01193  B86B  A2 16              LDX #ERRRG
01194  B86D  2C                 .BYT $2C
01195  B86E  A2 5A       USERR  LDX #ERRUS
01196  B870  4C CF B3           JMP ERROR
01197  B873  4C 00 BF    SNERR2 JMP SNERR
01198  B876  68          RETU1  PLA
01199  B877  68                 PLA
01200  B878  85 36              STA CURLIN
01201  B87A  68                 PLA
01202  B87B  85 37              STA CURLIN+1
01203  B87D  68                 PLA
01204  B87E  85 77              STA TXTPTR
01205  B880  68                 PLA
01206  B881  85 78              STA TXTPTR+1
01207  B883  20 91 B8    DATA   JSR DATAN
01208  B886  98          ADDON  TYA
01209  B887  18                 CLC
01210  B888  65 77              ADC TXTPTR
01211  B88A  85 77              STA TXTPTR
01212  B88C  90 02              BCC REMRTS
01213  B88E  E6 78              INC TXTPTR+1
01214  B890  60          REMRTS RTS
01215  B891  A2 3A       DATAN  LDX #':
01216  B893  2C                 .BYT $2C
01217  B894  A2 00       REMN   LDX #0
01218  B896  86 03              STX CHARAC
01219  B898  A0 00              LDY #0
01220  B89A  84 04              STY ENDCHR
01221  B89C  A5 04       EXCHQT LDA ENDCHR
01222  B89E  A6 03              LDX CHARAC
01223  B8A0  85 03              STA CHARAC
01224  B8A2  86 04              STX ENDCHR
01225  B8A4  B1 77       REMER  LDA (TXTPTR)Y
01226  B8A6  F0 E8              BEQ REMRTS
01227  B8A8  C5 04              CMP ENDCHR
01228  B8AA  F0 E4              BEQ REMRTS
01229  B8AC  C8                 INY
01230  B8AD  C9 22              CMP #34
01231  B8AF  D0 F3              BNE REMER
01232  B8B1  F0 E9              BEQ EXCHQT
01233  B8B3  20 98 BD    IF     JSR FRMEVL
01234  B8B6  20 76 00           JSR CHRGOT
01235  B8B9  C9 89              CMP #GOTOTK






CODE5......PAGE 001C

LINE# LOC   CODE        LINE


01236  B8BB  F0 05              BEQ OKGOTO
01237  B8BD  A9 A7              LDA #THENTK
01238  B8BF  20 F7 BE           JSR SYNCHR
01239  B8C2  A5 5E       OKGOTO LDA FACEXP
01240  B8C4  D0 05              BNE DOCOND
01241  B8C6  20 94 B8    REM    JSR REMN
01242  B8C9  F0 BB              BEQ ADDON
01243  B8CB  20 76 00    DOCOND JSR CHRGOT
01244  B8CE  B0 03              BCS DOCO
01245  B8D0  4C 30 B8           JMP GOTO
01246  B8D3  4C 85 B7    DOCO   JMP GONE3
01247  B8D6  20 D4 C8    ONGOTO JSR GETBYT
01248  B8D9  48                 PHA
01249  B8DA  C9 8D              CMP #GOSUTK
01250  B8DC  F0 04              BEQ ONGLOP
01251  B8DE  C9 89       SNERR3 CMP #GOTOTK
01252  B8E0  D0 91              BNE SNERR2
01253  B8E2  C6 62       ONGLOP DEC FACLO
01254  B8E4  D0 04              BNE ONGLP1
01255  B8E6  68                 PLA
01256  B8E7  4C 87 B7           JMP GONE2
01257  B8EA  20 70 00    ONGLP1 JSR CHRGET
01258  B8ED  20 F6 B8           JSR LINGET
01259  B8F0  C9 2C              CMP #44
01260  B8F2  F0 EE              BEQ ONGLOP
01261  B8F4  68                 PLA
01262  B8F5  60          ONGRTS RTS
01263  B8F6  A2 00       LINGET LDX #0
01264  B8F8  86 11              STX LINNUM
01265  B8FA  86 12              STX LINNUM+1
01266  B8FC  B0 F7       MORLIN BCS ONGRTS
01267  B8FE  E9 2F              SBC #$2F
01268  B900  85 03              STA CHARAC
01269  B902  A5 12              LDA LINNUM+1
01270  B904  85 1F              STA INDEX
01271  B906  C9 19              CMP #25
01272  B908  B0 D4              BCS SNERR3
01273  B90A  A5 11              LDA LINNUM
01274  B90C  0A                 ASL A
01275  B90D  26 1F              ROL INDEX
01276  B90F  0A                 ASL A
01277  B910  26 1F              ROL INDEX
01278  B912  65 11              ADC LINNUM
01279  B914  85 11              STA LINNUM
01280  B916  A5 1F              LDA INDEX
01281  B918  65 12              ADC LINNUM+1
01282  B91A  85 12              STA LINNUM+1
01283  B91C  06 11              ASL LINNUM
01284  B91E  26 12              ROL LINNUM+1
01285  B920  A5 11              LDA LINNUM
01286  B922  65 03              ADC CHARAC
01287  B924  85 11              STA LINNUM
01288  B926  90 02              BCC NXTLGC
01289  B928  E6 12              INC LINNUM+1
01290  B92A  20 70 00    NXTLGC JSR CHRGET






CODE5......PAGE 001D

LINE# LOC   CODE        LINE


01291  B92D  4C FC B8           JMP MORLIN
01292  B930  20 2B C1    LET    JSR PTRGET
01293  B933  85 46              STA FORPNT
01294  B935  84 47              STY FORPNT+1
01295  B937  A9 B2              LDA #$B2
01296  B939  20 F7 BE           JSR SYNCHR
01297  B93C  A5 08              LDA INTFLG
01298  B93E  48                 PHA
01299  B93F  A5 07              LDA VALTYP
01300  B941  48                 PHA
01301  B942  20 98 BD           JSR FRMEVL
01302  B945  68                 PLA
01303  B946  2A                 ROL A
01304  B947  20 8A BD           JSR CHKVAL
01305  B94A  D0 18              BNE COPSTR
01306  B94C  68                 PLA
01307  B94D  10 12       QINTGR BPL COPFLT
01308  B94F  20 51 CD           JSR ROUND
01309  B952  20 EA C2           JSR AYINT
01310  B955  A0 00              LDY #0
01311  B957  A5 61              LDA FACMO
01312  B959  91 46              STA (FORPNT)Y
01313  B95B  C8                 INY
01314  B95C  A5 62              LDA FACLO
01315  B95E  91 46              STA (FORPNT)Y
01316  B960  60                 RTS
01317  B961  4C 06 CD    COPFLT JMP MOVVF
01318  B964  68          COPSTR PLA
01319  B965  A4 47       INPCOM LDY FORPNT+1
01320  B967  C0 D0              CPY #>ZERO
01321  B969  D0 4F              BNE GETSPT
01322  B96B  20 B8 C7           JSR FREFAC
01323  B96E  C9 06              CMP #6
01324  B970  D0 40              BNE FCERR2
01325  B972  A0 00              LDY #0
01326  B974  84 5E              STY FACEXP
01327  B976  84 63              STY FACSGN
01328  B978              .FIL   CODE6























CODE6......PAGE 001E

LINE# LOC   CODE        LINE


01330  B978  84 6E       TIMELP STY FBUFPT
01331  B97A  20 AB B9           JSR TIMNUM
01332  B97D  20 18 CC           JSR MUL10
01333  B980  E6 6E              INC FBUFPT
01334  B982  A4 6E              LDY FBUFPT
01335  B984  20 AB B9           JSR TIMNUM
01336  B987  20 42 CD           JSR MOVAF
01337  B98A  AA                 TAX
01338  B98B  F0 05              BEQ NOML6
01339  B98D  E8                 INX
01340  B98E  8A                 TXA
01341  B98F  20 23 CC           JSR FINML6
01342  B992  A4 6E       NOML6  LDY FBUFPT
01343  B994  C8                 INY
01344  B995  C0 06              CPY #6
01345  B997  D0 DF              BNE TIMELP
01346  B999  20 18 CC           JSR MUL10
01347  B99C  20 D1 CD           JSR QINT
01348  B99F  A2 02              LDX #2
01349  B9A1  78                 SEI
01350  B9A2  B5 60       TIMEST LDA FACMOH,X
01351  B9A4  95 8D              STA CTIMR,X
01352  B9A6  CA                 DEX
01353  B9A7  10 F9              BPL TIMEST
01354  B9A9  58                 CLI
01355  B9AA  60                 RTS
01356  B9AB  B1 1F       TIMNUM LDA (INDEX)Y
01357  B9AD  20 7D 00           JSR QNUM
01358  B9B0  90 03              BCC GOTNUM
01359  B9B2  4C 73 C3    FCERR2 JMP FCERR
01360  B9B5  E9 2F       GOTNUM SBC #$2F
01361  B9B7  4C B4 CE           JMP FINLOG
01362  B9BA  A0 02       GETSPT LDY #2
01363  B9BC  B1 61              LDA (FACMO)Y
01364  B9BE  C5 0F              CMP DSDESC+2
01365  B9C0  D0 12              BNE DSKX2
01366  B9C2  48                 PHA
01367  B9C3  88                 DEY
01368  B9C4  A5 0D              LDA DSDESC
01369  B9C6  F0 0A              BEQ DSKX1
01370  B9C8  B1 61              LDA (FACMO),Y
01371  B9CA  C5 0E              CMP DSDESC+1
01372  B9CC  D0 04              BNE DSKX1
01373  B9CE  68                 PLA
01374  B9CF  4C F6 B9           JMP COPY
01375  B9D2  68          DSKX1  PLA
01376  B9D3  C8                 INY
01377  B9D4  C5 31       DSKX2  CMP FRETOP+1
01378  B9D6  90 17              BCC DNTCPY
01379  B9D8  D0 07              BNE QVARIA
01380  B9DA  88                 DEY
01381  B9DB  B1 61              LDA (FACMO)Y
01382  B9DD  C5 30              CMP FRETOP
01383  B9DF  90 0E              BCC DNTCPY
01384  B9E1  A4 62       QVARIA LDY FACLO






CODE6......PAGE 001F

LINE# LOC   CODE        LINE


01385  B9E3  C4 2B              CPY VARTAB+1
01386  B9E5  90 08              BCC DNTCPY
01387  B9E7  D0 0D              BNE COPY
01388  B9E9  A5 61              LDA FACMO
01389  B9EB  C5 2A              CMP VARTAB
01390  B9ED  B0 07              BCS COPY
01391  B9EF  A5 61       DNTCPY LDA FACMO
01392  B9F1  A4 62              LDY FACMO+1
01393  B9F3  4C 13 BA           JMP COPYC
01394  B9F6  A0 00       COPY   LDY #0
01395  B9F8  B1 61              LDA (FACMO)Y
01396  B9FA  20 9E C5           JSR STRINI
01397  B9FD  A5 4D              LDA DSCPNT
01398  B9FF  A4 4E              LDY DSCPNT+1
01399  BA01  85 6C              STA STRNG1
01400  BA03  84 6D              STY STRNG1+1
01401  BA05  20 8C C7           JSR MOVINS
01402  BA08  A5 6C              LDA STRNG1
01403  BA0A  A4 6D              LDY STRNG1+1
01404  BA0C  20 11 C8           JSR FRETMS
01405  BA0F  A9 5E              LDA #<DSCTMP
01406  BA11  A0 00              LDY #>DSCTMP
01407  BA13  85 4D       COPYC  STA DSCPNT
01408  BA15  84 4E              STY DSCPNT+1
01409  BA17  85 1F              STA INDEX       ;INDEX ... TO NEW
01410  BA19  84 20              STY INDEX+1     ;DESCRIPT ...
01411  BA1B  20 11 C8           JSR FRETMS
01412  BA1E              ;
01413  BA1E              ; FIX THE STRINGS BY FLAGGING THE
01414  BA1E              ;OLD STRING AS GARBAGE AND THE NEW
01415  BA1E              ;STRING BY FOINTING IT TO ITS
01416  BA1E              ;NEW DESCRIPTOR
01417  BA1E              ;
01418  BA1E  20 4E BA           JSR STRADJ      ;SET UP ... STRING
01419  BA21  90 0B              BCC COPY00      ;LEAVE ...
01420  BA23  A0 00              LDY #$00
01421  BA25  A5 46              LDA FORPNT      ;PUT IN ... WARDS LINK
01422  BA27  91 1F              STA (INDEX),Y
01423  BA29  C8                 INY
01424  BA2A  A5 47              LDA FORPNT+1
01425  BA2C  91 1F              STA (INDEX),Y
01426  BA2E              ;
01427  BA2E  A5 46       COPY00 LDA FORPNT      ;FIX OLD ... RING
01428  BA30  85 1F              STA INDEX
01429  BA32  A5 47              LDA FORPNT+1
01430  BA34  85 20              STA INDEX+1
01431  BA36  20 4E BA           JSR STRADJ      ;POINT TO ... STRING
01432  BA39  90 09              BCC COPY01      ;IN TEXT ... NOT FIX
01433  BA3B  88                 DEY             ;RESTORE ...
01434  BA3C  A9 FF              LDA #$FF        ;GARBAGE ...
01435  BA3E  91 1F              STA (INDEX),Y
01436  BA40  88                 DEY
01437  BA41  8A                 TXA
01438  BA42  91 1F              STA (INDEX),Y   ;STORE L ...
01439  BA44              ;






CODE6......PAGE 0020

LINE# LOC   CODE        LINE


01440  BA44  A0 02       COPY01 LDY #$02
01441  BA46  B1 4D       COPY02 LDA (DSCPNT),Y  ;SET THE ... DESCRIPTOR
01442  BA48  91 46              STA (FORPNT),Y
01443  BA4A  88                 DEY
01444  BA4B  10 F9              BPL COPY02
01445  BA4D  60                 RTS





01447  BA4E              ;
01448  BA4E              ;SUBROUTINE STRADJ TAKES THE POINTER
01449  BA4E              ;INDEX WHICH FOINTS TO A DESCRIPTOR
01450  BA4E              ;AND INDEXES TO THE DESCIPTORS
01451  BA4E              ;5TRING DATA.
01452  BA4E              ; IF THE STRING IS FELON FRETOP
01453  BA4E              ; (NO ACTIOH TO TAKE) WE RETURN
01454  BA4E              ;WITH THE CARRY CLEAR,
01455  BA4E              ; ELSE WE RETURN MITH THE POINTER
01456  BA4E              ;SET TO THE LINK BYTES IH THE STRING
01457  BA4E              ;THE LENGTH IN ACC AND THE CARRY SET
01458  BA4E              ;
01459  BA4E  A0 00       STRADJ LDY #$00
01460  BA50  B1 1F              LDA (INDEX),Y   ;PUSH LENGTH ON STACR
01461  BA52  48                 PHA
01462  BA53  F0 30              BEQ ADJ01       ;LENGTH 0 DO NOTHING
01463  BA55  C8                 INY
01464  BA56  B1 1F              LDA (INDEX),Y   ;LO BYTE TO X
01465  BA58  AA                 TAX
01466  BA59  C8                 INY
01467  BA5A  B1 1F              LDA (INDEX)Y    ;HI BYTE IN A
01468  BA5C  30 27              BMI ADJ01       ;FREVENTS WRITING ABOVE $8000
01469  BA5E  C9 B0              CMP #>ROMLOC
01470  BA60  B0 23              BCS ADJ01
01471  BA62  C5 31              CMP FRETOP+1    ;IF BELOW FRETOP
01472  BA64  90 1F              BCC ADJ01       ;THEN RETURN TO CALLER
01473  BA66  D0 04              BNE ADJ
01474  BA68  E4 30              CPX FRETOP
01475  BA6A  90 19              BCC ADJ01
01476  BA6C  C5 0F       ADJ    CMP DSDESC+2
01477  BA6E  D0 04              BNE LBA74
01478  BA70  E4 0E              CPX DSDESC+1
01479  BA72  F0 11              BEQ ADJ01
01480  BA74  86 1F       LBA74  STX INDEX       ;OK: SET POINTER
01481  BA76  85 20              STA INDEX+1
01482  BA78  68                 PLA             ;GET BACK LEHGTH
01483  BA79  AA                 TAX             ;INTO X ALSO
01484  BA7A  18                 CLC
01485  BA7B  65 1F              ADC INDEX
01486  BA7D  85 1F              STA INDEX
01487  BA7F  90 02              BCC ADJ00
01488  BA81  E6 20              INC INDEX+1
01489  BA83  38          ADJ00  SEC             ;CARRY SET
01490  BA84  60                 RTS






CODE6......PAGE 0021

LINE# LOC   CODE        LINE


01491  BA85  68          ADJ01  PLA             ;CLEAN UP STACK
01492  BA86  18                 CLC
01493  BA87  60                 RTS





01495  BA88  20 8E BA    PRINTN JSR CMD
01496  BA8B  4C B4 BB           JMP IODONE
01497  BA8E  20 D4 C8    CMD    JSR GETBYT
01498  BA91  F0 05              BEQ SAVEIT
01499  BA93  A9 2C              LDA #44
01500  BA95  20 F7 BE           JSR SYNCHR
01501  BA98  08          SAVEIT PHP
01502  BA99  20 C9 FF           JSR COOUT
01503  BA9C  86 10              STX CHANNL
01504  BA9E  28                 PLP
01505  BA9F  4C A8 BA           JMP PRINT
01506  BAA2  20 20 BB    STRDON JSR STRPRT
01507  BAA5  20 76 00    NEWCHR JSR CHRGOT
01508  BAA8  F0 35       PRINT  BEQ CRDO
01509  BAAA  F0 43       PRINTC BEQ PRTRTS
01510  BAAC  C9 A3              CMP #TABTK
01511  BAAE  F0 4D              BEQ TABER
01512  BAB0  C9 A6              CMP #SPCTK
01513  BAB2  18                 CLC
01514  BAB3  F0 48              BEQ TABER
01515  BAB5  C9 2C              CMP #44
01516  BAB7  F0 37              BEQ COMPRT
01517  BAB9  C9 3B              CMP #59
01518  BABB  F0 55              BEQ NOTABR
01519  BABD  20 98 BD           JSR FRMEVL
01520  BAC0  24 07              BIT VALTYP
01521  BAC2  30 DE              BMI STRDON
01522  BAC4  20 93 CF           JSR FOUT
01523  BAC7  20 B0 C5           JSR STRLIT
01524  BACA  20 20 BB           JSR STRPRT
01525  BACD  20 3A BB           JSR OUTSPC
01526  BAD0  D0 D3              BNE NEWCHR
01527  BAD2  A9 00       FININL LDA #0
01528  BAD4  9D 00 02           STA BUF,X
01529  BAD7              ZZ5=BUF-1
01530  BAD7  A2 FF              LDX #<ZZ5
01531  BAD9  A0 01              LDY #>ZZ5
01532  BADB  A5 10              LDA CHANNL
01533  BADD  D0 10              BNE PRTRTS
01534  BADF  A9 0D       CRDO   LDA #13
01535  BAE1  20 46 BB           JSR OUTDO
01536  BAE4  A5 10              LDA CHANNL
01537  BAE6  10 05              BPL CRFIN
01538  BAE8  A9 0A              LDA #$0A        ;LINE FEED
01539  BAEA  20 46 BB           JSR OUTDO
01540  BAED  49 FF       CRFIN  EOR #255
01541  BAEF  60          PRTRTS RTS






CODE6......PAGE 0022

LINE# LOC   CODE        LINE


01542  BAF0  A5 C6       COMPRT LDA TRMPOS
01543  BAF2              NCMPOS =@36
01544  BAF2  38                 SEC
01545  BAF3  E9 0A       MORCO1 SBC #CLMWID
01546  BAF5  B0 FC              BCS MORCO1
01547  BAF7  49 FF              EOR #255
01548  BAF9  69 01              ADC #1
01549  BAFB  D0 10              BNE ASPAC
01550  BAFD  08          TABER  PHP
01551  BAFE  20 D1 C8           JSR GTBYTC
01552  BB01  C9 29              CMP #41
01553  BB03  D0 59              BNE SNERR4
01554  BB05  28                 PLP
01555  BB06  90 06              BCC XSPAC
01556  BB08  8A                 TXA
01557  BB09  E5 C6              SBC TRMPOS
01558  BB0B  90 05              BCC NOTABR
01559  BB0D  AA          ASPAC  TAX
01560  BB0E  E8          XSPAC  INX
01561  BB0F  CA          XSPAC2 DEX
01562  BB10  D0 06              BNE XSPAC1
01563  BB12  20 70 00    NOTABR JSR CHRGET
01564  BB15  4C AA BA           JMP PRINTC
01565  BB18              .FIL   CODE7





































CODE7......PAGE 0023

LINE# LOC   CODE        LINE


01567  BB18  20 3A BB    XSPAC1 JSR OUTSPC
01568  BB1B  D0 F2              BNE XSPAC2
01569  BB1D  20 B0 C5    STROUT JSR STRLIT
01570  BB20  20 B8 C7    STRPRT JSR FREFAC
01571  BB23  AA                 TAX
01572  BB24  A0 00              LDY #0
01573  BB26  E8                 INX
01574  BB27  CA          STRPR2 DEX
01575  BB28  F0 C5              BEQ PRTRTS
01576  BB2A  B1 1F              LDA (INDEX)Y
01577  BB2C  20 46 BB           JSR OUTDO
01578  BB2F  C8                 INY
01579  BB30  C9 0D              CMP #13
01580  BB32  D0 F3              BNE STRPR2
01581  BB34  20 ED BA           JSR CRFIN
01582  BB37  4C 27 BB           JMP STRPR2
01583  BB3A              OUTSPC
01584  BB3A  A5 10              LDA CHANNL
01585  BB3C  F0 03              BEQ CRTSKP
01586  BB3E  A9 20              LDA #' 
01587  BB40  2C                 .BYT $2C
01588  BB41  A9 1D       CRTSKP LDA #29
01589  BB43  2C                 .BYT $2C
01590  BB44  A9 3F       OUTQST LDA #'?
01591  BB46  20 D2 FF    OUTDO  JSR OUTCH
01592  BB49  29 FF       OUTRTS AND #255
01593  BB4B  60                 RTS
01594  BB4C  A5 0B       TRMNOK LDA INPFLG
01595  BB4E  F0 11              BEQ TRMNO1
01596  BB50  30 04              BMI GETDTL
01597  BB52  A0 FF              LDY #255
01598  BB54  D0 04              BNE STCURL
01599  BB56  A5 3C       GETDTL LDA DATLIN
01600  BB58  A4 3D              LDY DATLIN+1
01601  BB5A  85 36       STCURL STA CURLIN
01602  BB5C  84 37              STY CURLIN+1
01603  BB5E  4C 00 BF    SNERR4 JMP SNERR
01604  BB61  A5 10       TRMNO1 LDA CHANNL
01605  BB63  F0 05              BEQ DOAGIN
01606  BB65  A2 BF              LDX #ERRBD
01607  BB67  4C CF B3           JMP ERROR
01608  BB6A  A9 07       DOAGIN LDA #<TRYAGN
01609  BB6C  A0 BD              LDY #>TRYAGN
01610  BB6E  20 1D BB           JSR STROUT
01611  BB71  A5 3A              LDA OLDTXT
01612  BB73  A4 3B              LDY OLDTXT+1
01613  BB75  85 77              STA TXTPTR
01614  BB77  84 78              STY TXTPTR+1
01615  BB79  60                 RTS
01616  BB7A  20 CF C4    GET    JSR ERRDIR
01617  BB7D  C9 23              CMP #'#
01618  BB7F  D0 10              BNE GETTTY
01619  BB81  20 70 00           JSR CHRGET
01620  BB84  20 D4 C8           JSR GETBYT
01621  BB87  A9 2C              LDA #44






CODE7......PAGE 0024

LINE# LOC   CODE        LINE


01622  BB89  20 F7 BE           JSR SYNCHR
01623  BB8C  20 C6 FF           JSR COIN
01624  BB8F  86 10              STX CHANNL
01625  BB91              ZZ2=BUF+1
01626  BB91  A2 01       GETTTY LDX #<ZZ2
01627  BB93              ZZ3=BUF+2
01628  BB93  A0 02              LDY #>ZZ3
01629  BB95  A9 00              LDA #0
01630  BB97  8D 01 02           STA BUF+1
01631  BB9A  A9 40              LDA #64
01632  BB9C  20 0B BC           JSR INPCO1
01633  BB9F  A6 10              LDX CHANNL
01634  BBA1  D0 13              BNE IORELE
01635  BBA3  60                 RTS
01636  BBA4  20 D4 C8    INPUTN JSR GETBYT
01637  BBA7  A9 2C              LDA #44
01638  BBA9  20 F7 BE           JSR SYNCHR
01639  BBAC  20 C6 FF           JSR COIN
01640  BBAF  86 10              STX CHANNL
01641  BBB1  20 CD BB           JSR NOTQTI
01642  BBB4  A5 10       IODONE LDA CHANNL
01643  BBB6  20 CC FF    IORELE JSR CCCHN
01644  BBB9  A2 00              LDX #0
01645  BBBB  86 10              STX CHANNL
01646  BBBD  60                 RTS
01647  BBBE  C9 22       INPUT  CMP #34
01648  BBC0  D0 0B              BNE NOTQTI
01649  BBC2  20 B5 BE           JSR STRTXT
01650  BBC5  A9 3B              LDA #59
01651  BBC7  20 F7 BE           JSR SYNCHR
01652  BBCA  20 20 BB           JSR STRPRT
01653  BBCD  20 CF C4    NOTQTI JSR ERRDIR
01654  BBD0  A9 2C              LDA #44
01655  BBD2  8D FF 01           STA BUF-1
01656  BBD5  20 F5 BB    GETAGN JSR QINLIN
01657  BBD8  A5 10              LDA CHANNL
01658  BBDA  F0 0C              BEQ BUFFUL
01659  BBDC  A5 96              LDA CSTAT
01660  BBDE  29 03              AND #3
01661  BBE0  F0 06              BEQ BUFFUL
01662  BBE2  20 B4 BB           JSR IODONE
01663  BBE5  4C 83 B8           JMP DATA
01664  BBE8  AD 00 02    BUFFUL LDA BUF
01665  BBEB  D0 1C              BNE INPCON
01666  BBED  A5 10              LDA CHANNL
01667  BBEF  D0 E4              BNE GETAGN
01668  BBF1  18                 CLC
01669  BBF2  4C D8 B7           JMP STPEND
01670  BBF5  A5 10       QINLIN LDA CHANNL
01671  BBF7  D0 06              BNE GINLIN
01672  BBF9  20 44 BB           JSR OUTQST
01673  BBFC  20 3A BB           JSR OUTSPC
01674  BBFF  4C E2 B4    GINLIN JMP INLIN
01675  BC02  A6 3E       READ   LDX DATPTR
01676  BC04  A4 3F              LDY DATPTR+1






CODE7......PAGE 0025

LINE# LOC   CODE        LINE


01677  BC06  A9                 .BYT $A9
01678  BC07  98                 TYA
01679  BC08  2C                 .BYT $2C
01680  BC09  A9 00       INPCON LDA #0
01681  BC0B  85 0B       INPCO1 STA INPFLG
01682  BC0D  86 40              STX INPPTR
01683  BC0F  84 41              STY INPPTR+1
01684  BC11  20 2B C1    INLOOP JSR PTRGET
01685  BC14  85 46              STA FORPNT
01686  BC16  84 47              STY FORPNT+1
01687  BC18  A5 77              LDA TXTPTR
01688  BC1A  A4 78              LDY TXTPTR+1
01689  BC1C  85 48              STA VARTXT
01690  BC1E  84 49              STY VARTXT+1
01691  BC20  A6 40              LDX INPPTR
01692  BC22  A4 41              LDY INPPTR+1
01693  BC24  86 77              STX TXTPTR
01694  BC26  84 78              STY TXTPTR+1
01695  BC28  20 76 00           JSR CHRGOT
01696  BC2B  D0 20              BNE DATBK1
01697  BC2D  24 0B              BIT INPFLG
01698  BC2F  50 0C              BVC QDATA
01699  BC31  20 E4 FF           JSR CGETL
01700  BC34  8D 00 02           STA BUF
01701  BC37              ZZ4=BUF-1
01702  BC37  A2 FF              LDX #<ZZ4
01703  BC39  A0 01              LDY #>ZZ4
01704  BC3B  D0 0C              BNE DATBK
01705  BC3D  30 75       QDATA  BMI DATLOP
01706  BC3F  A5 10              LDA CHANNL
01707  BC41  D0 03              BNE GETNTH
01708  BC43  20 44 BB           JSR OUTQST
01709  BC46  20 F5 BB    GETNTH JSR QINLIN
01710  BC49  86 77       DATBK  STX TXTPTR
01711  BC4B  84 78              STY TXTPTR+1
01712  BC4D              .FIL   CODE8

























CODE8......PAGE 0026

LINE# LOC   CODE        LINE


01714  BC4D  20 70 00    DATBK1 JSR CHRGET
01715  BC50  24 07              BIT VALTYP
01716  BC52  10 31              BPL NUMINS
01717  BC54  24 0B              BIT INPFLG
01718  BC56  50 09              BVC SETQUT
01719  BC58  E8                 INX
01720  BC59  86 77              STX TXTPTR
01721  BC5B  A9 00              LDA #0
01722  BC5D  85 03              STA CHARAC
01723  BC5F  F0 0C              BEQ RESETC
01724  BC61  85 03       SETQUT STA CHARAC
01725  BC63  C9 22              CMP #34
01726  BC65  F0 07              BEQ NOWGET
01727  BC67  A9 3A              LDA #':
01728  BC69  85 03              STA CHARAC
01729  BC6B  A9 2C              LDA #44
01730  BC6D  18          RESETC CLC
01731  BC6E  85 04       NOWGET STA ENDCHR
01732  BC70  A5 77              LDA TXTPTR
01733  BC72  A4 78              LDY TXTPTR+1
01734  BC74  69 00              ADC #0
01735  BC76  90 01              BCC NOWGE1
01736  BC78  C8                 INY
01737  BC79  20 B6 C5    NOWGE1 JSR STRLT2
01738  BC7C  20 18 C9           JSR ST2TXT
01739  BC7F  20 65 B9           JSR INPCOM
01740  BC82  4C 8D BC           JMP STRDN2
01741  BC85  20 29 CE    NUMINS JSR FIN
01742  BC88  A5 08              LDA INTFLG
01743  BC8A  20 4D B9           JSR QINTGR
01744  BC8D  20 76 00    STRDN2 JSR CHRGOT
01745  BC90  F0 07              BEQ TRMOK
01746  BC92  C9 2C              CMP #44
01747  BC94  F0 03              BEQ *+5
01748  BC96  4C 4C BB           JMP TRMNOK
01749  BC99  A5 77       TRMOK  LDA TXTPTR
01750  BC9B  A4 78              LDY TXTPTR+1
01751  BC9D  85 40              STA INPPTR
01752  BC9F  84 41              STY INPPTR+1
01753  BCA1  A5 48              LDA VARTXT
01754  BCA3  A4 49              LDY VARTXT+1
01755  BCA5  85 77              STA TXTPTR
01756  BCA7  84 78              STY TXTPTR+1
01757  BCA9  20 76 00           JSR CHRGOT
01758  BCAC  F0 2C              BEQ VAREND
01759  BCAE  20 F5 BE           JSR CHKCOM
01760  BCB1  4C 11 BC           JMP INLOOP
01761  BCB4  20 91 B8    DATLOP JSR DATAN
01762  BCB7  C8                 INY
01763  BCB8  AA                 TAX
01764  BCB9  D0 12              BNE NOWLIN
01765  BCBB  A2 2A              LDX #ERROD
01766  BCBD  C8                 INY
01767  BCBE  B1 77              LDA (TXTPTR)Y
01768  BCC0  F0 6B              BEQ ERRGO5






CODE8......PAGE 0027

LINE# LOC   CODE        LINE


01769  BCC2  C8                 INY
01770  BCC3  B1 77              LDA (TXTPTR)Y
01771  BCC5  85 3C              STA DATLIN
01772  BCC7  C8                 INY
01773  BCC8  B1 77              LDA (TXTPTR)Y
01774  BCCA  C8                 INY
01775  BCCB  85 3D              STA DATLIN+1
01776  BCCD  B1 77       NOWLIN LDA (TXTPTR)Y
01777  BCCF  AA                 TAX
01778  BCD0  20 86 B8           JSR ADDON
01779  BCD3  E0 83              CPX #DATATK
01780  BCD5  D0 DD              BNE DATLOP
01781  BCD7  4C 4D BC           JMP DATBK1
01782  BCDA  A5 40       VAREND LDA INPPTR
01783  BCDC  A4 41              LDY INPPTR+1
01784  BCDE  A6 0B              LDX INPFLG
01785  BCE0  10 03              BPL VARY0
01786  BCE2  4C C1 B7           JMP RESFIN
01787  BCE5  A0 00       VARY0  LDY #0
01788  BCE7  B1 40              LDA (INPPTR)Y
01789  BCE9  F0 0B              BEQ INPRTS
01790  BCEB  A5 10              LDA CHANNL
01791  BCED  D0 07              BNE INPRTS
01792  BCEF  A9 F7              LDA #<EXIGNT
01793  BCF1  A0 BC              LDY #>EXIGNT
01794  BCF3  4C 1D BB           JMP STROUT
01795  BCF6  60          INPRTS RTS
01796  BCF7  3F 45       EXIGNT .BYT '?EXTRA IGNORED'
01797  BD05  0D                 .BYT $D
01798  BD06  00                 .BYT 0
01799  BD07  3F 52       TRYAGN .BYT '?REDO FROM START'
01800  BD17  0D                 .BYT $D
01801  BD18  00                 .BYT 0
01802  BD19  D0 04       NEXT   BNE GETFOR
01803  BD1B  A0 00              LDY #0
01804  BD1D  F0 03              BEQ STXFOR
01805  BD1F  20 2B C1    GETFOR JSR PTRGET
01806  BD22  85 46       STXFOR STA FORPNT
01807  BD24  84 47              STY FORPNT+1
01808  BD26  20 22 B3           JSR FNDFOR
01809  BD29  F0 04              BEQ HAVFOR
01810  BD2B  A2 00              LDX #ERRNF
01811  BD2D  F0 66       ERRGO5 BEQ ERRGO4
01812  BD2F  9A          HAVFOR TXS
01813  BD30  8A                 TXA
01814  BD31  18                 CLC
01815  BD32  69 04              ADC #4
01816  BD34  48                 PHA
01817  BD35  69 06              ADC #5+ADDPRC
01818  BD37  85 21              STA INDEX2
01819  BD39  68                 PLA
01820  BD3A  A0 01              LDY #1
01821  BD3C  20 D8 CC           JSR MOVFM
01822  BD3F  BA                 TSX
01823  BD40  BD 09 01           LDA ADDPRC+264,X






CODE8......PAGE 0028

LINE# LOC   CODE        LINE


01824  BD43  85 63              STA FACSGN
01825  BD45  A5 46              LDA FORPNT
01826  BD47  A4 47              LDY FORPNT+1
01827  BD49  20 9D C9           JSR FADD
01828  BD4C  20 06 CD           JSR MOVVF
01829  BD4F  A0 01              LDY #1
01830  BD51  20 93 CD           JSR FCOMPN
01831  BD54  BA                 TSX
01832  BD55  38                 SEC
01833  BD56  FD 09 01           SBC ADDPRC+264,X
01834  BD59  F0 17              BEQ LOOPDN
01835  BD5B  BD 0F 01           LDA 269+ADDPRC+ADDPRC,X
01836  BD5E  85 36              STA CURLIN
01837  BD60  BD 10 01           LDA 270+ADDPRC+ADDPRC,X
01838  BD63  85 37              STA CURLIN+1
01839  BD65  BD 12 01           LDA 272+ADDPRC+ADDPRC,X
01840  BD68  85 77              STA TXTPTR
01841  BD6A  BD 11 01           LDA 271+ADDPRC+ADDPRC,X
01842  BD6D  85 78              STA TXTPTR+1
01843  BD6F  4C 4A B7    NEWSGO JMP NEWSTT
01844  BD72  8A          LOOPDN TXA
01845  BD73  69 11              ADC #15+ADDPRC+ADDPRC
01846  BD75  AA                 TAX
01847  BD76  9A                 TXS
01848  BD77  20 76 00           JSR CHRGOT
01849  BD7A  C9 2C              CMP #44
01850  BD7C  D0 F1              BNE NEWSGO
01851  BD7E  20 70 00           JSR CHRGET
01852  BD81  20 1F BD           JSR GETFOR
01853  BD84  20 98 BD    FRMNUM JSR FRMEVL
01854  BD87  18          CHKNUM CLC
01855  BD88  24                 .BYT $24
01856  BD89  38          CHKSTR SEC
01857  BD8A  24 07       CHKVAL BIT VALTYP
01858  BD8C              .FIL   CODE9


























CODE9......PAGE 0029

LINE# LOC   CODE        LINE


01860  BD8C  30 03              BMI DOCSTR
01861  BD8E  B0 03              BCS CHKERR
01862  BD90  60          CHKOK  RTS
01863  BD91  B0 FD       DOCSTR BCS CHKOK
01864  BD93  A2 A3       CHKERR LDX #ERRTM
01865  BD95  4C CF B3    ERRGO4 JMP ERROR
01866  BD98  A6 77       FRMEVL LDX TXTPTR
01867  BD9A  D0 02              BNE FRMEV1
01868  BD9C  C6 78              DEC TXTPTR+1
01869  BD9E  C6 77       FRMEV1 DEC TXTPTR
01870  BDA0  A2 00              LDX #0
01871  BDA2  24                 .BYT $24
01872  BDA3  48          LPOPER PHA
01873  BDA4  8A                 TXA
01874  BDA5  48                 PHA
01875  BDA6  A9 01              LDA #1
01876  BDA8  20 93 B3           JSR GETSTK
01877  BDAB  20 81 BE           JSR EVAL
01878  BDAE  A9 00              LDA #0
01879  BDB0  85 4A              STA OPMASK
01880  BDB2  20 76 00    TSTOP  JSR CHRGOT
01881  BDB5  38          LOPREL SEC
01882  BDB6  E9 B1              SBC #GREATK
01883  BDB8  90 17              BCC ENDREL
01884  BDBA  C9 03              CMP #LESSTK-GREATK+1
01885  BDBC  B0 13              BCS ENDREL
01886  BDBE  C9 01              CMP #1
01887  BDC0  2A                 ROL A
01888  BDC1  49 01              EOR #1
01889  BDC3  45 4A              EOR OPMASK
01890  BDC5  C5 4A              CMP OPMASK
01891  BDC7  90 61              BCC SNERR5
01892  BDC9  85 4A              STA OPMASK
01893  BDCB  20 70 00           JSR CHRGET
01894  BDCE  4C B5 BD           JMP LOPREL
01895  BDD1  A6 4A       ENDREL LDX OPMASK
01896  BDD3  D0 2C              BNE FINREL
01897  BDD5  B0 7F              BCS QOP
01898  BDD7  69 07              ADC #GREATK-PLUSTK
01899  BDD9  90 7B              BCC QOP
01900  BDDB  65 07              ADC VALTYP
01901  BDDD  D0 03              BNE *+5
01902  BDDF  4C 4F C7           JMP CAT
01903  BDE2  69 FF              ADC #$FF
01904  BDE4  85 1F              STA INDEX1
01905  BDE6  0A                 ASL A
01906  BDE7  65 1F              ADC INDEX1
01907  BDE9  A8                 TAY
01908  BDEA  68          QPREC  PLA
01909  BDEB  D9 94 B0           CMP OPTAB,Y
01910  BDEE  B0 6B              BCS QCHNUM
01911  BDF0  20 87 BD           JSR CHKNUM
01912  BDF3  48          DOPREC PHA
01913  BDF4  20 1A BE    NEGPRC JSR DOPRE1
01914  BDF7  68                 PLA






CODE9......PAGE 002A

LINE# LOC   CODE        LINE


01915  BDF8  A4 48              LDY OPPTR
01916  BDFA  10 17              BPL QPREC1
01917  BDFC  AA                 TAX
01918  BDFD  F0 5A              BEQ QOPGO
01919  BDFF  D0 63              BNE PULSTK
01920  BE01  46 07       FINREL LSR VALTYP
01921  BE03  8A                 TXA
01922  BE04  2A                 ROL A
01923  BE05  A6 77              LDX TXTPTR
01924  BE07  D0 02              BNE FINRE2
01925  BE09  C6 78              DEC TXTPTR+1
01926  BE0B  C6 77       FINRE2 DEC TXTPTR
01927  BE0D  A0 1B              LDY #PTDORL-OPTAB
01928  BE0F  85 4A              STA OPMASK
01929  BE11  D0 D7              BNE QPREC
01930  BE13  D9 94 B0    QPREC1 CMP OPTAB,Y
01931  BE16  B0 4C              BCS PULSTK
01932  BE18  90 D9              BCC DOPREC
01933  BE1A  B9 96 B0    DOPRE1 LDA OPTAB+2,Y
01934  BE1D  48                 PHA
01935  BE1E  B9 95 B0           LDA OPTAB+1,Y
01936  BE21  48                 PHA
01937  BE22  20 2D BE           JSR PUSHF1
01938  BE25  A5 4A              LDA OPMASK
01939  BE27  4C A3 BD           JMP LPOPER
01940  BE2A  4C 00 BF    SNERR5 JMP SNERR
01941  BE2D  A5 63       PUSHF1 LDA FACSGN
01942  BE2F  BE 94 B0           LDX OPTAB,Y
01943  BE32  A8          PUSHF  TAY
01944  BE33  68                 PLA
01945  BE34  85 1F              STA INDEX1
01946  BE36  68                 PLA
01947  BE37  85 20              STA INDEX1+1
01948  BE39  98                 TYA
01949  BE3A  48                 PHA
01950  BE3B  E6 1F              INC INDEX1
01951  BE3D  D0 02              BNE FORPSH
01952  BE3F  E6 20              INC INDEX1+1
01953  BE41  20 51 CD    FORPSH JSR ROUND
01954  BE44  A5 62              LDA FACLO
01955  BE46  48                 PHA
01956  BE47  A5 61              LDA FACMO
01957  BE49  48                 PHA
01958  BE4A  A5 60              LDA FACMOH
01959  BE4C  48                 PHA
01960  BE4D  A5 5F              LDA FACHO
01961  BE4F  48                 PHA
01962  BE50  A5 5E              LDA FACEXP
01963  BE52  48                 PHA
01964  BE53  6C 1F 00           JMP (INDEX1)
01965  BE56  A0 FF       QOP    LDY #255
01966  BE58  68                 PLA
01967  BE59  F0 23       QOPGO  BEQ QOPRTS
01968  BE5B  C9 64       QCHNUM CMP #100
01969  BE5D  F0 03              BEQ UNPSTK






CODE9......PAGE 002B

LINE# LOC   CODE        LINE


01970  BE5F  20 87 BD           JSR CHKNUM
01971  BE62  84 48       UNPSTK STY OPPTR
01972  BE64  68          PULSTK PLA
01973  BE65  4A                 LSR A
01974  BE66  85 0C              STA DOMASK
01975  BE68  68                 PLA
01976  BE69  85 66              STA ARGEXP
01977  BE6B  68                 PLA
01978  BE6C  85 67              STA ARGHO
01979  BE6E  68                 PLA
01980  BE6F  85 68              STA ARGMOH
01981  BE71  68                 PLA
01982  BE72  85 69              STA ARGMO
01983  BE74  68                 PLA
01984  BE75  85 6A              STA ARGLO
01985  BE77  68                 PLA
01986  BE78  85 6B              STA ARGSGN
01987  BE7A  45 63              EOR FACSGN
01988  BE7C  85 6C              STA ARISGN
01989  BE7E  A5 5E       QOPRTS LDA FACEXP
01990  BE80  60          UNPRTS RTS
01991  BE81  A9 00       EVAL   LDA #0
01992  BE83  85 07              STA VALTYP
01993  BE85  20 70 00    EVAL0  JSR CHRGET
01994  BE88  B0 03              BCS EVAL2
01995  BE8A  4C 29 CE    EVAL1  JMP FIN
01996  BE8D  20 B6 C1    EVAL2  JSR ISLETC
01997  BE90  B0 7B              BCS LBF0D
01998  BE92  C9 FF              CMP #PI
01999  BE94  D0 0F              BNE QDOT
02000  BE96  A9 A0              LDA #<PIVAL
02001  BE98  A0 BE              LDY #>PIVAL
02002  BE9A  20 D8 CC           JSR MOVFM
02003  BE9D  4C 70 00           JMP CHRGET
02004  BEA0  82          PIVAL  .BYT @202
02005  BEA1  49                 .BYT @111
02006  BEA2  0F                 .BYT @017
02007  BEA3  DA                 .BYT @332
02008  BEA4  A1                 .BYT @241
02009  BEA5  C9 2E       QDOT   CMP #'.
02010  BEA7  F0 E1              BEQ EVAL1
02011  BEA9  C9 AB              CMP #MINUTK
02012  BEAB  F0 58              BEQ DOMIN
02013  BEAD  C9 AA              CMP #PLUSTK
02014  BEAF  F0 D4              BEQ EVAL0
02015  BEB1  C9 22              CMP #34
02016  BEB3  D0 0F              BNE EVAL3
02017  BEB5  A5 77       STRTXT LDA TXTPTR
02018  BEB7  A4 78              LDY TXTPTR+1
02019  BEB9  69 00              ADC #0
02020  BEBB  90 01              BCC STRTX2
02021  BEBD  C8                 INY
02022  BEBE  20 B0 C5    STRTX2 JSR STRLIT
02023  BEC1  4C 18 C9           JMP ST2TXT
02024  BEC4  C9 A8       EVAL3  CMP #NOTTK






CODE9......PAGE 002C

LINE# LOC   CODE        LINE


02025  BEC6  D0 13              BNE EVAL4
02026  BEC8  A0 18              LDY #24
02027  BECA  D0 3B              BNE GONPRC
02028  BECC  20 EA C2    NOTOP  JSR AYINT
02029  BECF  A5 62              LDA FACLO
02030  BED1  49 FF              EOR #255
02031  BED3  A8                 TAY
02032  BED4  A5 61              LDA FACMO
02033  BED6  49 FF              EOR #255
02034  BED8  4C BC C4           JMP GIVAYF
02035  BEDB  C9 A5       EVAL4  CMP #FNTK
02036  BEDD  D0 03              BNE *+5
02037  BEDF  4C 1D C5           JMP FNDOER
02038  BEE2  C9 B4              CMP #ONEFUN
02039  BEE4  90 03              BCC PARCHK
02040  BEE6  4C 47 C0           JMP ISFUN
02041  BEE9  20 F2 BE    PARCHK JSR CHKOPN
02042  BEEC  20 98 BD           JSR FRMEVL
02043  BEEF  A9 29       CHKCLS LDA #41
02044  BEF1  2C                 .BYT $2C
02045  BEF2  A9 28       CHKOPN LDA #40
02046  BEF4  2C                 .BYT $2C
02047  BEF5  A9 2C       CHKCOM LDA #44
02048  BEF7  A0 00       SYNCHR LDY #0
02049  BEF9  D1 77              CMP (TXTPTR)Y
02050  BEFB  D0 03              BNE SNERR
02051  BEFD  4C 70 00           JMP CHRGET
02052  BF00  A2 10       SNERR  LDX #ERRSN
02053  BF02  4C CF B3           JMP ERROR
02054  BF05  A0 15       DOMIN  LDY #21
02055  BF07  68          GONPRC PLA
02056  BF08  68                 PLA
02057  BF09  4C F4 BD           JMP NEGPRC
02058  BF0C              .FIL   PATCH
02059  BF0C  00          CKSUMB .BYT 0          ;B-PAGE CHECKSUM 
02060  BF0D  4C 8C BF    LBF0D  JMP ISVAR
02061  BF10                     *=*+124
02062  BF8C              .FIL   CODE10























CODE10......PAGE 002D

LINE# LOC   CODE        LINE


02064  BF8C  20 2B C1    ISVAR  JSR PTRGET
02065  BF8F  85 61       ISVRET STA FACMO
02066  BF91  84 62              STY FACLO
02067  BF93  A5 42              LDA VARNAM
02068  BF95  A4 43              LDY VARNAM+1
02069  BF97  A6 07              LDX VALTYP
02070  BF99  F0 39              BEQ GOOO
02071  BF9B  A2 00              LDX #0
02072  BF9D  86 6D              STX FACOV
02073  BF9F  A6 62              LDX FACLO       ;IS IT AN ARRAY?
02074  BFA1              ZZ8    =3000+OFFSET
02075  BFA1  E0 8B              CPX #>ZZ8       ;:ABOVE BASIC?
02076  BFA3  90 2E              BCC STRRTS      ;AN ARRAY. . .
02077  BFA5  C9 54              CMP #'T
02078  BFA7  D0 18              BNE ISVDS
02079  BFA9  C0 C9              CPY #$C9
02080  BFAB  D0 14              BNE ISVDS
02081  BFAD  20 03 C0           JSR GETTIM
02082  BFB0  84 5B              STY TENEXP
02083  BFB2  88                 DEY
02084  BFB3  84 6E              STY FBUFPT
02085  BFB5  A0 06              LDY #6
02086  BFB7  84 5A              STY DECCNT
02087  BFB9  A0 24              LDY #FDCEND-FOUTBL
02088  BFBB  20 1E D0           JSR FOUTIM
02089  BFBE  4C 98 C5           JMP TIMSTR
02090  BFC1  C9 44       ISVDS  CMP #'D
02091  BFC3  D0 0E              BNE STRRTS
02092  BFC5  C0 D3              CPY #$D3
02093  BFC7  D0 0A              BNE STRRTS
02094  BFC9  20 FC BF           JSR CHKDS
02095  BFCC  A5 0E              LDA DSDESC+1
02096  BFCE  A4 0F              LDY DSDESC+2
02097  BFD0  4C B0 C5           JMP STRLIT
02098  BFD3  60          STRRTS RTS
02099  BFD4  A6 08       GOOO   LDX INTFLG
02100  BFD6  10 0D              BPL GOOOOO
02101  BFD8  A0 00              LDY #0
02102  BFDA  B1 61              LDA (FACMO)Y
02103  BFDC  AA                 TAX
02104  BFDD  C8                 INY
02105  BFDE  B1 61              LDA (FACMO)Y
02106  BFE0  A8                 TAY
02107  BFE1  8A                 TXA
02108  BFE2  4C BC C4           JMP GIVAYF
02109  BFE5  A6 62       GOOOOO LDX FACLO       ;AN ARRAY?
02110  BFE7  E0 8B              CPX #>ZZ8
02111  BFE9  90 55              BCC GOMOVF
02112  BFEB  C9 54              CMP #'T
02113  BFED  D0 20              BNE QSTATV
02114  BFEF  C0 49              CPY #'I
02115  BFF1  D0 4D              BNE GOMOVF
02116  BFF3  20 03 C0           JSR GETTIM
02117  BFF6  98                 TYA
02118  BFF7  A2 A0              LDX #160






CODE10......PAGE 002E

LINE# LOC   CODE        LINE


02119  BFF9  4C 85 CD           JMP FLOATB
02120  BFFC              ZZ7=CTIMR-2
02121  BFFC  A5 0D       CHKDS  LDA DSDESC
02122  BFFE  D0 D3              BNE STRRTS
02123  C000  4C BD FF           JMP READDS
02124  C003  A9 8B       GETTIM LDA #<ZZ7
02125  C005  A0 00              LDY #>ZZ7
02126  C007  78                 SEI
02127  C008  20 D8 CC           JSR MOVFM
02128  C00B  58                 CLI
02129  C00C  84 5F              STY FACHO
02130  C00E  60                 RTS
02131  C00F  C9 53       QSTATV CMP #'S
02132  C011  D0 09              BNE QDSAV
02133  C013  C0 54              CPY #'T
02134  C015  D0 05              BNE QDSAV
02135  C017  A5 96              LDA CSTAT
02136  C019  4C 72 CD           JMP FLOAT
02137  C01C  C9 44       QDSAV  CMP #'D
02138  C01E  D0 20              BNE GOMOVF
02139  C020  C0 53              CPY #'S
02140  C022  D0 1C              BNE GOMOVF
02141  C024  20 FC BF           JSR CHKDS
02142  C027  A0 00              LDY #0
02143  C029  B1 0E              LDA (DSDESC+1)Y
02144  C02B  29 0F              AND #$F
02145  C02D  0A                 ASL A
02146  C02E  85 09              STA GARBFL
02147  C030  0A                 ASL A
02148  C031  0A                 ASL A
02149  C032  65 09              ADC GARBFL
02150  C034  85 09              STA GARBFL
02151  C036  C8                 INY
02152  C037  B1 0E              LDA (DSDESC+1)Y
02153  C039  29 0F              AND #$F
02154  C03B  65 09              ADC GARBFL
02155  C03D  4C 72 CD           JMP FLOAT
02156  C040  A5 61       GOMOVF LDA FACMO
02157  C042  A4 62              LDY FACMO+1
02158  C044  4C D8 CC           JMP MOVFM
02159  C047  0A          ISFUN  ASL A
02160  C048  48                 PHA
02161  C049  AA                 TAX
02162  C04A  20 70 00           JSR CHRGET
02163  C04D  E0 8F              CPX #LASNUM+LASNUM-255
02164  C04F  90 20              BCC OKNORM
02165  C051  20 F2 BE           JSR CHKOPN
02166  C054  20 98 BD           JSR FRMEVL
02167  C057  20 F5 BE           JSR CHKCOM
02168  C05A  20 89 BD           JSR CHKSTR
02169  C05D  68                 PLA
02170  C05E  AA                 TAX
02171  C05F  A5 62              LDA FACMO+1
02172  C061  48                 PHA
02173  C062  A5 61              LDA FACMO






CODE10......PAGE 002F

LINE# LOC   CODE        LINE


02174  C064  48                 PHA
02175  C065  8A                 TXA
02176  C066  48                 PHA
02177  C067  20 D4 C8           JSR GETBYT
02178  C06A  68                 PLA
02179  C06B  A8                 TAY
02180  C06C  8A                 TXA
02181  C06D  48                 PHA
02182  C06E  4C 76 C0           JMP FINGO
02183  C071  20 E9 BE    OKNORM JSR PARCHK
02184  C074  68                 PLA
02185  C075  A8                 TAY
02186  C076  B9 FE AF    FINGO  LDA FUNDSP-ONEFUN-ONEFUN+256,Y
02187  C079  85 52              STA JMPER+1
02188  C07B  B9 FF AF           LDA FUNDSP-ONEFUN-ONEFUN+257,Y
02189  C07E  85 53              STA JMPER+2
02190  C080  20 51 00           JSR JMPER
02191  C083  4C 87 BD           JMP CHKNUM
02192  C086  A0 FF       OROP   LDY #255
02193  C088  2C                 .BYT $2C
02194  C089  A0 00       ANDOP  LDY #0
02195  C08B  84 05              STY COUNT
02196  C08D  20 EA C2           JSR AYINT
02197  C090  A5 61              LDA FACMO
02198  C092  45 05              EOR COUNT
02199  C094  85 03              STA INTEGR
02200  C096  A5 62              LDA FACLO
02201  C098  45 05              EOR COUNT
02202  C09A  85 04              STA INTEGR+1
02203  C09C  20 32 CD           JSR MOVFA
02204  C09F  20 EA C2           JSR AYINT
02205  C0A2  A5 62              LDA FACLO
02206  C0A4  45 05              EOR COUNT
02207  C0A6  25 04              AND INTEGR+1
02208  C0A8  45 05              EOR COUNT
02209  C0AA  A8                 TAY
02210  C0AB  A5 61              LDA FACMO
02211  C0AD  45 05              EOR COUNT
02212  C0AF  25 03              AND INTEGR
02213  C0B1  45 05              EOR COUNT
02214  C0B3  4C BC C4           JMP GIVAYF
02215  C0B6  20 8A BD    DOREL  JSR CHKVAL
02216  C0B9  B0 13              BCS STRCMP
02217  C0BB  A5 6B              LDA ARGSGN
02218  C0BD  09 7F              ORA #127
02219  C0BF  25 67              AND ARGHO
02220  C0C1  85 67              STA ARGHO
02221  C0C3  A9 66              LDA #<ARGEXP
02222  C0C5  A0 00              LDY #>ARGEXP
02223  C0C7  20 91 CD           JSR FCOMP
02224  C0CA  AA                 TAX
02225  C0CB  4C 01 C1           JMP QCOMP
02226  C0CE  A9 00       STRCMP LDA #0
02227  C0D0  85 07              STA VALTYP
02228  C0D2  C6 4A              DEC OPMASK






CODE10......PAGE 0030

LINE# LOC   CODE        LINE


02229  C0D4  20 B8 C7           JSR FREFAC
02230  C0D7  85 5E              STA DSCTMP
02231  C0D9  86 5F              STX DSCTMP+1
02232  C0DB  84 60              STY DSCTMP+2
02233  C0DD  A5 69              LDA ARGMO
02234  C0DF  A4 6A              LDY ARGMO+1
02235  C0E1  20 BC C7           JSR FRETMP
02236  C0E4  86 69              STX ARGMO
02237  C0E6  84 6A              STY ARGMO+1
02238  C0E8  AA                 TAX
02239  C0E9  38                 SEC
02240  C0EA  E5 5E              SBC DSCTMP
02241  C0EC  F0 08              BEQ STASGN
02242  C0EE  A9 01              LDA #1
02243  C0F0  90 04              BCC STASGN
02244  C0F2  A6 5E              LDX DSCTMP
02245  C0F4  A9 FF              LDA #$FF
02246  C0F6  85 63       STASGN STA FACSGN
02247  C0F8  A0 FF              LDY #255
02248  C0FA  E8                 INX
02249  C0FB  C8          NXTCMP INY
02250  C0FC  CA                 DEX
02251  C0FD  D0 07              BNE GETCMP
02252  C0FF  A6 63              LDX FACSGN
02253  C101  30 0F       QCOMP  BMI DOCMP
02254  C103  18                 CLC
02255  C104  90 0C              BCC DOCMP
02256  C106  B1 69       GETCMP LDA (ARGMO)Y
02257  C108              .FIL   CODE11
02258  C108              ;*****CODE11*****
02259  C108  D1 5F              CMP (DSCTMP+1)Y
02260  C10A  F0 EF              BEQ NXTCMP
02261  C10C  A2 FF              LDX #$FF
02262  C10E  B0 02              BCS DOCMP
02263  C110  A2 01              LDX #1
02264  C112  E8          DOCMP  INX
02265  C113  8A                 TXA
02266  C114  2A                 ROL A
02267  C115  25 0C              AND DOMASK
02268  C117  F0 02              BEQ GOFLOT
02269  C119  A9 FF              LDA #$FF
02270  C11B  4C 72 CD    GOFLOT JMP FLOAT
02271  C11E  20 F5 BE    DIM3   JSR CHKCOM
02272  C121  AA          DIM    TAX
02273  C122  20 30 C1           JSR PTRGT1
02274  C125  20 76 00           JSR CHRGOT
02275  C128  D0 F4              BNE DIM3
02276  C12A  60                 RTS
02277  C12B  A2 00       PTRGET LDX #0
02278  C12D  20 76 00           JSR CHRGOT
02279  C130  86 06       PTRGT1 STX DIMFLG
02280  C132  85 42       PTRGT2 STA VARNAM
02281  C134  20 76 00           JSR CHRGOT
02282  C137  20 B6 C1           JSR ISLETC
02283  C13A  B0 03              BCS PTRGT3






CODE10......PAGE 0031

LINE# LOC   CODE        LINE


02284  C13C  4C 00 BF    INTERR JMP SNERR
02285  C13F  A2 00       PTRGT3 LDX #0
02286  C141  86 07              STX VALTYP
02287  C143  86 08              STX INTFLG
02288  C145  20 70 00           JSR CHRGET
02289  C148  90 05              BCC ISSEC
02290  C14A  20 B6 C1           JSR ISLETC
02291  C14D  90 0B              BCC NOSEC
02292  C14F  AA          ISSEC  TAX
02293  C150  20 70 00    EATEM  JSR CHRGET
02294  C153  90 FB              BCC EATEM
02295  C155  20 B6 C1           JSR ISLETC
02296  C158  B0 F6              BCS EATEM
02297  C15A  C9 24       NOSEC  CMP #'$
02298  C15C  D0 06              BNE NOTSTR
02299  C15E  A9 FF              LDA #$FF
02300  C160  85 07              STA VALTYP
02301  C162  D0 10              BNE TURNON
02302  C164  C9 25       NOTSTR CMP #'%
02303  C166  D0 13              BNE STRNAM
02304  C168  A5 0A              LDA SUBFLG
02305  C16A  D0 D0              BNE INTERR
02306  C16C  A9 80              LDA #128
02307  C16E  85 08              STA INTFLG
02308  C170  05 42              ORA VARNAM
02309  C172  85 42              STA VARNAM
02310  C174  8A          TURNON TXA
02311  C175  09 80              ORA #128
02312  C177  AA                 TAX
02313  C178  20 70 00           JSR CHRGET
02314  C17B  86 43       STRNAM STX VARNAM+1
02315  C17D  38                 SEC
02316  C17E  05 0A              ORA SUBFLG
02317  C180  E9 28              SBC #40
02318  C182  D0 03              BNE *+5
02319  C184  4C FC C2           JMP ISARY
02320  C187  A0 00              LDY #0
02321  C189  84 0A              STY SUBFLG
02322  C18B  A5 2A              LDA VARTAB
02323  C18D  A6 2B              LDX VARTAB+1
02324  C18F  86 5D       STXFND STX LOWTR+1
02325  C191  85 5C       LOPFND STA LOWTR
02326  C193  E4 2D              CPX ARYTAB+1
02327  C195  D0 04              BNE LOPFN
02328  C197  C5 2C              CMP ARYTAB
02329  C199  F0 25              BEQ NOTFNS
02330  C19B  A5 42       LOPFN  LDA VARNAM
02331  C19D  D1 5C              CMP (LOWTR)Y
02332  C19F  D0 0B              BNE NOTIT
02333  C1A1  A5 43              LDA VARNAM+1
02334  C1A3  C8                 INY
02335  C1A4  D1 5C              CMP (LOWTR)Y
02336  C1A6  D0 03              BNE NXTPTR
02337  C1A8  4C B9 C2           JMP FINPTR
02338  C1AB  88          NXTPTR DEY






CODE10......PAGE 0032

LINE# LOC   CODE        LINE


02339  C1AC  18          NOTIT  CLC
02340  C1AD  A5 5C              LDA LOWTR
02341  C1AF  69 07              ADC #6+ADDPRC
02342  C1B1  90 DE              BCC LOPFND
02343  C1B3  E8                 INX
02344  C1B4  D0 D9              BNE STXFND
02345  C1B6  C9 41       ISLETC CMP #'A
02346  C1B8  90 05              BCC ISLRTS
02347  C1BA  E9 5B              SBC #$5B
02348  C1BC  38                 SEC
02349  C1BD  E9 A5              SBC #@245
02350  C1BF  60          ISLRTS RTS
02351  C1C0  68          NOTFNS PLA
02352  C1C1  48                 PHA
02353  C1C2              ZZ6=ISVRET-1
02354  C1C2  C9 8E              CMP #<ZZ6
02355  C1C4  D0 05              BNE NOTEVL
02356  C1C6  A9 C9       LDZR   LDA #<ZERO
02357  C1C8  A0 D0              LDY #>ZERO
02358  C1CA  60                 RTS
02359  C1CB  A5 42       NOTEVL LDA VARNAM
02360  C1CD  A4 43              LDY VARNAM+1
02361  C1CF  C9 54              CMP #'T
02362  C1D1  D0 0B              BNE QSTAVR
02363  C1D3  C0 C9              CPY #@311
02364  C1D5  F0 EF              BEQ LDZR
02365  C1D7  C0 49              CPY #@111
02366  C1D9  D0 03              BNE QSTAVR
02367  C1DB  4C 00 BF    GOBADV JMP SNERR
02368  C1DE  C9 53       QSTAVR CMP #'S
02369  C1E0  D0 04              BNE QDSVAR
02370  C1E2  C0 54              CPY #'T
02371  C1E4  F0 F5              BEQ GOBADV
02372  C1E6  C9 44       QDSVAR CMP #'D         ;DISK STATUS?
02373  C1E8  D0 08              BNE VAROK
02374  C1EA  C0 53              CPY #'S
02375  C1EC  F0 ED              BEQ GOBADV      ;CANNOT MODIFY D5
02376  C1EE  C0 D3              CPY #$D3
02377  C1F0  F0 E9              BEQ GOBADV      ;CANNOT MODIFY DS$
02378  C1F2  A5 2C       VAROK  LDA ARYTAB
02379  C1F4  A4 2D              LDY ARYTAB+1
02380  C1F6  85 5C              STA LOWTR
02381  C1F8  84 5D              STY LOWTR+1
02382  C1FA  A5 2E              LDA STREND
02383  C1FC  A4 2F              LDY STREND+1
02384  C1FE  85 57              STA HIGHTR
02385  C200  84 58              STY HIGHTR+1
02386  C202  18                 CLC
02387  C203  69 07              ADC #6+ADDPRC
02388  C205  90 01              BCC NOTEVE
02389  C207  C8                 INY
02390  C208  85 55       NOTEVE STA HIGHDS
02391  C20A  84 56              STY HIGHDS+1
02392  C20C  20 50 B3           JSR BLTU
02393  C20F  A5 55              LDA HIGHDS






CODE10......PAGE 0033

LINE# LOC   CODE        LINE


02394  C211  A4 56              LDY HIGHDS+1
02395  C213  C8                 INY
02396  C214  85 2C              STA ARYTAB
02397  C216  84 2D              STY ARYTAB+1
02398  C218  85 55              STA ARYPNT      ;SET FOINTER TO ARRAYS
02399  C21A  84 56              STY ARYPNT+1
02400  C21C  A5 55       ARYVA2 LDA ARYPNT
02401  C21E  A6 56              LDX ARYPNT+1
02402  C220  E4 2F       ARYVA3 CPX STREND+1    ;END OF ARRAYS ?
02403  C222  D0 04              BNE ARYVGO
02404  C224  C5 2E              CMP STREND
02405  C226  F0 75              BEQ ARYDON      ;FINISHED...
02406  C228  85 1F       ARYVGO STA INDEX1      ;PARSE THE ARRAY
02407  C22A  86 20              STX INDEX1+1
02408  C22C  A0 00              LDY #1-ADDPRC
02409  C22E  B1 1F              LDA (INDEX1),Y  ;ARRAY NAME
02410  C230  AA                 TAX
02411  C231  C8                 INY
02412  C232  B1 1F              LDA (INDEX1),Y  ;NAME 2ND CHAR
02413  C234  08                 PHP             ;SAVE STATUS REG
02414  C235  C8                 INY
02415  C236  B1 1F              LDA (INDEX1),Y  ;POINT TO HEXT ARRAY
02416  C238  65 55              ADC ARYPNT
02417  C23A  85 55              STA ARYPNT
02418  C23C  C8                 INY
02419  C23D  B1 1F              LDA (INDEX1),Y
02420  C23F  65 56              ADC ARYPNT+1
02421  C241  85 56              STA ARYPNT+1
02422  C243  28                 PLP             ;RESTORE STATUS
02423  C244  10 D6              BPL ARYVA2      ;NOT A STRING TYPE
02424  C246  8A                 TXA
02425  C247  30 D3              BMI ARYVA2      ;NOT A STRING ARRAY
02426  C249  C8                 INY             ;OK WE HAYE A STRING ARRAY
02427  C24A  B1 1F              LDA (INDEX1),Y
02428  C24C  A0 00              LDY #$00
02429  C24E  0A                 ASL A
02430  C24F  69 05              ADC #5
02431  C251  65 1F              ADC INDEX1
02432  C253  85 1F              STA INDEX1
02433  C255  90 02              BCC ARYGET
02434  C257  E6 20              INC INDEX1+1
02435  C259  A6 20       ARYGET LDX INDEX1+1    ;PARSE ARRAY
02436  C25B  E4 56              CPX ARYPNT+1    ;DONE WITH THIS ARRAY ?
02437  C25D  D0 04              BNE GOGO
02438  C25F  C5 55              CMP ARYPNT
02439  C261  F0 BD              BEQ ARYVA3      ;YES...
02440  C263  A0 00       GOGO   LDY #$00        ;PROCESS STRING FOINTER
02441  C265  B1 1F              LDA (INDEX1),Y
02442  C267  F0 27              BEQ DVARTS      ;NO STRING...GO ON...
02443  C269  C8                 INY
02444  C26A  18                 CLC
02445  C26B  71 1F              ADC (INDEX1),Y
02446  C26D  85 57              STA HIGHTR
02447  C26F  AA                 TAX             ;SAVE IS X FOR CHECK
02448  C270  C8                 INY






CODE10......PAGE 0034

LINE# LOC   CODE        LINE


02449  C271  B1 1F              LDA (INDEX1),Y
02450  C273  69 00              ADC #$00        ;ADJUST HIGH BYTE
02451  C275  85 58              STA HIGHTR+1
02452  C277  C5 31              CMP FRETOP+1    ;NO FIX IF BELOW FRETOP
02453  C279  90 15              BCC DVARTS
02454  C27B  D0 04              BNE GOGO1
02455  C27D  E4 30              CPX FRETOP
02456  C27F  90 0F              BCC DVARTS
02457  C281              ;FIX BACKWARDS POINTER BY ADDING
02458  C281              ;MOVE LEHSTH TO IT
02459  C281  A0 00       GOGO1  LDY #$00
02460  C283  B1 57              LDA (HIGHTR),Y
02461  C285  69 06              ADC #6+ADDPRC-1 ;CARRY SET (CAREFUL)
02462  C287  91 57              STA (HIGHTR),Y
02463  C289  C8                 INY
02464  C28A  B1 57              LDA (HIGHTR),Y
02465  C28C  69 00              ADC #$00
02466  C28E  91 57              STA (HIGHTR),Y  ;DONE WITH THIS STR.
02467  C290              ;FIX THE NEXT STRING IN THE ARRAY
02468  C290  A9 03       DVARTS LDA #STRSIZ     ;BUMP BY FOUR6
02469  C292  18                 CLC
02470  C293  65 1F              ADC INDEX1
02471  C295  85 1F              STA INDEX1
02472  C297  90 C0              BCC ARYGET
02473  C299  E6 20              INC INDEX1+1
02474  C29B  D0 BC              BNE ARYGET      ;BRAHCH ALWAYS
02475  C29D              ;
02476  C29D  A0 00       ARYDON LDY #0
02477  C29F  A5 42              LDA VARNAM
02478  C2A1  91 5C              STA (LOWTR)Y
02479  C2A3  C8                 INY
02480  C2A4  A5 43              LDA VARNAM+1
02481  C2A6  91 5C              STA (LOWTR)Y
02482  C2A8  A9 00              LDA #0
02483  C2AA  C8                 INY
02484  C2AB  91 5C              STA (LOWTR)Y
02485  C2AD  C8                 INY
02486  C2AE  91 5C              STA (LOWTR)Y
02487  C2B0  C8                 INY
02488  C2B1  91 5C              STA (LOWTR)Y
02489  C2B3  C8                 INY
02490  C2B4  91 5C              STA (LOWTR)Y
02491  C2B6  C8                 INY
02492  C2B7  91 5C              STA (LOWTR)Y
02493  C2B9  A5 5C       FINPTR LDA LOWTR
02494  C2BB  18                 CLC
02495  C2BC  69 02              ADC #2
02496  C2BE  A4 5D              LDY LOWTR+1
02497  C2C0  90 01              BCC FINNOW
02498  C2C2  C8                 INY
02499  C2C3  85 44       FINNOW STA VARPNT
02500  C2C5  84 45              STY VARPNT+1
02501  C2C7  60                 RTS
02502  C2C8  A5 05       FMAPTR LDA COUNT
02503  C2CA  0A                 ASL A






CODE10......PAGE 0035

LINE# LOC   CODE        LINE


02504  C2CB  69 05              ADC #5
02505  C2CD  65 5C              ADC LOWTR
02506  C2CF  A4 5D              LDY LOWTR+1
02507  C2D1  90 01              BCC JSRGM
02508  C2D3  C8                 INY
02509  C2D4  85 55       JSRGM  STA ARYPNT
02510  C2D6  84 56              STY ARYPNT+1
02511  C2D8  60                 RTS
02512  C2D9              .FIL   CODE12
02513  C2D9              ;*****CODE12*****
02514  C2D9  90          N32768 .BYT 144,128,0,0
02514  C2DA  80 
02514  C2DB  00 
02514  C2DC  00 
02515  C2DD  20 70 00    INTIDX JSR CHRGET
02516  C2E0  20 98 BD           JSR FRMEVL
02517  C2E3  20 87 BD    POSINT JSR CHKNUM
02518  C2E6  A5 63              LDA FACSGN
02519  C2E8  30 0D              BMI NONONO
02520  C2EA  A5 5E       AYINT  LDA FACEXP
02521  C2EC  C9 90              CMP #144
02522  C2EE  90 09              BCC QINTGO
02523  C2F0  A9 D9              LDA #<N32768
02524  C2F2  A0 C2              LDY #>N32768
02525  C2F4  20 91 CD           JSR FCOMP
02526  C2F7  D0 7A       NONONO BNE FCERR
02527  C2F9  4C D1 CD    QINTGO JMP QINT
02528  C2FC  A5 06       ISARY  LDA DIMFLG
02529  C2FE  05 08              ORA INTFLG
02530  C300  48                 PHA
02531  C301  A5 07              LDA VALTYP
02532  C303  48                 PHA
02533  C304  A0 00              LDY #0
02534  C306  98          INDLOP TYA
02535  C307  48                 PHA
02536  C308  A5 43              LDA VARNAM+1
02537  C30A  48                 PHA
02538  C30B  A5 42              LDA VARNAM
02539  C30D  48                 PHA
02540  C30E  20 DD C2           JSR INTIDX
02541  C311  68                 PLA
02542  C312  85 42              STA VARNAM
02543  C314  68                 PLA
02544  C315  85 43              STA VARNAM+1
02545  C317  68                 PLA
02546  C318  A8                 TAY
02547  C319  BA                 TSX
02548  C31A  BD 02 01           LDA 258,X
02549  C31D  48                 PHA
02550  C31E  BD 01 01           LDA 257,X
02551  C321  48                 PHA
02552  C322  A5 61              LDA INDICE
02553  C324  9D 02 01           STA 258,X
02554  C327  A5 62              LDA INDICE+1
02555  C329  9D 01 01           STA 257,X






CODE10......PAGE 0036

LINE# LOC   CODE        LINE


02556  C32C  C8                 INY
02557  C32D  20 76 00           JSR CHRGOT
02558  C330  C9 2C              CMP #44
02559  C332  F0 D2              BEQ INDLOP
02560  C334  84 05              STY COUNT
02561  C336  20 EF BE           JSR CHKCLS
02562  C339  68                 PLA
02563  C33A  85 07              STA VALTYP
02564  C33C  68                 PLA
02565  C33D  85 08              STA INTFLG
02566  C33F  29 7F              AND #127
02567  C341  85 06              STA DIMFLG
02568  C343  A6 2C              LDX ARYTAB
02569  C345  A5 2D              LDA ARYTAB+1
02570  C347  86 5C       LOPFDA STX LOWTR
02571  C349  85 5D              STA LOWTR+1
02572  C34B  C5 2F              CMP STREND+1
02573  C34D  D0 04              BNE LOPFDV
02574  C34F  E4 2E              CPX STREND
02575  C351  F0 39              BEQ NOTFDD
02576  C353  A0 00       LOPFDV LDY #0
02577  C355  B1 5C              LDA (LOWTR)Y
02578  C357  C8                 INY
02579  C358  C5 42              CMP VARNAM
02580  C35A  D0 06              BNE NMARY1
02581  C35C  A5 43              LDA VARNAM+1
02582  C35E  D1 5C              CMP (LOWTR)Y
02583  C360  F0 16              BEQ GOTARY
02584  C362  C8          NMARY1 INY
02585  C363  B1 5C              LDA (LOWTR)Y
02586  C365  18                 CLC
02587  C366  65 5C              ADC LOWTR
02588  C368  AA                 TAX
02589  C369  C8                 INY
02590  C36A  B1 5C              LDA (LOWTR)Y
02591  C36C  65 5D              ADC LOWTR+1
02592  C36E  90 D7              BCC LOPFDA
02593  C370  A2 6B       BSERR  LDX #ERRBS
02594  C372  2C                 .BYT $2C
02595  C373  A2 35       FCERR  LDX #ERRFC
02596  C375  4C CF B3    ERRGO3 JMP ERROR
02597  C378  A2 78       GOTARY LDX #ERRDD
02598  C37A  A5 06              LDA DIMFLG
02599  C37C  D0 F7              BNE ERRGO3
02600  C37E  20 C8 C2           JSR FMAPTR
02601  C381  A5 05              LDA COUNT
02602  C383  A0 04              LDY #4
02603  C385  D1 5C              CMP (LOWTR)Y
02604  C387  D0 E7              BNE BSERR
02605  C389  4C 15 C4           JMP GETDEF
02606  C38C  20 C8 C2    NOTFDD JSR FMAPTR
02607  C38F  20 A0 B3           JSR REASON
02608  C392  A0 00              LDY #0
02609  C394  84 6F              STY CURTOL+1
02610  C396  A2 05              LDX #5






CODE10......PAGE 0037

LINE# LOC   CODE        LINE


02611  C398  A5 42              LDA VARNAM
02612  C39A  91 5C              STA (LOWTR)Y
02613  C39C  10 01              BPL NOTFLT
02614  C39E  CA                 DEX
02615  C39F  C8          NOTFLT INY
02616  C3A0  A5 43              LDA VARNAM+1
02617  C3A2  91 5C              STA (LOWTR)Y
02618  C3A4  10 02              BPL STOMLT
02619  C3A6  CA                 DEX
02620  C3A7  CA                 DEX
02621  C3A8  86 6E       STOMLT STX CURTOL
02622  C3AA  A5 05              LDA COUNT
02623  C3AC  C8                 INY
02624  C3AD  C8                 INY
02625  C3AE  C8                 INY
02626  C3AF  91 5C              STA (LOWTR)Y
02627  C3B1  A2 0B       LOPPTA LDX #11
02628  C3B3  A9 00              LDA #0
02629  C3B5  24 06              BIT DIMFLG
02630  C3B7  50 08              BVC NOTDIM
02631  C3B9  68                 PLA
02632  C3BA  18                 CLC
02633  C3BB  69 01              ADC #1
02634  C3BD  AA                 TAX
02635  C3BE  68                 PLA
02636  C3BF  69 00              ADC #0
02637  C3C1  C8          NOTDIM INY
02638  C3C2  91 5C              STA (LOWTR)Y
02639  C3C4  C8                 INY
02640  C3C5  8A                 TXA
02641  C3C6  91 5C              STA (LOWTR)Y
02642  C3C8  20 77 C4           JSR UMULT
02643  C3CB  86 6E              STX CURTOL
02644  C3CD  85 6F              STA CURTOL+1
02645  C3CF  A4 1F              LDY INDEX
02646  C3D1  C6 05              DEC COUNT
02647  C3D3  D0 DC              BNE LOPPTA
02648  C3D5  65 56              ADC ARYPNT+1
02649  C3D7  B0 5D              BCS OMERR1
02650  C3D9  85 56              STA ARYPNT+1
02651  C3DB  A8                 TAY
02652  C3DC  8A                 TXA
02653  C3DD  65 55              ADC ARYPNT
02654  C3DF  90 03              BCC GREASE
02655  C3E1  C8                 INY
02656  C3E2  F0 52              BEQ OMERR1
02657  C3E4  20 A0 B3    GREASE JSR REASON
02658  C3E7  85 2E              STA STREND
02659  C3E9  84 2F              STY STREND+1
02660  C3EB  A9 00              LDA #0
02661  C3ED  E6 6F              INC CURTOL+1
02662  C3EF              .FIL   CODE13









CODE13......PAGE 0038

LINE# LOC   CODE        LINE


02664  C3EF  A4 6E              LDY CURTOL
02665  C3F1  F0 05              BEQ DECCUR
02666  C3F3  88          ZERITA DEY
02667  C3F4  91 55              STA (ARYPNT)Y
02668  C3F6  D0 FB              BNE ZERITA
02669  C3F8  C6 56       DECCUR DEC ARYPNT+1
02670  C3FA  C6 6F              DEC CURTOL+1
02671  C3FC  D0 F5              BNE ZERITA
02672  C3FE  E6 56              INC ARYPNT+1
02673  C400  38                 SEC
02674  C401  A5 2E              LDA STREND
02675  C403  E5 5C              SBC LOWTR
02676  C405  A0 02              LDY #2
02677  C407  91 5C              STA (LOWTR)Y
02678  C409  A5 2F              LDA STREND+1
02679  C40B  C8                 INY
02680  C40C  E5 5D              SBC LOWTR+1
02681  C40E  91 5C              STA (LOWTR)Y
02682  C410  A5 06              LDA DIMFLG
02683  C412  D0 62              BNE DIMRTS
02684  C414  C8                 INY
02685  C415  B1 5C       GETDEF LDA (LOWTR)Y
02686  C417  85 05              STA COUNT
02687  C419  A9 00              LDA #0
02688  C41B  85 6E              STA CURTOL
02689  C41D  85 6F       INLPNM STA CURTOL+1
02690  C41F  C8                 INY
02691  C420  68                 PLA
02692  C421  AA                 TAX
02693  C422  85 61              STA INDICE
02694  C424  68                 PLA
02695  C425  85 62              STA INDICE+1
02696  C427  D1 5C              CMP (LOWTR)Y
02697  C429  90 0E              BCC INLPN2
02698  C42B  D0 06              BNE BSERR7
02699  C42D  C8                 INY
02700  C42E  8A                 TXA
02701  C42F  D1 5C              CMP (LOWTR)Y
02702  C431  90 07              BCC INLPN1
02703  C433  4C 70 C3    BSERR7 JMP BSERR
02704  C436  4C CD B3    OMERR1 JMP OMERR
02705  C439  C8          INLPN2 INY
02706  C43A  A5 6F       INLPN1 LDA CURTOL+1
02707  C43C  05 6E              ORA CURTOL
02708  C43E  18                 CLC
02709  C43F  F0 0A              BEQ ADDIND
02710  C441  20 77 C4           JSR UMULT
02711  C444  8A                 TXA
02712  C445  65 61              ADC INDICE
02713  C447  AA                 TAX
02714  C448  98                 TYA
02715  C449  A4 1F              LDY INDEX1
02716  C44B  65 62       ADDIND ADC INDICE+1
02717  C44D  86 6E              STX CURTOL
02718  C44F  C6 05              DEC COUNT






CODE13......PAGE 0039

LINE# LOC   CODE        LINE


02719  C451  D0 CA              BNE INLPNM
02720  C453  85 6F              STA CURTOL+1
02721  C455  A2 05              LDX #5
02722  C457  A5 42              LDA VARNAM
02723  C459  10 01              BPL NOTFL1
02724  C45B  CA                 DEX
02725  C45C  A5 43       NOTFL1 LDA VARNAM+1
02726  C45E  10 02              BPL STOML1
02727  C460  CA                 DEX
02728  C461  CA                 DEX
02729  C462  86 25       STOML1 STX ADDEND
02730  C464  A9 00              LDA #0
02731  C466  20 80 C4           JSR UMULTD
02732  C469  8A                 TXA
02733  C46A  65 55              ADC ARYPNT
02734  C46C  85 44              STA VARPNT
02735  C46E  98                 TYA
02736  C46F  65 56              ADC ARYPNT+1
02737  C471  85 45              STA VARPNT+1
02738  C473  A8                 TAY
02739  C474  A5 44              LDA VARPNT
02740  C476  60          DIMRTS RTS
02741  C477  84 1F       UMULT  STY INDEX
02742  C479  B1 5C              LDA (LOWTR)Y
02743  C47B  85 25              STA ADDEND
02744  C47D  88                 DEY
02745  C47E  B1 5C              LDA (LOWTR)Y
02746  C480  85 26       UMULTD STA ADDEND+1
02747  C482  A9 10              LDA #16
02748  C484  85 5A              STA DECCNT
02749  C486  A2 00              LDX #0
02750  C488  A0 00              LDY #0
02751  C48A  8A          UMULTC TXA
02752  C48B  0A                 ASL A
02753  C48C  AA                 TAX
02754  C48D  98                 TYA
02755  C48E  2A                 ROL A
02756  C48F  A8                 TAY
02757  C490  B0 A4              BCS OMERR1
02758  C492  06 6E              ASL CURTOL
02759  C494  26 6F              ROL CURTOL+1
02760  C496  90 0B              BCC UMLCNT
02761  C498  18                 CLC
02762  C499  8A                 TXA
02763  C49A  65 25              ADC ADDEND
02764  C49C  AA                 TAX
02765  C49D  98                 TYA
02766  C49E  65 26              ADC ADDEND+1
02767  C4A0  A8                 TAY
02768  C4A1  B0 93              BCS OMERR1
02769  C4A3  C6 5A       UMLCNT DEC DECCNT
02770  C4A5  D0 E3              BNE UMULTC
02771  C4A7  60          UMLRTS RTS
02772  C4A8  A5 07       FRE    LDA VALTYP
02773  C4AA  F0 03              BEQ NOFREF






CODE13......PAGE 003A

LINE# LOC   CODE        LINE


02774  C4AC  20 B8 C7           JSR FREFAC
02775  C4AF  20 6A C6    NOFREF JSR GARBA2
02776  C4B2  38                 SEC
02777  C4B3  A5 30              LDA FRETOP
02778  C4B5  E5 2E              SBC STREND
02779  C4B7  A8                 TAY
02780  C4B8  A5 31              LDA FRETOP+1
02781  C4BA  E5 2F              SBC STREND+1
02782  C4BC  A2 00       GIVAYF LDX #0
02783  C4BE  86 07              STX VALTYP
02784  C4C0  85 5F              STA FACHO
02785  C4C2  84 60              STY FACHO+1
02786  C4C4  A2 90              LDX #144
02787  C4C6  4C 7A CD           JMP FLOATS
02788  C4C9  A4 C6       POS    LDY TRMPOS
02789  C4CB  A9 00       SNGFLT LDA #0
02790  C4CD  F0 ED              BEQ GIVAYF
02791  C4CF  A6 37       ERRDIR LDX CURLIN+1
02792  C4D1  E8                 INX
02793  C4D2  D0 A2              BNE DIMRTS
02794  C4D4  A2 95              LDX #ERRID
02795  C4D6  2C                 .BYT $2C
02796  C4D7  A2 E9       ERRGUF LDX #ERRUF
02797  C4D9  4C CF B3           JMP ERROR
02798  C4DC  20 0A C5    DEF    JSR GETFNM
02799  C4DF  20 CF C4           JSR ERRDIR
02800  C4E2  20 F2 BE           JSR CHKOPN
02801  C4E5  A9 80              LDA #128
02802  C4E7  85 0A              STA SUBFLG
02803  C4E9  20 2B C1           JSR PTRGET
02804  C4EC  20 87 BD           JSR CHKNUM
02805  C4EF  20 EF BE           JSR CHKCLS
02806  C4F2  A9 B2              LDA #$B2
02807  C4F4  20 F7 BE           JSR SYNCHR
02808  C4F7  48                 PHA
02809  C4F8  A5 45              LDA VARPNT+1
02810  C4FA  48                 PHA
02811  C4FB  A5 44              LDA VARPNT
02812  C4FD  48                 PHA
02813  C4FE  A5 78              LDA TXTPTR+1
02814  C500              .FIL   CODE14




















CODE14......PAGE 003B

LINE# LOC   CODE        LINE


02816  C500  48                 PHA
02817  C501  A5 77              LDA TXTPTR
02818  C503  48                 PHA
02819  C504  20 83 B8           JSR DATA
02820  C507  4C 78 C5           JMP DEFFIN
02821  C50A  A9 A5       GETFNM LDA #FNTK
02822  C50C  20 F7 BE           JSR SYNCHR
02823  C50F  09 80              ORA #128
02824  C511  85 0A              STA SUBFLG
02825  C513  20 32 C1           JSR PTRGT2
02826  C516  85 4B              STA DEFPNT
02827  C518  84 4C              STY DEFPNT+1
02828  C51A  4C 87 BD           JMP CHKNUM
02829  C51D  20 0A C5    FNDOER JSR GETFNM
02830  C520  A5 4C              LDA DEFPNT+1
02831  C522  48                 PHA
02832  C523  A5 4B              LDA DEFPNT
02833  C525  48                 PHA
02834  C526  20 E9 BE           JSR PARCHK
02835  C529  20 87 BD           JSR CHKNUM
02836  C52C  68                 PLA
02837  C52D  85 4B              STA DEFPNT
02838  C52F  68                 PLA
02839  C530  85 4C              STA DEFPNT+1
02840  C532  A0 02              LDY #2
02841  C534  B1 4B              LDA (DEFPNT)Y
02842  C536  85 44              STA VARPNT
02843  C538  AA                 TAX
02844  C539  C8                 INY
02845  C53A  B1 4B              LDA (DEFPNT)Y
02846  C53C  F0 99              BEQ ERRGUF
02847  C53E  85 45              STA VARPNT+1
02848  C540  C8                 INY
02849  C541  B1 44       DEFSTF LDA (VARPNT)Y
02850  C543  48                 PHA
02851  C544  88                 DEY
02852  C545  10 FA              BPL DEFSTF
02853  C547  A4 45              LDY VARPNT+1
02854  C549  20 0A CD           JSR MOVMF
02855  C54C  A5 78              LDA TXTPTR+1
02856  C54E  48                 PHA
02857  C54F  A5 77              LDA TXTPTR
02858  C551  48                 PHA
02859  C552  B1 4B              LDA (DEFPNT)Y
02860  C554  85 77              STA TXTPTR
02861  C556  C8                 INY
02862  C557  B1 4B              LDA (DEFPNT)Y
02863  C559  85 78              STA TXTPTR+1
02864  C55B  A5 45              LDA VARPNT+1
02865  C55D  48                 PHA
02866  C55E  A5 44              LDA VARPNT
02867  C560  48                 PHA
02868  C561  20 84 BD           JSR FRMNUM
02869  C564  68                 PLA
02870  C565  85 4B              STA DEFPNT






CODE14......PAGE 003C

LINE# LOC   CODE        LINE


02871  C567  68                 PLA
02872  C568  85 4C              STA DEFPNT+1
02873  C56A  20 76 00           JSR CHRGOT
02874  C56D  F0 03              BEQ *+5
02875  C56F  4C 00 BF           JMP SNERR
02876  C572  68                 PLA
02877  C573  85 77              STA TXTPTR
02878  C575  68                 PLA
02879  C576  85 78              STA TXTPTR+1
02880  C578  A0 00       DEFFIN LDY #0
02881  C57A  68                 PLA
02882  C57B  91 4B              STA (DEFPNT)Y
02883  C57D  68                 PLA
02884  C57E  C8                 INY
02885  C57F  91 4B              STA (DEFPNT)Y
02886  C581  68                 PLA
02887  C582  C8                 INY
02888  C583  91 4B              STA (DEFPNT)Y
02889  C585  68                 PLA
02890  C586  C8                 INY
02891  C587  91 4B              STA (DEFPNT)Y
02892  C589  68                 PLA
02893  C58A  C8                 INY
02894  C58B  91 4B              STA (DEFPNT)Y
02895  C58D  60                 RTS
02896  C58E  20 87 BD    STRD   JSR CHKNUM
02897  C591  A0 00              LDY #0
02898  C593  20 95 CF           JSR FOUTC
02899  C596  68                 PLA
02900  C597  68                 PLA
02901  C598  A9 FF       TIMSTR LDA #<LOFBUF
02902  C59A  A0 00              LDY #>LOFBUF
02903  C59C  F0 12              BEQ STRLIT
02904  C59E  A6 61       STRINI LDX FACMO
02905  C5A0  A4 62              LDY FACMO+1
02906  C5A2  86 4D              STX DSCPNT
02907  C5A4  84 4E              STY DSCPNT+1
02908  C5A6  20 1D C6    STRSPA JSR GETSPA
02909  C5A9  86 5F              STX DSCTMP+1
02910  C5AB  84 60              STY DSCTMP+2
02911  C5AD  85 5E              STA DSCTMP
02912  C5AF  60                 RTS
02913  C5B0  A2 22       STRLIT LDX #34
02914  C5B2  86 03              STX CHARAC
02915  C5B4  86 04              STX ENDCHR
02916  C5B6  85 6C       STRLT2 STA STRNG1
02917  C5B8  84 6D              STY STRNG1+1
02918  C5BA  85 5F              STA DSCTMP+1
02919  C5BC  84 60              STY DSCTMP+2
02920  C5BE  A0 FF              LDY #255
02921  C5C0  C8          STRGET INY
02922  C5C1  B1 6C              LDA (STRNG1)Y
02923  C5C3  F0 0C              BEQ STRFI1
02924  C5C5  C5 03              CMP CHARAC
02925  C5C7  F0 04              BEQ STRFIN






CODE14......PAGE 003D

LINE# LOC   CODE        LINE


02926  C5C9  C5 04              CMP ENDCHR
02927  C5CB  D0 F3              BNE STRGET
02928  C5CD  C9 22       STRFIN CMP #34
02929  C5CF  F0 01              BEQ STRFI2
02930  C5D1  18          STRFI1 CLC
02931  C5D2  84 5E       STRFI2 STY DSCTMP
02932  C5D4  98                 TYA
02933  C5D5  65 6C              ADC STRNG1
02934  C5D7  85 6E              STA STRNG2
02935  C5D9  A6 6D              LDX STRNG1+1
02936  C5DB  90 01              BCC STRST2
02937  C5DD  E8                 INX
02938  C5DE  86 6F       STRST2 STX STRNG2+1
02939  C5E0  A5 6D              LDA STRNG1+1
02940  C5E2  F0 04              BEQ STRCP
02941  C5E4  C9 02              CMP #BUFPAG
02942  C5E6  D0 0B              BNE PUTNEW
02943  C5E8  98          STRCP  TYA
02944  C5E9  20 9E C5           JSR STRINI
02945  C5EC  A6 6C              LDX STRNG1
02946  C5EE  A4 6D              LDY STRNG1+1
02947  C5F0  20 9A C7           JSR MOVSTR
02948  C5F3  A6 13       PUTNEW LDX TEMPPT
02949  C5F5  E0 1F              CPX #TEMPST+STRSIZ+STRSIZ+STRSIZ
02950  C5F7  D0 05              BNE PUTNW1
02951  C5F9  A2 C8              LDX #ERRST
02952  C5FB  4C CF B3    ERRGO2 JMP ERROR
02953  C5FE  A5 5E       PUTNW1 LDA DSCTMP
02954  C600  95 00              STA 0,X
02955  C602  A5 5F              LDA DSCTMP+1
02956  C604  95 01              STA 1,X
02957  C606  A5 60              LDA DSCTMP+2
02958  C608  95 02              STA 2,X
02959  C60A  A0 00              LDY #0
02960  C60C  86 61              STX FACMO
02961  C60E  84 62              STY FACMO+1
02962  C610  84 6D              STY FACOV
02963  C612  88                 DEY
02964  C613  84 07              STY VALTYP
02965  C615  86 14              STX LASTPT
02966  C617  E8                 INX
02967  C618  E8                 INX
02968  C619  E8                 INX
02969  C61A  86 13              STX TEMPPT
02970  C61C  60                 RTS
02971  C61D  46 09       GETSPA LSR GARBFL
02972  C61F  AA          TRYAG2 TAX             ;SAVE IH X ALSO
02973  C620  F0 38              BEQ GETRTS      ;LEHSTH OF 0 NO GO...
02974  C622  48                 PHA             ;SAVE A (LENGTH) ON STACK
02975  C623  A5 30              LDA FRETOP      ;LO BYTE
02976  C625  38                 SEC             ;FOR SUBTRACT
02977  C626  E9 02              SBC #2          ;MINUS 2 (LINK BYTES)
02978  C628  A4 31              LDY FRETOP+1
02979  C62A  B0 01              BCS TRYAG3
02980  C62C  88                 DEY






CODE14......PAGE 003E

LINE# LOC   CODE        LINE


02981  C62D  85 1F       TRYAG3 STA INDEX1      ;SAVE FOR LATER
02982  C62F  84 20              STY INDEX1+1
02983  C631  8A                 TXA
02984  C632  49 FF              EOR #255
02985  C634  38                 SEC
02986  C635  65 1F              ADC INDEX1
02987  C637  B0 01              BCS TRYAG4
02988  C639  88                 DEY
02989  C63A  C4 2F       TRYAG4 CPY STREND+1
02990  C63C  90 1D              BCC GARBAG
02991  C63E  D0 04              BNE STRFRE
02992  C640  C5 2E              CMP STREND
02993  C642  90 17              BCC GARBAG
02994  C644  85 32       STRFRE STA FRESPC
02995  C646  84 33              STY FRESPC+1
02996  C648  A0 01              LDY #$01        ;FLAG STRING AS GARB.
02997  C64A  A9 FF              LDA #$FF
02998  C64C  91 1F              STA (INDEX1),Y  ;FLAG
02999  C64E  88                 DEY
03000  C64F  68                 PLA             ;LEHGTH
03001  C650  91 1F              STA (INDEX1),Y
03002  C652  A6 32              LDX FRESPC
03003  C654  A4 33              LDY FRESPC+1
03004  C656  86 30              STX FRETOP
03005  C658  84 31              STY FRETOP+1
03006  C65A  60          GETRTS RTS
03007  C65B  A2 4D       GARBAG LDX #ERROM      ;OUT OF MEMORY
03008  C65D  A5 09              LDA GARBFL
03009  C65F  30 9A              BMI ERRGO2
03010  C661  20 6A C6           JSR GARBA2
03011  C664  38                 SEC
03012  C665  66 09              ROR GARBFL
03013  C667  68                 PLA
03014  C668  D0 B5              BNE TRYAG2
03015  C66A              .FIL   GRBCOL


























GARBAGE COLLECTION......PAGE 003F

LINE# LOC   CODE        LINE


03017  C66A              ;*******************************
03018  C66A              ;*
03019  C66A              ;* THIS ROUTINE LOOKS FOR AND
03020  C66A              ;* SQUASHES OUT ANY UNUSED STRING
03021  C66A              ;* SFACE IT FINDS. THUS RETURNING
03022  C66A              ;* THE SPACE FOR FUTURE USE BY
03023  C66A              ;* THE STRING ROUTINES.
03024  C66A              ;* GARBA2 IS CALLED ONLY WHEN
03025  C66A              ;* BASIC NEED SPACE OF A FRE
03026  C66A              ;* INSTRUCTION IS USED.
03027  C66A              ;*
03028  C66A              ;*******************************
03029  C66A              ;*
03030  C66A  A0 00       GARBA2 LDY #$00        ;SET UP FLAG
03031  C66C  84 55              STY HIGHDS
03032  C66E  A5 34              LDA MEMSIZ      ;START AT TOP OF RAM
03033  C670  A4 35              LDY MEMSIZ+1
03034  C672  85 5C              STA GRBTOP      ;SET BOTH POINTERS
03035  C674  85 4B              STA GRBPNT
03036  C676  85 32              STA FRESPC
03037  C678  84 5D              STY GRBTOP+1
03038  C67A  84 4C              STY GRBPNT+1
03039  C67C  84 33              STY FRESPC+1
03040  C67E              ;
03041  C67E              ; DO WHILE (GRBPNT <> FRETOP)
03042  C67E              ;
03043  C67E  C4 31       GLOOP  CPY FRETOP+1    ;END OF STRINGS ?
03044  C680  90 7E              BCC GRBEND
03045  C682  D0 06              BNE COL00
03046  C684  C5 30              CMP FRETOP
03047  C686  F0 78              BEQ GRBEND
03048  C688  90 76              BCC GRBEND
03049  C68A              ;
03050  C68A              ; IF .A = #$FF THEN STRING IS GARBAGE
03051  C68A              ;
03052  C68A  A6 55       COL00  LDX HIGHDS      ;CHECK FLAG
03053  C68C  30 05              BMI COL00B
03054  C68E  A9 02              LDA #$02
03055  C690  20 35 C7           JSR MOVTOP
03056  C693  20 24 C7    COL00B JSR SKIP2A
03057  C696  A0 01              LDY #$01
03058  C698  B1 4B              LDA (GRBPNT),Y  ;GARBAGE ?
03059  C69A  C9 FF              CMP #$FF
03060  C69C  D0 0B              BNE COL01       ;NO A GOGD STRING
03061  C69E  88          COL00A DEY             ;BACK UP TO LEHGTH
03062  C69F  B1 4B              LDA (GRBPNT),Y
03063  C6A1  20 26 C7           JSR MOVPNT      ;MOVE GRBPNT TO NEXT
03064  C6A4  38                 SEC
03065  C6A5  66 55              ROR HIGHDS      ;SET FLAG FOR SQUASH
03066  C6A7  D0 D5              BNE GLOOP       ;(JMP) GO GET MORE
03067  C6A9              ;
03068  C6A9              ; ELSE
03069  C6A9              ;
03070  C6A9  20 44 C7    COL01  JSR SETINX      ;POINT INDEX TO DEST
03071  C6AC  A6 55              LDX HIGHDS      ;IF ON DO SQUASH






GARBAGE COLLECTION......PAGE 0040

LINE# LOC   CODE        LINE


03072  C6AE  10 53              BPL COL03
03073  C6B0  46 55              LSR HIGHDS      ;RESET FLAG
03074  C6B2              ;
03075  C6B2              ; MOVE A STRING OVER GARBAGE
03076  C6B2              ;
03077  C6B2  A0 00       COL02  LDY #$00        ;MOVE THE LINK BYTES
03078  C6B4  B1 4B              LDA (GRBPNT),Y
03079  C6B6  91 5C              STA (GRBTOP),Y
03080  C6B8  C8                 INY
03081  C6B9  B1 4B              LDA (GRBPNT),Y
03082  C6BB  91 5C              STA (GRBTOP),Y
03083  C6BD              ;
03084  C6BD  88                 DEY             ;GET LENGTH OF STRING
03085  C6BE  B1 1F              LDA (INDEX1),Y
03086  C6C0  AA                 TAX
03087  C6C1  20 35 C7           JSR MOVTOP      ;MOVE TOP FOINTER
03088  C6C4  85 32              STA FRESPC      ;SAVE IN FRESPC
03089  C6C6  84 33              STY FRESPC+1
03090  C6C8  8A                 TXA
03091  C6C9  20 26 C7           JSR MOVPNT      ;MOVE GRBPNT
03092  C6CC  8A                 TXA             ;PUT LENGTH-1 IN .Y
03093  C6CD  A8                 TAY
03094  C6CE  88          GLOP1  DEY
03095  C6CF  B1 4B              LDA (GRBPNT),Y
03096  C6D1  91 5C              STA (GRBTOP),Y
03097  C6D3  CA                 DEX
03098  C6D4  D0 F8              BNE GLOP1
03099  C6D6              ;
03100  C6D6  A0 02              LDY #$02        ;FIX THE DESCRIPTOR
03101  C6D8  B9 5B 00    COL02B LDA GRBTOP-1,Y
03102  C6DB  91 1F              STA (INDEX1),Y
03103  C6DD  88                 DEY
03104  C6DE  D0 F8              BNE COL02B
03105  C6E0  A5 4B              LDA GRBPNT      ;CHECK POINTER
03106  C6E2  A4 4C              LDY GRBPNT+1
03107  C6E4  C4 31              CPY FRETOP+1
03108  C6E6  90 18              BCC GRBEND
03109  C6E8  D0 06              BNE COL02A
03110  C6EA  C5 30              CMP FRETOP
03111  C6EC  F0 12              BEQ GRBEND
03112  C6EE  90 10              BCC GRBEND
03113  C6F0  20 1F C7    COL02A JSR SKIP2       ;SKIP LINK BYTES
03114  C6F3  A0 01              LDY #$01        ;IS IT GARBAGE ?
03115  C6F5  B1 4B              LDA (GRBPNT),Y
03116  C6F7  C9 FF              CMP #$FF
03117  C6F9  F0 A3              BEQ COL00A
03118  C6FB  20 44 C7           JSR SETINX      ;RETURNS N SET
03119  C6FE  30 B2              BMI COL02
03120  C700  4C 16 C7    GRBEND JMP ENDGRB
03121  C703              ;
03122  C703  A0 00       COL03  LDY #$00        ;SKIF OVER GOOD STRINGS
03123  C705  B1 1F              LDA (INDEX1),Y
03124  C707  AA                 TAX
03125  C708  20 35 C7           JSR MOVTOP
03126  C70B  85 32              STA FRESPC






GARBAGE COLLECTION......PAGE 0041

LINE# LOC   CODE        LINE


03127  C70D  84 33              STY FRESPC+1
03128  C70F  8A                 TXA
03129  C710  20 26 C7           JSR MOVPNT
03130  C713  4C 7E C6           JMP GLOOP
03131  C716              ;
03132  C716              ; DONE FIX FRETOP & FRESPC
03133  C716              ;
03134  C716  A5 32       ENDGRB LDA FRESPC
03135  C718  A4 33              LDY FRESPC+1
03136  C71A  85 30              STA FRETOP
03137  C71C  84 31              STY FRETOP+1
03138  C71E  60                 RTS
03139  C71F              ;
03140  C71F              ; SUBRUOTINES USED FOR GAREAGE COLLECTION
03141  C71F              ;
03142  C71F  A9 02       SKIP2  LDA #$02        ;SKIP POINTERS FAST
03143  C721  20 35 C7           JSR MOVTOP      ;THE LINK BYTES IN
03144  C724  A9 02       SKIP2A LDA #$02        ;THE STRING DATA
03145  C726              ;
03146  C726  49 FF       MOVPNT EOR #255        ;COMP AND ADD
03147  C728  38                 SEC
03148  C729  65 4B              ADC GRBPNT
03149  C72B  A4 4C              LDY GRBPNT+1
03150  C72D  B0 01              BCS MOV00
03151  C72F  88                 DEY
03152  C730  85 4B       MOV00  STA GRBPNT
03153  C732  84 4C              STY GRBPNT+1
03154  C734  60                 RTS
03155  C735              ;
03156  C735  49 FF       MOVTOP EOR #255        ;COMP AND ADD
03157  C737  38                 SEC
03158  C738  65 5C              ADC GRBTOP
03159  C73A  A4 5D              LDY GRBTOP+1
03160  C73C  B0 01              BCS MOV01
03161  C73E  88                 DEY
03162  C73F  85 5C       MOV01  STA GRBTOP
03163  C741  84 5D              STY GRBTOP+1
03164  C743  60                 RTS
03165  C744              ;
03166  C744  A0 01       SETINX LDY #$01        ;SET INDEX1 AS POINTER
03167  C746  B1 4B       SET00  LDA (GRBPNT),Y  ;TO THE LENGTH BYTE IN
03168  C748  99 1F 00           STA INDEX1,Y
03169  C74B  88                 DEY
03170  C74C  10 F8              BPL SET00
03171  C74E  60                 RTS
03172  C74F              .FIL   CODE15















CODE15......PAGE 0042

LINE# LOC   CODE        LINE


03174  C74F  A5 62       CAT    LDA FACLO
03175  C751  48                 PHA
03176  C752  A5 61              LDA FACMO
03177  C754  48                 PHA
03178  C755  20 81 BE           JSR EVAL
03179  C758  20 89 BD           JSR CHKSTR
03180  C75B  68                 PLA
03181  C75C  85 6C              STA STRNG1
03182  C75E  68                 PLA
03183  C75F  85 6D              STA STRNG1+1
03184  C761  A0 00              LDY #0
03185  C763  B1 6C              LDA (STRNG1)Y
03186  C765  18                 CLC
03187  C766  71 61              ADC (FACMO)Y
03188  C768  90 05              BCC SIZEOK
03189  C76A  A2 B0              LDX #ERRLS
03190  C76C  4C CF B3           JMP ERROR
03191  C76F  20 9E C5    SIZEOK JSR STRINI
03192  C772  20 8C C7           JSR MOVINS
03193  C775  A5 4D              LDA DSCPNT
03194  C777  A4 4E              LDY DSCPNT+1
03195  C779  20 BC C7           JSR FRETMP
03196  C77C  20 9E C7           JSR MOVDO
03197  C77F  A5 6C              LDA STRNG1
03198  C781  A4 6D              LDY STRNG1+1
03199  C783  20 BC C7           JSR FRETMP
03200  C786  20 F3 C5           JSR PUTNEW
03201  C789  4C B2 BD           JMP TSTOP
03202  C78C  A0 00       MOVINS LDY #0
03203  C78E  B1 6C              LDA (STRNG1)Y
03204  C790  48                 PHA
03205  C791  C8                 INY
03206  C792              .FIL   CODE16




























CODE16......PAGE 0043

LINE# LOC   CODE        LINE


03208  C792  B1 6C              LDA (STRNG1)Y
03209  C794  AA                 TAX
03210  C795  C8                 INY
03211  C796  B1 6C              LDA (STRNG1)Y
03212  C798  A8                 TAY
03213  C799  68                 PLA
03214  C79A  86 1F       MOVSTR STX INDEX
03215  C79C  84 20              STY INDEX+1
03216  C79E  A8          MOVDO  TAY
03217  C79F  F0 0A              BEQ MVDONE
03218  C7A1  48                 PHA
03219  C7A2  88          MOVLP  DEY
03220  C7A3  B1 1F              LDA (INDEX)Y
03221  C7A5  91 32              STA (FRESPC)Y
03222  C7A7  98                 TYA
03223  C7A8  D0 F8              BNE MOVLP
03224  C7AA  68                 PLA
03225  C7AB  18          MVDONE CLC
03226  C7AC  65 32              ADC FRESPC
03227  C7AE  85 32              STA FRESPC
03228  C7B0  90 02              BCC MVSTRT
03229  C7B2  E6 33              INC FRESPC+1
03230  C7B4  60          MVSTRT RTS
03231  C7B5  20 89 BD    FRESTR JSR CHKSTR
03232  C7B8  A5 61       FREFAC LDA FACMO
03233  C7BA  A4 62              LDY FACMO+1
03234  C7BC  85 1F       FRETMP STA INDEX
03235  C7BE  84 20              STY INDEX+1
03236  C7C0  20 11 C8           JSR FRETMS      ;CHECK DESC, IF LAST
03237  C7C3  D0 39              BNE FRE02       ;ONE THEN SCRATCH IT
03238  C7C5  20 4E BA           JSR STRADJ      ;INDEX POINTS TO LINK
03239  C7C8  90 34              BCC FRE02       ;LITERAL NO FIX
03240  C7CA  88                 DEY             ;.Y=1
03241  C7CB  A9 FF              LDA #$FF        ;FLAG STRING AS GARBAGE
03242  C7CD  91 1F              STA (INDEX),Y
03243  C7CF  88                 DEY
03244  C7D0  8A                 TXA
03245  C7D1  91 1F              STA (INDEX),Y   ;FUT IN LENGTH
03246  C7D3  48                 PHA             ;SAVE LENGTH ON STACK
03247  C7D4              ;
03248  C7D4  49 FF              EOR #255        ;PUT INDEX BACK
03249  C7D6  38                 SEC             ;TO FIRST BYTE
03250  C7D7  65 1F              ADC INDEX
03251  C7D9  A4 20              LDY INDEX+1
03252  C7DB  B0 01              BCS RES00
03253  C7DD  88                 DEY
03254  C7DE  85 1F       RES00  STA INDEX
03255  C7E0  84 20              STY INDEX+1
03256  C7E2  AA                 TAX             ;LO INTO X
03257  C7E3  68                 PLA             ;PULL LENGTH FROM STACK
03258  C7E4  C4 31              CPY FRETOP+1    ;TEST FOR EQ TO FRETOP
03259  C7E6  D0 39              BNE FRERTS
03260  C7E8  E4 30              CPX FRETOP
03261  C7EA  D0 35              BNE FRERTS
03262  C7EC              ;






CODE16......PAGE 0044

LINE# LOC   CODE        LINE


03263  C7EC              ;STRING WAS LAST INTO STRING SFACE
03264  C7EC              ;SAVE GARBAGE COLLECTION SOME TIME
03265  C7EC              ;BY FREEING UP. (LENGTH + 2)
03266  C7EC              ;
03267  C7EC  48                 PHA             ;SAVE LENGTH ON STACK
03268  C7ED  38                 SEC             ;PLUS ONE
03269  C7EE  65 30              ADC FRETOP
03270  C7F0  85 30              STA FRETOP
03271  C7F2  90 02              BCC FRE01
03272  C7F4  E6 31              INC FRETOP+1
03273  C7F6  E6 30       FRE01  INC FRETOP      ;+ ONE MORE
03274  C7F8  D0 02              BNE FREPLA
03275  C7FA  E6 31              INC FRETOP+1
03276  C7FC  68          FREPLA PLA             ;PULL LENGTH OFF STACK
03277  C7FD  60                 RTS
03278  C7FE  A0 00       FRE02  LDY #$00        ;SET UF X,Y,A AND INDEX
03279  C800  B1 1F              LDA (INDEX),Y   ;LEHGTH
03280  C802  48                 PHA             ;ON STACK
03281  C803  C8                 INY
03282  C804  B1 1F              LDA (INDEX),Y   ;POINTER LO
03283  C806  AA                 TAX
03284  C807  C8                 INY
03285  C808  B1 1F              LDA (INDEX),Y   ;POINTER HI
03286  C80A  A8                 TAY
03287  C80B  86 1F              STX INDEX
03288  C80D  84 20              STY INDEX+1
03289  C80F  68                 PLA             ;GET BACK LENGTH
03290  C810  60                 RTS
03291  C811  C4 15       FRETMS CPY LASTPT+1
03292  C813  D0 0C              BNE FRERTS
03293  C815  C5 14              CMP LASTPT
03294  C817  D0 08              BNE FRERTS
03295  C819  85 13              STA TEMPPT
03296  C81B  E9 03              SBC #STRSIZ
03297  C81D  85 14              STA LASTPT
03298  C81F  A0 00              LDY #0
03299  C821  60          FRERTS RTS
03300  C822  20 D7 C8    CHRD   JSR CONINT
03301  C825  8A                 TXA
03302  C826  48                 PHA
03303  C827  A9 01              LDA #1
03304  C829  20 A6 C5           JSR STRSPA
03305  C82C  68                 PLA
03306  C82D  A0 00              LDY #0
03307  C82F  91 5F              STA (DSCTMP+1)Y
03308  C831  68                 PLA
03309  C832  68                 PLA
03310  C833  4C F3 C5           JMP PUTNEW
03311  C836  20 97 C8    LEFTD  JSR PREAM
03312  C839  D1 4D              CMP (DSCPNT)Y
03313  C83B  98                 TYA
03314  C83C  90 04       RLEFT  BCC RLEFT1
03315  C83E  B1 4D              LDA (DSCPNT)Y
03316  C840  AA                 TAX
03317  C841  98                 TYA






CODE16......PAGE 0045

LINE# LOC   CODE        LINE


03318  C842  48          RLEFT1 PHA
03319  C843  8A          RLEFT2 TXA
03320  C844  48          RLEFT3 PHA
03321  C845  20 A6 C5           JSR STRSPA
03322  C848  A5 4D              LDA DSCPNT
03323  C84A  A4 4E              LDY DSCPNT+1
03324  C84C  20 BC C7           JSR FRETMP
03325  C84F  68                 PLA
03326  C850  A8                 TAY
03327  C851  68                 PLA
03328  C852  18                 CLC
03329  C853  65 1F              ADC INDEX
03330  C855  85 1F              STA INDEX
03331  C857  90 02              BCC PULMOR
03332  C859  E6 20              INC INDEX+1
03333  C85B  98          PULMOR TYA
03334  C85C  20 9E C7           JSR MOVDO
03335  C85F  4C F3 C5           JMP PUTNEW
03336  C862  20 97 C8    RIGHTD JSR PREAM
03337  C865  18                 CLC
03338  C866  F1 4D              SBC (DSCPNT)Y
03339  C868  49 FF              EOR #255
03340  C86A  4C 3C C8           JMP RLEFT
03341  C86D  A9 FF       MIDD   LDA #255
03342  C86F  85 62              STA FACLO
03343  C871  20 76 00           JSR CHRGOT
03344  C874  C9 29              CMP #41
03345  C876  F0 06              BEQ MID2
03346  C878  20 F5 BE           JSR CHKCOM
03347  C87B  20 D4 C8           JSR GETBYT
03348  C87E  20 97 C8    MID2   JSR PREAM
03349  C881  F0 4B              BEQ GOFUC
03350  C883  CA                 DEX
03351  C884  8A                 TXA
03352  C885  48                 PHA
03353  C886  18                 CLC
03354  C887  A2 00              LDX #0
03355  C889  F1 4D              SBC (DSCPNT)Y
03356  C88B  B0 B6              BCS RLEFT2
03357  C88D  49 FF              EOR #255
03358  C88F  C5 62              CMP FACLO
03359  C891  90 B1              BCC RLEFT3
03360  C893  A5 62              LDA FACLO
03361  C895  B0 AD              BCS RLEFT3
03362  C897  20 EF BE    PREAM  JSR CHKCLS
03363  C89A  68                 PLA
03364  C89B  A8                 TAY
03365  C89C  68                 PLA
03366  C89D  85 52              STA JMPER+1
03367  C89F  68                 PLA
03368  C8A0  68                 PLA
03369  C8A1  68                 PLA
03370  C8A2  AA                 TAX
03371  C8A3  68                 PLA
03372  C8A4  85 4D              STA DSCPNT






CODE16......PAGE 0046

LINE# LOC   CODE        LINE


03373  C8A6  68                 PLA
03374  C8A7  85 4E              STA DSCPNT+1
03375  C8A9  A5 52              LDA JMPER+1
03376  C8AB  48                 PHA
03377  C8AC  98                 TYA
03378  C8AD  48                 PHA
03379  C8AE  A0 00              LDY #0
03380  C8B0  8A                 TXA
03381  C8B1  60                 RTS
03382  C8B2  20 B8 C8    LEN    JSR LEN1
03383  C8B5  4C CB C4           JMP SNGFLT
03384  C8B8  20 B5 C7    LEN1   JSR FRESTR
03385  C8BB  A2 00              LDX #0
03386  C8BD  86 07              STX VALTYP
03387  C8BF  A8                 TAY
03388  C8C0  60                 RTS
03389  C8C1  20 B8 C8    ASC    JSR LEN1
03390  C8C4  F0 08              BEQ GOFUC
03391  C8C6  A0 00              LDY #0
03392  C8C8  B1 1F              LDA (INDEX1)Y
03393  C8CA  A8                 TAY
03394  C8CB  4C CB C4           JMP SNGFLT
03395  C8CE  4C 73 C3    GOFUC  JMP FCERR
03396  C8D1  20 70 00    GTBYTC JSR CHRGET
03397  C8D4              .FIL   CODE17
03398  C8D4              ;'CODE17'
03399  C8D4  20 84 BD    GETBYT JSR FRMNUM
03400  C8D7  20 E3 C2    CONINT JSR POSINT
03401  C8DA  A6 61              LDX FACMO
03402  C8DC  D0 F0              BNE GOFUC
03403  C8DE  A6 62              LDX FACLO
03404  C8E0  4C 76 00           JMP CHRGOT
03405  C8E3  20 B8 C8    VAL    JSR LEN1
03406  C8E6  D0 03              BNE *+5
03407  C8E8  4C 2D CA           JMP ZEROFC
03408  C8EB  A6 77              LDX TXTPTR
03409  C8ED  A4 78              LDY TXTPTR+1
03410  C8EF  86 6E              STX STRNG2
03411  C8F1  84 6F              STY STRNG2+1
03412  C8F3  A6 1F              LDX INDEX1
03413  C8F5  86 77              STX TXTPTR
03414  C8F7  18                 CLC
03415  C8F8  65 1F              ADC INDEX1
03416  C8FA  85 21              STA INDEX2
03417  C8FC  A6 20              LDX INDEX1+1
03418  C8FE  86 78              STX TXTPTR+1
03419  C900  90 01              BCC VAL2
03420  C902  E8                 INX 
03421  C903  86 22       VAL2   STX INDEX2+1
03422  C905  A0 00              LDY #0
03423  C907  B1 21              LDA (INDEX2)Y
03424  C909  48                 PHA
03425  C90A  98                 TYA
03426  C90B  91 21              STA (INDEX2)Y
03427  C90D  20 76 00           JSR CHRGOT






CODE16......PAGE 0047

LINE# LOC   CODE        LINE


03428  C910  20 29 CE           JSR FIN
03429  C913  68                 PLA
03430  C914  A0 00              LDY #0
03431  C916  91 21              STA (INDEX2)Y
03432  C918  A6 6E       ST2TXT LDX STRNG2
03433  C91A  A4 6F              LDY STRNG2+1
03434  C91C  86 77              STX TXTPTR
03435  C91E  84 78              STY TXTPTR+1
03436  C920  60          VALRTS RTS
03437  C921  20 84 BD    GETNUM JSR FRMNUM
03438  C924  20 2D C9           JSR GETADR
03439  C927  20 F5 BE    COMBYT JSR CHKCOM
03440  C92A  4C D4 C8           JMP GETBYT
03441  C92D  A5 63       GETADR LDA FACSGN
03442  C92F  30 9D              BMI GOFUC
03443  C931  A5 5E              LDA FACEXP
03444  C933  C9 91              CMP #145
03445  C935  B0 97              BCS GOFUC
03446  C937  20 D1 CD           JSR QINT
03447  C93A  A5 61              LDA FACMO
03448  C93C  A4 62              LDY FACMO+1
03449  C93E  84 11              STY POKER
03450  C940  85 12              STA POKER+1
03451  C942  60                 RTS
03452  C943  A5 12       PEEK   LDA POKER+1
03453  C945  48                 PHA
03454  C946  A5 11              LDA POKER
03455  C948  48                 PHA
03456  C949  20 2D C9           JSR GETADR
03457  C94C  A0 00              LDY #0
03458  C94E  B1 11       GETCON LDA (POKER)Y
03459  C950  A8                 TAY
03460  C951  68          DOSGFL PLA
03461  C952  85 11              STA POKER
03462  C954  68                 PLA
03463  C955  85 12              STA POKER+1
03464  C957  4C CB C4           JMP SNGFLT
03465  C95A  20 21 C9    POKE   JSR GETNUM
03466  C95D  8A                 TXA
03467  C95E  A0 00              LDY #0
03468  C960  91 11              STA (POKER)Y
03469  C962  60                 RTS
03470  C963  20 21 C9    FNWAIT JSR GETNUM
03471  C966  86 46              STX ANDMSK
03472  C968  A2 00              LDX #0
03473  C96A  20 76 00           JSR CHRGOT
03474  C96D  F0 03              BEQ STORDO
03475  C96F  20 27 C9           JSR COMBYT
03476  C972  86 47       STORDO STX EORMSK
03477  C974  A0 00              LDY #0
03478  C976  B1 11       WAITER LDA (POKER)Y
03479  C978  45 47              EOR EORMSK
03480  C97A  25 46              AND ANDMSK
03481  C97C  F0 F8              BEQ WAITER
03482  C97E  60          ZERRTS RTS






CODE16......PAGE 0048

LINE# LOC   CODE        LINE


03483  C97F  A9 C7       FADDH  LDA #<FHALF
03484  C981  A0 D0              LDY #>FHALF
03485  C983  4C 9D C9           JMP FADD
03486  C986  20 C2 CB    FSUB   JSR CONUPK
03487  C989  A5 63       FSUBT  LDA FACSGN
03488  C98B  49 FF              EOR #@377
03489  C98D  85 63              STA FACSGN
03490  C98F  45 6B              EOR ARGSGN
03491  C991  85 6C              STA ARISGN
03492  C993  A5 5E              LDA FACEXP
03493  C995  4C A0 C9           JMP FADDT
03494  C998  20 CF CA    FADD5  JSR SHIFTR
03495  C99B  90 3C              BCC FADD4
03496  C99D  20 C2 CB    FADD   JSR CONUPK
03497  C9A0  D0 03       FADDT  BNE *+5
03498  C9A2  4C 32 CD           JMP MOVFA
03499  C9A5  A6 6D              LDX FACOV
03500  C9A7  86 53              STX OLDOV
03501  C9A9  A2 66              LDX #ARGEXP
03502  C9AB  A5 66              LDA ARGEXP
03503  C9AD  A8          FADDC  TAY
03504  C9AE  F0 CE              BEQ ZERRTS
03505  C9B0  38                 SEC
03506  C9B1  E5 5E              SBC FACEXP
03507  C9B3  F0 24              BEQ FADD4
03508  C9B5  90 12              BCC FADDA
03509  C9B7  84 5E              STY FACEXP
03510  C9B9  A4 6B              LDY ARGSGN
03511  C9BB  84 63              STY FACSGN
03512  C9BD  49 FF              EOR #@377
03513  C9BF  69 00              ADC #0
03514  C9C1  A0 00              LDY #0
03515  C9C3  84 53              STY OLDOV
03516  C9C5  A2 5E              LDX #FAC
03517  C9C7  D0 04              BNE FADD1
03518  C9C9  A0 00       FADDA  LDY #0
03519  C9CB  84 6D              STY FACOV
03520  C9CD  C9 F9       FADD1  CMP #$F9
03521  C9CF  30 C7              BMI FADD5
03522  C9D1  A8                 TAY
03523  C9D2  A5 6D              LDA FACOV
03524  C9D4  56 01              LSR 1,X
03525  C9D6  20 E6 CA           JSR ROLSHF
03526  C9D9  24 6C       FADD4  BIT ARISGN
03527  C9DB  10 57              BPL FADD2
03528  C9DD  A0 5E              LDY #FACEXP
03529  C9DF  E0 66              CPX #ARGEXP
03530  C9E1  F0 02              BEQ SUBIT
03531  C9E3  A0 66              LDY #ARGEXP
03532  C9E5  38          SUBIT  SEC
03533  C9E6  49 FF              EOR #@377
03534  C9E8  65 53              ADC OLDOV
03535  C9EA  85 6D              STA FACOV
03536  C9EC  B9 04 00           LDA 3+ADDPRC,Y
03537  C9EF  F5 04              SBC 3+ADDPRC,X






CODE16......PAGE 0049

LINE# LOC   CODE        LINE


03538  C9F1  85 62              STA FACLO
03539  C9F3  B9 03 00           LDA ADDPRC+2,Y
03540  C9F6  F5 03              SBC 2+ADDPRC,X
03541  C9F8  85 61              STA FACMO
03542  C9FA  B9 02 00           LDA 2,Y
03543  C9FD  F5 02              SBC 2,X
03544  C9FF  85 60              STA FACMOH
03545  CA01  B9 01 00           LDA 1,Y
03546  CA04  F5 01              SBC 1,X
03547  CA06  85 5F              STA FACHO
03548  CA08  B0 03       FADFLT BCS NORMAL
03549  CA0A  20 7D CA           JSR NEGFAC
03550  CA0D  A0 00       NORMAL LDY #0
03551  CA0F  98                 TYA
03552  CA10  18                 CLC
03553  CA11  A6 5F       NORM3  LDX FACHO
03554  CA13  D0 4A              BNE NORM1
03555  CA15  A6 60              LDX FACHO+1
03556  CA17  86 5F              STX FACHO
03557  CA19  A6 61              LDX FACMOH+1
03558  CA1B              .FIL   CODE18








































CODE18......PAGE 004A

LINE# LOC   CODE        LINE


03560  CA1B  86 60              STX FACMOH
03561  CA1D  A6 62              LDX FACMO+1
03562  CA1F  86 61              STX FACMO
03563  CA21  A6 6D              LDX FACOV
03564  CA23  86 62              STX FACLO
03565  CA25  84 6D              STY FACOV
03566  CA27  69 08              ADC #@10
03567  CA29              ADDPR2 =ADDPRC+ADDPRC
03568  CA29              ADDPR4 =ADDPR2+ADDPR2
03569  CA29              ADDPR8 =ADDPR4+ADDPR4
03570  CA29  C9 20              CMP #@30+ADDPR8
03571  CA2B  D0 E4              BNE NORM3
03572  CA2D  A9 00       ZEROFC LDA #0
03573  CA2F  85 5E       ZEROF1 STA FACEXP
03574  CA31  85 63       ZEROML STA FACSGN
03575  CA33  60                 RTS
03576  CA34  65 53       FADD2  ADC OLDOV
03577  CA36  85 6D              STA FACOV
03578  CA38  A5 62              LDA FACLO
03579  CA3A  65 6A              ADC ARGLO
03580  CA3C  85 62              STA FACLO
03581  CA3E  A5 61              LDA FACMO
03582  CA40  65 69              ADC ARGMO
03583  CA42  85 61              STA FACMO
03584  CA44  A5 60              LDA FACMOH
03585  CA46  65 68              ADC ARGMOH
03586  CA48  85 60              STA FACMOH
03587  CA4A  A5 5F              LDA FACHO
03588  CA4C  65 67              ADC ARGHO
03589  CA4E  85 5F              STA FACHO
03590  CA50  4C 6C CA           JMP SQUEEZ
03591  CA53  69 01       NORM2  ADC #1
03592  CA55  06 6D              ASL FACOV
03593  CA57  26 62              ROL FACLO
03594  CA59  26 61              ROL FACMO
03595  CA5B  26 60              ROL FACMOH
03596  CA5D  26 5F              ROL FACHO
03597  CA5F  10 F2       NORM1  BPL NORM2
03598  CA61  38                 SEC
03599  CA62  E5 5E              SBC FACEXP
03600  CA64  B0 C7              BCS ZEROFC
03601  CA66  49 FF              EOR #@377
03602  CA68  69 01              ADC #1
03603  CA6A  85 5E              STA FACEXP
03604  CA6C  90 0E       SQUEEZ BCC RNDRTS
03605  CA6E  E6 5E       RNDSHF INC FACEXP
03606  CA70  F0 42              BEQ OVERR
03607  CA72  66 5F              ROR FACHO
03608  CA74  66 60              ROR FACMOH
03609  CA76  66 61              ROR FACMO
03610  CA78  66 62              ROR FACLO
03611  CA7A  66 6D              ROR FACOV
03612  CA7C  60          RNDRTS RTS
03613  CA7D  A5 63       NEGFAC LDA FACSGN
03614  CA7F  49 FF              EOR #@377






CODE18......PAGE 004B

LINE# LOC   CODE        LINE


03615  CA81  85 63              STA FACSGN
03616  CA83  A5 5F       NEGFCH LDA FACHO
03617  CA85  49 FF              EOR #@377
03618  CA87  85 5F              STA FACHO
03619  CA89  A5 60              LDA FACMOH
03620  CA8B  49 FF              EOR #@377
03621  CA8D  85 60              STA FACMOH
03622  CA8F  A5 61              LDA FACMO
03623  CA91  49 FF              EOR #@377
03624  CA93  85 61              STA FACMO
03625  CA95  A5 62              LDA FACLO
03626  CA97  49 FF              EOR #@377
03627  CA99  85 62              STA FACLO
03628  CA9B  A5 6D              LDA FACOV
03629  CA9D  49 FF              EOR #@377
03630  CA9F  85 6D              STA FACOV
03631  CAA1  E6 6D              INC FACOV
03632  CAA3  D0 0E              BNE INCFRT
03633  CAA5  E6 62       INCFAC INC FACLO
03634  CAA7  D0 0A              BNE INCFRT
03635  CAA9  E6 61              INC FACMO
03636  CAAB  D0 06              BNE INCFRT
03637  CAAD  E6 60              INC FACMOH
03638  CAAF  D0 02              BNE INCFRT
03639  CAB1  E6 5F              INC FACHO
03640  CAB3  60          INCFRT RTS
03641  CAB4  A2 45       OVERR  LDX #ERROV
03642  CAB6  4C CF B3           JMP ERROR
03643  CAB9  A2 22       MULSHF LDX #RESHO-1
03644  CABB  B4 04       SHFTR2 LDY 3+ADDPRC,X
03645  CABD  84 6D              STY FACOV
03646  CABF  B4 03              LDY 3,X
03647  CAC1  94 04              STY 4,X
03648  CAC3  B4 02              LDY 2,X
03649  CAC5  94 03              STY 3,X
03650  CAC7  B4 01              LDY 1,X
03651  CAC9  94 02              STY 2,X
03652  CACB  A4 65              LDY BITS
03653  CACD  94 01              STY 1,X
03654  CACF  69 08       SHIFTR ADC #@10
03655  CAD1  30 E8              BMI SHFTR2
03656  CAD3  F0 E6              BEQ SHFTR2
03657  CAD5  E9 08              SBC #@10
03658  CAD7  A8                 TAY
03659  CAD8  A5 6D              LDA FACOV
03660  CADA  B0 14              BCS SHFTRT
03661  CADC  16 01       SHFTR3 ASL 1,X
03662  CADE  90 02              BCC SHFTR4
03663  CAE0  F6 01              INC 1,X
03664  CAE2  76 01       SHFTR4 ROR 1,X
03665  CAE4  76 01              ROR 1,X
03666  CAE6  76 02       ROLSHF ROR 2,X
03667  CAE8  76 03              ROR 3,X
03668  CAEA  76 04              ROR 4,X
03669  CAEC  6A                 ROR A






CODE18......PAGE 004C

LINE# LOC   CODE        LINE


03670  CAED  C8                 INY
03671  CAEE  D0 EC              BNE SHFTR3
03672  CAF0  18          SHFTRT CLC
03673  CAF1  60                 RTS
03674  CAF2  81          FONE   .BYT @201,0,0,0,0
03674  CAF3  00 
03674  CAF4  00 
03674  CAF5  00 
03674  CAF6  00 
03675  CAF7  03          LOGCN2 .BYT 3,@177,@136,@126
03675  CAF8  7F 
03675  CAF9  5E 
03675  CAFA  56 
03676  CAFB  CB                 .BYT @313,@171,@200,@23
03676  CAFC  79 
03676  CAFD  80 
03676  CAFE  13 
03677  CAFF  9B                 .BYT @233,@13,@144,@200
03677  CB00  0B 
03677  CB01  64 
03677  CB02  80 
03678  CB03  76                 .BYT @166,@70,@223,@26
03678  CB04  38 
03678  CB05  93 
03678  CB06  16 
03679  CB07  82                 .BYT @202,@70,@252,@73,@40
03679  CB08  38 
03679  CB09  AA 
03679  CB0A  3B 
03679  CB0B  20 
03680  CB0C  80          SQR05  .BYT @200,@65,4,@363,@64
03680  CB0D  35 
03680  CB0E  04 
03680  CB0F  F3 
03680  CB10  34 
03681  CB11  81          SQR20  .BYT @201,@65,@4,@363,@64
03681  CB12  35 
03681  CB13  04 
03681  CB14  F3 
03681  CB15  34 
03682  CB16  80          NEGHLF .BYT @200,@200,0,0,0
03682  CB17  80 
03682  CB18  00 
03682  CB19  00 
03682  CB1A  00 
03683  CB1B  80          LOG2   .BYT @200,@61,@162,@27,@370
03683  CB1C  31 
03683  CB1D  72 
03683  CB1E  17 
03683  CB1F  F8 
03684  CB20              .FIL   CODE19










CODE19......PAGE 004D

LINE# LOC   CODE        LINE


03686  CB20  20 61 CD    LOG    JSR SIGN
03687  CB23  F0 02              BEQ LOGERR
03688  CB25  10 03              BPL LOG1
03689  CB27  4C 73 C3    LOGERR JMP FCERR
03690  CB2A  A5 5E       LOG1   LDA FACEXP
03691  CB2C  E9 7F              SBC #@177
03692  CB2E  48                 PHA
03693  CB2F  A9 80              LDA #@200
03694  CB31  85 5E              STA FACEXP
03695  CB33  A9 0C              LDA #<SQR05
03696  CB35  A0 CB              LDY #>SQR05
03697  CB37  20 9D C9           JSR FADD
03698  CB3A  A9 11              LDA #<SQR20
03699  CB3C  A0 CB              LDY #>SQR20
03700  CB3E  20 45 CC           JSR FDIV
03701  CB41  A9 F2              LDA #<FONE
03702  CB43  A0 CA              LDY #>FONE
03703  CB45  20 86 C9           JSR FSUB
03704  CB48  A9 F7              LDA #<LOGCN2
03705  CB4A  A0 CA              LDY #>LOGCN2
03706  CB4C  20 D7 D1           JSR POLYX
03707  CB4F  A9 16              LDA #<NEGHLF
03708  CB51  A0 CB              LDY #>NEGHLF
03709  CB53  20 9D C9           JSR FADD
03710  CB56  68                 PLA
03711  CB57  20 B4 CE           JSR FINLOG
03712  CB5A  A9 1B       MULLN2 LDA #<LOG2
03713  CB5C  A0 CB              LDY #>LOG2
03714  CB5E  20 C2 CB    FMULT  JSR CONUPK
03715  CB61  D0 03       FMULTT BNE *+5
03716  CB63  4C C1 CB           JMP MULTRT
03717  CB66  20 ED CB           JSR MULDIV
03718  CB69  A9 00              LDA #0
03719  CB6B  85 23              STA RESHO
03720  CB6D  85 24              STA RESMOH
03721  CB6F  85 25              STA RESMO
03722  CB71  85 26              STA RESLO
03723  CB73  A5 6D              LDA FACOV
03724  CB75  20 8F CB           JSR MLTPLY
03725  CB78  A5 62              LDA FACLO
03726  CB7A  20 8F CB           JSR MLTPLY
03727  CB7D  A5 61              LDA FACMO
03728  CB7F  20 8F CB           JSR MLTPLY
03729  CB82  A5 60              LDA FACMOH
03730  CB84  20 8F CB           JSR MLTPLY
03731  CB87  A5 5F              LDA FACHO
03732  CB89  20 94 CB           JSR MLTPL1
03733  CB8C  4C C5 CC           JMP MOVFR
03734  CB8F  D0 03       MLTPLY BNE *+5
03735  CB91  4C B9 CA           JMP MULSHF
03736  CB94  4A          MLTPL1 LSR A
03737  CB95  09 80              ORA #@200
03738  CB97  A8          MLTPL2 TAY
03739  CB98  90 19              BCC MLTPL3
03740  CB9A  18                 CLC






CODE19......PAGE 004E

LINE# LOC   CODE        LINE


03741  CB9B  A5 26              LDA RESLO
03742  CB9D  65 6A              ADC ARGLO
03743  CB9F  85 26              STA RESLO
03744  CBA1  A5 25              LDA RESMO
03745  CBA3  65 69              ADC ARGMO
03746  CBA5  85 25              STA RESMO
03747  CBA7  A5 24              LDA RESMOH
03748  CBA9  65 68              ADC ARGMOH
03749  CBAB  85 24              STA RESMOH
03750  CBAD  A5 23              LDA RESHO
03751  CBAF  65 67              ADC ARGHO
03752  CBB1  85 23              STA RESHO
03753  CBB3  66 23       MLTPL3 ROR RESHO
03754  CBB5  66 24              ROR RESMOH
03755  CBB7  66 25              ROR RESMO
03756  CBB9  66 26              ROR RESLO
03757  CBBB  66 6D              ROR FACOV
03758  CBBD  98                 TYA
03759  CBBE  4A                 LSR A
03760  CBBF  D0 D6              BNE MLTPL2
03761  CBC1  60          MULTRT RTS
03762  CBC2  85 1F       CONUPK STA INDEX1
03763  CBC4  84 20              STY INDEX1+1
03764  CBC6  A0 04              LDY #4
03765  CBC8  B1 1F              LDA (INDEX1)Y
03766  CBCA  85 6A              STA ARGLO
03767  CBCC  88                 DEY
03768  CBCD  B1 1F              LDA (INDEX)Y
03769  CBCF  85 69              STA ARGMO
03770  CBD1  88                 DEY
03771  CBD2  B1 1F              LDA (INDEX1)Y
03772  CBD4  85 68              STA ARGMOH
03773  CBD6  88                 DEY
03774  CBD7  B1 1F              LDA (INDEX1)Y
03775  CBD9  85 6B              STA ARGSGN
03776  CBDB  45 63              EOR FACSGN
03777  CBDD  85 6C              STA ARISGN
03778  CBDF  A5 6B              LDA ARGSGN
03779  CBE1  09 80              ORA #@200
03780  CBE3  85 67              STA ARGHO
03781  CBE5  88                 DEY
03782  CBE6  B1 1F              LDA (INDEX1)Y
03783  CBE8  85 66              STA ARGEXP
03784  CBEA  A5 5E              LDA FACEXP
03785  CBEC  60                 RTS
03786  CBED  A5 66       MULDIV LDA ARGEXP
03787  CBEF  F0 1F       MLDEXP BEQ ZEREMV
03788  CBF1  18                 CLC
03789  CBF2  65 5E              ADC FACEXP
03790  CBF4  90 04              BCC TRYOFF
03791  CBF6  30 1D              BMI GOOVER
03792  CBF8  18                 CLC
03793  CBF9  2C                 .BYT $2C
03794  CBFA  10 14       TRYOFF BPL ZEREMV
03795  CBFC  69 80              ADC #@200






CODE19......PAGE 004F

LINE# LOC   CODE        LINE


03796  CBFE  85 5E              STA FACEXP
03797  CC00  D0 03              BNE *+5
03798  CC02  4C 31 CA           JMP ZEROML
03799  CC05  A5 6C              LDA ARISGN
03800  CC07  85 63              STA FACSGN
03801  CC09  60                 RTS
03802  CC0A  A5 63       MLDVEX LDA FACSGN
03803  CC0C  49 FF              EOR #@377
03804  CC0E  30 05              BMI GOOVER
03805  CC10  68          ZEREMV PLA
03806  CC11  68                 PLA
03807  CC12  4C 2D CA           JMP ZEROFC
03808  CC15  4C B4 CA    GOOVER JMP OVERR
03809  CC18  20 42 CD    MUL10  JSR MOVAF
03810  CC1B  AA                 TAX
03811  CC1C  F0 10              BEQ MUL10R
03812  CC1E  18                 CLC
03813  CC1F  69 02              ADC #2
03814  CC21  B0 F2              BCS GOOVER
03815  CC23  A2 00       FINML6 LDX #0
03816  CC25  86 6C              STX ARISGN
03817  CC27  20 AD C9           JSR FADDC
03818  CC2A  E6 5E              INC FACEXP
03819  CC2C  F0 E7              BEQ GOOVER
03820  CC2E  60          MUL10R RTS
03821  CC2F  84          TENC   .BYT @204,@40,0,0,0
03821  CC30  20 
03821  CC31  00 
03821  CC32  00 
03821  CC33  00 
03822  CC34  20 42 CD    DIV10  JSR MOVAF
03823  CC37  A9 2F              LDA #<TENC
03824  CC39  A0 CC              LDY #>TENC
03825  CC3B  A2 00              LDX #0
03826  CC3D  86 6C       FDIVF  STX ARISGN
03827  CC3F  20 D8 CC           JSR MOVFM
03828  CC42  4C 48 CC           JMP FDIVT
03829  CC45  20 C2 CB    FDIV   JSR CONUPK
03830  CC48  F0 76       FDIVT  BEQ DV0ERR
03831  CC4A  20 51 CD           JSR ROUND
03832  CC4D  A9 00              LDA #0
03833  CC4F  38                 SEC
03834  CC50  E5 5E              SBC FACEXP
03835  CC52  85 5E              STA FACEXP
03836  CC54  20 ED CB           JSR MULDIV
03837  CC57  E6 5E              INC FACEXP
03838  CC59  F0 BA              BEQ GOOVER
03839  CC5B  A2 FC              LDX #$FC
03840  CC5D  A9 01              LDA #1
03841  CC5F  A4 67       DIVIDE LDY ARGHO
03842  CC61  C4 5F              CPY FACHO
03843  CC63  D0 10              BNE SAVQUO
03844  CC65  A4 68              LDY ARGMOH
03845  CC67  C4 60              CPY FACMOH
03846  CC69  D0 0A              BNE SAVQUO






CODE19......PAGE 0050

LINE# LOC   CODE        LINE


03847  CC6B  A4 69              LDY ARGMO
03848  CC6D  C4 61              CPY FACMO
03849  CC6F  D0 04              BNE SAVQUO
03850  CC71  A4 6A              LDY ARGLO
03851  CC73  C4 62              CPY FACLO
03852  CC75  08          SAVQUO PHP
03853  CC76  2A                 ROL A
03854  CC77  90 09              BCC QSHFT
03855  CC79  E8                 INX
03856  CC7A  95 26              STA RESLO,X
03857  CC7C  F0 32              BEQ LD100
03858  CC7E  10 34              BPL DIVNRM
03859  CC80  A9 01              LDA #1
03860  CC82  28          QSHFT  PLP
03861  CC83  B0 0E              BCS DIVSUB
03862  CC85  06 6A       SHFARG ASL ARGLO
03863  CC87  26 69              ROL ARGMO
03864  CC89  26 68              ROL ARGMOH
03865  CC8B  26 67              ROL ARGHO
03866  CC8D  B0 E6              BCS SAVQUO
03867  CC8F  30 CE              BMI DIVIDE
03868  CC91  10 E2              BPL SAVQUO
03869  CC93  A8          DIVSUB TAY
03870  CC94  A5 6A              LDA ARGLO
03871  CC96  E5 62              SBC FACLO
03872  CC98  85 6A              STA ARGLO
03873  CC9A  A5 69              LDA ARGMO
03874  CC9C  E5 61              SBC FACMO
03875  CC9E  85 69              STA ARGMO
03876  CCA0  A5 68              LDA ARGMOH
03877  CCA2  E5 60              SBC FACMOH
03878  CCA4  85 68              STA ARGMOH
03879  CCA6  A5 67              LDA ARGHO
03880  CCA8  E5 5F              SBC FACHO
03881  CCAA  85 67              STA ARGHO
03882  CCAC  98                 TYA
03883  CCAD  4C 85 CC           JMP SHFARG
03884  CCB0  A9 40       LD100  LDA #@100
03885  CCB2  D0 CE              BNE QSHFT
03886  CCB4  0A          DIVNRM ASL A
03887  CCB5  0A                 ASL A
03888  CCB6  0A                 ASL A
03889  CCB7  0A                 ASL A
03890  CCB8  0A                 ASL A
03891  CCB9  0A                 ASL A
03892  CCBA  85 6D              STA FACOV
03893  CCBC  28                 PLP
03894  CCBD  4C C5 CC           JMP MOVFR
03895  CCC0  A2 85       DV0ERR LDX #ERRDVO
03896  CCC2  4C CF B3           JMP ERROR
03897  CCC5              .FIL   CODE20










CODE20......PAGE 0051

LINE# LOC   CODE        LINE


03899  CCC5  A5 23       MOVFR  LDA RESHO
03900  CCC7  85 5F              STA FACHO
03901  CCC9  A5 24              LDA RESMOH
03902  CCCB  85 60              STA FACMOH
03903  CCCD  A5 25              LDA RESMO
03904  CCCF  85 61              STA FACMO
03905  CCD1  A5 26              LDA RESLO
03906  CCD3  85 62              STA FACLO
03907  CCD5  4C 0D CA           JMP NORMAL
03908  CCD8  85 1F       MOVFM  STA INDEX1
03909  CCDA  84 20              STY INDEX1+1
03910  CCDC  A0 04              LDY #3+ADDPRC
03911  CCDE  B1 1F              LDA (INDEX1)Y
03912  CCE0  85 62              STA FACLO
03913  CCE2  88                 DEY
03914  CCE3  B1 1F              LDA (INDEX1)Y
03915  CCE5  85 61              STA FACMO
03916  CCE7  88                 DEY
03917  CCE8  B1 1F              LDA (INDEX1)Y
03918  CCEA  85 60              STA FACMOH
03919  CCEC  88                 DEY
03920  CCED  B1 1F              LDA (INDEX1)Y
03921  CCEF  85 63              STA FACSGN
03922  CCF1  09 80              ORA #@200
03923  CCF3  85 5F              STA FACHO
03924  CCF5  88                 DEY
03925  CCF6  B1 1F              LDA (INDEX1)Y
03926  CCF8  85 5E              STA FACEXP
03927  CCFA  84 6D              STY FACOV
03928  CCFC  60                 RTS
03929  CCFD  A2 59       MOV2F  LDX #TEMPF2
03930  CCFF  2C                 .BYT $2C
03931  CD00  A2 54       MOV1F  LDX #TEMPF1
03932  CD02  A0 00              LDY #0
03933  CD04  F0 04              BEQ MOVMF
03934  CD06  A6 46       MOVVF  LDX FORPNT
03935  CD08  A4 47              LDY FORPNT+1
03936  CD0A  20 51 CD    MOVMF  JSR ROUND
03937  CD0D  86 1F              STX INDEX1
03938  CD0F  84 20              STY INDEX1+1
03939  CD11  A0 04              LDY #3+ADDPRC
03940  CD13  A5 62              LDA FACLO
03941  CD15  91 1F              STA (INDEX)Y
03942  CD17  88                 DEY
03943  CD18  A5 61              LDA FACMO
03944  CD1A  91 1F              STA (INDEX)Y
03945  CD1C  88                 DEY
03946  CD1D  A5 60              LDA FACMOH
03947  CD1F  91 1F              STA (INDEX)Y
03948  CD21  88                 DEY
03949  CD22  A5 63              LDA FACSGN
03950  CD24  09 7F              ORA #@177
03951  CD26  25 5F              AND FACHO
03952  CD28  91 1F              STA (INDEX)Y
03953  CD2A  88                 DEY






CODE20......PAGE 0052

LINE# LOC   CODE        LINE


03954  CD2B  A5 5E              LDA FACEXP
03955  CD2D  91 1F              STA (INDEX)Y
03956  CD2F  84 6D              STY FACOV
03957  CD31  60                 RTS
03958  CD32  A5 6B       MOVFA  LDA ARGSGN
03959  CD34  85 63       MOVFA1 STA FACSGN
03960  CD36  A2 05              LDX #4+ADDPRC
03961  CD38  B5 65       MOVFAL LDA ARGEXP-1,X
03962  CD3A  95 5D              STA FACEXP-1,X
03963  CD3C  CA                 DEX
03964  CD3D  D0 F9              BNE MOVFAL
03965  CD3F  86 6D              STX FACOV
03966  CD41  60                 RTS
03967  CD42  20 51 CD    MOVAF  JSR ROUND
03968  CD45  A2 06       MOVEF  LDX #5+ADDPRC
03969  CD47  B5 5D       MOVAFL LDA FACEXP-1,X
03970  CD49  95 65              STA ARGEXP-1,X
03971  CD4B  CA                 DEX
03972  CD4C  D0 F9              BNE MOVAFL
03973  CD4E  86 6D              STX FACOV
03974  CD50  60          MOVRTS RTS
03975  CD51  A5 5E       ROUND  LDA FACEXP
03976  CD53  F0 FB              BEQ MOVRTS
03977  CD55  06 6D              ASL FACOV
03978  CD57  90 F7              BCC MOVRTS
03979  CD59  20 A5 CA    INCRND JSR INCFAC
03980  CD5C  D0 F2              BNE MOVRTS
03981  CD5E  4C 6E CA           JMP RNDSHF
03982  CD61  A5 5E       SIGN   LDA FACEXP
03983  CD63  F0 09              BEQ SIGNRT
03984  CD65  A5 63       FCSIGN LDA FACSGN
03985  CD67  2A          FCOMPS ROL A
03986  CD68  A9 FF              LDA #$FF
03987  CD6A  B0 02              BCS SIGNRT
03988  CD6C  A9 01              LDA #1
03989  CD6E  60          SIGNRT RTS
03990  CD6F  20 61 CD    SGN    JSR SIGN
03991  CD72  85 5F       FLOAT  STA FACHO
03992  CD74  A9 00              LDA #0
03993  CD76  85 60              STA FACHO+1
03994  CD78  A2 88              LDX #@210
03995  CD7A  A5 5F       FLOATS LDA FACHO
03996  CD7C  49 FF              EOR #@377
03997  CD7E  2A                 ROL A
03998  CD7F  A9 00       FLOATC LDA #0
03999  CD81  85 62              STA FACLO
04000  CD83  85 61              STA FACMO
04001  CD85  86 5E       FLOATB STX FACEXP
04002  CD87  85 6D              STA FACOV
04003  CD89  85 63              STA FACSGN
04004  CD8B  4C 08 CA           JMP FADFLT
04005  CD8E  46 63       ABS    LSR FACSGN
04006  CD90  60                 RTS
04007  CD91  85 21       FCOMP  STA INDEX2
04008  CD93  84 22       FCOMPN STY INDEX2+1






CODE20......PAGE 0053

LINE# LOC   CODE        LINE


04009  CD95  A0 00              LDY #0
04010  CD97  B1 21              LDA (INDEX2)Y
04011  CD99  C8                 INY
04012  CD9A  AA                 TAX
04013  CD9B  F0 C4              BEQ SIGN
04014  CD9D  B1 21              LDA (INDEX2)Y
04015  CD9F  45 63              EOR FACSGN
04016  CDA1  30 C2              BMI FCSIGN
04017  CDA3  E4 5E              CPX FACEXP
04018  CDA5  D0 21              BNE FCOMPC
04019  CDA7  B1 21              LDA (INDEX2)Y
04020  CDA9  09 80              ORA #@200
04021  CDAB  C5 5F              CMP FACHO
04022  CDAD  D0 19              BNE FCOMPC
04023  CDAF  C8                 INY
04024  CDB0  B1 21              LDA (INDEX2)Y
04025  CDB2  C5 60              CMP FACMOH
04026  CDB4  D0 12              BNE FCOMPC
04027  CDB6  C8                 INY
04028  CDB7  B1 21              LDA (INDEX2)Y
04029  CDB9  C5 61              CMP FACMO
04030  CDBB  D0 0B              BNE FCOMPC
04031  CDBD  C8                 INY
04032  CDBE  A9 7F              LDA #@177
04033  CDC0  C5 6D              CMP FACOV
04034  CDC2  B1 21              LDA (INDEX2)Y
04035  CDC4  E5 62              SBC FACLO
04036  CDC6  F0 28              BEQ QINTRT
04037  CDC8  A5 63       FCOMPC LDA FACSGN
04038  CDCA  90 02              BCC FCOMPD
04039  CDCC  49 FF              EOR #@377
04040  CDCE  4C 67 CD    FCOMPD JMP FCOMPS
04041  CDD1              .FIL   CODE21




























CODE21......PAGE 0054

LINE# LOC   CODE        LINE


04043  CDD1  A5 5E       QINT   LDA FACEXP
04044  CDD3  F0 4A              BEQ CLRFAC
04045  CDD5  38                 SEC
04046  CDD6  E9 A0              SBC #ADDPR8+@230
04047  CDD8  24 63              BIT FACSGN
04048  CDDA  10 09              BPL QISHFT
04049  CDDC  AA                 TAX
04050  CDDD  A9 FF              LDA #@377
04051  CDDF  85 65              STA BITS
04052  CDE1  20 83 CA           JSR NEGFCH
04053  CDE4  8A                 TXA
04054  CDE5  A2 5E       QISHFT LDX #FAC
04055  CDE7  C9 F9              CMP #$F9
04056  CDE9  10 06              BPL QINT1
04057  CDEB  20 CF CA           JSR SHIFTR
04058  CDEE  84 65              STY BITS
04059  CDF0  60          QINTRT RTS
04060  CDF1  A8          QINT1  TAY
04061  CDF2  A5 63              LDA FACSGN
04062  CDF4  29 80              AND #@200
04063  CDF6  46 5F              LSR FACHO
04064  CDF8  05 5F              ORA FACHO
04065  CDFA  85 5F              STA FACHO
04066  CDFC  20 E6 CA           JSR ROLSHF
04067  CDFF  84 65              STY BITS
04068  CE01  60                 RTS
04069  CE02  A5 5E       INT    LDA FACEXP
04070  CE04  C9 A0              CMP #ADDPR8+@230
04071  CE06  B0 20              BCS INTRTS
04072  CE08  20 D1 CD           JSR QINT
04073  CE0B  84 6D              STY FACOV
04074  CE0D  A5 63              LDA FACSGN
04075  CE0F  84 63              STY FACSGN
04076  CE11  49 80              EOR #@200
04077  CE13  2A                 ROL A
04078  CE14  A9 A0              LDA #@230+8
04079  CE16  85 5E              STA FACEXP
04080  CE18  A5 62              LDA FACLO
04081  CE1A  85 03              STA INTEGR
04082  CE1C  4C 08 CA           JMP FADFLT
04083  CE1F  85 5F       CLRFAC STA FACHO
04084  CE21  85 60              STA FACMOH
04085  CE23  85 61              STA FACMO
04086  CE25  85 62              STA FACLO
04087  CE27  A8                 TAY
04088  CE28  60          INTRTS RTS
04089  CE29  A0 00       FIN    LDY #@0
04090  CE2B  A2 0A              LDX #@11+ADDPRC
04091  CE2D  94 5A       FINZLP STY DECCNT,X
04092  CE2F  CA                 DEX
04093  CE30  10 FB              BPL FINZLP
04094  CE32  90 0F              BCC FINDGQ
04095  CE34  C9 2D              CMP #'-
04096  CE36  D0 04              BNE QPLUS
04097  CE38  86 64              STX SGNFLG






CODE21......PAGE 0055

LINE# LOC   CODE        LINE


04098  CE3A  F0 04              BEQ FINC
04099  CE3C  C9 2B       QPLUS  CMP #'+
04100  CE3E  D0 05              BNE FIN1
04101  CE40  20 70 00    FINC   JSR CHRGET
04102  CE43  90 5B       FINDGQ BCC FINDIG
04103  CE45  C9 2E       FIN1   CMP #'.
04104  CE47  F0 2E              BEQ FINDP
04105  CE49  C9 45              CMP #'E
04106  CE4B  D0 30              BNE FINE
04107  CE4D  20 70 00           JSR CHRGET
04108  CE50  90 17              BCC FNEDG1
04109  CE52  C9 AB              CMP #MINUTK
04110  CE54  F0 0E              BEQ FINEC1
04111  CE56  C9 2D              CMP #'-
04112  CE58  F0 0A              BEQ FINEC1
04113  CE5A  C9 AA              CMP #PLUSTK
04114  CE5C  F0 08              BEQ FINEC
04115  CE5E  C9 2B              CMP #'+
04116  CE60  F0 04              BEQ FINEC
04117  CE62  D0 07              BNE FINEC2
04118  CE64  66 5D       FINEC1 ROR EXPSGN
04119  CE66  20 70 00    FINEC  JSR CHRGET
04120  CE69  90 5C       FNEDG1 BCC FINEDG
04121  CE6B  24 5D       FINEC2 BIT EXPSGN
04122  CE6D  10 0E              BPL FINE
04123  CE6F  A9 00              LDA #0
04124  CE71  38                 SEC
04125  CE72  E5 5B              SBC TENEXP
04126  CE74  4C 7F CE           JMP FINE1
04127  CE77  66 5C       FINDP  ROR DPTFLG
04128  CE79  24 5C              BIT DPTFLG
04129  CE7B  50 C3              BVC FINC
04130  CE7D  A5 5B       FINE   LDA TENEXP
04131  CE7F  38          FINE1  SEC
04132  CE80  E5 5A              SBC DECCNT
04133  CE82  85 5B              STA TENEXP
04134  CE84  F0 12              BEQ FINQNG
04135  CE86  10 09              BPL FINMUL
04136  CE88  20 34 CC    FINDIV JSR DIV10
04137  CE8B  E6 5B              INC TENEXP
04138  CE8D  D0 F9              BNE FINDIV
04139  CE8F  F0 07              BEQ FINQNG
04140  CE91  20 18 CC    FINMUL JSR MUL10
04141  CE94  C6 5B              DEC TENEXP
04142  CE96  D0 F9              BNE FINMUL
04143  CE98  A5 64       FINQNG LDA SGNFLG
04144  CE9A  30 01              BMI NEGXQS
04145  CE9C  60                 RTS
04146  CE9D  4C 4B D1    NEGXQS JMP NEGOP
04147  CEA0  48          FINDIG PHA
04148  CEA1  24 5C              BIT DPTFLG
04149  CEA3  10 02              BPL FINDG1
04150  CEA5  E6 5A              INC DECCNT
04151  CEA7  20 18 CC    FINDG1 JSR MUL10
04152  CEAA  68                 PLA






CODE21......PAGE 0056

LINE# LOC   CODE        LINE


04153  CEAB  38                 SEC
04154  CEAC  E9 30              SBC #'0
04155  CEAE  20 B4 CE           JSR FINLOG
04156  CEB1  4C 40 CE           JMP FINC
04157  CEB4  48          FINLOG PHA
04158  CEB5  20 42 CD           JSR MOVAF
04159  CEB8  68                 PLA
04160  CEB9  20 72 CD           JSR FLOAT
04161  CEBC  A5 6B              LDA ARGSGN
04162  CEBE  45 63              EOR FACSGN
04163  CEC0  85 6C              STA ARISGN
04164  CEC2  A6 5E              LDX FACEXP
04165  CEC4  4C A0 C9           JMP FADDT
04166  CEC7  A5 5B       FINEDG LDA TENEXP
04167  CEC9  C9 0A              CMP #@12
04168  CECB  90 09              BCC MLEX10
04169  CECD  A9 64              LDA #@144
04170  CECF  24 5D              BIT EXPSGN
04171  CED1  30 11              BMI MLEXMI
04172  CED3  4C B4 CA           JMP OVERR
04173  CED6  0A          MLEX10 ASL A
04174  CED7  0A                 ASL A
04175  CED8  18                 CLC
04176  CED9  65 5B              ADC TENEXP
04177  CEDB  0A                 ASL A
04178  CEDC  18                 CLC
04179  CEDD  A0 00              LDY #0
04180  CEDF  71 77              ADC (TXTPTR)Y
04181  CEE1  38                 SEC
04182  CEE2  E9 30              SBC #'0
04183  CEE4  85 5B       MLEXMI STA TENEXP
04184  CEE6  4C 66 CE           JMP FINEC
04185  CEE9              .FIL   CODE22




























CODE22......PAGE 0057

LINE# LOC   CODE        LINE


04187  CEE9  9B          N0999  .BYT @233,@76,@274,@37,@375
04187  CEEA  3E 
04187  CEEB  BC 
04187  CEEC  1F 
04187  CEED  FD 
04188  CEEE  9E          N9999  .BYT @236,@156,@153,@47,@375
04188  CEEF  6E 
04188  CEF0  6B 
04188  CEF1  27 
04188  CEF2  FD 
04189  CEF3  9E          NMIL   .BYT @236,@156,@153,@50,0
04189  CEF4  6E 
04189  CEF5  6B 
04189  CEF6  28 
04189  CEF7  00 
04190  CEF8  00          CHSUMC .BYT 0          ;C-PAGE CHECKSUM 
04191  CEF9                     *=*+127
04192  CF78  A9 0D       INPRT  LDA #<INTXT
04193  CF7A  A0 B3              LDY #>INTXT
04194  CF7C  20 90 CF           JSR STROU2
04195  CF7F  A5 37              LDA CURLIN+1
04196  CF81  A6 36              LDX CURLIN
04197  CF83  85 5F       LINPRT STA FACHO
04198  CF85  86 60              STX FACHO+1
04199  CF87  A2 90              LDX #@220
04200  CF89  38                 SEC
04201  CF8A  20 7F CD           JSR FLOATC
04202  CF8D  20 93 CF           JSR FOUT
04203  CF90  4C 1D BB    STROU2 JMP STROUT
04204  CF93  A0 01       FOUT   LDY #1
04205  CF95  A9 20       FOUTC  LDA #' 
04206  CF97  24 63              BIT FACSGN
04207  CF99  10 02              BPL FOUT1
04208  CF9B  A9 2D              LDA #'-
04209  CF9D  99 FF 00    FOUT1  STA FBUFFR-1,Y
04210  CFA0  85 63              STA FACSGN
04211  CFA2  84 6E              STY FBUFPT
04212  CFA4  C8                 INY
04213  CFA5  A9 30              LDA #'0
04214  CFA7  A6 5E              LDX FACEXP
04215  CFA9  D0 03              BNE *+5
04216  CFAB  4C BA D0           JMP FOUT19
04217  CFAE  A9 00              LDA #0
04218  CFB0  E0 80              CPX #@200
04219  CFB2  F0 02              BEQ FOUT37
04220  CFB4  B0 09              BCS FOUT7
04221  CFB6  A9 F3       FOUT37 LDA #<NMIL
04222  CFB8  A0 CE              LDY #>NMIL
04223  CFBA  20 5E CB           JSR FMULT
04224  CFBD  A9 F7              LDA #250-ADDPR2-ADDPRC
04225  CFBF  85 5A       FOUT7  STA DECCNT
04226  CFC1  A9 EE       FOUT4  LDA #<N9999
04227  CFC3  A0 CE              LDY #>N9999
04228  CFC5  20 91 CD           JSR FCOMP
04229  CFC8  F0 1E              BEQ BIGGES






CODE22......PAGE 0058

LINE# LOC   CODE        LINE


04230  CFCA  10 12              BPL FOUT9
04231  CFCC  A9 E9       FOUT3  LDA #<N0999
04232  CFCE  A0 CE              LDY #>N0999
04233  CFD0  20 91 CD           JSR FCOMP
04234  CFD3  F0 02              BEQ FOUT38
04235  CFD5  10 0E              BPL FOUT5
04236  CFD7  20 18 CC    FOUT38 JSR MUL10
04237  CFDA  C6 5A              DEC DECCNT
04238  CFDC  D0 EE              BNE FOUT3
04239  CFDE  20 34 CC    FOUT9  JSR DIV10
04240  CFE1  E6 5A              INC DECCNT
04241  CFE3  D0 DC              BNE FOUT4
04242  CFE5  20 7F C9    FOUT5  JSR FADDH
04243  CFE8  20 D1 CD    BIGGES JSR QINT
04244  CFEB  A2 01              LDX #1
04245  CFED  A5 5A              LDA DECCNT
04246  CFEF  18                 CLC
04247  CFF0  69 0A              ADC #ADDPR2+ADDPRC+7
04248  CFF2  30 09              BMI FOUTPI
04249  CFF4  C9 0B              CMP #ADDPR2+ADDPRC+@10
04250  CFF6  B0 06              BCS FOUT6
04251  CFF8  69 FF              ADC #$FF
04252  CFFA  AA                 TAX
04253  CFFB  A9 02              LDA #2
04254  CFFD  38          FOUTPI SEC
04255  CFFE  E9 02       FOUT6  SBC #2
04256  D000  85 5B              STA TENEXP
04257  D002  86 5A              STX DECCNT
04258  D004  8A                 TXA
04259  D005  F0 02              BEQ FOUT39
04260  D007  10 13              BPL FOUT8
04261  D009  A4 6E       FOUT39 LDY FBUFPT
04262  D00B  A9 2E              LDA #'.
04263  D00D  C8                 INY
04264  D00E  99 FF 00           STA FBUFFR-1,Y
04265  D011  8A                 TXA
04266  D012  F0 06              BEQ FOUT16
04267  D014  A9 30              LDA #'0
04268  D016  C8                 INY
04269  D017  99 FF 00           STA FBUFFR-1,Y
04270  D01A  84 6E       FOUT16 STY FBUFPT
04271  D01C  A0 00       FOUT8  LDY #0
04272  D01E  A2 80       FOUTIM LDX #@200
04273  D020  A5 62       FOUT2  LDA FACLO
04274  D022  18                 CLC
04275  D023  79 CF D0           ADC FOUTBL+2+ADDPRC,Y
04276  D026  85 62              STA FACLO
04277  D028  A5 61              LDA FACMO
04278  D02A  79 CE D0           ADC FOUTBL+1+ADDPRC,Y
04279  D02D  85 61              STA FACMO
04280  D02F  A5 60              LDA FACMOH
04281  D031  79 CD D0           ADC FOUTBL+1,Y
04282  D034  85 60              STA FACMOH
04283  D036  A5 5F              LDA FACHO
04284  D038  79 CC D0           ADC FOUTBL,Y






CODE22......PAGE 0059

LINE# LOC   CODE        LINE


04285  D03B  85 5F              STA FACHO
04286  D03D  E8                 INX
04287  D03E  B0 04              BCS FOUT41
04288  D040  10 DE              BPL FOUT2
04289  D042  30 02              BMI FOUT40
04290  D044  30 DA       FOUT41 BMI FOUT2
04291  D046  8A          FOUT40 TXA
04292  D047  90 04              BCC FOUTYP
04293  D049  49 FF              EOR #@377
04294  D04B  69 0A              ADC #@12
04295  D04D  69 2F       FOUTYP ADC #@57
04296  D04F  C8                 INY
04297  D050  C8                 INY
04298  D051  C8                 INY
04299  D052  C8                 INY
04300  D053  84 44              STY FDECPT
04301  D055  A4 6E              LDY FBUFPT
04302  D057  C8                 INY
04303  D058  AA                 TAX
04304  D059  29 7F              AND #@177
04305  D05B  99 FF 00           STA FBUFFR-1,Y
04306  D05E  C6 5A              DEC DECCNT
04307  D060  D0 06              BNE STXBUF
04308  D062  A9 2E              LDA #'.
04309  D064  C8                 INY
04310  D065  99 FF 00           STA FBUFFR-1,Y
04311  D068  84 6E       STXBUF STY FBUFPT
04312  D06A  A4 44              LDY FDECPT
04313  D06C  8A                 TXA
04314  D06D  49 FF              EOR #@377
04315  D06F  29 80              AND #@200
04316  D071  AA                 TAX
04317  D072  C0 24              CPY #FDCEND-FOUTBL
04318  D074  F0 04              BEQ FOULDY
04319  D076  C0 3C              CPY #TIMEND-FOUTBL
04320  D078  D0 A6              BNE FOUT2
04321  D07A  A4 6E       FOULDY LDY FBUFPT
04322  D07C  B9 FF 00    FOUT11 LDA FBUFFR-1,Y
04323  D07F  88                 DEY
04324  D080  C9 30              CMP #'0
04325  D082  F0 F8              BEQ FOUT11
04326  D084  C9 2E              CMP #'.
04327  D086  F0 01              BEQ FOUT12
04328  D088  C8                 INY
04329  D089  A9 2B       FOUT12 LDA #'+
04330  D08B  A6 5B              LDX TENEXP
04331  D08D  F0 2E              BEQ FOUT17
04332  D08F  10 08              BPL FOUT14
04333  D091  A9 00              LDA #0
04334  D093  38                 SEC
04335  D094  E5 5B              SBC TENEXP
04336  D096  AA                 TAX
04337  D097              .FIL   CODE23








CODE23......PAGE 005A

LINE# LOC   CODE        LINE


04339  D097  A9 2D              LDA #'-
04340  D099  99 01 01    FOUT14 STA FBUFFR+1,Y
04341  D09C  A9 45              LDA #'E
04342  D09E  99 00 01           STA FBUFFR,Y
04343  D0A1  8A                 TXA
04344  D0A2  A2 2F              LDX #@57
04345  D0A4  38                 SEC
04346  D0A5  E8          FOUT15 INX
04347  D0A6  E9 0A              SBC #@12
04348  D0A8  B0 FB              BCS FOUT15
04349  D0AA  69 3A              ADC #@72
04350  D0AC  99 03 01           STA FBUFFR+3,Y
04351  D0AF  8A                 TXA
04352  D0B0  99 02 01           STA FBUFFR+2,Y
04353  D0B3  A9 00              LDA #0
04354  D0B5  99 04 01           STA FBUFFR+4,Y
04355  D0B8  F0 08              BEQ FOUT20
04356  D0BA  99 FF 00    FOUT19 STA FBUFFR-1,Y
04357  D0BD  A9 00       FOUT17 LDA #0
04358  D0BF  99 00 01           STA FBUFFR,Y
04359  D0C2  A9 00       FOUT20 LDA #<FBUFFR
04360  D0C4  A0 01              LDY #>FBUFFR
04361  D0C6  60                 RTS
04362  D0C7  80          FHALF  .BYT @200,0
04362  D0C8  00 
04363  D0C9  00          ZERO   .BYT 0,0,0
04363  D0CA  00 
04363  D0CB  00 
04364  D0CC  FA          FOUTBL .BYT @372,@12,@37,0,0
04364  D0CD  0A 
04364  D0CE  1F 
04364  D0CF  00 
04364  D0D0  00 
04365  D0D1  98                 .BYT @230,@226,@200,@377
04365  D0D2  96 
04365  D0D3  80 
04365  D0D4  FF 
04366  D0D5  F0                 .BYT @360,@275,@300,0
04366  D0D6  BD 
04366  D0D7  C0 
04366  D0D8  00 
04367  D0D9  01                 .BYT 1,@206,@240,@377
04367  D0DA  86 
04367  D0DB  A0 
04367  D0DC  FF 
04368  D0DD  FF                 .BYT @377,@330,@360,0,0
04368  D0DE  D8 
04368  D0DF  F0 
04368  D0E0  00 
04368  D0E1  00 
04369  D0E2  03                 .BYT 3,@350,@377,@377
04369  D0E3  E8 
04369  D0E4  FF 
04369  D0E5  FF 
04370  D0E6  FF                 .BYT @377,@234,0,0,0,@12






CODE23......PAGE 005B

LINE# LOC   CODE        LINE


04370  D0E7  9C 
04370  D0E8  00 
04370  D0E9  00 
04370  D0EA  00 
04370  D0EB  0A 
04371  D0EC  FF                 .BYT @377,@377,@377,@377
04371  D0ED  FF 
04371  D0EE  FF 
04371  D0EF  FF 
04372  D0F0  FF          FDCEND .BYT @377,@337,@12,@200
04372  D0F1  DF 
04372  D0F2  0A 
04372  D0F3  80 
04373  D0F4  00                 .BYT 0,3,@113,@300,@377
04373  D0F5  03 
04373  D0F6  4B 
04373  D0F7  C0 
04373  D0F8  FF 
04374  D0F9  FF                 .BYT @377,@163,@140,0,0
04374  D0FA  73 
04374  D0FB  60 
04374  D0FC  00 
04374  D0FD  00 
04375  D0FE  0E                 .BYT @16,@20,@377,@377
04375  D0FF  10 
04375  D100  FF 
04375  D101  FF 
04376  D102  FD                 .BYT @375,@250,0,0,0,@74
04376  D103  A8 
04376  D104  00 
04376  D105  00 
04376  D106  00 
04376  D107  3C 
04377  D108              TIMEND
04378  D108  20 42 CD    SQR    JSR MOVAF
04379  D10B  A9 C7              LDA #<FHALF
04380  D10D  A0 D0              LDY #>FHALF
04381  D10F  20 D8 CC           JSR MOVFM
04382  D112  F0 70       FPWRT  BEQ EXP
04383  D114  A5 66              LDA ARGEXP
04384  D116  D0 03              BNE FPWRT1
04385  D118  4C 2F CA           JMP ZEROF1
04386  D11B  A2 4B       FPWRT1 LDX #<TEMPF3
04387  D11D  A0 00              LDY #>TEMPF3
04388  D11F  20 0A CD           JSR MOVMF
04389  D122  A5 6B              LDA ARGSGN
04390  D124  10 0F              BPL FPWR1
04391  D126  20 02 CE           JSR INT
04392  D129  A9 4B              LDA #<TEMPF3
04393  D12B  A0 00              LDY #>TEMPF3
04394  D12D  20 91 CD           JSR FCOMP
04395  D130  D0 03              BNE FPWR1
04396  D132  98                 TYA
04397  D133  A4 03              LDY INTEGR
04398  D135  20 34 CD    FPWR1  JSR MOVFA1






CODE23......PAGE 005C

LINE# LOC   CODE        LINE


04399  D138  98                 TYA
04400  D139  48                 PHA
04401  D13A  20 20 CB           JSR LOG
04402  D13D  A9 4B              LDA #<TEMPF3
04403  D13F  A0 00              LDY #>TEMPF3
04404  D141  20 5E CB           JSR FMULT
04405  D144  20 84 D1           JSR EXP
04406  D147  68                 PLA
04407  D148  4A                 LSR A
04408  D149  90 0A              BCC NEGRTS
04409  D14B  A5 5E       NEGOP  LDA FACEXP
04410  D14D  F0 06              BEQ NEGRTS
04411  D14F  A5 63              LDA FACSGN
04412  D151  49 FF              EOR #@377
04413  D153  85 63              STA FACSGN
04414  D155  60          NEGRTS RTS
04415  D156              .FIL   CODE24












































CODE24......PAGE 005D

LINE# LOC   CODE        LINE


04417  D156  81          LOGEB2 .BYT @201,@70,@252,@73,@51
04417  D157  38 
04417  D158  AA 
04417  D159  3B 
04417  D15A  29 
04418  D15B  07          EXPCON .BYT 7,@161,@64,@130,@76
04418  D15C  71 
04418  D15D  34 
04418  D15E  58 
04418  D15F  3E 
04419  D160  56                 .BYT @126,@164,@26,@176
04419  D161  74 
04419  D162  16 
04419  D163  7E 
04420  D164  B3                 .BYT @263,@33,@167,@57
04420  D165  1B 
04420  D166  77 
04420  D167  2F 
04421  D168  EE                 .BYT @356,@343,@205,@172
04421  D169  E3 
04421  D16A  85 
04421  D16B  7A 
04422  D16C  1D                 .BYT @35,@204,@34,@52
04422  D16D  84 
04422  D16E  1C 
04422  D16F  2A 
04423  D170  7C                 .BYT @174,@143,@131,@130
04423  D171  63 
04423  D172  59 
04423  D173  58 
04424  D174  0A                 .BYT @12,@176,@165,@375
04424  D175  7E 
04424  D176  75 
04424  D177  FD 
04425  D178  E7                 .BYT @347,@306,@200,@61
04425  D179  C6 
04425  D17A  80 
04425  D17B  31 
04426  D17C  72                 .BYT @162,@30,@20,@201
04426  D17D  18 
04426  D17E  10 
04426  D17F  81 
04427  D180  00                 .BYT 0,0,0,0
04427  D181  00 
04427  D182  00 
04427  D183  00 
04428  D184  A9 56       EXP    LDA #<LOGEB2
04429  D186  A0 D1              LDY #>LOGEB2
04430  D188  20 5E CB           JSR FMULT
04431  D18B  A5 6D              LDA FACOV
04432  D18D  69 50              ADC #@120
04433  D18F  90 03              BCC STOLD
04434  D191  20 59 CD           JSR INCRND
04435  D194              .FIL   CODE25
04436  D194              ;CODE25






CODE24......PAGE 005E

LINE# LOC   CODE        LINE


04437  D194  85 53       STOLD  STA OLDOV
04438  D196  20 45 CD           JSR MOVEF
04439  D199  A5 5E              LDA FACEXP
04440  D19B  C9 88              CMP #@210
04441  D19D  90 03              BCC EXP1
04442  D19F  20 0A CC    GOMLDV JSR MLDVEX
04443  D1A2  20 02 CE    EXP1   JSR INT
04444  D1A5  A5 03              LDA INTEGR
04445  D1A7  18                 CLC
04446  D1A8  69 81              ADC #@201
04447  D1AA  F0 F3              BEQ GOMLDV
04448  D1AC  38                 SEC
04449  D1AD  E9 01              SBC #1
04450  D1AF  48                 PHA
04451  D1B0  A2 05              LDX #4+ADDPRC
04452  D1B2  B5 66       SWAPLP LDA ARGEXP,X
04453  D1B4  B4 5E              LDY FACEXP,X
04454  D1B6  95 5E              STA FACEXP,X
04455  D1B8  94 66              STY ARGEXP,X
04456  D1BA  CA                 DEX
04457  D1BB  10 F5              BPL SWAPLP
04458  D1BD  A5 53              LDA OLDOV
04459  D1BF  85 6D              STA FACOV
04460  D1C1  20 89 C9           JSR FSUBT
04461  D1C4  20 4B D1           JSR NEGOP
04462  D1C7  A9 5B              LDA #<EXPCON
04463  D1C9  A0 D1              LDY #>EXPCON
04464  D1CB  20 ED D1           JSR POLY
04465  D1CE  A9 00              LDA #0
04466  D1D0  85 6C              STA ARISGN
04467  D1D2  68                 PLA
04468  D1D3  20 EF CB           JSR MLDEXP
04469  D1D6  60                 RTS
04470  D1D7  85 6E       POLYX  STA POLYPT
04471  D1D9  84 6F              STY POLYPT+1
04472  D1DB  20 00 CD           JSR MOV1F
04473  D1DE  A9 54              LDA #TEMPF1
04474  D1E0  20 5E CB           JSR FMULT
04475  D1E3  20 F1 D1           JSR POLY1
04476  D1E6  A9 54              LDA #<TEMPF1
04477  D1E8  A0 00              LDY #>TEMPF1
04478  D1EA  4C 5E CB           JMP FMULT
04479  D1ED  85 6E       POLY   STA POLYPT
04480  D1EF  84 6F              STY POLYPT+1
04481  D1F1  20 FD CC    POLY1  JSR MOV2F
04482  D1F4  B1 6E              LDA (POLYPT)Y
04483  D1F6  85 64              STA DEGREE
04484  D1F8  A4 6E              LDY POLYPT
04485  D1FA  C8                 INY
04486  D1FB  98                 TYA
04487  D1FC  D0 02              BNE POLY3
04488  D1FE  E6 6F              INC POLYPT+1
04489  D200  85 6E       POLY3  STA POLYPT
04490  D202  A4 6F              LDY POLYPT+1
04491  D204  20 5E CB    POLY2  JSR FMULT






CODE24......PAGE 005F

LINE# LOC   CODE        LINE


04492  D207  A5 6E              LDA POLYPT
04493  D209  A4 6F              LDY POLYPT+1
04494  D20B  18                 CLC
04495  D20C  69 05              ADC #4+ADDPRC
04496  D20E  90 01              BCC POLY4
04497  D210  C8                 INY
04498  D211  85 6E       POLY4  STA POLYPT
04499  D213  84 6F              STY POLYPT+1
04500  D215  20 9D C9           JSR FADD
04501  D218  A9 59              LDA #<TEMPF2
04502  D21A  A0 00              LDY #>TEMPF2
04503  D21C  C6 64              DEC DEGREE
04504  D21E  D0 E4              BNE POLY2
04505  D220  60                 RTS
04506  D221  98          RMULC  .BYT @230,@65,@104,@172
04506  D222  35 
04506  D223  44 
04506  D224  7A 
04507  D225  68          RADDC  .BYT @150,@50,@261,@106
04507  D226  28 
04507  D227  B1 
04507  D228  46 
04508  D229  20 61 CD    RND    JSR SIGN
04509  D22C  30 2E              BMI RND1
04510  D22E  D0 17              BNE QSETNR
04511  D230  AD 44 E8           LDA CHTIM
04512  D233  85 5F              STA FACHO
04513  D235  AD 48 E8           LDA CHTIM+4
04514  D238  85 60              STA FACMOH
04515  D23A  AD 45 E8           LDA CHTIM+1
04516  D23D  85 61              STA FACMO
04517  D23F  AD 49 E8           LDA CHTIM+5
04518  D242  85 62              STA FACLO
04519  D244  4C 6C D2           JMP STRNEX
04520  D247  A9 88       QSETNR LDA #<RNDX
04521  D249  A0 00              LDY #>RNDX
04522  D24B  20 D8 CC           JSR MOVFM
04523  D24E  A9 21              LDA #<RMULC
04524  D250  A0 D2              LDY #>RMULC
04525  D252  20 5E CB           JSR FMULT
04526  D255  A9 25              LDA #<RADDC
04527  D257  A0 D2              LDY #>RADDC
04528  D259  20 9D C9           JSR FADD
04529  D25C  A6 62       RND1   LDX FACLO
04530  D25E  A5 5F              LDA FACHO
04531  D260  85 62              STA FACLO
04532  D262  86 5F              STX FACHO
04533  D264  A6 60              LDX FACMOH
04534  D266  A5 61              LDA FACMO
04535  D268  85 60              STA FACMOH
04536  D26A  86 61              STX FACMO
04537  D26C  A9 00       STRNEX LDA #0
04538  D26E  85 63              STA FACSGN
04539  D270  A5 5E              LDA FACEXP
04540  D272  85 6D              STA FACOV






CODE24......PAGE 0060

LINE# LOC   CODE        LINE


04541  D274  A9 80              LDA #@200
04542  D276  85 5E              STA FACEXP
04543  D278  20 0D CA           JSR NORMAL
04544  D27B  A2 88              LDX #<RNDX
04545  D27D  A0 00              LDY #>RNDX
04546  D27F  4C 0A CD    GMOVMF JMP MOVMF
04547  D282  A9 FE       COS    LDA #<PI2
04548  D284  A0 D2              LDY #>PI2
04549  D286  20 9D C9           JSR FADD
04550  D289  20 42 CD    SIN    JSR MOVAF
04551  D28C  A9 03              LDA #<TWOPI
04552  D28E  A0 D3              LDY #>TWOPI
04553  D290  A6 6B              LDX ARGSGN
04554  D292  20 3D CC           JSR FDIVF
04555  D295  20 42 CD           JSR MOVAF
04556  D298  20 02 CE           JSR INT
04557  D29B  A9 00              LDA #0
04558  D29D  85 6C              STA ARISGN
04559  D29F  20 89 C9           JSR FSUBT
04560  D2A2  A9 08              LDA #<FR4
04561  D2A4  A0 D3              LDY #>FR4
04562  D2A6  20 86 C9           JSR FSUB
04563  D2A9  A5 63              LDA FACSGN
04564  D2AB  48                 PHA
04565  D2AC  10 0D              BPL SIN1
04566  D2AE  20 7F C9           JSR FADDH
04567  D2B1  A5 63              LDA FACSGN
04568  D2B3  30 09              BMI SIN2
04569  D2B5  A5 0C              LDA TANSGN
04570  D2B7  49 FF              EOR #$FF
04571  D2B9  85 0C              STA TANSGN
04572  D2BB  20 4B D1    SIN1   JSR NEGOP
04573  D2BE  A9 08       SIN2   LDA #<FR4
04574  D2C0  A0 D3              LDY #>FR4
04575  D2C2  20 9D C9           JSR FADD
04576  D2C5  68                 PLA
04577  D2C6  10 03              BPL SIN3
04578  D2C8  20 4B D1           JSR NEGOP
04579  D2CB  A9 0D       SIN3   LDA #<SINCON
04580  D2CD  A0 D3              LDY #>SINCON
04581  D2CF  4C D7 D1           JMP POLYX
04582  D2D2  20 00 CD    TAN    JSR MOV1F
04583  D2D5  A9 00              LDA #0
04584  D2D7  85 0C              STA TANSGN
04585  D2D9  20 89 D2           JSR SIN
04586  D2DC  A2 4B              LDX #<TEMPF3
04587  D2DE  A0 00              LDY #>TEMPF3
04588  D2E0  20 7F D2           JSR GMOVMF
04589  D2E3  A9 54              LDA #<TEMPF1
04590  D2E5  A0 00              LDY #>TEMPF1
04591  D2E7  20 D8 CC           JSR MOVFM
04592  D2EA  A9 00              LDA #0
04593  D2EC  85 63              STA FACSGN
04594  D2EE  A5 0C              LDA TANSGN
04595  D2F0  20 FA D2           JSR COSC






CODE24......PAGE 0061

LINE# LOC   CODE        LINE


04596  D2F3  A9 4B              LDA #<TEMPF3
04597  D2F5  A0 00              LDY #>TEMPF3
04598  D2F7  4C 45 CC           JMP FDIV
04599  D2FA  48          COSC   PHA
04600  D2FB  4C BB D2           JMP SIN1
04601  D2FE  81          PI2    .BYT @201,@111,@17,@332,@242
04601  D2FF  49 
04601  D300  0F 
04601  D301  DA 
04601  D302  A2 
04602  D303  83          TWOPI  .BYT @203,@111,@17,@332,@242
04602  D304  49 
04602  D305  0F 
04602  D306  DA 
04602  D307  A2 
04603  D308  7F          FR4    .BYT @177,0,0,0,0
04603  D309  00 
04603  D30A  00 
04603  D30B  00 
04603  D30C  00 
04604  D30D  05          SINCON .BYT 5,@204,@346,@32,@55
04604  D30E  84 
04604  D30F  E6 
04604  D310  1A 
04604  D311  2D 
04605  D312  1B                 .BYT @33,@206,@50,@7,@373
04605  D313  86 
04605  D314  28 
04605  D315  07 
04605  D316  FB 
04606  D317  F8                 .BYT @370,@207,@231,@150,@211
04606  D318  87 
04606  D319  99 
04606  D31A  68 
04606  D31B  89 
04607  D31C  01                 .BYT 1,@207,@43,@65,@337,@341
04607  D31D  87 
04607  D31E  23 
04607  D31F  35 
04607  D320  DF 
04607  D321  E1 
04608  D322  86                 .BYT @206,@245,@135,@347,@50,@203
04608  D323  A5 
04608  D324  5D 
04608  D325  E7 
04608  D326  28 
04608  D327  83 
04609  D328  49                 .BYT @111,@17,@332,@242
04609  D329  0F 
04609  D32A  DA 
04609  D32B  A2 
04610  D32C  A5 63       ATN    LDA FACSGN
04611  D32E  48                 PHA
04612  D32F  10 03              BPL ATN1
04613  D331  20 4B D1           JSR NEGOP






CODE24......PAGE 0062

LINE# LOC   CODE        LINE


04614  D334  A5 5E       ATN1   LDA FACEXP
04615  D336  48                 PHA
04616  D337  C9 81              CMP #@201
04617  D339  90 07              BCC ATN2
04618  D33B  A9 F2              LDA #<FONE
04619  D33D  A0 CA              LDY #>FONE
04620  D33F  20 45 CC           JSR FDIV
04621  D342  A9 5C       ATN2   LDA #<ATNCON
04622  D344  A0 D3              LDY #>ATNCON
04623  D346  20 D7 D1           JSR POLYX
04624  D349  68                 PLA
04625  D34A  C9 81              CMP #@201
04626  D34C  90 07              BCC ATN3
04627  D34E  A9 FE              LDA #<PI2
04628  D350  A0 D2              LDY #>PI2
04629  D352  20 86 C9           JSR FSUB
04630  D355  68          ATN3   PLA
04631  D356  10 03              BPL ATN4
04632  D358  4C 4B D1           JMP NEGOP
04633  D35B  60          ATN4   RTS
04634  D35C  0B          ATNCON .BYT @13,@166,@263,@203
04634  D35D  76 
04634  D35E  B3 
04634  D35F  83 
04635  D360  BD                 .BYT @275,@323,@171,@36,@364
04635  D361  D3 
04635  D362  79 
04635  D363  1E 
04635  D364  F4 
04636  D365  A6                 .BYT @246,@365,@173,@203,@374
04636  D366  F5 
04636  D367  7B 
04636  D368  83 
04636  D369  FC 
04637  D36A  B0                 .BYT @260,@20
04637  D36B  10 
04638  D36C  7C                 .BYT @174,@14,@37,@147,@312
04638  D36D  0C 
04638  D36E  1F 
04638  D36F  67 
04638  D370  CA 
04639  D371  7C                 .BYT @174,@336,@123,@313,@301
04639  D372  DE 
04639  D373  53 
04639  D374  CB 
04639  D375  C1 
04640  D376  7D                 .BYT @175,@24,@144,@160,@114
04640  D377  14 
04640  D378  64 
04640  D379  70 
04640  D37A  4C 
04641  D37B  7D                 .BYT @175,@267,@352,@121,@172
04641  D37C  B7 
04641  D37D  EA 
04641  D37E  51 






CODE24......PAGE 0063

LINE# LOC   CODE        LINE


04641  D37F  7A 
04642  D380  7D                 .BYT @175,@143,@60,@210,@176
04642  D381  63 
04642  D382  30 
04642  D383  88 
04642  D384  7E 
04643  D385  7E                 .BYT @176,@222,@104,@231,@72
04643  D386  92 
04643  D387  44 
04643  D388  99 
04643  D389  3A 
04644  D38A  7E                 .BYT @176,@114,@314,@221,@307
04644  D38B  4C 
04644  D38C  CC 
04644  D38D  91 
04644  D38E  C7 
04645  D38F  7F                 .BYT @177,@252,@252,@252,@23
04645  D390  AA 
04645  D391  AA 
04645  D392  AA 
04645  D393  13 
04646  D394  81                 .BYT @201,0,0,0,0
04646  D395  00 
04646  D396  00 
04646  D397  00 
04646  D398  00 
04647  D399              .FIL   CODE26


































CODE26......PAGE 0064

LINE# LOC   CODE        LINE


04649  D399  E6 77       INITAT INC CHRGET+7
04650  D39B  D0 02              BNE CHDGOT
04651  D39D  E6 78              INC CHRGET+8
04652  D39F  AD 60 EA    CHDGOT LDA 60000
04653  D3A2  C9 3A              CMP #':
04654  D3A4  B0 0A              BCS CHDRTS
04655  D3A6  C9 20              CMP #' 
04656  D3A8  F0 EF              BEQ INITAT
04657  D3AA  38                 SEC
04658  D3AB  E9 30              SBC #'0
04659  D3AD  38                 SEC
04660  D3AE  E9 D0              SBC #$D0
04661  D3B0  60          CHDRTS RTS
04662  D3B1  80                 .BYT 128,79,199,82,88
04662  D3B2  4F 
04662  D3B3  C7 
04662  D3B4  52 
04662  D3B5  58 
04663  D3B6  A2 FB       INIT   LDX #STKEND-256
04664  D3B8  9A                 TXS
04665  D3B9  A9 4C              LDA #76
04666  D3BB  85 51              STA JMPER
04667  D3BD  85 00              STA USRPOK
04668  D3BF  A9 73              LDA #<FCERR
04669  D3C1  A0 C3              LDY #>FCERR
04670  D3C3  85 01              STA USRPOK+1
04671  D3C5  84 02              STY USRPOK+2
04672  D3C7  A2 1C              LDX #RNDX+4-CHRGET
04673  D3C9  BD 98 D3    MOVCHG LDA INITAT-1,X
04674  D3CC  95 6F              STA CHRGET-1,X
04675  D3CE  CA                 DEX
04676  D3CF  D0 F8              BNE MOVCHG
04677  D3D1  A9 03              LDA #STRSIZ
04678  D3D3  85 50              STA FOUR6
04679  D3D5  8A                 TXA
04680  D3D6  85 65              STA BITS
04681  D3D8  85 10              STA CHANNL
04682  D3DA  85 15              STA LASTPT+1
04683  D3DC  85 0D              STA DSDESC
04684  D3DE  48                 PHA
04685  D3DF  E8                 INX
04686  D3E0  8E FD 01           STX BUF-3
04687  D3E3  8E FC 01           STX BUF-4
04688  D3E6  A2 16              LDX #TEMPST
04689  D3E8  86 13              STX TEMPPT
04690  D3EA  A0 04              LDY #>RAMLOC
04691  D3EC  85 28              STA TXTTAB
04692  D3EE  84 29              STY TXTTAB+1
04693  D3F0  85 11              STA LINNUM
04694  D3F2  84 12              STY LINNUM+1
04695  D3F4  A8                 TAY

04697  D3F5              ;CREATE RAM INITIALIZATION IF NEEDED
04698  D3F5  A9 80              LDA #>OFFSET
04699  D3F7  D0 07              BNE LOOPMM






CODE26......PAGE 0065

LINE# LOC   CODE        LINE


04700  D3F9  A9 00              LDA #<ROMLOC
04701  D3FB  A0 B0              LDY #>ROMLOC
04702  D3FD  4C 1B D4           JMP USEDEF
04703  D400  E6 11       LOOPMM INC LINNUM
04704  D402  D0 04              BNE LOOPM1
04705  D404  E6 12              INC LINNUM+1
04706  D406  30 0F              BMI USEDEC
04707  D408  A9 55       LOOPM1 LDA #85
04708  D40A  91 11              STA (LINNUM)Y
04709  D40C  D1 11              CMP (LINNUM)Y
04710  D40E  D0 07              BNE USEDEC
04711  D410  0A                 ASL A
04712  D411  91 11              STA (LINNUM)Y
04713  D413  D1 11              CMP (LINNUM)Y
04714  D415  F0 E9              BEQ LOOPMM
04715  D417  A5 11       USEDEC LDA LINNUM
04716  D419  A4 12              LDY LINNUM+1
04717  D41B  85 34       USEDEF STA MEMSIZ
04718  D41D  84 35              STY MEMSIZ+1
04719  D41F  85 30              STA FRETOP
04720  D421  84 31              STY FRETOP+1
04721  D423  A0 00              LDY #0
04722  D425  98                 TYA
04723  D426  91 28              STA (TXTTAB)Y
04724  D428  E6 28              INC TXTTAB
04725  D42A  A9 A4              LDA #<SIGNON
04726  D42C  A0 DE              LDY #>SIGNON
04727  D42E  20 1D BB           JSR STROUT
04728  D431  A5 34              LDA MEMSIZ
04729  D433  38                 SEC
04730  D434  E5 28              SBC TXTTAB
04731  D436  AA                 TAX
04732  D437  A5 35              LDA MEMSIZ+1
04733  D439  E5 29              SBC TXTTAB+1
04734  D43B  20 83 CF           JSR LINPRT
04735  D43E  A9 4B              LDA #<WORDS
04736  D440  A0 D4              LDY #>WORDS
04737  D442  20 1D BB           JSR STROUT
04738  D445  20 D4 B5           JSR SCRTCH
04739  D448  4C FF B3           JMP READY
04740  D44B  20 42       WORDS  .BYT ' BYTES FREE',13,0
04740  D456  0D 
04740  D457  00 
04741  D458  23 23       FREMES .BYT '### COMMODORE BASIC ###'
04742  D46F  0D                 .BYT 13,13,0
04742  D470  0D 
04742  D471  00 
04743  D472              LASTWR
04744  D472              .END


ERRORS = 00000











SYMBOL TABLE

SYMBOL VALUE
 ABS      CD8E    ADDEND   0025    ADDFRS   B348    ADDIND   C44B
 ADDON    B886    ADDPR2   0002    ADDPR4   0004    ADDPR8   0008
 ADDPRC   0001    ADJ      BA6C    ADJ00    BA83    ADJ01    BA85
 AFFRTS   B5C7    ANDMSK   0046    ANDOP    C089    APPEND   FFAB
 ARGEXP   0066    ARGHO    0067    ARGLO    006A    ARGMO    0069
 ARGMOH   0068    ARGSGN   006B    ARISGN   006C    ARYDON   C29D
 ARYGET   C259    ARYPNT   0055    ARYTAB   002C    ARYVA2   C21C
 ARYVA3   C220    ARYVGO   C228    ASC      C8C1    ASPAC    BB0D
 ATN      D32C    ATN1     D334    ATN2     D342    ATN3     D355
 ATN4     D35B    ATNCON   D35C    AYINT    C2EA    BACKUP   FFA5
 BIGGES   CFE8    BITS     0065    BLT1     B374    BLTLP    B380
 BLTU     B350    BLTUC    B357    BRKTXT   B31B    BSERR    C370
 BSERR7   C433    BUF      0200    BUFFUL   BBE8    BUFLEN   0051
 BUFOFS   0200    BUFPAG   0002    BUFPTR   006E    CAT      C74F
 CCALL    FFE7    CCCHN    FFCC    CCLOS    FFC3    CGETL    FFE4
 CHANNL   0010    CHARAC   0003    CHDGOT   D39F    CHDRTS   D3B0
 CHEAD    B4BF    CHKCLS   BEEF    CHKCOM   BEF5    CHKDS    BFFC
 CHKERR   BD93    CHKNUM   BD87    CHKOK    BD90    CHKOPN   BEF2
 CHKSTR   BD89    CHKVAL   BD8A    CHRD     C822    CHRGET   0070
 CHRGOT   0076    CHRRTS   0087    CHSUMC   CEF8    CHTIM    E844
 CINCH    FFCF    CKSUMB   BF0C    CLEAR    B5EE    CLEARC   B5F0
 CLMWID   000A    CLOAD    FFD5    CLRFAC   CE1F    CLSCHN   FFCC
 CMD      BA8E    CMPFOR   B33C    CMPSPC   B50D    COIN     FFC6
 COL00    C68A    COL00A   C69E    COL00B   C693    COL01    C6A9
 COL02    C6B2    COL02A   C6F0    COL02B   C6D8    COL03    C703
 COLECT   FFA2    COLIS    B567    COMBYT   C927    COMPRT   BAF0
 CONCAT   FF93    CONINT   C8D7    CONT     B7EE    CONTRT   B807
 CONUPK   CBC2    COOUT    FFC9    COPEN    FFC0    COPFLT   B961
 COPSTR   B964    COPY     B9F6    COPY00   BA2E    COPY01   BA44
 COPY02   BA46    COPYC    BA13    COS      D282    COSC     D2FA
 COUNT    0005    CRDO     BADF    CRDONE   B599    CRFIN    BAED
 CRTSKP   BB41    CRUNCH   B4FB    CSAVE    FFD8    CSTAT    0096
 CSYS     FFDE    CTIMR    008D    CURLIN   0036    CURTOL   006E
 CVERF    FFDB    CZLOOP   B4C7    DATA     B883    DATAN    B891
 DATATK   0083    DATBK    BC49    DATBK1   BC4D    DATLIN   003C
 DATLOP   BCB4    DATPTR   003E    DCAT     FFB4    DCLOSE   FF99
 DCOPY    FFA8    DECBLT   B38B    DECCNT   005A    DECCUR   C3F8
 DEF      C4DC    DEFFIN   C578    DEFPNT   004B    DEFSTF   C541
 DEGREE   0064    DIM      C121    DIM3     C11E    DIMFLG   0006
 DIMRTS   C476    DIRCN1   B769    DIRCON   B759    DIRIS    B7E0
 DIV10    CC34    DIVIDE   CC5F    DIVNRM   CCB4    DIVSUB   CC93
 DLOAD    FFB1    DNTCPY   B9EF    DOAGIN   BB6A    DOCMP    C112
 DOCO     B8D3    DOCOND   B8CB    DOCSTR   BD91    DOMASK   000C
 DOMIN    BF05    DOPEN    FF96    DOPRE1   BE1A    DOPREC   BDF3
 DOREL    C0B6    DORES    0009    DOSGFL   C951    DPTFLG   005C
 DSAVE    FFAE    DSCPNT   004D    DSCTMP   005E    DSDESC   000D
 DSKX1    B9D2    DSKX2    B9D4    DV0ERR   CCC0    DVARTS   C290
 EATEM    C150    END      B7C8    ENDCHR   0004    ENDCON   B7E2
 ENDGRB   C716    ENDREL   BDD1    ENDTK    0080    EORMSK   0047
 EPSGN    005D    EQULTK   00B2    ERR      B306    ERRBD    00BF
 ERRBS    006B    ERRCN    00DB    ERRCRD   B3DA    ERRDD    0078
 ERRDIR   C4CF    ERRDVO   0085    ERRFC    0035    ERRFIN   B3F4
 ERRGO2   C5FB    ERRGO3   C375    ERRGO4   BD95    ERRGO5   BD2D
 ERRGUF   C4D7    ERRID    0095    ERRLS    00B0    ERRNF    0000
 ERROD    002A    ERROM    004D    ERROR    B3CF    ERROV    0045








SYMBOL TABLE

SYMBOL VALUE
 ERRRG    0016    ERRSN    0010    ERRST    00C8    ERRTAB   B20D
 ERRTM    00A3    ERRUF    00E9    ERRUS    005A    EVAL     BE81
 EVAL0    BE85    EVAL1    BE8A    EVAL2    BE8D    EVAL3    BEC4
 EVAL4    BEDB    EXCHQT   B89C    EXIGNT   BCF7    EXP      D184
 EXP1     D1A2    EXPCON   D15B    EXPSGN   005D    FAC      005E
 FACEXP   005E    FACHO    005F    FACLO    0062    FACMO    0061
 FACMOH   0060    FACOV    006D    FACSGN   0063    FADD     C99D
 FADD1    C9CD    FADD2    CA34    FADD4    C9D9    FADD5    C998
 FADDA    C9C9    FADDC    C9AD    FADDH    C97F    FADDT    C9A0
 FADFLT   CA08    FBUFFR   0100    FBUFPT   006E    FCERR    C373
 FCERR2   B9B2    FCOMP    CD91    FCOMPC   CDC8    FCOMPD   CDCE
 FCOMPN   CD93    FCOMPS   CD67    FCSIGN   CD65    FDCEND   D0F0
 FDECPT   0044    FDIV     CC45    FDIVF    CC3D    FDIVT    CC48
 FFLOOP   B327    FFRTS    B34F    FHALF    D0C7    FIN      CE29
 FIN1     CE45    FINC     CE40    FINDG1   CEA7    FINDGQ   CE43
 FINDIG   CEA0    FINDIV   CE88    FINDP    CE77    FINE     CE7D
 FINE1    CE7F    FINEC    CE66    FINEC1   CE64    FINEC2   CE6B
 FINEDG   CEC7    FINGO    C076    FINI     B4AD    FININ1   B4F8
 FININL   BAD2    FINLOG   CEB4    FINML6   CC23    FINMUL   CE91
 FINNOW   C2C3    FINPTR   C2B9    FINQNG   CE98    FINRE2   BE0B
 FINREL   BE01    FINZLP   CE2D    FLINRT   B5D0    FLNRTS   B5D1
 FLOAD    B60B    FLOAT    CD72    FLOATB   CD85    FLOATC   CD7F
 FLOATS   CD7A    FMAPTR   C2C8    FMULT    CB5E    FMULTT   CB61
 FNDFOR   B322    FNDLIN   B5A3    FNDLNC   B5A7    FNDLO1   B5BE
 FNDOER   C51D    FNEDG1   CE69    FNTK     00A5    FNWAIT   C963
 FONE     CAF2    FOR      B6DE    FORMAT   FF9F    FORPNT   0046
 FORPSH   BE41    FORSIZ   0012    FORTK    0081    FOULDY   D07A
 FOUR6    0050    FOUT     CF93    FOUT1    CF9D    FOUT11   D07C
 FOUT12   D089    FOUT14   D099    FOUT15   D0A5    FOUT16   D01A
 FOUT17   D0BD    FOUT19   D0BA    FOUT2    D020    FOUT20   D0C2
 FOUT3    CFCC    FOUT37   CFB6    FOUT38   CFD7    FOUT39   D009
 FOUT4    CFC1    FOUT40   D046    FOUT41   D044    FOUT5    CFE5
 FOUT6    CFFE    FOUT7    CFBF    FOUT8    D01C    FOUT9    CFDE
 FOUTBL   D0CC    FOUTC    CF95    FOUTIM   D01E    FOUTPI   CFFD
 FOUTYP   D04D    FPWR1    D135    FPWRT    D112    FPWRT1   D11B
 FR4      D308    FRE      C4A8    FRE01    C7F6    FRE02    C7FE
 FREFAC   C7B8    FREMES   D458    FREPLA   C7FC    FRERTS   C821
 FRESPC   0032    FRESTR   C7B5    FRETMP   C7BC    FRETMS   C811
 FRETOP   0030    FRMEV1   BD9E    FRMEVL   BD98    FRMNUM   BD84
 FSUB     C986    FSUBT    C989    FUNDSP   B066    GARBA2   C66A
 GARBAG   C65B    GARBFL   0009    GET      BB7A    GETADR   C92D
 GETAGN   BBD5    GETBPT   B552    GETBYT   C8D4    GETCMP   C106
 GETCON   C94E    GETDEF   C415    GETDTL   BB56    GETERR   B3E0
 GETFNM   C50A    GETFOR   BD1F    GETNTH   BC46    GETNUM   C921
 GETRTS   C65A    GETSPA   C61D    GETSPT   B9BA    GETSTK   B393
 GETTIM   C003    GETTTY   BB91    GINLIN   BBFF    GIVAYF   C4BC
 GLET     B7A2    GLOOP    C67E    GLOP1    C6CE    GMOVMF   D27F
 GO       B7AC    GOBADV   C1DB    GOFLOT   C11B    GOFUC    C8CE
 GOGO     C263    GOGO1    C281    GOLST    B638    GOMLDV   D19F
 GOMOVF   C040    GONE     B77C    GONE2    B787    GONE3    B785
 GONE4    B795    GONPRC   BF07    GOOO     BFD4    GOOOOO   BFE5
 GOOVER   CC15    GORDY    B7EB    GORTS    B85C    GOSUB    B813
 GOSUTK   008D    GOTARY   C378    GOTK     00CB    GOTNUM   B9B5
 GOTO     B830    GOTOTK   0089    GRBEND   C700    GRBPNT   004B
 GRBTOP   005C    GREASE   C3E4    GREATK   00B1    GRODY    B6A8








SYMBOL TABLE

SYMBOL VALUE
 GTBYTC   C8D1    HAVFOR   BD2F    HIGHDS   0055    HIGHTR   0057
 IF       B8B3    INCFAC   CAA5    INCFRT   CAB3    INCHR    FFCF
 INCRND   CD59    INDEX    001F    INDEX1   001F    INDEX2   0021
 INDICE   0061    INDLOP   C306    INIT     D3B6    INITAT   D399
 INLIN    B4E2    INLINC   B4E4    INLOOP   BC11    INLPN1   C43A
 INLPN2   C439    INLPNM   C41D    INPCO1   BC0B    INPCOM   B965
 INPCON   BC09    INPFLG   000B    INPPTR   0040    INPRT    CF78
 INPRTS   BCF6    INPUT    BBBE    INPUTN   BBA4    INT      CE02
 INTEGR   0003    INTERR   C13C    INTFLG   0008    INTIDX   C2DD
 INTRTS   CE28    INTXT    B30D    IODONE   BBB4    IORELE   BBB6
 ISARY    C2FC    ISCNTC   FFE1    ISCRTS   B7C5    ISFUN    C047
 ISLETC   C1B6    ISLRTS   C1BF    ISSEC    C14F    ISVAR    BF8C
 ISVDS    BFC1    ISVRET   BF8F    JMPER    0051    JSRGM    C2D4
 KLOOP    B501    KLOOP1   B523    LASNUM   00C7    LASTPT   0014
 LASTWR   D472    LBA74    BA74    LBF0D    BF0D    LD100    CCB0
 LDFONE   B727    LDZR     C1C6    LEFTD    C836    LEN      C8B2
 LEN1     C8B8    LESSTK   00B3    LET      B930    LINGET   B8F6
 LINLEN   0028    LINNUM   0011    LINPRT   CF83    LIST     B630
 LIST4    B65D    LNKPRG   B4B6    LNKRTS   B4E1    LOFBUF   00FF
 LOG      CB20    LOG1     CB2A    LOG2     CB1B    LOGCN2   CAF7
 LOGEB2   D156    LOGERR   CB27    LOOPDN   BD72    LOOPM1   D408
 LOOPMM   D400    LOPFDA   C347    LOPFDV   C353    LOPFN    C19B
 LOPFND   C191    LOPPTA   C3B1    LOPREL   BDB5    LOWDS    005A
 LOWTR    005C    LPOPER   BDA3    LSTEND   B64F    LSTPNT   0046
 LUK4IT   B847    LUKALL   B84B    MAIN     B406    MAIN1    B41F
 MEMSIZ   0034    MID2     C87E    MIDD     C86D    MINUTK   00AB
 MLDEXP   CBEF    MLDVEX   CC0A    MLEX10   CED6    MLEXMI   CEE4
 MLOOP    B462    MLTPL1   CB94    MLTPL2   CB97    MLTPL3   CBB3
 MLTPLY   CB8F    MORCO1   BAF3    MOREN1   B384    MORLIN   B8FC
 MORSTS   B7A5    MOV00    C730    MOV01    C73F    MOV1F    CD00
 MOV2F    CCFD    MOVAF    CD42    MOVAFL   CD47    MOVCHG   D3C9
 MOVDO    C79E    MOVEF    CD45    MOVFA    CD32    MOVFA1   CD34
 MOVFAL   CD38    MOVFM    CCD8    MOVFR    CCC5    MOVINS   C78C
 MOVLP    C7A2    MOVMF    CD0A    MOVPNT   C726    MOVRTS   CD50
 MOVSTR   C79A    MOVTOP   C735    MOVVF    CD06    MUL10    CC18
 MUL10R   CC2E    MULDIV   CBED    MULLN2   CB5A    MULSHF   CAB9
 MULTRT   CBC1    MUSTCR   B52B    MVDONE   C7AB    MVSTRT   C7B4
 N0999    CEE9    N32768   C2D9    N9999    CEEE    NCMPOS   001E
 NEGFAC   CA7D    NEGFCH   CA83    NEGHLF   CB16    NEGOP    D14B
 NEGPRC   BDF4    NEGRTS   D155    NEGTAB   B0A9    NEGXQS   CE9D
 NEWCHR   BAA5    NEWSGO   BD6F    NEWSTT   B74A    NEXT     BD19
 NMARY1   C362    NMIL     CEF3    NODATT   B569    NODEL    B470
 NODELC   B48B    NOFREF   C4AF    NOML6    B992    NONONO   C2F7
 NORM1    CA5F    NORM2    CA53    NORM3    CA11    NORMAL   CA0D
 NOSEC    C15A    NOTABR   BB12    NOTDIM   C3C1    NOTEVE   C208
 NOTEVL   C1CB    NOTFDD   C38C    NOTFL1   C45C    NOTFLT   C39F
 NOTFNS   C1C0    NOTIT    C1AC    NOTOL    B6EF    NOTOP    BECC
 NOTQTI   BBCD    NOTSTR   C164    NOTTAB   B0AC    NOTTK    00A8
 NOWGE1   BC79    NOWGET   BC6E    NOWLIN   BCCD    NTHIS    B580
 NTHIS1   B584    NTHIS2   B58D    NUMINS   BC85    NUMLEV   0017
 NXTCMP   C0FB    NXTLGC   B92A    NXTPTR   C1AB    OFFSET   8000
 OKGOTO   B8C2    OKNORM   C071    OLDLIN   0038    OLDOV    0053
 OLDTXT   003A    OMERR    B3CD    OMERR1   C436    ONEFUN   00B4
 ONEON    B73B    ONGLOP   B8E2    ONGLP1   B8EA    ONGOTO   B8D6
 ONGRTS   B8F5    OPMASK   004A    OPPTR    0048    OPTAB    B094








SYMBOL TABLE

SYMBOL VALUE
 OROP     C086    OUTCH    FFD2    OUTDO    BB46    OUTQST   BB44
 OUTRTS   BB49    OUTSPC   BB3A    OVERR    CAB4    PARCHK   BEE9
 PEEK     C943    PI       00FF    PI2      D2FE    PIVAL    BEA0
 PLOOP    B687    PLOOP1   B694    PLUSTK   00AA    POKE     C95A
 POKER    0011    POLY     D1ED    POLY1    D1F1    POLY2    D204
 POLY3    D200    POLY4    D211    POLYPT   006E    POLYX    D1D7
 POS      C4C9    POSINT   C2E3    PREAM    C897    PRINT    BAA8
 PRINTC   BAAA    PRINTK   0099    PRINTN   BA88    PRIT3    B6D4
 PRIT3B   B6D5    PRIT4    B683    PRTRTS   BAEF    PTDORL   B0AF
 PTRGET   C12B    PTRGT1   C130    PTRGT2   C132    PTRGT3   C13F
 PULMOR   C85B    PULSTK   BE64    PUSHF    BE32    PUSHF1   BE2D
 PUTNEW   C5F3    PUTNW1   C5FE    QCHNUM   BE5B    QCOMP    C101
 QDATA    BC3D    QDECT1   B45A    QDOT     BEA5    QDSAV    C01C
 QDSVAR   C1E6    QINLIN   BBF5    QINT     CDD1    QINT1    CDF1
 QINTGO   C2F9    QINTGR   B94D    QINTRT   CDF0    QISHFT   CDE5
 QNUM     007D    QOP      BE56    QOPGO    BE59    QOPRTS   BE7E
 QPLOP    B6AB    QPLUS    CE3C    QPREC    BDEA    QPREC1   BE13
 QSETNR   D247    QSHFT    CC82    QSTATV   C00F    QSTAVR   C1DE
 QVARIA   B9E1    RADDC    D225    RAMLOC   0400    READ     BC02
 READDS   FFBD    READY    B3FF    REARTS   B3CC    REASAV   B3AE
 REASON   B3A0    REASTO   B3B9    RECORD   FF9C    REDDY    B312
 REM      B8C6    REMER    B8A4    REMN     B894    REMRTS   B890
 REMTK    008F    RENAME   FFB7    RES00    C7DE    RESCON   B544
 RESCR1   B6C8    RESCR2   B6CE    RESER    B53D    RESETC   BC6D
 RESFIN   B7C1    RESHO    0023    RESLO    0026    RESLST   B0B2
 RESMO    0025    RESMOH   0024    RESRCH   B6C5    RESTOR   B7B7
 RETU1    B876    RETURN   B85D    RIGHTD   C862    RLEFT    C83C
 RLEFT1   C842    RLEFT2   C843    RLEFT3   C844    RMULC    D221
 RND      D229    RND1     D25C    RNDRTS   CA7C    RNDSHF   CA6E
 RNDX     0088    ROLSHF   CAE6    ROMLOC   B000    ROUND    CD51
 RUN      B808    RUNC     B5E9    RUNC2    B827    SAVEIT   BA98
 SAVQUO   CC75    SCRATC   FFBA    SCRATH   B5D2    SCRATK   00A2
 SCRTCH   B5D4    SET00    C746    SETINX   C744    SETQUT   BC61
 SGN      CD6F    SGNFLG   0064    SHFARG   CC85    SHFTR2   CABB
 SHFTR3   CADC    SHFTR4   CAE2    SHFTRT   CAF0    SHIFTR   CACF
 SIGN     CD61    SIGNON   DEA4    SIGNRT   CD6E    SIN      D289
 SIN1     D2BB    SIN2     D2BE    SIN3     D2CB    SINCON   D30D
 SIZE     0052    SIZEOK   C76F    SKIP2    C71F    SKIP2A   C724
 SNERR    BF00    SNERR1   B7A9    SNERR2   B873    SNERR3   B8DE
 SNERR4   BB5E    SNERR5   BE2A    SNGFLT   C4CB    SPCTK    00A6
 SQR      D108    SQR05    CB0C    SQR20    CB11    SQUEEZ   CA6C
 ST2TXT   C918    STASGN   C0F6    STCURL   BB5A    STEPTK   00A9
 STKEND   01FB    STKINI   B60E    STKRTS   B621    STMDSP   B000
 STOLD    D194    STOLOP   B4A5    STOML1   C462    STOMLT   C3A8
 STOP     B7C6    STOPC    B7C9    STORDO   C972    STPEND   B7D8
 STR1     B570    STRADJ   BA4E    STRCMP   C0CE    STRCP    C5E8
 STRD     C58E    STRDN2   BC8D    STRDON   BAA2    STREND   002E
 STRFI1   C5D1    STRFI2   C5D2    STRFIN   C5CD    STRFRE   C644
 STRGET   C5C0    STRINI   C59E    STRLIT   C5B0    STRLT2   C5B6
 STRNAM   C17B    STRNEX   D26C    STRNG    B579    STRNG1   006C
 STRNG2   006E    STROU2   CF90    STROUT   BB1D    STRPR2   BB27
 STRPRT   BB20    STRRTS   BFD3    STRSIZ   0003    STRSPA   C5A6
 STRST2   C5DE    STRTX2   BEBE    STRTXT   BEB5    STUFFH   B554
 STXBUF   D068    STXFND   C18F    STXFOR   BD22    STXTPT   B622
 SUBFLG   000A    SUBIT    C9E5    SWAPLP   D1B2    SYNCHR   BEF7








SYMBOL TABLE

SYMBOL VALUE
 TABER    BAFD    TABTK    00A3    TAN      D2D2    TANSGN   000C
 TEMPF1   0054    TEMPF2   0059    TEMPF3   004B    TEMPPT   0013
 TEMPST   0016    TENC     CC2F    TENEXP   005B    THENTK   00A7
 TIMELP   B978    TIMEND   D108    TIMEST   B9A2    TIMNUM   B9AB
 TIMSTR   C598    TOTK     00A4    TRMNO1   BB61    TRMNOK   BB4C
 TRMOK    BC99    TRMPOS   00C6    TRYAG2   C61F    TRYAG3   C62D
 TRYAG4   C63A    TRYAGN   BD07    TRYMOR   B3AA    TRYOFF   CBFA
 TSTDUN   B67A    TSTOP    BDB2    TURNON   C174    TWOPI    D303
 TXTPTR   0077    TXTTAB   0028    TYPERR   B3ED    TYPLIN   B67C
 UMLCNT   C4A3    UMLRTS   C4A7    UMULT    C477    UMULTC   C48A
 UMULTD   C480    UNPRTS   BE80    UNPSTK   BE62    USEDEC   D417
 USEDEF   D41B    USERR    B86E    USRLOC   B06C    USRPOK   0000
 VAL      C8E3    VAL2     C903    VALRTS   C920    VALTYP   0007
 VAREND   BCDA    VARNAM   0042    VAROK    C1F2    VARPNT   0044
 VARTAB   002A    VARTXT   0048    VARY0    BCE5    WAITER   C976
 WORDS    D44B    XSPAC    BB0E    XSPAC1   BB18    XSPAC2   BB0F
 ZEREMV   CC10    ZERITA   C3F3    ZERO     D0C9    ZEROF1   CA2F
 ZEROFC   CA2D    ZEROML   CA31    ZERRTS   C97E    ZZ1      01FF
 ZZ2      0201    ZZ3      0202    ZZ4      01FF    ZZ5      01FF
 ZZ6      BF8E    ZZ7      008B    ZZ8      8BB8   

END OF ASSEMBLY
ossrc......PAGE 0001

LINE# LOC   CODE        LINE


00001  0000              ;**********************************
00002  0000              ;*                                *
00003  0000              ;* PET 2001 OPERATING SYSTEM      *
00004  0000              ;*                                *
00005  0000              ;* VERSION 4.0  JULY 25 1979      *
00006  0000              ;* VERSION 3.0  JUNE 11 1979      *
00007  0000              ;* VERSION 2.0  AUGUST 2,1978     *
00008  0000              ;* VERSION 1.0  AUGUST 8,1977     *
00009  0000              ;*                                *
00010  0000              ;* ROMS PRODUCED: 901465-21       *
00011  0000              ;*                901447-29       *
00012  0000              ;*                901465-22       *
00013  0000              ;* RECONSTR.: M.HOFFMANN-VETTER   *
00014  0000              ;*                                *
00015  0000              ;**********************************

00017  0000              OFFSET =$8000          ;FOR *** HARD MACHINE ***

00019  0000              ; LISTING DATE ??/??/??

00021  0000                     * =$8D
00022  008D              TIME   *=*+3           ;24 HR CLOCK IN 1/60 SEC
00023  0090              CINV   *=*+2           ;IRQ RAM VECTOR
00024  0092              CBINV  *=*+2           ;BRK INSTR RAM VECTOR
00025  0094              NMINV  *=*+2           ;NMI RAM VECTOR
00026  0096              SATUS  *=*+1           ;OPERATION STATUS BYTE
00027  0097              LSTX   *=*+1           ;INDEX TO CHAR IN KEYSCAN
00028  0098              SFST   *=*+1           ;KEYBOARD SHIFT FLAG
00029  0099              CRFAC  *=*+2           ;CORRECTION FACTOR TIME
00030  009B              STKEY  *=*+1           ;STOP KEY FLAG
00031  009C              SVXT   *=*+1           ;TEMPORARY
00032  009D              VERCK  *=*+1           ;LOAD OR VERIFY FLAG
00033  009E              NDX    *=*+1           ;INDEX TO KEYD QUEUE
00034  009F              RVS    *=*+1           ;REVERSE FIELD ENABLED
00035  00A0              C3P0   *=*+1           ;CASSETTE SERVQ CONSTANT
00036  00A1              INDX   *=*+1           ;
00037  00A2              SNSW   *=*+1           ;CASSETTE....
00038  00A3              LSXP   *=*+1           ;START GF SCREEN INPUT
00039  00A4              LSTP   *=*+1
00040  00A5              BSOUR  *=*+1           ;CHAR BUFFER FOR IEEE
00041  00A6              SFDX   *=*+1           ;SHIFT MODE FOR PRINT
00042  00A7              BLNSW  *=*+1           ;CURSOR BLINK ENABLE
00043  00A8              BLNCT  *=*+1           ;COUNTER TO FLIP CURSORBREAK
00044  00A9              GDBLN  *=*+1           ;O0LD CHAR BEFORE BLINK
00045  00AA              BLNON  *=*+1           ;ON/OFF BLINK FLAG
00046  00AB              SYNO   *=*+1           ;CASSETTE SYNC #
00047  00AC              CRSW   *=*+1           ;INPUT/GET FLAG
00048  00AD              XSAV   *=*+1           ;TEMP FOR BASIN
00049  00AE              LDTND  *=*+1           ;INDEX TO LOGICAL FILE
00050  00AF              DFLTN  *=*+1           ;DEFAULT INPUT DEVICE #
00051  00B0              DFLTO  *=*+1           ;DEFAULT QUTPUT DEVICE #
00052  00B1              PRTY   *=*+1           ;CASSETTE PARITY
00053  00B2              DPSW   *=*+1           ;CASSETTE DIPOLE SWITCH
00054  00B3              WSW    *=*+1           ;CASSETE WRITE ENABLE
00055  00B4              SAVX






ossrc......PAGE 0002

LINE# LOC   CODE        LINE


00056  00B4              T1     *=*+1           ;TEMPORARY 1
00057  00B5              RCNT
00058  00B5              TMPC
00059  00B5              T2     *=*+1           ;TEMPORARY 2
00060  00B6              TMPC2
00061  00B6              T3     *=*+1           ;TEMPORARY 3
00062  00B7              PCNTR  *=*+1           ;CASSETTE STUFF
00063  00B8              PTCH   *=*+1
00064  00B9              FIRT   *=*+1
00065  00BA              CNTDN  *=*+1           ;CASSETTE SYNC CQUNTDOWN
00066  00BB              BUFPT  *=*+2           ;POINTER TO ACTIVE CASSETTE BUFFE
00067  00BD              SHCNL  *=*+1           ;CASSETTE SHORT COUNT
00068  00BE              RER    *=*+1           ;CASSETTE READ ERROR
00069  00BF              REZ    *=*+1           ;CASSETE READING ZEROES
00070  00C0              PTR1   *=*+1           ;CASSETTE ERROR PASS1
00071  00C1              PTR2   *=*+1           ;CASSETTE ERROR PASS2
00072  00C2              RDFLG  *=*+1           ;CASSETTE READ MODE
00073  00C3              SHCNH  *=*+1           ;CASSETTE SHORT CNT
00074  00C4              PNT    *=*+1
00075  00C5              POINT  *=*+1
00076  00C6              PNTR   *=*+1
00077  00C7              SAL    *=*+1
00078  00C8              SAH    *=*+1
00079  00C9              EAL    *=*+1
00080  00CA              EAH    *=*+1
00081  00CB              CMP0   *=*+1
00082  00CC              TEMP   *=*+1
00083  00CD              QTSW   *=*+1
00084  00CE              SNSW1  *=*+1
00085  00CF              DIFF   *=*+1
00086  00D0              PRP    *=*+1
00087  00D1              FNLEN  *=*+1           ;LENGTH CURRENT FILE N STR
00088  00D2              LA     *=*+1           ;CURRENT FILE LOGICAL ADDR
00089  00D3              SA     *=*+1           ;CURRENT FILE 2ND ADDR
00090  00D4              FA     *=*+1           ;CURRENT FILE PRIMARY ADDR
00091  00D5              LNMX   *=*+1
00092  00D6              TBUF   *=*+2
00093  00D8              TBLX   *=*+1
00094  00D9              DATA   *=*+1
00095  00DA              FNADR  *=*+2           ;ADDR CURRENT FILE NAME STR
00096  00DC              INSRT  *=*+1
00097  00DD              OCHAR  *=*+1
00098  00DE              WRAP
00099  00DE              FSBLK  *=*+1           ;CASSETTE READ BLOCK COUNT
00100  00DF              MYCH   *=*+1
00101  00E0              LDTB1  *=*+25
00102  00F9              CAS1   *=*+1
00103  00FA              CAS2   *=*+1
00104  00FB              TMP0
00105  00FB              STAL   *=*+1
00106  00FC              STAH   *=*+1
00107  00FD              FNADR2
00108  00FD              TMP2   *=*+2
00109  00FF                     *=$100
00110  0100              BAD    *=*+1






ossrc......PAGE 0003

LINE# LOC   CODE        LINE


00111  0101                     *=$200
00112  0200              BUF                    ;BASIC INPUT BUFFER
00113  0200              ;VIRTUAL REGS FOR MACHINE LANGUAGE MONITOR
00114  0200              PCH    *=*+1
00115  0201              PCL    *=*+1
00116  0202              FLGS   *=*+1
00117  0203              ACC    *=*+1
00118  0204              XR     *=*+1
00119  0205              YR     *=*+1
00120  0206              SP     *=*+1
00121  0207              INVH   *=*+1           ;USER MODIFIABLE IRQ
00122  0208              INVL   *=*+1
00123  0209              SAVNAM *=*+72          ;BUFFER
00124  0251              ;TABLES FOR OPEN FILES
00125  0251              LAT    *=*+10          ;LOGICAL FILE NUMBERS
00126  025B              FAT    *=*+10          ;PRIMARY DEVICE NUMBERS
00127  0265              SAT    *=*+10          ;SECONDARY ADDRESSES
00128  026F              KEYD   *=*+10
00129  0279                     *=*+1
00130  027A              TAPE1  *=*+192
00131  033A              TAPE2                  ;192 BYTES RESERVED
00132  033A              POS
00133  033A              FNLEN2 *=*+1
00134  033B              DRIVE1 *=*+1
00135  033C              DRIVE2 *=*+1
00136  033D              DIDCHK
00137  033D              LRECL  *=*+1
00138  033E              PARCHK *=*+1
00139  033F              DISKID *=*+2
00140  0341              COUNT  *=*+1
00141  0342              TBUF2  *=*+17          ;FN1 STORAGE
00142  0353              TBUFF  *=*+167
00143  03FA              ;RAM VECTOR FOR USER INTERP OF MONITOR CMDS
00144  03FA              USRCMD *=*+2
00145  03FC              BOB    *=*+1
00146  03FD                     *=$E810
00147  E810              PIAL   *=*+1
00148  E811              PIAL1  *=*+1
00149  E812              PIAK   *=*+1
00150  E813              PIAS   *=*+1
00151  E814                     *=$E820
00152  E820              IEEI   *=*+1
00153  E821              IEEIS  *=*+1
00154  E822              IEEO   *=*+1
00155  E823              IEEOS  *=*+1
00156  E824                     *=$E840
00157  E840              PIA    *=*+1
00158  E841              SYNC   *=*+1
00159  E842              P2DB   *=*+1
00160  E843              P2DA   *=*+1
00161  E844              TIL    *=*+1
00162  E845              TIH    *=*+1
00163  E846              TILL   *=*+1
00164  E847              TILH   *=*+1
00165  E848              T2L    *=*+1






ossrc......PAGE 0004

LINE# LOC   CODE        LINE


00166  E849              T2H    *=*+1
00167  E84A              SR     *=*+1
00168  E84B              ACR    *=*+1
00169  E84C              PCR    *=*+1
00170  E84D              IFR    *=*+1
00171  E84E              IER    *=*+1
00172  E84F              SYNC1  *=*+1





00174  E850              ;CONSTANTS FROM BASIC
00175  E850              CHANL  =$0010
00176  E850              READY  =$B3FF+OFFSET-$8000
00177  E850              INIT   =$D3B6+OFFSET-$8000
00178  E850              FRMNUM =$BD84+OFFSET-$8000
00179  E850              GETADR =$C92D+OFFSET-$8000
00180  E850              LINNUM =$0011
00181  E850              TXTPTR =$0077
00182  E850              FINI   =$B4AD+OFFSET-$8000
00183  E850              STXTPT =$B622+OFFSET-$8000
00184  E850              FLOAD  =$B60B+OFFSET-$8000
00185  E850              VARTAB =$002A
00186  E850              GETBYT =$C8D4+OFFSET-$8000
00187  E850              SNERR  =$BF00+OFFSET-$8000
00188  E850              CHRGOT =$0076
00189  E850              TYPERR =$B3ED+OFFSET-$8000
00190  E850              SYNCHR =$BEF7+OFFSET-$8000
00191  E850              CHKCOM =$BEF5+OFFSET-$8000
00192  E850              FRESTR =$C7B5+OFFSET-$8000
00193  E850              FRMEVL =$BD98+OFFSET-$8000
00194  E850              CHRGET =$0070
00195  E850              BSTOP  =$B7C6+OFFSET-$8000 ;BASIC SYMB STOP
00196  E850              INDEX1 =$001F
00197  E850              TXTTAB =$0028
00198  E850              LASTWR =$D472+OFFSET-$8000
00199  E850              POKER  =$0011
00200  E850              LINPRT =$CF83+OFFSET-$8000
00201  E850              GETSPA =$C61D+OFFSET-$8000
00202  E850              CHKOPN =$BEF2+OFFSET-$8000
00203  E850              CHKCLS =$BEEF+OFFSET-$8000
00204  E850              ERRFC  =@065
00205  E850              ERRLS  =@260
00206  E850              ERROR  =$B3CF+OFFSET-$8000





00208  E850              ;TAPE BLOCK TYPES
00209  E850              EOT=5
00210  E850              BLF=1
00211  E850              BDF=2
00212  E850              BDFH=4






ossrc......PAGE 0005

LINE# LOC   CODE        LINE


00213  E850              BUFSZ=192
00214  E850              CR     =$D
00215  E850              ONTK=$91
00216  E850              TOTK=$A4
00217  E850              APEN   =$41
00218  E850              DSDESC =$000D
00219  E850              .FILE  CALLE






















































PET RESIDENT MONITOR......PAGE 0006

LINE# LOC   CODE        LINE


00221  E850                     *=LASTWR        ;START ADDRESS
00222  D472              NCMDS  =8
00223  D472  A9 43       CALLE  LDA #'C         ;SET A=C TO INDICATE
00224  D474  85 B5              STA TMPC
00225  D476  D0 19              BNE B3          ;CALL ENTRY, THEN JMP TO B3
00226  D478  20 A6 F2    BRKE   JSR CLRCH       ;CLR CHANNELS
00227  D47B  A9 42              LDA #'B
00228  D47D  85 B5              STA TMPC
00229  D47F  D8                 CLD
00230  D480  4A                 LSR A           ;SET CY FOR PC CORRECTION
00231  D481  68                 PLA
00232  D482  8D 05 02           STA YR          ;SAVE Y
00233  D485  68                 PLA
00234  D486  8D 04 02           STA XR          ;AND X
00235  D489  68                 PLA
00236  D48A  8D 03 02           STA ACC         ;AND ACCUMULATOR
00237  D48D  68                 PLA
00238  D48E  8D 02 02           STA FLGS        ;AND FLAGS
00239  D491  68          B3     PLA
00240  D492  69 FF              ADC #$FF        ;CY SET TO PC-1 FOR BREAK
00241  D494  8D 01 02           STA PCL
00242  D497  68                 PLA
00243  D498  69 FF              ADC #$FF
00244  D49A  8D 00 02           STA PCH
00245  D49D  A5 90              LDA CINV
00246  D49F  8D 08 02           STA INVL
00247  D4A2  A5 91              LDA CINV+1
00248  D4A4  8D 07 02           STA INVH
00249  D4A7  BA                 TSX
00250  D4A8  8E 06 02           STX SP          ;SAVE ORIGINAL SP
00251  D4AB  58                 CLI             ;CLBAR INTS
00252  D4AC  20 34 D5    B5     JSR CRLF
00253  D4AF  A6 B5              LDX TMPC        ;SET X EQUAL TO B OR C
00254  D4B1  A9 2A              LDA #'*
00255  D4B3  20 31 D7           JSR WRTWO
00256  D4B6  A9 52              LDA #'R         ;SET FOR R DISPLAY TO
00257  D4B8              ;                      PERMIT IMMEDIATE
00258  D4B8              ;                      ALTER FOLLOWING
00259  D4B8              ;                      BREAKPOINT
00260  D4B8  D0 1A              BNE S0
00261  D4BA  A9 02       STRT   LDA #2          ;NEXT COMMAND FROM USER
00262  D4BC  85 77              STA TXTPTR
00263  D4BE  A9 00              LDA #0
00264  D4C0  85 DE              STA WRAP        ;CLEAR ADR WRAPZAROUND FLAG
00265  D4C2  A2 0D              LDX #CR
00266  D4C4  A9 2E              LDA #'.         ;TYPE A PROMPTING '. '
00267  D4C6  20 31 D7           JSR WRTWO
00268  D4C9  20 98 D7    ST1    JSR RDOC        ;READ COMMAND. CHARACTER
00269  D4CC              ;                      IS RETURNED IN A
00270  D4CC  C9 2E              CMP #'.         ;IGNORE PROMPTING '. '
00271  D4CE  F0 F9              BEQ ST1
00272  D4D0  C9 20              CMP #$20        ;IGNORE SPACES
00273  D4D2  F0 F5              BEQ ST1
00274  D4D4  A2 07       S0     LDX #NCMDS-1    ;LOOKUP COMMAND
00275  D4D6  DD 44 D5    S1     CMP CMDS,X






PET RESIDENT MONITOR......PAGE 0007

LINE# LOC   CODE        LINE


00276  D4D9  D0 0B              BNE S2
00277  D4DB  86 B4              STX SAVX        ;SAVE CURRENT COMMAND INDEX
00278  D4DD              ;INDIRECT JMP FROM TABLE BY
00279  D4DD              ; PUSHING TARGET ADDRESS-1
00280  D4DD              ;  THEN RTS
00281  D4DD  BD 4C D5           LDA ADRH,X
00282  D4E0  48                 PHA
00283  D4E1  BD 54 D5           LDA ADRL,X
00284  D4E4  48                 PHA
00285  D4E5  60                 RTS
00286  D4E6  CA          S2     DEX
00287  D4E7  10 ED              BPL S1          ;LOOP FOR ALL. COMMANDS
00288  D4E9  6C FA 03           JMP (USRCMD)
00289  D4EC  A5 FB       PUTP   LDA TMP0        ;MOVE TMP0 TO PCH,PCL
00290  D4EE  8D 01 02           STA PCL
00291  D4F1  A5 FC              LDA TMP0+1
00292  D4F3  8D 00 02           STA PCH
00293  D4F6  60                 RTS
00294  D4F7              ;
00295  D4F7              ;DISPLAY MEM SUBR. SET AR=NUMBER
00296  D4F7              ;OF MEMORY BYTES DISPLAYED.
00297  D4F7              ;TMP0=ADR OF MEM DISPLAYED
00298  D4F7              ;
00299  D4F7  85 B5       DM     STA TMPC
00300  D4F9  A0 00              LDY #0
00301  D4FB  20 31 D5    DM1    JSR SPACE       ;WR N BYTES
00302  D4FE  B1 FB              LDA (TMP0),Y    ;(TMP0)=ADR
00303  D500  20 22 D7           JSR WROB
00304  D503  20 39 D5           JSR INCTMP
00305  D506  C6 B5              DEC TMPC
00306  D508  D0 F1              BNE DM1
00307  D50A  60                 RTS
00308  D50B              ;READ AND STORE BYTE.
00309  D50B              ;NO STORE IF SPACE OR TMPC = O.
00310  D50B  20 63 D7    BYTE   JSR RDOB        ;CHAR IN A, CY=O0 IF SP
00311  D50E  90 0D              BCC BY3         ;SPACE
00312  D510  A2 00              LDX #0          ;STORE BYTE
00313  D512  81 FB              STA (TMP0,X)
00314  D514  C1 FB              CMP (TMP0,X)    ;TEST FOR VALID WRITE (RAM)
00315  D516  F0 05              BEQ BY3
00316  D518  68                 PLA             ;ERROR: CLEAR JSR ADR IN STACK
00317  D519  68                 PLA
00318  D51A  4C A4 D7           JMP ERROPR
00319  D51D  20 39 D5    BY3    JSR INCTMP      ;GO INC TMPO ADR
00320  D520  C6 B5              DEC TMPC
00321  D522  60                 RTS
00322  D523  A9 02       SETR   LDA #<FLGS      ;SET TO ACCESS REGS
00323  D525  85 FB              STA TMP0
00324  D527  A9 02              LDA #>FLGS
00325  D529  85 FC              STA TMP0+1
00326  D52B  A9 05              LDA #5
00327  D52D  60                 RTS
00328  D52E  20 31 D5    SPAC2  JSR SPACE
00329  D531  A9 20       SPACE  LDA #$20
00330  D533  2C                 .BYT $2C






PET RESIDENT MONITOR......PAGE 0008

LINE# LOC   CODE        LINE


00331  D534  A9 0D       CRLF   LDA #$D
00332  D536  4C 66 F2           JMP BSOUT
00333  D539              ;INCREMENT (TMP0,TMP0+1) BY 1
00334  D539  E6 FB       INCTMP INC TMP0        ;LOW BYTE
00335  D53B  D0 06              BNE SETWR
00336  D53D  E6 FC              INC TMP0+1      ;HIGH BYTE
00337  D53F  D0 02              BNE SETWR
00338  D541  E6 DE              INC WRAP
00339  D543  60          SETWR  RTS




















































COMMAND & ADDR TABLE......PAGE 0009

LINE# LOC   CODE        LINE


00341  D544  3A          CMDS   .BYT ':'        ;MODIFY MEMORY
00342  D545  3B                 .BYT ';'        ;ALTER REGISTERS
00343  D546  52                 .BYT 'R'        ;DIGPLAY REGS
00344  D547  4D                 .BYT 'M'        ;DISPLAY MEMORY
00345  D548  47                 .BYT 'G'        ;START EXECUTION
00346  D549  58                 .BYT 'X'        ;WARM START BASIC
00347  D54A  4C                 .BYT 'L'        ;LOAD MEMORY
00348  D54B  53                 .BYT 'S'        ;SAVE MEMORY
00349  D54C  D6          ADRH   .BYT >ZZ1
00350  D54D  D5                 .BYT >ZZ2
00351  D54E  D5                 .BYT >ZZ3
00352  D54F  D5                 .BYT >ZZ4
00353  D550  D6                 .BYT >ZZ5
00354  D551  D6                 .BYT >ZZ6
00355  D552  D6                 .BYT >ZZ7
00356  D553  D6                 .BYT >ZZ8
00357  D554  1C          ADRL   .BYT <ZZ1
00358  D555  FA                 .BYT <ZZ2
00359  D556  86                 .BYT <ZZ3
00360  D557  BB                 .BYT <ZZ4
00361  D558  32                 .BYT <ZZ5
00362  D559  6A                 .BYT <ZZ6
00363  D55A  74                 .BYT <ZZ7
00364  D55B  74                 .BYT <ZZ8





































PET MONITOR 13.1......PAGE 000A

LINE# LOC   CODE        LINE


00366  D55C  0D          REGK   .BYT CR,$20,$20,$20,$20 ;4 SPACES
00366  D55D  20 
00366  D55E  20 
00366  D55F  20 
00366  D560  20 
00367  D561  20 50              .BYT ' PC ',' IRQ ',' SR AC XR YR SP'
00367  D565  20 49 
00367  D56A  20 53 
00368  D579  98          ALTRIT TYA
00369  D57A  48                 PHA
00370  D57B  20 34 D5           JSR CRLF
00371  D57E  68                 PLA
00372  D57F  A2 2E              LDX #'.
00373  D581  20 31 D7           JSR WRTWO
00374  D584  4C 2E D5           JMP SPAC2

00376  D587  A2 00       DSPLYR LDX #0
00377  D589  BD 5C D5    D2     LDA REGK,X
00378  D58C  20 66 F2           JSR BSOUT
00379  D58F  E8                 INX
00380  D590  E0 1D              CPX #29
00381  D592  D0 F5              BNE D2
00382  D594  A0 3B              LDY #';
00383  D596  20 79 D5           JSR ALTRIT
00384  D599  AD 00 02           LDA PCH
00385  D59C  20 22 D7           JSR WROB
00386  D59F  AD 01 02           LDA PCL
00387  D5A2  20 22 D7           JSR WROB
00388  D5A5  20 31 D5           JSR SPACE
00389  D5A8  AD 07 02           LDA INVH
00390  D5AB  20 22 D7           JSR WROB
00391  D5AE  AD 08 02           LDA INVL
00392  D5B1  20 22 D7           JSR WROB
00393  D5B4  20 23 D5           JSR SETR
00394  D5B7  20 F7 D4           JSR DM          ;USE DM SUBR.
00395  D5BA  F0 39              BEQ BEQS1
00396  D5BC  20 98 D7    DSPLYM JSR RDOC
00397  D5BF  20 54 D7           JSR RDOA        ;READ START ADR
00398  D5C2  90 34              BCC ERRS1       ;ERR IF NO SA
00399  D5C4  20 44 D7           JSR T2T2        ;SA TO TMP2
00400  D5C7  20 98 D7           JSR RDOC        ;SKIP DELIMITER
00401  D5CA  20 54 D7           JSR RDOA        ;READ END ADR
00402  D5CD  90 29              BCC ERRS1       ;ERR IF NO EA
00403  D5CF  20 44 D7           JSR T2T2        ;SA TO TMP0, EA TO TMP2
00404  D5D2  20 35 F3    DSP1   JSR STOP1       ;TEST FOR STOP KEY
00405  D5D5  F0 1E              BEQ BEQS1
00406  D5D7  A6 DE              LDX WRAP
00407  D5D9  D0 1A              BNE BEQS1
00408  D5DB  38                 SEC             ;DOUBLE BYTE COMPARE
00409  D5DC  A5 FD              LDA TMP2
00410  D5DE  E5 FB              SBC TMP0
00411  D5E0  A5 FE              LDA TMP2+1
00412  D5E2  E5 FC              SBC TMP0+1
00413  D5E4  90 0F              BCC BEQS1       ;STOP IF EA LESS THAN SA
00414  D5E6  A0 3A              LDY #':






PET MONITOR 13.1......PAGE 000B

LINE# LOC   CODE        LINE


00415  D5E8  20 79 D5           JSR ALTRIT
00416  D5EB  20 17 D7           JSR WROA
00417  D5EE  A9 08              LDA #8
00418  D5F0  20 F7 D4           JSR DM          ;DIGPLAY 8, INCR TMPO
00419  D5F3  F0 DD              BEQ DSP1
00420  D5F5  4C BA D4    BEQS1  JMP STRT
00421  D5F8  4C A4 D7    ERRS1  JMP ERROPR
00422  D5FB              ;ALTER REGISTERS
00423  D5FB  20 63 D7    ALTR   JSR RDOB        ;SKIP 2 SPACES
00424  D5FE  20 54 D7           JSR RDOA        ;CY=0 IF SP
00425  D601  90 03              BCC AL2         ;SPACE
00426  D603  20 EC D4           JSR PUTP        ;ALTER PC
00427  D606  20 15 F2    AL2    JSR BASIN
00428  D609  20 54 D7           JSR RDOA
00429  D60C  90 0A              BCC AL3
00430  D60E  A5 FB              LDA TMP0
00431  D610  8D 08 02           STA INVL
00432  D613  A5 FC              LDA TMP0+1
00433  D615  8D 07 02           STA INVH
00434  D618  20 23 D5    AL3    JSR SETR        ;SET TO ALTER R'S
00435  D61B  D0 0A              BNE A4
00436  D61D              ; ALTER MEMORY - READ ADR AND DATA
00437  D61D  20 63 D7    ALTM   JSR RDOB        ;SKIP 2 SPACES
00438  D620  20 54 D7           JSR RDOA        ;READ MEM ALTER ADR
00439  D623  90 D3              BCC ERRS1       ;CY=0, IF SPACE,ERR
00440  D625  A9 08              LDA #8          ;SET CNT = 8
00441  D627  85 B5       A4     STA TMPC
00442  D629  20 98 D7    A5     JSR RDOC
00443  D62C  20 0B D5           JSR BYTE
00444  D62F  D0 F8              BNE A5
00445  D631  F0 C2       A9     BEQ BEQS1
00446  D633  20 15 F2    GO     JSR BASIN
00447  D636  C9 0D              CMP #$0D        ;IF CR, EXIT
00448  D638  F0 0C              BEQ G1
00449  D63A  C9 20              CMP #$20        ;1F NOT SPACE, ERR
00450  D63C  D0 BA              BNE ERRS1
00451  D63E  20 54 D7           JSR RDOA
00452  D641  90 03              BCC G1
00453  D643  20 EC D4           JSR PUTP
00454  D646  AE 06 02    G1     LDX SP
00455  D649  9A                 TXS             ;ORIG OR NEW SP VALUE TO SP
00456  D64A  78                 SEI
00457  D64B  AD 07 02           LDA INVH
00458  D64E  85 91              STA CINV+1
00459  D650  AD 08 02           LDA INVL
00460  D653  85 90              STA CINV
00461  D655  AD 00 02           LDA PCH
00462  D658  48                 PHA
00463  D659  AD 01 02           LDA PCL
00464  D65C  48                 PHA
00465  D65D  AD 02 02           LDA FLGS
00466  D660  48                 PHA
00467  D661  AD 03 02           LDA ACC
00468  D664  AE 04 02           LDX XR
00469  D667  AC 05 02           LDY YR






PET MONITOR 13.1......PAGE 000C

LINE# LOC   CODE        LINE


00470  D66A  40                 RTI
00471  D66B  AE 06 02    EXIT   LDX SP
00472  D66E  9A                 TXS
00473  D66F  4C FF B3           JMP READY       ;EXIT TO BASIC WARM START
00474  D672  4C A4 D7    ERRL   JMP ERROPR
00475  D675              ZZZ1   =SAVNAM         ;PLACE TO PUT NAME
00476  D675  A0 01       LD     LDY #1
00477  D677  84 D4              STY FA          ;DEFAULT DEVICE #1
00478  D679  88                 DEY
00479  D67A  84 D1              STY FNLEN
00480  D67C  84 96              STY SATUS       ;CLEAR STATUS ON LOAD
00481  D67E  84 9D              STY VERCK
00482  D680  A9 02              LDA #>ZZZ1      ;PLACE TO STORE NAME
00483  D682  85 DB              STA FNADR+1
00484  D684  A9 09              LDA #<ZZZ1
00485  D686  85 DA              STA FNADR
00486  D688  20 15 F2    L1     JSR BASIN
00487  D68B  C9 20              CMP #' 
00488  D68D  F0 F9              BEQ L1          ;SPAN BLANKS
00489  D68F  C9 0D              CMP #CR
00490  D691  F0 1A              BEQ L5          ;DEFAULT TO LOAD
00491  D693  C9 22              CMP #'"
00492  D695  D0 DB       L2     BNE ERRL        ;FILE NAME MUST BE NEXT
00493  D697  20 15 F2    L3     JSR BASIN
00494  D69A  C9 22              CMP #'"
00495  D69C  F0 24              BEQ L8          ;END OF NAME
00496  D69E  C9 0D              CMP #CR         ;DEFAULT A LOAD
00497  D6A0  F0 0B              BEQ L5
00498  D6A2  91 DA              STA (FNADR)Y
00499  D6A4  E6 D1              INC FNLEN
00500  D6A6  C8                 INY
00501  D6A7  C0 10              CPY #16
00502  D6A9  F0 C7       L4     BEQ ERRL        ;FILE NAME TOO LONG
00503  D6AB  D0 EA              BNE L3
00504  D6AD  A5 B4       L5     LDA SAVX
00505  D6AF  C9 06              CMP #6
00506  D6B1  D0 E2       L6     BNE L2          ;NOT A LOAD
00507  D6B3  20 56 F3           JSR LD15
00508  D6B6  20 2B F9           JSR TWAIT
00509  D6B9  A5 96              LDA SATUS
00510  D6BB  29 10              AND #SPERR
00511  D6BD  D0 F2       L7     BNE L6          ;LOAD ERROR
00512  D6BF  4C BA D4           JMP STRT
00513  D6C2  20 15 F2    L8     JSR BASIN
00514  D6C5  C9 0D              CMP #CR
00515  D6C7  F0 E4              BEQ L5          ;DEFUALT LOAD
00516  D6C9  C9 2C              CMP #',
00517  D6CB  D0 F0       L9     BNE L7          ;BAD SYNTAX
00518  D6CD  20 63 D7           JSR RDOB
00519  D6D0  29 0F              AND #$F
00520  D6D2  F0 D5       L10    BEQ L4          ;DEVICE 0
00521  D6D4  C9 03              CMP #3
00522  D6D6  F0 FA       L11    BEQ L10         ;DEVICE 3
00523  D6D8  85 D4              STA FA
00524  D6DA  20 15 F2           JSR BASIN






PET MONITOR 13.1......PAGE 000D

LINE# LOC   CODE        LINE


00525  D6DD  C9 0D              CMP #CR
00526  D6DF  F0 CC              BEQ L5          ;DEFAULT LOAD
00527  D6E1  C9 2C              CMP #',
00528  D6E3  D0 E6       L12    BNE L9          ;BAD SYNTAX
00529  D6E5  20 54 D7           JSR RDOA
00530  D6E8  20 44 D7           JSR T2T2
00531  D6EB  20 15 F2           JSR BASIN
00532  D6EE  C9 2C              CMP #',
00533  D6F0  D0 F1       L13    BNE L12         ;MISSING END ADDR
00534  D6F2  20 54 D7           JSR RDOA
00535  D6F5  A5 FB              LDA TMP0
00536  D6F7  85 C9              STA EAL
00537  D6F9  A5 FC              LDA TMP0+1
00538  D6FB  85 CA              STA EAH
00539  D6FD  20 44 D7           JSR T2T2
00540  D700  20 15 F2    L20    JSR BASIN
00541  D703  C9 20              CMP #$20
00542  D705  F0 F9              BEQ L20
00543  D707  C9 0D              CMP #CR
00544  D709  D0 E5       L14    BNE L13         ;MISSING CR AT END
00545  D70B  A5 B4              LDA SAVX
00546  D70D  C9 07              CMP #7
00547  D70F  D0 F8              BNE L14
00548  D711  20 E3 F6           JSR SV5
00549  D714  4C BA D4           JMP STRT
00550  D717              ZZ1=ALTM-1
00551  D717              ZZ2=ALTR-1
00552  D717              ZZ3=DSPLYR-1
00553  D717              ZZ4=DSPLYM-1
00554  D717              ZZ5=GO-1
00555  D717              ZZ6=EXIT-1
00556  D717              ZZ7=LD-1
00557  D717              ZZ8=LD-1
00558  D717              .FIL   UTILIT



























UTILITIES......PAGE 000E

LINE# LOC   CODE        LINE


00560  D717              ;WRITE ADR FROM TMPO STORES
00561  D717  A2 01       WROA   LDX #1
00562  D719  B5 FA       WROA1  LDA TMP0-1,X
00563  D71B  48                 PHA
00564  D71C  B5 FB              LDA TMP0,X
00565  D71E  20 22 D7           JSR WROB
00566  D721  68                 PLA
00567  D722              ;WRITE BYTE --- A = BYTE
00568  D722              ;UNPACK BYTE DATA INTO TWO ASCII
00569  D722              ;CHARACTERS. A=BYTE; X,A=CHARS
00570  D722  48          WROB   PHA
00571  D723  4A                 LSR A
00572  D724  4A                 LSR A
00573  D725  4A                 LSR A
00574  D726  4A                 LSR A
00575  D727  20 3A D7           JSR ASCII       ;CONVERT TO ASCII
00576  D72A  AA                 TAX
00577  D72B  68                 PLA
00578  D72C  29 0F              AND #$0F
00579  D72E  20 3A D7           JSR ASCII
00580  D731              ;WRITE 2 CHARS--X,A=CHARS
00581  D731  48          WRTWO  PHA
00582  D732  8A                 TXA
00583  D733  20 66 F2           JSR BSOUT
00584  D736  68                 PLA
00585  D737  4C 66 F2           JMP BSOUT
00586  D73A  18          ASCII  CLC
00587  D73B  69 F6              ADC #$F6
00588  D73D  90 02              BCC ASC1
00589  D73F  69 06              ADC #$06
00590  D741  69 3A       ASC1   ADC #$3A
00591  D743  60                 RTS
00592  D744  A2 02       T2T2   LDX #2
00593  D746  B5 FA       T2T21  LDA TMP0-1,X
00594  D748  48                 PHA
00595  D749  B5 FC              LDA TMP2-1,X
00596  D74B  95 FA              STA TMP0-1,X
00597  D74D  68                 PLA
00598  D74E  95 FC              STA TMP2-1,X
00599  D750  CA                 DEX
00600  D751  D0 F3              BNE T2T21
00601  D753  60                 RTS
00602  D754              ;READ HEX ADR,RETURN HI IN TMP0,
00603  D754              ;LO IN TMPO+1,AND CY=1
00604  D754              ;IF SP CY=0
00605  D754  20 63 D7    RDOA   JSR RDOB        ;READ 2-CHAR BYTE
00606  D757  90 02              BCC RDOA2       ;SPACE
00607  D759  85 FC              STA TMP0+1
00608  D75B  20 63 D7    RDOA2  JSR RDOB
00609  D75E  90 02              BCC RDEXIT      ;SP
00610  D760  85 FB              STA TMP0
00611  D762  60          RDEXIT RTS
00612  D763              ;READ HEX BYTE AND RETURN IN A
00613  D763              ;AND CY=1 IF SP CY=0
00614  D763  A9 00       RDOB   LDA #0          ;SPACE






UTILITIES......PAGE 000F

LINE# LOC   CODE        LINE


00615  D765  8D 00 01           STA BAD         ;READ NEXT CHAR
00616  D768  20 98 D7           JSR RDOC
00617  D76B  C9 20       RDOB1  CMP #' 
00618  D76D  D0 09              BNE RDOB2
00619  D76F  20 98 D7           JSR RDOC        ;READ NEXT CHAR
00620  D772  C9 20              CMP #' 
00621  D774  D0 0F              BNE RDOB3
00622  D776  18                 CLC             ;CY=0
00623  D777  60                 RTS
00624  D778  20 8D D7    RDOB2  JSR HEXIT       ;TO HEX
00625  D77B  0A                 ASL A
00626  D77C  0A                 ASL A
00627  D77D  0A                 ASL A
00628  D77E  0A                 ASL A
00629  D77F  8D 00 01           STA BAD
00630  D782  20 98 D7           JSR RDOC        ;2ND CHAR ASSUMED HEX
00631  D785  20 8D D7    RDOB3  JSR HEXIT
00632  D788  0D 00 01           ORA BAD
00633  D78B  38                 SEC             ;CY=1
00634  D78C  60                 RTS
00635  D78D  C9 3A       HEXIT  CMP #$3A
00636  D78F  08                 PHP             ;SAVE FLAGS
00637  D790  29 0F              AND #$0F
00638  D792  28                 PLP
00639  D793  90 02              BCC HEX09       ;0-9
00640  D795  69 08              ADC #8          ;ALPHA ADD 8+CY=9
00641  D797  60          HEX09  RTS
00642  D798  20 15 F2    RDOC   JSR BASIN       ;READ CHAR
00643  D79B  C9 0D              CMP #$0D        ;IS IT A CR
00644  D79D  D0 F8              BNE HEX09       ;NO,RTS
00645  D79F  68                 PLA
00646  D7A0  68                 PLA             ;YES, CLEAN STACK,EXIT
00647  D7A1  4C BA D4           JMP STRT
00648  D7A4  A9 3F       ERROPR LDA #$3F
00649  D7A6  20 66 F2           JSR BSOUT
00650  D7A9  4C BA D4           JMP STRT
00651  D7AC              .FIL   DOS.SYNTAX
























DOS SYNTAX......PAGE 0010

LINE# LOC   CODE        LINE


00653  D7AC              ;*******************************
00654  D7AC              ;*   COMMODORE DOS PARSER      *
00655  D7AC              ;*                             *
00656  D7AC              ;*     -MGM  7/11/79-          *
00657  D7AC              ;*                             *
00658  D7AC              ;* THIS SET OF ROUTINES TAKES  *
00659  D7AC              ;* TOKENS AND VALUES AFTER THE *
00660  D7AC              ;* THE FOLLOWING BASIC KEYHORDS*
00661  D7AC              ;*  DOPEN; DCLOSE ; RECORD ;   *
00662  D7AC              ;*  FORMAT ; COLLECT ; BACKUP ;*
00663  D7AC              ;*  COPY   ; CONCAT  ; DSAVE  ;*
00664  D7AC              ;* DLOAD  ; CATLOG ; RENAME ;  *
00665  D7AC              ;* APPEND ; SCRTCH             *
00666  D7AC              ;*******************************
00667  D7AC              ;
00668  D7AC              ;IT THEN PARSES THE FOLLOWING LINE
00669  D7AC              ; AND FINDS SYNTAX ERRORS, CHECKS
00670  D7AC              ;FOR OUT OF RANGE VALUES, AND SETS
00671  D7AC              ; VARIABLES IN THE ZERO-PAGE TO BE
00672  D7AC              ; PASSED TO THE DISK MESSAGE GEN-
00673  D7AC              ; ERATOR (DMG)
00674  D7AC              ;
00675  D7AC              ;
00676  D7AC  4C 00 BF    SYNERR JMP SNERR       ;SYNTAX ERROR
00677  D7AF              ;
00678  D7AF              ;************************************
00679  D7AF              ;* "RECORD" PARSER & SYNTAX CHECKER *
00680  D7AF              ;*   NOTE: POSITION DEPENDENT       *
00681  D7AF              ;************************************
00682  D7AF  A9 01       RECORD LDA #01         ;FIX POS
00683  D7B1  8D 3A 03           STA POS
00684  D7B4  20 76 00           JSR CHRGOT
00685  D7B7  A9 23              LDA #'#
00686  D7B9  20 F7 BE           JSR SYNCHR      ;NXT CHR MUST BE '#'
00687  D7BC  20 8A DE           JSR GTVL2       ;GET NXT VALUE
00688  D7BF  E0 00              CPX #0
00689  D7C1  F0 3E              BEQ QTYER1      ;ADDR CAN'T BE < 1
00690  D7C3  86 D2              STX LA          ;STORE LOGICAL ADDR
00691  D7C5  20 F5 BE           JSR CHKCOM      ;NXT MUST BE COMMA
00692  D7C8  F0 E2              BEQ SYNERR      ;<CR>/<:>  NOT ALLOWED
00693  D7CA  90 0F              BCC NUMADR      ;MUST BE NUM OR "("
00694  D7CC  20 F2 BE           JSR CHKOPN      ;MUST BE "("
00695  D7CF  20 98 BD           JSR FRMEVL
00696  D7D2  20 2D C9           JSR GETADR
00697  D7D5  20 EF BE           JSR CHKCLS
00698  D7D8  4C E1 D7           JMP REXNEX
00699  D7DB  20 98 BD    NUMADR JSR FRMEVL
00700  D7DE  20 2D C9           JSR GETADR      ;SEE WHAT NXT IS
00701  D7E1  20 76 00    REXNEX JSR CHRGOT       ;SEE WHAT NXT IS
00702  D7E4  F0 18              BEQ DONER       ;<CR>/<:> => DONE
00703  D7E6  20 F5 BE           JSR CHKCOM      ;ELSE MUST BE COMMA
00704  D7E9  F0 C1              BEQ SYNERR      ; CANT BE <CR> OR <:>
00705  D7EB  20 8A DE           JSR GTVL2
00706  D7EE  E0 00              CPX #0
00707  D7F0  F0 0F              BEQ QTYER1      ; OUT OF RANGE






DOS SYNTAX......PAGE 0011

LINE# LOC   CODE        LINE


00708  D7F2  E0 FF              CPX #$FF
00709  D7F4  F0 0B              BEQ QTYER1      ;OUT OF RANGE
00710  D7F6  8E 3A 03           STX POS         ;STORE POSITION OF REC
00711  D7F9  20 76 00           JSR CHRGOT
00712  D7FC  D0 AE              BNE SYNERR      ;MUST BE <CR> OR <:>
00713  D7FE  4C 31 DA    DONER  JMP BOBREC
00714  D801              ;






















































DOS SYNTAX......PAGE 0012

LINE# LOC   CODE        LINE


00716  D801              .
00717  D801              .
00718  D801  4C 27 DE    QTYER1 JMP QTYERR
00719  D804              ;
00720  D804              ;**********************************
00721  D804              ;*          SYNTAX CHECKER        *
00722  D804              ;* ROUTINES FOR DOS WRITE         *
00723  D804              ;**********************************
00724  D804  29 E6       CHK1   AND #$E6;FOR HEADER,DLDAD,SCRTCH
00725  D806  F0 03              BEQ CHK2        ;CHK OPT PARMS
00726  D808  4C 00 BF    CHKER1 JMP SNERR
00727  D80B  AD 3E 03    CHK2   LDA PARCHK      ;FOR DSAVE
00728  D80E  29 01              AND #1
00729  D810  C9 01              CMP #1          ;CHK REQ'D PARMS
00730  D812  D0 F4              BNE CHKER1      ;ERROR IF 1 MISSING
00731  D814  AD 3E 03           LDA PARCHK      ;RELOAD FOR RETURN
00732  D817  60                 RTS
00733  D818              ;
00734  D818  29 E7       CHK3   AND #$E7        ;FOR COLECT,CATLOG
00735  D81A  D0 EC              BNE CHKER1      ;CHK OPT PARMS
00736  D81C  60                 RTS
00737  D81D              ;
00738  D81D  29 C4       CHK4   AND #$C4        ;FOR COPY,CONCAT
00739  D81F  D0 E7              BNE CHKER1      ;CHK OPT PARMS
00740  D821  AD 3E 03           LDA PARCHK
00741  D824  29 03       CHK5   AND #3          ;FOR RENAME
00742  D826  C9 03              CMP #3          ;CHK REQ'D PARMS
00743  D828  D0 DE              BNE CHKER1
00744  D82A  AD 3E 03           LDA PARCHK      ;RELOAD FOR RETURN
00745  D82D  60                 RTS
00746  D82E              ;
00747  D82E  29 05       CHK6   AND #5          ;FOR APPEND,DOPEN
00748  D830  C9 05              CMP #5          ;CHK REQ'D PARNS
00749  D832  D0 D4              BNE CHKER1
00750  D834  AD 3E 03           LDA PARCHK      ;RELOAD FOR RTS
00751  D837  60                 RTS
00752  D838              ;
00753  D838              .FILE  DOS.WRITE























DOS SYNTAX & WRITE......PAGE 0013

LINE# LOC   CODE        LINE


00755  D838              ;********************************
00756  D838              ;*
00757  D838              ;*  PET2001 DISK ROUTINES
00758  D838              ;*  --RSR--7/24/79--
00759  D838              ;*
00760  D838              ;********************************
00761  D838              ;
00762  D838              ; TABLD SYMBOLS
00763  D838              XFN1   =$F1            ;SENDS FILENAME1
00764  D838              XFN2   =$F2            ;SENDS FILENAME2
00765  D838              XID    =$D0            ;SENDS DISK ID
00766  D838              XREC   =$E0            ;SENDS S FOR SEG OR LRECL
00767  D838              XWRT   =$E1            ;SENDS W OR L
00768  D838              XD1    =$D1            ;SENDS DRIVE1
00769  D838              XD2    =$D2            ;SENDS DRIVE2
00770  D838              ;
00771  D838              ; TABLD
00772  D838              ;
00773  D838              TABLD                  ; USED TO BUILD DISK STRINGS
00774  D838              ; CATALOG
00775  D838  FF                 .BYT $FF,'$',XD1
00775  D839  24 
00775  D83A  D1 
00776  D83B              ; DOPEN  DSAVE DLOAD
00777  D83B  D1                 .BYT XD1,':',XFN1,',',XWRT,',',XREC
00777  D83C  3A 
00777  D83D  F1 
00777  D83E  2C 
00777  D83F  E1 
00777  D840  2C 
00777  D841  E0 
00778  D842              ; APPEND
00779  D842  D1                 .BYT XD1,':',XFN1,',','A'
00779  D843  3A 
00779  D844  F1 
00779  D845  2C 
00779  D846  41 
00780  D847              ; HEADER
00781  D847  4E                 .BYT 'N',XD1,':',XFN1,',',XID
00781  D848  D1 
00781  D849  3A 
00781  D84A  F1 
00781  D84B  2C 
00781  D84C  D0 
00782  D84D              ; COLLECT
00783  D84D  56                 .BYT 'V',XD1
00783  D84E  D1 
00784  D84F              ; BACKUP
00785  D84F  44                 .BYT 'D',XD2,'=',XD1
00785  D850  D2 
00785  D851  3D 
00785  D852  D1 
00786  D853              ; COPY
00787  D853  43                 .BYT 'C',XD2,':',XFN2,'=',XD1,':',XFN1
00787  D854  D2 






DOS SYNTAX & WRITE......PAGE 0014

LINE# LOC   CODE        LINE


00787  D855  3A 
00787  D856  F2 
00787  D857  3D 
00787  D858  D1 
00787  D859  3A 
00787  D85A  F1 
00788  D85B              ; CONCAT
00789  D85B  43                 .BYT 'C',XD2,':',XFN2,'=',XD2,':',XFN2
00789  D85C  D2 
00789  D85D  3A 
00789  D85E  F2 
00789  D85F  3D 
00789  D860  D2 
00789  D861  3A 
00789  D862  F2 
00790  D863  2C                 .BYT ',',XD1,':',XFN1
00790  D864  D1 
00790  D865  3A 
00790  D866  F1 
00791  D867              ; RENAME
00792  D867  52                 .BYT 'R',XD1,':',XFN2,'=',XD1,':',XFN1
00792  D868  D1 
00792  D869  3A 
00792  D86A  F2 
00792  D86B  3D 
00792  D86C  D1 
00792  D86D  3A 
00792  D86E  F1 
00793  D86F              ; SCRATCH
00794  D86F  53                 .BYT 'S',XD1,':',XFN1
00794  D870  D1 
00794  D871  3A 
00794  D872  F1 
00795  D873              ;



























DOS SYNTAX & WRITE......PAGE 0015

LINE# LOC   CODE        LINE


00797  D873              ;
00798  D873              ; CATALOG  (BOB F'S)
00799  D873              ;
00800  D873  A5 D2       CATLOG LDA LA          ;SAVE LA
00801  D875  85 B3              STA WSW
00802  D877  20 68 DC           JSR DOSPAR      ;PARSE THE LINE
00803  D87A  20 18 D8           JSR CHK3        ;CHK OPT PARMS
00804  D87D  A0 00       CATALG LDY #0          ;TABLD OFFSET
00805  D87F  A2 01              LDX #1          ;JUST $
00806  D881  AD 3E 03           LDA PARCHK      ;CHK FOR DEFAULT
00807  D884  29 10              AND #$10        ;NO DRIVE?
00808  D886  F0 01              BEQ CATBLD
00809  D888  E8                 INX
00810  D889  8A          CATBLD TXA             ;A NOW HAS LENGTH
00811  D88A  20 FA DB           JSR SENDP       ;BUILD
00812  D88D  A5 B0              LDA DFLTO       ;SAVE DFLTO
00813  D88F  85 BA              STA CNTDN
00814  D891  A9 60              LDA #$60        ;SECONDARY ADDR
00815  D893  85 D3              STA SA
00816  D895  A9 0E              LDA #14         ;OPEN THE FILE
00817  D897  85 D2              STA LA
00818  D899  20 B9 F1           JSR UNLSN       ;DON'T LISTEN TO FLOPPY
00819  D89C  20 65 F5           JSR FOPEN
00820  D89F  A9 00              LDA #0
00821  D8A1  85 96              STA SATUS       ;SET STATUS TO 0
00822  D8A3  A0 03              LDY #$03        ;LOOP THREE TIMES
00823  D8A5              ;
00824  D8A5  84 D1       WG220  STY FNLEN       ;SAVE NEW COUNT
00825  D8A7  A2 0E              LDX #14         ;DISK CHANNEL
00826  D8A9  20 AF F7           JSR CHKIN
00827  D8AC  20 15 F2           JSR BASIN
00828  D8AF  85 FD              STA TMP2
00829  D8B1  A4 96              LDY SATUS       ;CHECK STATUS
00830  D8B3  D0 5D              BNE WG230       ;BAD STATUS
00831  D8B5  20 15 F2           JSR BASIN
00832  D8B8  85 FE              STA TMP2+1
00833  D8BA  A4 96              LDY SATUS       ;CHECK STATUS
00834  D8BC  D0 54              BNE WG230
00835  D8BE  A4 D1              LDY FNLEN       ;MORE TO DO?
00836  D8C0  88                 DEY
00837  D8C1  D0 E2              BNE WG220       ;NOT DONE YET
00838  D8C3  20 A6 F2           JSR CLRCHN      ;CLEAR CHANNEL
00839  D8C6  20 23 D9           JSR SUBB
00840  D8C9  A6 FD              LDX TMP2
00841  D8CB  A5 FE              LDA TMP2+1
00842  D8CD  20 83 CF           JSR LINPRT      ;PRINT LINE NUMBER
00843  D8D0  A9 20              LDA #$20        ;PRINT A SPACE
00844  D8D2  20 66 F2    SKIPB  JSR BSOUT
00845  D8D5  20 A6 F2           JSR CLRCHN
00846  D8D8  A2 0E       WG250  LDX #14         ;DISK CHANNEL
00847  D8DA  20 AF F7           JSR CHKIN
00848  D8DD  20 15 F2           JSR BASIN
00849  D8E0  48                 PHA
00850  D8E1  20 A6 F2           JSR CLRCHN
00851  D8E4  68                 PLA






DOS SYNTAX & WRITE......PAGE 0016

LINE# LOC   CODE        LINE


00852  D8E5  A6 96              LDX SATUS
00853  D8E7  D0 29              BNE WG230       ;BAD
00854  D8E9  C9 00              CMP #0          ;EOL
00855  D8EB  F0 18              BEQ WG240
00856  D8ED  20 1A D9           JSR SUBA
00857  D8F0  20 35 F3           JSR STOP1       ;STOP KEY
00858  D8F3  F0 1D              BEQ WG230       ;YES...
00859  D8F5  20 05 F2           JSR GETIN       ;GET CHAR FROM KBYD
00860  D8F8  F0 DE              BEQ WG250       ; NOTHING...
00861  D8FA  C9 20              CMP #$20        ;SPACE BAR?
00862  D8FC  D0 DA              BNE WG250       ;NO...
00863  D8FE  20 05 F2    WG255  JSR GETIN       ;ANY KEY STARTS
00864  D901  F0 FB              BEQ WG255
00865  D903  D0 D3              BNE WG250       ;(JMP)
00866  D905  A9 0D       WG240  LDA #CR
00867  D907  20 1A D9           JSR SUBA
00868  D90A  20 B9 F1           JSR UNLSN
00869  D90D  A0 02              LDY #02         ; DO TWICE
00870  D90F  D0 94              BNE WG220
00871  D911  68          WG235  PLA             ;CLEAN UP
00872  D912  20 A6 F2    WG230  JSR CLRCHN
00873  D915  A9 0E              LDA #14         ;CLOSE FLOPPY
00874  D917  4C E2 F2           JMP FCLOSE
00875  D91A              ;
00876  D91A  20 23 D9    SUBA   JSR SUBB
00877  D91D  20 66 F2           JSR BSOUT
00878  D920  4C A6 F2           JMP CLRCHN
00879  D923              ;
00880  D923  A6 BA       SUBB   LDX CNTDN
00881  D925  E0 03              CPX #3
00882  D927  F0 05              BEQ SUBBR
00883  D929  A6 B3              LDX WSW
00884  D92B  20 FE F7           JSR CHKOUT
00885  D92E  60          SUBBR  RTS
00886  D92F              ;


























DOS - DOPEN,APPEND......PAGE 0017

LINE# LOC   CODE        LINE


00888  D92F              ;
00889  D92F              ;ENTRY LOOK UP SUBROUTINE
00890  D92F              ;
00891  D92F  A0 61       ENTRY0 LDY #$61        ;CALC SA >APPEND ENTRY
00892  D931  C8          ENTRY1 INY
00893  D932  98                 TYA
00894  D933  A6 AE              LDX LDTND
00895  D935  CA          ENTRY2 DEX
00896  D936  30 07              BMI RFOUND      ;ALL THRU STK?
00897  D938  DD 65 02           CMP SAT,X
00898  D93B  F0 F4              BEQ ENTRY1      ;THIS SA USED
00899  D93D  D0 F6              BNE ENTRY2      ;CONT DOWN
00900  D93F  84 D3       RFOUND STY SA           ;.Y=SA
00901  D941  60                 RTS
00902  D942              ;
00903  D942              ; DOPEN CODE D:FN[,T[,R]]
00904  D942              ;
00905  D942  20 68 DC    DOPEN  JSR DOSPAR      ;CALL PARSER SUB
00906  D945  20 2E D8           JSR CHK6
00907  D948  29 22              AND #$22
00908  D94A  F0 03              BEQ DOPEN2
00909  D94C  4C 00 BF           JMP SNERR
00910  D94F  20 2F D9    DOPEN2 JSR ENTRY0      ;GET SA
00911  D952  A0 02              LDY #2          ;INFO OFFSET
00912  D954  A2 03              LDX #3          ;BASIC LENGTH
00913  D956  2C 3E 03           BIT PARCHK      ;REL RECORD?
00914  D959  50 02              BVC LEAV        ;Z=NO
00915  D95B  A2 07       RECLCK LDX #7          ;LENGTH NOW 7
00916  D95D  2C 3E 03    LEAV   BIT PARCHK      ;CHK FOR @
00917  D960  10 0E              BPL LEAV1       ;NO @
00918  D962  A9 40              LDA #'@
00919  D964  8D 53 03           STA TBUFF
00920  D967  8A                 TXA
00921  D968  A2 01              LDX #1
00922  D96A  20 FC DB           JSR SENDP1
00923  D96D  4C 63 F5           JMP OP94
00924  D970  8A          LEAV1  TXA
00925  D971  20 FA DB           JSR SENDP
00926  D974  4C 63 F5           JMP OP94
00927  D977              ;

00929  D977              ; APPEND CODE
00930  D977              ;
00931  D977  20 68 DC    APPEND JSR DOSPAR      ;PARSE IT
00932  D97A  20 2E D8           JSR CHK6        ;CHK REQ'D PARMS
00933  D97D  29 E2              AND #$E2        ;CHK OPT PARMS
00934  D97F  F0 03              BEQ DAPPEN
00935  D981  4C 00 BF           JMP SNERR
00936  D984  20 2F D9    DAPPEN JSR ENTRY0      ;GET A SA
00937  D987  A0 09              LDY #9          ;TABLD INDEX
00938  D989  A9 05              LDA #5          ;LENGTH
00939  D98B  20 FA DB           JSR SENDP       ;BUILD
00940  D98E  4C 63 F5           JMP OP94        ;GO OPEN
00941  D991              ;







DOS - ERROR CHANNEL......PAGE 0018

LINE# LOC   CODE        LINE


00943  D991              ;
00944  D991              ;ERROR CHANNEL READ
00945  D991              ;
00946  D991  A5 0D       ERRCHL LDA DSDESC      ;ENTRY FOR USER
00947  D993  D0 16              BNE ECHKS       ;CHK OLD STATUS
00948  D995  A9 28       GETDS  LDA #40         ;GET 40 CHAR STR
00949  D997  85 0D              STA DSDESC      ;WE HAVE 40 CHRS
00950  D999  20 1D C6           JSR GETSPA
00951  D99C  86 0E              STX DSDESC+1    ;RETURN LOW
00952  D99E  84 0F              STY DSDESC+2    ;RETURN HIGH
00953  D9A0  A9 00              LDA #00         ;BACKLINK STRING
00954  D9A2  A0 29              LDY #41
00955  D9A4              ;       STA (DSDESC+1)Y ;UPPER
00956  D9A4              ;       DEY
00957  D9A4  20 9E DE           JSR PATCH5
00958  D9A7  A9 0D              LDA #$0D        ;ADDRESS $000D
00959  D9A9  91 0E              STA (DSDESC+1)Y ;LOWER
00960  D9AB  A5 D4       ECHKS  LDA FA          ;CHK BUS <=DS READ
00961  D9AD  D0 04              BNE EREAD       ;1F =0 DEFAULT
00962  D9AF  A9 08              LDA #8
00963  D9B1  85 D4              STA FA
00964  D9B3  20 D2 F0    EREAD  JSR TALK
00965  D9B6  A9 6F              LDA #$6F
00966  D9B8  85 D3              STA SA
00967  D9BA  20 93 F1           JSR TKSA
00968  D9BD  A0 FF              LDY #$FF;FOR OFFSET
00969  D9BF  C8          LOOP1  INY
00970  D9C0  20 C0 F1           JSR ACPTR
00971  D9C3  C9 0D              CMP #CR         ;CHECK FOR END
00972  D9C5  F0 04              BEQ ERREND
00973  D9C7  91 0E              STA (DSDESC+1)Y
00974  D9C9  D0 F4              BNE LOOP1       ;BR ALWAYS
00975  D9CB  A9 00       ERREND LDA #00
00976  D9CD  91 0E              STA (DSDESC+1)Y
00977  D9CF  4C AE F1           JMP UNTLK       ;GOT ALL
00978  D9D2              ;

























DOS - FORMAT......PAGE 0019

LINE# LOC   CODE        LINE


00980  D9D2              ;FORMAT ND:DN[,ID]
00981  D9D2              ;
00982  D9D2  20 68 DC    FORMAT JSR DOSPAR
00983  D9D5  20 04 D8           JSR CHK1        ;CHK OPT PARMS
00984  D9D8  29 11              AND #$11        ;CHK REQ'D PARMS
00985  D9DA  C9 11              CMP #$11
00986  D9DC  F0 03              BEQ DFORMA
00987  D9DE  4C 00 BF    FERRO  JMP SNERR
00988  D9E1  20 1B DA    DFORMA JSR DCLALL      ;CLOSE ALL FILES
00989  D9E4  20 9E DB           JSR RUSURE      ;R-U-SURE PRPT
00990  D9E7  90 01              BCC FBUILD      ;C-NO & DIRECT
00991  D9E9  60                 RTS             ;Z SET IF FOUND ELSE NO
00992  D9EA              ;
00993  D9EA  A0 0E       FBUILD LDY #14         ;TABLD INDEX
00994  D9EC  A9 04              LDA #4          ;LENGTH
00995  D9EE  AE 3F 03           LDX DISKID      ;CHECK FOR DISKID
00996  D9F1  F0 02              BEQ FCONT
00997  D9F3  A9 06              LDA #6          ;LENGTH WITH ID
00998  D9F5  20 98 DA    FCONT  JSR TRANS       ;BUILD AND SEND
00999  D9F8              ;
01000  D9F8  20 91 D9    FERRS  JSR ERRCHL      ;ERRS?
01001  D9FB  A0 00              LDY #0
01002  D9FD  B1 0E              LDA (DSDESC+1)Y
01003  D9FF  C9 32              CMP #'2
01004  DA01  B0 01              BCS FERRP       ;>=2 IS ERROR
01005  DA03  60                 RTS             ;ELSE BYE
01006  DA04              ;
01007  DA04  4C D7 DB    FERRP  JMP BADDIS      ;PRINT ?BAD DISK
01008  DA07              ;
































DOS - DCLOSE,RECORD......PAGE 001A

LINE# LOC   CODE        LINE


01010  DA07              ; DCLOSE
01011  DA07              ;
01012  DA07  20 68 DC    DCLOSE JSR DOSPAR
01013  DA0A  29 F3              AND #$F3        ;CHECK OPT PARMS
01014  DA0C  F0 03              BEQ DCLSE       ;EXTRA STUFF ERR?
01015  DA0E  4C 00 BF           JMP SNERR
01016  DA11  20 E1 DB    DCLSE  JSR OLDCLR
01017  DA14  A5 D2              LDA LA          ;CHK FOR ALL DEFALT
01018  DA16  F0 03              BEQ DCLALL
01019  DA18  4C E2 F2           JMP CLOS5       ;GO REMOVE
01020  DA1B              ;
01021  DA1B  A5 D4       DCLALL LDA FA          ;GET DISK #
01022  DA1D  A6 AE              LDX LDTND       ;SRCH FOR DISK REFS
01023  DA1F  CA          DCLLP  DEX
01024  DA20  30 0E              BMI DCLBYE      ;DONE?
01025  DA22  DD 5B 02           CMP FAT,X
01026  DA25  D0 F8              BNE DCLLP
01027  DA27  BD 51 02           LDA LAT,X       ;GET LA & REMOVE
01028  DA2A  20 E7 F2           JSR CLOS10      ;.X=POS .A=LA
01029  DA2D  B8                 CLV
01030  DA2E  50 EB              BVC DCLALL      ;BRA
01031  DA30  60          DCLBYE RTS             ;BYE
01032  DA31              ;

01034  DA31              ; DRECORD
01035  DA31              ; --P<CHL><RECNUML><RECNUMH><POS>
01036  DA31              ;
01037  DA31  A5 D2       BOBREC LDA LA          ;CHK TABLES
01038  DA33  20 C1 F2           JSR JLTLK
01039  DA36  F0 05              BEQ DRECG
01040  DA38  A0 17              LDY #MS3-MS1    ;FILE NOT FOUND ERR
01041  DA3A  4C AF F5           JMP ERMSG
01042  DA3D  20 CD F2    DRECG  JSR JZ100       ;GET RECORD
01043  DA40  20 E1 DB           JSR OLDCLR
01044  DA43  A9 50       DREBLD LDA #'P         ;BUILD
01045  DA45  8D 53 03           STA TBUFF
01046  DA48  A5 D3              LDA SA          ;GET CHL
01047  DA4A  8D 54 03           STA TBUFF+1
01048  DA4D  A5 11              LDA POKER       ;GET RECNUML
01049  DA4F  8D 55 03           STA TBUFF+2
01050  DA52  A5 12              LDA POKER+1     ;GET RECNUMH
01051  DA54  8D 56 03           STA TBUFF+3
01052  DA57  AD 3A 03           LDA FNLEN2      ;GET POS
01053  DA5A  8D 57 03           STA TBUFF+4
01054  DA5D  A2 05              LDX #05         ;FNLEN
01055  DA5F  20 4C DC           JSR TRANR       ;SET POINTERS
01056  DA62  4C 9B DA           JMP TRANS1      ;CHNL 15
01057  DA65              ;













DOS - COLLECT......PAGE 001B

LINE# LOC   CODE        LINE


01059  DA65              ;COLLECT V<DRIVE#>
01060  DA65              ;
01061  DA65  20 68 DC    COLECT JSR DOSPAR
01062  DA68  20 18 D8           JSR CHK3        ;CHK OPT PARMS
01063  DA6B  20 1B DA    DCOLLE JSR DCLALL      ;CLOSE ALL FILES
01064  DA6E  A0 14              LDY #20         ;TABLD OFFSET
01065  DA70  A2 01              LDX #1          ;LENGTH
01066  DA72  AD 3E 03           LDA PARCHK
01067  DA75  29 10              AND #$10
01068  DA77  F0 01              BEQ DCOLL0
01069  DA79  E8                 INX             ;INCLUDE DRIVE
01070  DA7A  8A          DCOLL0 TXA             ;PLACE IN A
01071  DA7B  4C 98 DA           JMP TRANS
01072  DA7E              ;















































DOS - BACKUP,COPY,CO......PAGE 001C

LINE# LOC   CODE        LINE


01074  DA7E              ; BACKUP D<DD>=<SD>
01075  DA7E              ;
01076  DA7E  20 68 DC    BACKUP JSR DOSPAR
01077  DA81  29 30              AND #$30        ;REG'D PARMS
01078  DA83  C9 30              CMP #$30
01079  DA85  F0 03              BEQ BBACK
01080  DA87  4C 00 BF    BERRO  JMP SNERR
01081  DA8A  AD 3E 03    BBACK  LDA PARCHK      ;MISSING PARMS ERR?
01082  DA8D  29 C7              AND #$C7        ;OPT PARMS
01083  DA8F  D0 F6              BNE BERRO
01084  DA91  20 1B DA    DBACKU JSR DCLALL      ;CLOSE DISK
01085  DA94  A0 16              LDY #22
01086  DA96  A9 04              LDA #4          ;LENGTH
01087  DA98              ;
01088  DA98              ; TRANS SUBROUTINE
01089  DA98              ;
01090  DA98  20 FA DB    TRANS  JSR SENDP       ;BUILD
01091  DA9B  A9 6F       TRANS1 LDA #$6F        ;OPEN CHL 15
01092  DA9D  85 D3              STA SA
01093  DA9F  20 D5 F0           JSR LISTN       ;DON'T OPEN15
01094  DAA2  A5 D3              LDA SA
01095  DAA4  4C B4 F4           JMP OPENIB      ;SEND MESSAGE
01096  DAA7              ;

01098  DAA7              ; COPY ROUTINES CDD:DFN=SD:SFN
01099  DAA7              ;
01100  DAA7  20 68 DC    COPY   JSR DOSPAR      ;PARSE IT
01101  DAAA  29 30              AND #$30
01102  DAAC  C9 30              CMP #$30        ;CHK REQ'D PARMS
01103  DAAE  D0 07              BNE COPY2
01104  DAB0  AD 3E 03           LDA PARCHK
01105  DAB3  29 C7              AND #$C7
01106  DAB5  F0 09              BEQ COPY3
01107  DAB7  AD 3E 03    COPY2  LDA PARCHK
01108  DABA  20 1D D8           JSR CHK4
01109  DABD  AD 3E 03    COPCON LDA PARCHK
01110  DAC0  A0 1A       COPY3  LDY #26         ;TABLD OFFSET
01111  DAC2  A9 08              LDA #8          ;LENGTH
01112  DAC4  4C 98 DA           JMP TRANS       ;GO DO IT
01113  DAC7              ;
01114  DAC7              ; CONCAT ROUTINES
01115  DAC7              ; --CDD:DFN=DD:DFN,SD:SFN
01116  DAC7              ;
01117  DAC7  20 68 DC    CONCAT JSR DOSPAR      ;PARSE IT
01118  DACA  20 1D D8           JSR CHK4
01119  DACD  A0 22              LDY #34         ;OFFSET
01120  DACF  A9 0C              LDA #12         ;LENGTH
01121  DAD1  4C 98 DA           JMP TRANS       ;GO DO IT
01122  DAD4              ;












DOS - COPY ROUTINES......PAGE 001D

LINE# LOC   CODE        LINE


01124  DAD4              ; COPY ROUTINES
01125  DAD4              ;
01126  DAD4  A5 D1       RSFN   LDA FNLEN
01127  DAD6  8D 3A 03           STA FNLEN2
01128  DAD9  A5 DA              LDA FNADR
01129  DADB  85 FD              STA FNADR2
01130  DADD  A5 DB              LDA FNADR+1
01131  DADF  85 FE              STA FNADR2+1
01132  DAE1              ;
01133  DAE1              ; MOVE INFO INTO TBUFF
01134  DAE1              ;
01135  DAE1  98          RDFN   TYA             ;SAVE Y
01136  DAE2  48                 PHA
01137  DAE3  AC 3A 03           LDY FNLEN2      ;CHK FOR NO FILENAME
01138  DAE6  F0 10              BEQ RDRT0
01139  DAE8  A0 00              LDY #0          ;MOVE NAME TO TBUFF
01140  DAEA  B1 FD       RDMOV  LDA (FNADR2)Y
01141  DAEC  9D 53 03           STA TBUFF,X
01142  DAEF  E8                 INX
01143  DAF0  C8                 INY
01144  DAF1  CC 3A 03           CPY FNLEN2      ;ALL DONE?
01145  DAF4  D0 F4              BNE RDMOV
01146  DAF6  F0 01              BEQ RDRT1       ;BRA AROUND
01147  DAF8  CA          RDRT0  DEX             ;CASE CDD=SD
01148  DAF9  68          RDRT1  PLA             ;RESTORE Y
01149  DAFA  A8                 TAY
01150  DAFB  38                 SEC             ;RETURN FLAG
01151  DAFC  60                 RTS
01152  DAFD              ;
01153  DAFD              ; ID SUBROUTINE
01154  DAFD              ;
01155  DAFD  AD 3F 03    RID    LDA DISKID      ;INCLUDE ID
01156  DB00  9D 53 03           STA TBUFF,X
01157  DB03  E8                 INX
01158  DB04  AD 40 03           LDA DISKID+1
01159  DB07  9D 53 03           STA TBUFF,X
01160  DB0A  E8                 INX
01161  DB0B  8A                 TXA             ;KILL WEIRD .A JUST IN CASE
01162  DB0C  60                 RTS
01163  DB0D              ;





















DOS - DSAVE,DLOAD,RE......PAGE 001E

LINE# LOC   CODE        LINE


01165  DB0D              ;DSAVE D:FN
01166  DB0D              ;
01167  DB0D  20 68 DC    DSAVE  JSR DOSPAR
01168  DB10  20 0B D8           JSR CHK2
01169  DB13  29 66              AND #$66
01170  DB15  F0 03              BEQ DSAVE2
01171  DB17  4C 00 BF           JMP SNERR
01172  DB1A  A0 02       DSAVE2 LDY #2          ;TABLE OFFSET
01173  DB1C  AD 3E 03           LDA PARCHK      ;CHK FOR @
01174  DB1F  29 80              AND #$80        ;
01175  DB21  F0 0F              BEQ SAVLD1
01176  DB23  A9 40       SAVLD0 LDA #'@         ;@SYMBOL
01177  DB25  8D 53 03           STA TBUFF
01178  DB28  A2 01              LDX #1          ;ONE CHAR IN
01179  DB2A  A9 03              LDA #3
01180  DB2C  20 FC DB           JSR SENDP1
01181  DB2F  4C E0 F6           JMP SV3
01182  DB32  A9 03       SAVLD1 LDA #3          ;LENGTH
01183  DB34  20 FA DB           JSR SENDP
01184  DB37  4C E0 F6           JMP SV3
01185  DB3A              ;
01186  DB3A              ; DLOAD D:FN
01187  DB3A              ;
01188  DB3A  20 68 DC    DLOAD  JSR DOSPAR
01189  DB3D  20 0B D8           JSR CHK2
01190  DB40  29 E6              AND #$E6
01191  DB42  F0 03              BEQ DLOAD2
01192  DB44  4C 00 BF    DLOERR JMP SNERR
01193  DB47  A0 02       DLOAD2 LDY #2
01194  DB49  A9 03              LDA #3          ;LENGTH
01195  DB4B  20 FA DB           JSR SENDP       ;BUILD
01196  DB4E  A9 00              LDA #0          ;CLR VERIFY FLAG
01197  DB50  85 9D              STA VERCK
01198  DB52  4C 08 F4           JMP LOADNP

01200  DB55              ;RENAME RDD: DFN=SD: SFN
01201  DB55              ;
01202  DB55  20 68 DC    RENAME JSR DOSPAR
01203  DB58  20 24 D8           JSR CHK5
01204  DB5B  29 E4              AND #$E4
01205  DB5D  D0 E5              BNE DLOERR
01206  DB5F  A0 2E       DREN   LDY #46         ;OFFSET
01207  DB61  A9 08              LDA #8          ;LENGTH
01208  DB63  4C 98 DA           JMP TRANS       ;GO DO IT

















DOS - SCRTCH......PAGE 001F

LINE# LOC   CODE        LINE


01210  DB66              ;SCRATCH SD: FN
01211  DB66              ;
01212  DB66  20 68 DC    SCRTCH JSR DOSPAR
01213  DB69  20 04 D8           JSR CHK1
01214  DB6C  20 9E DB    DSCRAT JSR RUSURE      ;DIRECT=>R-U-SURE
01215  DB6F  B0 27              BCS NUMBYE      ;C-NO&DIRECT
01216  DB71  A0 36              LDY #54         ;OFFSET
01217  DB73  A9 04              LDA #4          ;LENGTH
01218  DB75  20 98 DA           JSR TRANS
01219  DB78              ;
01220  DB78  20 99 DB    NUMSCR JSR DDIREC      ;DIRECT?
01221  DB7B  D0 1B              BNE NUMBYE      ;Z CLR-NOT DIRECT
01222  DB7D  20 91 D9           JSR ERRCHL      ;READ ERRS
01223  DB80  A9 0D              LDA #$D         ;PRINT C/R
01224  DB82  20 02 E2           JSR PRT
01225  DB85  A0 00              LDY #0          ;CLR TO READ ERRCHL
01226  DB87  B1 0E       NUMLP  LDA (DSDESC+1)Y ;GET MESG
01227  DB89  C9 00              CMP #00
01228  DB8B  F0 06              BEQ NUMPRT
01229  DB8D  20 02 E2           JSR PRT         ;TO SCRN
01230  DB90  C8                 INY
01231  DB91  D0 F4              BNE NUMLP
01232  DB93  A9 0D       NUMPRT LDA #$D
01233  DB95  20 02 E2           JSR PRT
01234  DB98  60          NUMBYE RTS

01236  DB99              ;DIRECT CHECK SUBROUTINE
01237  DB99  A5 78       DDIREC LDA TXTPTR+1
01238  DB9B  C9 02              CMP #2
01239  DB9D  60          DXCR0  RTS
01240  DB9E              ;
01241  DB9E              ;R-U-SURE SUBROUTINE
01242  DB9E  20 99 DB    RUSURE JSR DDIREC      ;CHK FOR DIRECT
01243  DBA1  D0 32              BNE ANSYES      ;Z CLR=NOT DIRECT
01244  DBA3  A0 B6       RUSUR1 LDY #MSG30-MSG1 ;ARE YOU SURE ?
01245  DBA5  20 85 F1           JSR MSG
01246  DBA8  20 A6 F2           JSR CLRCH       ;CLR CHL FOR BASIN
01247  DBAB  20 15 F2    RUSUR2 JSR BASIN       ;GET BASIC INPUT
01248  DBAE  C9 59              CMP #'Y         ;MUST START WITH Y
01249  DBB0  D0 19              BNE ANSNO
01250  DBB2  20 15 F2           JSR BASIN       ;NEXT CHR
01251  DBB5  C9 0D              CMP #$D         ;CR?
01252  DBB7  F0 1C              BEQ ANSYES      ;Y CR
01253  DBB9  C9 45              CMP #'E         ;THEN E
01254  DBBB  D0 0E              BNE ANSNO
01255  DBBD  20 15 F2           JSR BASIN       ;NEXT CHR
01256  DBC0  C9 53              CMP #'S         ;THEN S
01257  DBC2  D0 07              BNE ANSNO
01258  DBC4  20 15 F2           JSR BASIN       ;NEXT CHR
01259  DBC7  C9 0D              CMP #$D         ;CR?
01260  DBC9  F0 0A              BEQ ANSYES
01261  DBCB  C9 0D       ANSNO  CMP #CR         ;LOOK FOR END
01262  DBCD  38                 SEC             ;CARRY SET =NO&DIRECT
01263  DBCE  F0 06              BEQ ANSBYE
01264  DBD0  20 15 F2           JSR BASIN       ;GET NEXT CHR






DOS - SCRTCH......PAGE 0020

LINE# LOC   CODE        LINE


01265  DBD3  D0 F6              BNE ANSNO       ;BRA TO DUMP INPUT
01266  DBD5  18          ANSYES CLC             ;CARRY CLR =NOT DIRECT
01267  DBD6  60          ANSBYE RTS
01268  DBD7              ;
01269  DBD7              ;BAD DISK SUBROUTINE
01270  DBD7  20 99 DB    BADDIS JSR DDIREC      ;DIRECT?
01271  DBDA  D0 FA              BNE ANSBYE      ;NEED RTN
01272  DBDC  A0 C5              LDY #MSG31-MSG1 ;? BAD DISK
01273  DBDE  4C 85 F1           JMP MSG
01274  DBE1              ;
01275  DBE1              ;OLDCLR SUBROUTINE
01276  DBE1              ;CLEARS DISK STATUS & SATUS
01277  DBE1              ;
01278  DBE1  98          OLDCLR TYA             ;SAVE Y
01279  DBE2  48                 PHA
01280  DBE3  A5 0D              LDA DSDESC      ;CHK FOR ALLOCATION
01281  DBE5  F0 0A              BEQ OLDCL1      ;BRA IF NOT
01282  DBE7  A0 28              LDY #40
01283  DBE9  98                 TYA
01284  DBEA  91 0E              STA (DSDESC+1)Y ;LENGTH OF GARBAGE
01285  DBEC  C8                 INY
01286  DBED  A9 FF              LDA #$FF
01287  DBEF  91 0E              STA (DSDESC+1)Y ;GARBAGE FLAGED
01288  DBF1  A9 00       OLDCL1 LDA #0
01289  DBF3  85 96              STA SATUS       ;ZAP STATUS
01290  DBF5  85 0D              STA DSDESC      ;KILL DS$
01291  DBF7  68                 PLA             ;RESTORE Y
01292  DBF8  A8                 TAY
01293  DBF9  60                 RTS
01294  DBFA              ;































SENDP ROUTINE......PAGE 0021

LINE# LOC   CODE        LINE


01296  DBFA              ;
01297  DBFA  A2 00       SENDP  LDX #0          ;ZERO OFFSET
01298  DBFC  8D 41 03    SENDP1 STA COUNT       ;NON ZERO ENTRY
01299  DBFF  20 E1 DB           JSR OLDCLR      ;CLR OLD STATUS
01300  DC02  CE 41 03    SENDP2 DEC COUNT
01301  DC05  30 45              BMI TRANR
01302  DC07  C8                 INY             ;MOVE DOWN TABLE
01303  DC08  B9 38 D8           LDA TABLD,Y     ;GET NEXT ENTRY
01304  DC0B  10 39              BPL RPLCE       ;1F N CLR THEN CHAR
01305  DC0D  C9 F1       RXFN1  CMP #XFN1       ;FILE NAME 1
01306  DC0F  D0 03              BNE RXFN2
01307  DC11  20 D4 DA           JSR RSFN
01308  DC14  C9 F2       RXFN2  CMP #XFN2
01309  DC16  D0 03              BNE RXREC
01310  DC18  20 E1 DA           JSR RDFN
01311  DC1B  C9 E0       RXREC  CMP #XREC
01312  DC1D  D0 05              BNE RXID
01313  DC1F  AD 3D 03           LDA LRECL       ;GET REC#
01314  DC22  D0 22              BNE RPLCE       ;BRA
01315  DC24  C9 D0       RXID   CMP #XID
01316  DC26  D0 03              BNE RXWRT
01317  DC28  20 FD DA           JSR RID
01318  DC2B  C9 E1       RXWRT  CMP #XWRT       ;CHK FOR W OR L
01319  DC2D  D0 05              BNE RXD1
01320  DC2F  20 57 DC           JSR RWRT
01321  DC32  D0 12              BNE RPLCE       ;BRA
01322  DC34  C9 D1       RXD1   CMP #XD1
01323  DC36  D0 05              BNE RXD2
01324  DC38  AD 3B 03           LDA DRIVE1
01325  DC3B  10 07              BPL RXDD        ;BRA
01326  DC3D  C9 D2       RXD2   CMP #XD2
01327  DC3F  D0 C1              BNE SENDP2      ;END OF TABLE BRA
01328  DC41  AD 3C 03           LDA DRIVE2
01329  DC44  09 30       RXDD   ORA #48         ;CHANGE TO ASCII
01330  DC46              ;
01331  DC46  9D 53 03    RPLCE  STA TBUFF,X     ;ELSE INTO BUFFER
01332  DC49  E8                 INX
01333  DC4A  D0 B6              BNE SENDP2      ;BRA TO RESTART
01334  DC4C              ;
01335  DC4C  86 D1       TRANR  STX FNLEN       ;X IS LENGTH TO SEND
01336  DC4E  A9 53              LDA #<TBUFF     ;MOVE POINTERS
01337  DC50  85 DA              STA FNADR
01338  DC52  A9 03              LDA #>TBUFF
01339  DC54  85 DB              STA FNADR+1
01340  DC56  60                 RTS
01341  DC57              ;
01342  DC57  AD 3D 03    RWRT   LDA LRECL       ;CHA FOR L OR W
01343  DC5A  F0 04              BEQ RWRT1       ;ZERO THEN WRITE
01344  DC5C  A9 4C              LDA #'L
01345  DC5E  D0 07              BNE RWRTS       ;BRA
01346  DC60  A9 53       RWRT1  LDA #'S         ;SEND W,S
01347  DC62  8D 3D 03           STA LRECL
01348  DC65  A9 57              LDA #'W
01349  DC67  60          RWRTS  RTS
01350  DC68              .FILE  DOS.PARSER






DOS PARSER......PAGE 0022

LINE# LOC   CODE        LINE


01352  DC68              ;******* DOSPAR **************
01353  DC68              ;*
01354  DC68              ;*       -MGM 7/23/79-
01355  DC68              ;*
01356  DC68              ;* THIS IS THE PARSER ROUTINE
01357  DC68              ;* IT LOOKS AT LINES PASSED TO
01358  DC68              ;* IT AND MAKES SURE THAT THE
01359  DC68              ;* SYNTAX IS ALL PROPER.
01360  DC68              ;*
01361  DC68              ;* IT RETURNS WITH PARCHK
01362  DC68              ;* IN THE .ACC
01363  DC68              ;*
01364  DC68              ;* PARCHK IS THE
01365  DC68              ;*   "PARSING CHECK BYTE".
01366  DC68              ;* FLAGS ARE SET ACCORDINGLY
01367  DC68              ;* AS VALUES ARE PARSED  AND SET
01368  DC68              ;*
01369  DC68              ;* STRUCTURE OF PARCHK:
01370  DC68              ;*
01371  DC68              ;*I-I-I-I-I-I-I-I-I
01372  DC68              ;*I7+6+5+4+3+2+1+0I
01373  DC68              ;*I-I-I-I-I-I-I-I-I
01374  DC68              ;* ^ ^ ^ ^ ^ ^ ^ ^=> FN1:  THIS BIT
01375  DC68              ;* ! ! ! ! ! ! !   IS SET WHEN THE FIRST
01376  DC68              ;* ! ! ! ! ! ! !   FILENAME IS PARSED
01377  DC68              ;* ! ! ! ! ! ! !=> FN2: " FOR SECOND FILENAME
01378  DC68              ;* ! ! ! ! ! !=> LA: BIT SET WHEN #L IS PARSED
01379  DC68              ;* ! ! ! ! !=> FA: BIT SET WHEN UNIT# 1S PARSED
01380  DC68              ;* ! ! ! !=> D1: BIT SET WHEN DRIVE1 PARSED
01381  DC68              ;* ! ! !=> D2: DITTO - WHEN DRIVE2 PARSED
01382  DC68              ;* ! !=> LRECL: SET WHEN LRECL PARSED
01383  DC68              ;* !=> @RPL: SET ON REPLCMNT OPERATOR IN FN1
01384  DC68              ;*
01385  DC68              ;*  THE FOLLOWING ARE THE VALID BIT-
01386  DC68              ;*     PATTERNS FOR PARCHK AFTER PARSING
01387  DC68              ;*   FOR THE VARIOUS KEYWORDS:
01388  DC68              ;*
01389  DC68              ;*             PARCHK
01390  DC68              ;*          7 6 5 4   3 2 1 0
01391  DC68              ;*(FORMAT)
01392  DC68              ;* HEADER   0 0 0 1   * 0 0 1
01393  DC68              ;* COLECT   0 0 0 *   * 0 0 0
01394  DC68              ;* BACKUP   0 0 1 1   * 0 0 0
01395  DC68              ;* COPY     0 0 1 1   * 0 0 0
01396  DC68              ;*   OR..   0 0 * *   * 0 1 1
01397  DC68              ;* CONCAT   0 0 * *   * 0 1 1
01398  DC68              ;* DSAVE    * 0 0 *   * 0 0 1
01399  DC68              ;* DLOAD    0 0 0 *   * 0 0 l
01400  DC68              ;* CATLOG   0 0 0 *   * 0 0 0
01401  DC68              ;* RENAME   0 0 0 *   * 0 1 1
01402  DC68              ;* APPEND   0 0 0 *   * 1 0 1
01403  DC68              ;* SCRTCH   0 0 0 *   * 0 0 1
01404  DC68              ;* DOPEN    * * 0 *   * 1 0 1
01405  DC68              ;* DCLOSE   0 0 0 0   * * 0 0
01406  DC68              ;*          ^ ^ ^ ^   ^ ^ ^ ^






DOS PARSER......PAGE 0023

LINE# LOC   CODE        LINE


01407  DC68              ;*          @ L D D   F L F F
01408  DC68              ;*          R R 2 1   A A N N
01409  DC68              ;*          P E           2 1
01410  DC68              ;*          L L
01411  DC68              ;*   "1" BITS ARE REQ'D PARAMETERS
01412  DC68              ;*   "*" BITS ARE OPTIONAL PARMS
01413  DC68              ;************************************
01414  DC68              ;
01415  DC68  A2 00       DOSPAR LDX #0
01416  DC6A  8E 3E 03           STX PARCHK
01417  DC6D  86 D2              STX LA
01418  DC6F  8E 3D 03           STX LRECL       ; INIT VARS
01419  DC72  8E 3B 03           STX DRIVE1
01420  DC75  8E 3C 03           STX DRIVE2
01421  DC78  86 D1              STX FNLEN
01422  DC7A  8E 3A 03           STX FNLEN2
01423  DC7D  8E 3F 03           STX DISKID
01424  DC80  A2 08              LDX #8
01425  DC82  86 D4              STX FA
01426  DC84  20 76 00           JSR CHRGOT      ; GET CURRENT CHR
01427  DC87  F0 7A              BEQ DONE1       ; <CR> OR <:> => DONE
01428  DC89              ;
01429  DC89  C9 23       PARSEL CMP #'#
01430  DC8B  F0 30              BEQ LOGADR
01431  DC8D  C9 57              CMP #'W
01432  DC8F  F0 47              BEQ RECLEN
01433  DC91  C9 4C              CMP #'L
01434  DC93  F0 43              BEQ RECLEN
01435  DC95  C9 52              CMP #'R
01436  DC97  D0 06              BNE PARNXT
01437  DC99  20 70 00           JSR CHRGET      ;MOVE ON
01438  DC9C  4C 96 DD           JMP DELIM1
01439  DC9F  C9 44       PARNXT CMP #'D
01440  DCA1  F0 72              BEQ DRV1
01441  DCA3  C9 91              CMP #ONTK       ;"ON" TOKEN
01442  DCA5  F0 62              BEQ ON1
01443  DCA7  C9 55              CMP #'U
01444  DCA9  F0 64              BEQ UNIT1
01445  DCAB  C9 49              CMP #'I
01446  DCAD  D0 03              BNE NEXT7
01447  DCAF  4C 37 DD           JMP IDENT
01448  DCB2  C9 22       NEXT7  CMP #'"
01449  DCB4  F0 50              BEQ NAME11
01450  DCB6  C9 28              CMP #'(
01451  DCB8  F0 4C              BEQ NAME11
01452  DCBA  4C 00 BF    SNER1  JMP SNERR       ;SNYTAX ERROR
01453  DCBD              ; OF THE ABOVE
01454  DCBD              ;
01455  DCBD              ;
01456  DCBD  AD 3E 03    LOGADR LDA PARCHK      ;CHK SYNTAX
01457  DCC0  29 04              AND #4
01458  DCC2  D0 F6              BNE SNER1       ;ONLY ONE LA ALLOWED
01459  DCC4  20 87 DE           JSR GETVAL
01460  DCC7  E0 00              CPX #0
01461  DCC9  F0 69              BEQ QTYER2      ;ZERO NOT ALLOWED






DOS PARSER......PAGE 0024

LINE# LOC   CODE        LINE


01462  DCCB  86 D2              STX LA
01463  DCCD  AD 3E 03           LDA PARCHK
01464  DCD0  09 04              ORA #4          ;SET LA FLAG &
01465  DCD2  8D 3E 03           STA PARCHK
01466  DCD5  4C 96 DD           JMP DELIM1      ;CONTINUE
01467  DCD8              ;
01468  DCD8              ;
01469  DCD8  AA          RECLEN TAX             ;SAVE CHAR
01470  DCD9  AD 3E 03           LDA PARCHK      ;CHK SYNTAX
01471  DCDC  29 40              AND #$40
01472  DCDE  D0 DA              BNE SNER1       ;ONLY 1 LRECL ALLOWED
01473  DCE0  E0 57              CPX #'W
01474  DCE2  D0 06              BNE RECOO
01475  DCE4  20 70 00           JSR CHRGET
01476  DCE7  4C F8 DC           JMP RECON       ;ONLY SET PARCHK
01477  DCEA  20 87 DE    RECOO  JSR GETVAL
01478  DCED  E0 00              CPX #0
01479  DCEF  F0 43              BEQ QTYER2      ;ZERO ILLEGAL. LRECL
01480  DCF1  E0 FF              CPX #255
01481  DCF3  F0 3F              BEQ QTYER2      ;ILLEGAL LRECL
01482  DCF5  8E 3D 03           STX LRECL       ;STORE PARCEL
01483  DCF8  AD 3E 03    RECON  LDA PARCHK
01484  DCFB  09 40              ORA #$40        ;SET LRECL FLAG &
01485  DCFD  8D 3E 03           STA PARCHK
01486  DD00  4C 96 DD           JMP DELIM1      ; CONTINUE
01487  DD03              ;
01488  DD03  4C 23 DE    DONE1  JMP DONE
01489  DD06              ;
01490  DD06  4C 60 DD    NAME11 JMP NAME1
01491  DD09  20 2C DE    ON1    JSR ON
01492  DD0C  4C 96 DD           JMP DELIM1
01493  DD0F  20 33 DE    UNIT1  JSR UNIT        ;DO UNIT# PARSING
01494  DD12  4C 96 DD           JMP DELIM1
01495  DD15              ;
01496  DD15              ;
01497  DD15  AD 3E 03    DRV1   LDA PARCHK
01498  DD18  29 10              AND #$10
01499  DD1A  D0 9E              BNE SNER1       ;DRIVE1 ALLOWED ONCE
01500  DD1C  20 87 DE           JSR GETVAL
01501  DD1F  E0 02              CPX #2
01502  DD21  B0 11              BCS QTYER2      ;ILLEGAL DRV# IF >1
01503  DD23  8E 3B 03           STX DRIVE1
01504  DD26  8E 3C 03           STX DRIVE2
01505  DD29  AD 3E 03           LDA PARCHK
01506  DD2C  09 10              ORA #$10
01507  DD2E  8D 3E 03           STA PARCHK      ;SET DRIVE1 FLAG &
01508  DD31  4C 96 DD           JMP DELIM1      ; CONTINUE
01509  DD34              ;
01510  DD34  4C 27 DE    QTYER2 JMP QTYERR
01511  DD37              ;
01512  DD37  AD 3D 03    IDENT  LDA DIDCHK
01513  DD3A  29 FF              AND #$FF
01514  DD3C  F0 03              BEQ IDCON       ;ONLY 1 DISKID ALLOWED
01515  DD3E  4C 00 BF           JMP SNERR
01516  DD41  A0 00       IDCON  LDY #0






DOS PARSER......PAGE 0025

LINE# LOC   CODE        LINE


01517  DD43  A2 00              LDX #0
01518  DD45  E6 77       NEXT3  INC TXTPTR
01519  DD47  D0 02              BNE NEXT4
01520  DD49  E6 78              INC TXTPTR+1
01521  DD4B  B1 77       NEXT4  LDA (TXTPTR),Y
01522  DD4D  9D 3F 03           STA DISKID,X    ;M(TXTPTR => DISKID
01523  DD50  E8                 INX
01524  DD51  E0 02              CPX #2
01525  DD53  90 F0              BCC NEXT3
01526  DD55  A9 FF              LDA #$FF
01527  DD57  8D 3D 03           STA DIDCHK      ;SET DISKID FLAG &
01528  DD5A  20 70 00           JSR CHRGET      ;CONTINUE
01529  DD5D  4C 96 DD           JMP DELIM1
01530  DD60              ;
01531  DD60              ;
01532  DD60  AD 3E 03    NAME1  LDA PARCHK
01533  DD63  29 01              AND #1          ;NAMEL ALLWD ONLY ONCE
01534  DD65  20 49 DE           JSR NEWNAM      ;DO NAME PARSING
01535  DD68  85 D1              STA FNLEN
01536  DD6A  8D 41 03           STA COUNT       ;SAVE TEMP VALUE
01537  DD6D  A9 42              LDA #<TBUF2
01538  DD6F  85 DA              STA FNADR
01539  DD71  A9 03              LDA #>TBUF2
01540  DD73  85 DB              STA FNADR+1;RESET FNADR VALUE
01541  DD75  A0 00              LDY #0
01542  DD77  B1 1F       LOOP6  LDA (INDEX1)Y   ;TBUF2 XFER LOOP
01543  DD79  C0 00              CPY #0
01544  DD7B  D0 08              BNE NAMCON
01545  DD7D  C9 40              CMP #'@
01546  DD7F  D0 04              BNE NAMCON
01547  DD81  E6 DA              INC FNADR       ;AND ERASE IT
01548  DD83  C6 D1              DEC FNLEN
01549  DD85  99 42 03    NAMCON STA TBUF2,Y
01550  DD88  C8                 INY
01551  DD89  CC 41 03           CPY COUNT
01552  DD8C  90 E9              BCC LOOP6
01553  DD8E  AD 3E 03           LDA PARCHK
01554  DD91  09 01              ORA #1          ;SET NAPIE1 FLAG
01555  DD93  8D 3E 03           STA PARCHK
01556  DD96              ;
01557  DD96  20 76 00    DELIM1 JSR CHRGOT
01558  DD99  D0 03              BNE NXXX
01559  DD9B  4C 03 DD           JMP DONE1       ;<CR>/<:> => DONE
01560  DD9E  C9 2C       NXXX   CMP #',
01561  DDA0  D0 06              BNE NEXT6
01562  DDA2  20 70 00           JSR CHRGET
01563  DDA5  4C 89 DC           JMP PARSEL
01564  DDA8  C9 91       NEXT6  CMP #ONTK
01565  DDAA  D0 03              BNE NEXT6A
01566  DDAC  4C 09 DD           JMP ON1
01567  DDAF  C9 A4       NEXT6A CMP #TOTK       ;"TO" TOKEN
01568  DDB1  F0 03              BEQ PARSE2
01569  DDB3  4C 00 BF    SNER8  JMP SNERR       ;SNTAX ERROR
01570  DDB6              ;
01571  DDB6              ;






DOS PARSER......PAGE 0026

LINE# LOC   CODE        LINE


01572  DDB6  20 70 00    PARSE2 JSR CHRGET
01573  DDB9  C9 44              CMP #'D
01574  DDBB  F0 13              BEQ DRV2
01575  DDBD  C9 91              CMP #ONTK       ;"ON" TOKEN
01576  DDBF  F0 2B              BEQ ON2
01577  DDC1  C9 55              CMP #'U
01578  DDC3  F0 2D              BEQ UNIT2
01579  DDC5  C9 22              CMP #'"
01580  DDC7  F0 2F              BEQ NAME2
01581  DDC9  C9 28              CMP #'(
01582  DDCB  F0 2B              BEQ NAME2
01583  DDCD  4C 00 BF    SNER2  JMP SNERR        ;ERROR
01584  DDD0              ;
01585  DDD0              ;
01586  DDD0  AD 3E 03    DRV2   LDA PARCHK
01587  DDD3  29 20              AND #$20
01588  DDD5  D0 F6              BNE SNER2       ;ONLY ONE DRIVE2 ALLWD
01589  DDD7  20 87 DE           JSR GETVAL
01590  DDDA  E0 02              CPX #2
01591  DDDC  B0 49              BCS QTYERR      ;ILLEGAL DRIVE #
01592  DDDE  8E 3C 03           STX DRIVE2
01593  DDE1  AD 3E 03           LDA PARCHK
01594  DDE4  09 20              ORA #$20
01595  DDE6  8D 3E 03           STA PARCHK      ;GET DRIVE2 FLAG &
01596  DDE9  4C 0F DE           JMP DELIM2
01597  DDEC              ;
01598  DDEC              ;
01599  DDEC  20 2C DE    ON2    JSR ON
01600  DDEF  4C 0F DE           JMP DELIM2
01601  DDF2  20 33 DE    UNIT2  JSR UNIT         ;DO UNIT# PARSING
01602  DDF5  4C 0F DE           JMP DELIM2
01603  DDF8              ;
01604  DDF8              ;
01605  DDF8  AD 3E 03    NAME2  LDA PARCHK
01606  DDFB  29 02              AND #2          ;NAME2 ALLOWED ONLY ONCE
01607  DDFD  20 49 DE           JSR NEWNAM
01608  DE00  8D 3A 03           STA FNLEN2
01609  DE03  86 FD              STX FNADR2
01610  DE05  84 FE              STY FNADR2+1
01611  DE07  AD 3E 03           LDA PARCHK
01612  DE0A  09 02              ORA #2          ;SET FILENAME2 FLAG &
01613  DE0C  8D 3E 03           STA PARCHK
01614  DE0F              ;CONTINUE
01615  DE0F              ;
01616  DE0F  20 76 00    DELIM2 JSR CHRGOT
01617  DE12  F0 0F              BEQ DONE        ;DONE ON <CR>/<:>
01618  DE14  C9 2C              CMP #',
01619  DE16  F0 9E              BEQ PARSE2
01620  DE18  C9 91              CMP #ONTK       ;"ON" TOKEN
01621  DE1A  F0 D0              BEQ ON2
01622  DE1C  C9 55              CMP #'U
01623  DE1E  F0 D2              BEQ UNIT2
01624  DE20  4C 00 BF    SNER3  JMP SNERR        ;ERROR
01625  DE23              ;
01626  DE23              ;






DOS PARSER......PAGE 0027

LINE# LOC   CODE        LINE


01627  DE23  AD 3E 03    DONE   LDA PARCHK       ;LOAD PARSER CHK
01628  DE26  60                 RTS             ;BYTE FOR CALLING PROG TO CHECK
01629  DE27              ;
01630  DE27              ;***************************************
01631  DE27              ;* DOSPAR SUPPORT ROUTINES             *
01632  DE27              ;***************************************
01633  DE27              ;
01634  DE27              ;
01635  DE27  A2 35       QTYERR LDX #ERRFC
01636  DE29  4C CF B3           JMP ERROR; "ILLEGAL QUANTITY"
01637  DE2C              ;
01638  DE2C              ;
01639  DE2C  20 70 00    ON     JSR CHRGET
01640  DE2F  C9 55              CMP #'U
01641  DE31  D0 ED              BNE SNER3       ;NXT CHR MUST BE "U"
01642  DE33  20 87 DE    UNIT   JSR GETVAL
01643  DE36  E0 20              CPX #32
01644  DE38  B0 ED              BCS QTYERR      ;ERROR IF >31
01645  DE3A  E0 03              CPX #3
01646  DE3C  90 E9              BCC QTYERR      ;ERROR IF <3
01647  DE3E  86 D4              STX FA
01648  DE40  AD 3E 03           LDA PARCHK
01649  DE43  09 08              ORA #8
01650  DE45  8D 3E 03           STA PARCHK      ;SET UNIT# FLAG
01651  DE48  60                 RTS
01652  DE49              ;
01653  DE49              ;
01654  DE49  D0 D5       NEWNAM BNE SNER3
01655  DE4B  20 98 BD           JSR FRMEVL
01656  DE4E  20 B5 C7           JSR FRESTR
01657  DE51  AA                 TAX             ;SAVE LENGTH IN .X
01658  DE52  C9 00              CMP #0
01659  DE54  F0 D1              BEQ QTYERR      ;0 LENGTH NOT ALLOWED
01660  DE56  C9 12              CMP #18
01661  DE58  B0 1A              BCS ERRLEN
01662  DE5A  A0 00              LDY #0
01663  DE5C  B1 1F              LDA (INDEX1)Y
01664  DE5E  C9 40              CMP #'@
01665  DE60  D0 0A              BNE LENCHK
01666  DE62  AD 3E 03           LDA PARCHK
01667  DE65  29 80              AND #$80        ;IF T => SNERR
01668  DE67  F0 10              BEQ NXXT5
01669  DE69  4C 00 BF           JMP SNERR
01670  DE6C  8A          LENCHK TXA
01671  DE6D  C9 11              CMP #17         ;"STRING TOO LONG ?
01672  DE6F  B0 03              BCS ERRLEN
01673  DE71  4C 82 DE           JMP NXX5
01674  DE74  A2 B0       ERRLEN LDX #ERRLS
01675  DE76  4C CF B3           JMP ERROR       ;"STRING TOO LONG"
01676  DE79  AD 3E 03    NXXT5  LDA PARCHK
01677  DE7C  09 80              ORA #$80        ;SET "@" FLAG
01678  DE7E  8D 3E 03           STA PARCHK
01679  DE81  8A          NEXT5  TXA              ;.A = FNLEN NOW
01680  DE82  A6 1F       NXX5   LDX INDEX1
01681  DE84  A4 20              LDY INDEX1+1






DOS PARSER......PAGE 0028

LINE# LOC   CODE        LINE


01682  DE86  60                 RTS
01683  DE87              ;
01684  DE87              ;
01685  DE87              GETVAL                 ;GET NEXTVALUE ROUTINE
01686  DE87  20 70 00           JSR CHRGET      ;GET NXT CHR
01687  DE8A  D0 03       GTVL2  BNE CONT
01688  DE8C  4C 00 BF           JMP SNERR       ;CANT BE <CR>/<:>
01689  DE8F  90 09       CONT   BCC NUMERC       ;CAN BE NUMERIC
01690  DE91  20 F2 BE           JSR CHKOPN      ;OR A "("
01691  DE94  20 D4 C8           JSR GETBYT      ;ANYTHING ELSE IS AN ERROR
01692  DE97  4C EF BE           JMP CHKCLS      ;NEED CLOSING ")"
01693  DE9A  4C D4 C8    NUMERC JMP GETBYT       ;EVALUATE IT
01694  DE9D              ;
01695  DE9D  00          CKSUMD .BYT 0           ; D-PAGE CHECKSUM BYT
01696  DE9E              ;
01697  DE9E  85 96       PATCH5 STA SATUS
01698  DEA0  91 0E              STA (DSDESC+1)Y
01699  DEA2  88                 DEY
01700  DEA3  60                 RTS
01701  DEA4              ;
01702  DEA4  2A 2A       SIGNON .BYT '*** COMMODORE BASIC 4.0 ***'
01703  DEBF  0D                 .BYT 13,13,0
01703  DEC0  0D 
01703  DEC1  00 
01704  DEC2              ;
01705  DEC2              .FILE  OA1SRC



































SCREEN EDITOR & I/O......PAGE 0029

LINE# LOC   CODE        LINE


01707  DEC2                     *=$6000+OFFSET  ;OFFSET IS FOR A
01708  E000              ;*** SOFT MACHINE ******
01709  E000  A9 7F       CINT   LDA #$7F
01710  E002  8D 4E E8           STA IER
01711  E005  A2 6D              LDX #CAS2-TIME
01712  E007  A9 00              LDA #0
01713  E009  95 8D       PX1    STA TIME,X
01714  E00B  CA                 DEX
01715  E00C  10 FB              BPL PX1
01716  E00E  A9 55              LDA #<KEY
01717  E010  85 90              STA CINV
01718  E012  A9 E4              LDA #>KEY
01719  E014  85 91              STA CINV+1
01720  E016  A9 03              LDA #3
01721  E018  85 B0              STA DFLTO
01722  E01A  A9 0F              LDA #$F
01723  E01C  8D 10 E8           STA PIAL
01724  E01F  0A                 ASL A
01725  E020  8D 40 E8           STA PIA
01726  E023  8D 42 E8           STA P2DB
01727  E026  8E 22 E8           STX IEEO
01728  E029  8E 45 E8           STX TIH
01729  E02C  A9 3D              LDA #$3D
01730  E02E  8D 13 E8           STA PIAS
01731  E031  2C 12 E8           BIT PIAK
01732  E034  A9 3C              LDA #$3C
01733  E036  8D 21 E8           STA IEEIS
01734  E039  8D 23 E8           STA IEEOS
01735  E03C  8D 11 E8           STA PIAL1
01736  E03F  8E 22 E8           STX IEEO
01737  E042  A9 0C              LDA #$C
01738  E044  8D 4C E8           STA PCR
01739  E047  85 A8              STA BLNCT
01740  E049  85 A7              STA BLNSW
01741  E04B  A0 83       CLSR   LDY #$83
01742  E04D  A2 18              LDX #24
01743  E04F  94 E0       LPS1   STY LDTB1,X
01744  E051  E0 14              CPX #20
01745  E053  F0 08              BEQ LPS2
01746  E055  E0 0D              CPX #13
01747  E057  F0 04              BEQ LPS2
01748  E059  E0 07              CPX #7
01749  E05B  D0 01              BNE LPS3
01750  E05D  88          LPS2   DEY
01751  E05E  CA          LPS3   DEX
01752  E05F  10 EE              BPL LPS1
01753  E061  84 C5              STY POINT
01754  E063  E8                 INX
01755  E064  86 9F              STX RVS
01756  E066  86 C4              STX POINT-1
01757  E068  A9 20              LDA #' 
01758  E06A  9D 00 80    LPS4   STA $8000,X
01759  E06D  9D 00 81           STA $8100,X
01760  E070  9D 00 82           STA $8200,X
01761  E073  9D 00 83           STA $8300,X






SCREEN EDITOR & I/O......PAGE 002A

LINE# LOC   CODE        LINE


01762  E076  CA                 DEX
01763  E077  D0 F1              BNE LPS4
01764  E079  A0 00       NXTD   LDY #0
01765  E07B  84 C6              STY PNTR
01766  E07D  84 D8              STY TBLX
01767  E07F  A6 D8       STUPT  LDX TBLX
01768  E081  B5 E0              LDA LDTB1,X
01769  E083  09 80              ORA #$80
01770  E085  85 C5              STA POINT
01771  E087  BD 5B E6           LDA LDTB2,X
01772  E08A  85 C4              STA PNT
01773  E08C  A9 27              LDA #39
01774  E08E  85 D5              STA LNMX
01775  E090  E0 18              CPX #24
01776  E092  F0 08              BEQ STUPZ
01777  E094  B5 E1              LDA LDTB1+1,X
01778  E096  30 04              BMI STUPZ
01779  E098  A9 4F              LDA #79
01780  E09A  85 D5              STA LNMX
01781  E09C  A5 C6       STUPZ  LDA PNTR
01782  E09E  C9 28              CMP #40
01783  E0A0  90 04              BCC STUPR
01784  E0A2  E9 28              SBC #40
01785  E0A4  85 C6              STA PNTR
01786  E0A6  60          STUPR  RTS
01787  E0A7  AC 6F 02    LP2    LDY KEYD
01788  E0AA  A2 00              LDX #0
01789  E0AC  BD 70 02    LP1    LDA KEYD+1,X
01790  E0AF  9D 6F 02           STA KEYD,X
01791  E0B2  E8                 INX
01792  E0B3  E4 9E              CPX NDX
01793  E0B5  D0 F5              BNE LP1
01794  E0B7  C6 9E              DEC NDX
01795  E0B9  98                 TYA
01796  E0BA  58                 CLI
01797  E0BB  60                 RTS
01798  E0BC  20 02 E2    LOOP4  JSR PRT
01799  E0BF  A5 9E       LOOP3  LDA NDX
01800  E0C1  85 A7              STA BLNSW
01801  E0C3  F0 FA              BEQ LOOP3
01802  E0C5  78                 SEI
01803  E0C6  A5 AA              LDA BLNON
01804  E0C8  F0 09              BEQ LP21
01805  E0CA  A5 A9              LDA GDBLN
01806  E0CC  A0 00              LDY #0
01807  E0CE  84 AA              STY BLNON
01808  E0D0  20 06 E6           JSR DSPP
01809  E0D3  20 A7 E0    LP21   JSR LP2
01810  E0D6  C9 83              CMP #$83
01811  E0D8  D0 10              BNE LP22
01812  E0DA  78                 SEI
01813  E0DB  A2 09              LDX #9
01814  E0DD  86 9E              STX NDX
01815  E0DF  BD 73 E6    LP23   LDA RUNTB-1,X
01816  E0E2  9D 6E 02           STA KEYD-1,X






SCREEN EDITOR & I/O......PAGE 002B

LINE# LOC   CODE        LINE


01817  E0E5  CA                 DEX
01818  E0E6  D0 F7              BNE LP23
01819  E0E8  F0 D5              BEQ LOOP3
01820  E0EA  C9 0D       LP22   CMP #$D
01821  E0EC  D0 CE              BNE LOOP4
01822  E0EE  A4 D5              LDY LNMX
01823  E0F0  84 AC              STY CRSW
01824  E0F2  B1 C4       CLP5   LDA (PNT)Y
01825  E0F4  C9 20              CMP #' 
01826  E0F6  D0 03              BNE CLP6
01827  E0F8  88                 DEY
01828  E0F9  D0 F7              BNE CLP5
01829  E0FB  C8          CLP6   INY
01830  E0FC  84 A1              STY INDX
01831  E0FE  A0 00              LDY #0
01832  E100  84 C6              STY PNTR
01833  E102  84 CD              STY QTSW
01834  E104  A5 A3              LDA LSXP
01835  E106  30 16              BMI LOP5
01836  E108  C5 D8              CMP TBLX
01837  E10A  D0 12              BNE LOP5
01838  E10C  A5 A4              LDA LSTP
01839  E10E  85 C6              STA PNTR
01840  E110  C5 A1              CMP INDX
01841  E112  90 0A              BCC LOP5
01842  E114  B0 2B              BCS CLP2
01843  E116  98          LOOP5  TYA
01844  E117  48                 PHA
01845  E118  8A                 TXA
01846  E119  48                 PHA
01847  E11A  A5 AC              LDA CRSW
01848  E11C  F0 A1              BEQ LOOP3
01849  E11E  A4 C6       LOP5   LDY PNTR
01850  E120  B1 C4              LDA (PNT)Y
01851  E122  85 D9              STA DATA
01852  E124  29 3F       LOP51  AND #$3F
01853  E126  06 D9              ASL DATA
01854  E128  24 D9              BIT DATA
01855  E12A  10 02              BPL LOP54
01856  E12C  09 80              ORA #$80
01857  E12E  90 04       LOP54  BCC LOP52
01858  E130  A6 CD              LDX QTSW
01859  E132  D0 04              BNE LOP53
01860  E134  70 02       LOP52  BVS LOP53
01861  E136  09 40              ORA #$40
01862  E138  E6 C6       LOP53  INC PNTR
01863  E13A  20 67 E1           JSR QTSWC
01864  E13D  C4 A1              CPY INDX
01865  E13F  D0 17              BNE CLP1
01866  E141  A9 00       CLP2   LDA #0
01867  E143  85 AC              STA CRSW
01868  E145  A9 0D              LDA #$D
01869  E147  A6 AF              LDX DFLTN       ;FIX GETS FROM SCREEN
01870  E149  E0 03              CPX #3          ;1S IT THE SCREEN?
01871  E14B  F0 06              BEQ CLP2A






SCREEN EDITOR & I/O......PAGE 002C

LINE# LOC   CODE        LINE


01872  E14D  A6 B0              LDX DFLTO
01873  E14F  E0 03              CPX #3
01874  E151  F0 03              BEQ CLP21
01875  E153  20 02 E2    CLP2A  JSR PRT
01876  E156  A9 0D       CLP21  LDA #$D
01877  E158  85 D9       CLP1   STA DATA
01878  E15A  68                 PLA
01879  E15B  AA                 TAX
01880  E15C  68                 PLA
01881  E15D  A8                 TAY
01882  E15E  A5 D9              LDA DATA
01883  E160  C9 DE              CMP #$DE
01884  E162  D0 02              BNE CLP7
01885  E164  A9 FF              LDA #$FF
01886  E166  60          CLP7   RTS
01887  E167  C9 22       QTSWC  CMP #$22
01888  E169  D0 08              BNE QTSWL
01889  E16B  A5 CD              LDA QTSW
01890  E16D  49 01              EOR #$1
01891  E16F  85 CD              STA QTSW
01892  E171  A9 22              LDA #$22
01893  E173  60          QTSWL  RTS
01894  E174  09 40       NXT33  ORA #$40
01895  E176  A6 9F       NXT3   LDX RVS
01896  E178  F0 02              BEQ NVS
01897  E17A  09 80       NC3    ORA #$80
01898  E17C  A6 DC       NVS    LDX INSRT
01899  E17E  F0 02              BEQ NVS1
01900  E180  C6 DC              DEC INSRT
01901  E182  20 06 E6    NVS1   JSR DSPP
01902  E185  E6 C6       JSTS   INC PNTR
01903  E187  A4 D5              LDY LNMX
01904  E189  C4 C6              CPY PNTR
01905  E18B  B0 19              BCS LOOP2
01906  E18D  A6 D8              LDX TBLX
01907  E18F  C0 4F              CPY #79
01908  E191  D0 0C              BNE JSTS1
01909  E193  20 B3 E1           JSR JSTSX
01910  E196  20 43 E3           JSR NXLN
01911  E199  A9 00              LDA #0
01912  E19B  85 C6              STA PNTR
01913  E19D  F0 07              BEQ LOOP2
01914  E19F  E0 18       JSTS1  CPX #24
01915  E1A1  D0 1B              BNE JTS2
01916  E1A3  20 C4 E1           JSR SCRL
01917  E1A6  68          LOOP2  PLA
01918  E1A7  A8                 TAY
01919  E1A8  A5 DC              LDA INSRT
01920  E1AA  F0 02              BEQ LOP2
01921  E1AC  46 CD              LSR QTSW
01922  E1AE  68          LOP2   PLA
01923  E1AF  AA                 TAX
01924  E1B0  68                 PLA
01925  E1B1  58                 CLI
01926  E1B2  60                 RTS






SCREEN EDITOR & I/O......PAGE 002D

LINE# LOC   CODE        LINE


01927  E1B3  E0 17       JSTSX  CPX #23
01928  E1B5  B0 06              BCS JSXB
01929  E1B7  B5 E2              LDA LDTB1+2,X
01930  E1B9  09 80              ORA #$80
01931  E1BB  95 E2              STA LDTB1+2,X
01932  E1BD  60          JSXB   RTS
01933  E1BE  20 CD E1    JTS2   JSR JSTS2
01934  E1C1  4C A6 E1           JMP LOOP2
01935  E1C4  20 69 E3    SCRL   JSR SCROL
01936  E1C7  C6 A3              DEC LSXP        ;FIX INPUT SCROLL
01937  E1C9  C6 D8              DEC TBLX
01938  E1CB  A6 D8              LDX TBLX
01939  E1CD  16 E1       JSTS2  ASL LDTB1+1,X
01940  E1CF  56 E1              LSR LDTB1+1,X
01941  E1D1  20 B3 E1           JSR JSTSX
01942  E1D4  A5 C6              LDA PNTR
01943  E1D6  48                 PHA
01944  E1D7  20 7F E0           JSR STUPT
01945  E1DA  68                 PLA
01946  E1DB  85 C6              STA PNTR
01947  E1DD  60                 RTS
01948  E1DE  A0 27       BKLN   LDY #39
01949  E1E0  A6 D8              LDX TBLX
01950  E1E2  D0 06              BNE BKLN1
01951  E1E4  86 C6              STX PNTR
01952  E1E6  68                 PLA
01953  E1E7  68                 PLA
01954  E1E8  D0 BC              BNE LOOP2
01955  E1EA  B5 DF       BKLN1  LDA LDTB1-1,X
01956  E1EC  30 05              BMI NTCN2
01957  E1EE  CA                 DEX
01958  E1EF  B5 DF              LDA LDTB1-1,X
01959  E1F1  A0 4F              LDY #79
01960  E1F3  CA          NTCN2  DEX
01961  E1F4  86 D8              STX TBLX
01962  E1F6  85 C5              STA POINT
01963  E1F8  BD 5B E6           LDA LDTB2,X
01964  E1FB  85 C4              STA PNT
01965  E1FD  84 C6              STY PNTR
01966  E1FF  84 D5              STY LNMX
01967  E201  60                 RTS
01968  E202  48          PRT    PHA
01969  E203  85 D9              STA DATA
01970  E205  8A                 TXA
01971  E206  48                 PHA
01972  E207  98                 TYA
01973  E208  48                 PHA
01974  E209  A9 00              LDA #0
01975  E20B  85 AC              STA CRSW
01976  E20D  A4 C6              LDY PNTR
01977  E20F  A5 D9              LDA DATA
01978  E211  10 03              BPL *+5
01979  E213  4C A4 E2           JMP NXTX
01980  E216  C9 0D              CMP #$D
01981  E218  D0 03              BNE NJT1






SCREEN EDITOR & I/O......PAGE 002E

LINE# LOC   CODE        LINE


01982  E21A  4C 59 E3           JMP NXT1
01983  E21D  C9 20       NJT1   CMP #' 
01984  E21F  90 08              BCC NTCN
01985  E221  29 3F              AND #$3F
01986  E223  20 67 E1           JSR QTSWC
01987  E226  4C 76 E1           JMP NXT3
01988  E229  A6 DC       NTCN   LDX INSRT
01989  E22B  F0 03              BEQ CNC3X
01990  E22D  4C 7A E1           JMP NC3
01991  E230  C9 14       CNC3X  CMP #$14
01992  E232  D0 1C              BNE NTCN1
01993  E234  88                 DEY
01994  E235  84 C6              STY PNTR
01995  E237  10 06              BPL BK1
01996  E239  20 DE E1           JSR BKLN
01997  E23C  4C 4A E2           JMP BK2
01998  E23F  C8          BK1    INY
01999  E240  B1 C4              LDA (PNT)Y
02000  E242  88                 DEY
02001  E243  91 C4              STA (PNT)Y
02002  E245  C8                 INY
02003  E246  C4 D5              CPY LNMX
02004  E248  D0 F5              BNE BK1
02005  E24A  A9 20       BK2    LDA #' 
02006  E24C  91 C4              STA (PNT)Y
02007  E24E  D0 3C              BNE JPL3
02008  E250  A6 CD       NTCN1  LDX QTSW
02009  E252  F0 03              BEQ NC3W
02010  E254  4C 7A E1    CNC3   JMP NC3
02011  E257  C9 12       NC3W   CMP #$12
02012  E259  D0 02              BNE NC1
02013  E25B  85 9F              STA RVS
02014  E25D  C9 13       NC1    CMP #$13
02015  E25F  D0 03              BNE NC2
02016  E261  20 79 E0           JSR NXTD
02017  E264  C9 1D       NC2    CMP #$1D
02018  E266  D0 12              BNE NCX2
02019  E268  C8                 INY
02020  E269  84 C6              STY PNTR
02021  E26B  88                 DEY
02022  E26C  C4 D5              CPY LNMX
02023  E26E  90 07              BCC NCZ2
02024  E270  20 43 E3           JSR NXLN
02025  E273  A0 00              LDY #0
02026  E275  84 C6       JPL4   STY PNTR
02027  E277  4C A6 E1    NCZ2   JMP LOOP2
02028  E27A  C9 11       NCX2   CMP #$11
02029  E27C  D0 0E              BNE JPL3
02030  E27E  18                 CLC
02031  E27F  98                 TYA
02032  E280  69 28              ADC #40
02033  E282  A8                 TAY
02034  E283  C5 D5              CMP LNMX
02035  E285  90 EE              BCC JPL4
02036  E287  F0 EC              BEQ JPL4






SCREEN EDITOR & I/O......PAGE 002F

LINE# LOC   CODE        LINE


02037  E289  20 43 E3           JSR NXLN
02038  E28C  4C A6 E1    JPL3   JMP LOOP2
02039  E28F  E8          PRT1   INX
02040  E290  85 D8              STA TBLX
02041  E292  98                 TYA
02042  E293  E9 28              SBC #40
02043  E295  85 C6              STA PNTR
02044  E297  E6 D8       PRT2   INC TBLX
02045  E299  AD 5B E6           LDA LDTB2
02046  E29C  85 C4              STA PNT
02047  E29E  A5 E0              LDA LDTB1
02048  E2A0  85 C5              STA POINT
02049  E2A2  D0 E8              BNE JPL3
02050  E2A4  29 7F       NXTX   AND #$7F
02051  E2A6  C9 7F              CMP #$7F
02052  E2A8  D0 02              BNE NXTX1
02053  E2AA  A9 5E              LDA #$5E
02054  E2AC  C9 20       NXTX1  CMP #' 
02055  E2AE  90 03              BCC *+5
02056  E2B0  4C 74 E1           JMP NXT33
02057  E2B3  C9 0D              CMP #$D
02058  E2B5  D0 03              BNE UP5
02059  E2B7  4C 59 E3           JMP NXT1
02060  E2BA  A6 CD       UP5    LDX  QTSW
02061  E2BC  D0 30              BNE UP6
02062  E2BE  C9 14              CMP #$14
02063  E2C0  D0 28              BNE UP9
02064  E2C2  A4 D5              LDY LNMX
02065  E2C4  B1 C4              LDA (PNT)Y
02066  E2C6  C9 20              CMP #' 
02067  E2C8  D0 04              BNE INS3
02068  E2CA  C4 C6              CPY PNTR
02069  E2CC  D0 07              BNE INS1
02070  E2CE  C0 4F       INS3   CPY #79
02071  E2D0  F0 BA              BEQ JPL3
02072  E2D2  20 E2 E3           JSR NEWLN
02073  E2D5  A4 D5       INS1   LDY LNMX
02074  E2D7  88          INS2   DEY
02075  E2D8  B1 C4              LDA (PNT)Y
02076  E2DA  C8                 INY
02077  E2DB  91 C4              STA (PNT)Y
02078  E2DD  88                 DEY
02079  E2DE  C4 C6              CPY PNTR
02080  E2E0  D0 F5              BNE INS2
02081  E2E2  A9 20              LDA #$20
02082  E2E4  91 C4              STA (PNT)Y
02083  E2E6  E6 DC              INC INSRT
02084  E2E8  D0 56              BNE JLP2
02085  E2EA  A6 DC       UP9    LDX INSRT
02086  E2EC  F0 05              BEQ UP2
02087  E2EE  09 40       UP6    ORA #$40
02088  E2F0  4C 7A E1           JMP NC3
02089  E2F3  C9 11       UP2    CMP #$11
02090  E2F5  D0 2B              BNE NXT2
02091  E2F7  A5 C6              LDA PNTR






SCREEN EDITOR & I/O......PAGE 0030

LINE# LOC   CODE        LINE


02092  E2F9  C9 28              CMP #40
02093  E2FB  90 06              BCC UP1
02094  E2FD  E9 28              SBC #40
02095  E2FF  85 C6              STA PNTR
02096  E301  B0 3D              BCS JLP2
02097  E303  A6 D8       UP1    LDX TBLX
02098  E305  F0 39              BEQ JLP2
02099  E307  B5 DF              LDA LDTB1-1,X
02100  E309  10 07              BPL UP3
02101  E30B  C6 D8              DEC TBLX
02102  E30D  20 7F E0           JSR STUPT
02103  E310  90 2E              BCC JLP2
02104  E312  CA          UP3    DEX
02105  E313  CA                 DEX
02106  E314  86 D8              STX TBLX
02107  E316  20 7F E0           JSR STUPT
02108  E319  A5 C6              LDA PNTR
02109  E31B  18                 CLC
02110  E31C  69 28              ADC #40
02111  E31E  85 C6              STA PNTR
02112  E320  D0 1E              BNE JLP2
02113  E322  C9 12       NXT2   CMP #$12
02114  E324  D0 04              BNE NXT6
02115  E326  A9 00              LDA #0
02116  E328  85 9F              STA RVS
02117  E32A  C9 1D       NXT6   CMP #$1D
02118  E32C  D0 0B              BNE NXT61
02119  E32E  88                 DEY
02120  E32F  84 C6              STY PNTR
02121  E331  10 0D              BPL JLP2
02122  E333  20 DE E1           JSR BKLN
02123  E336  4C A6 E1           JMP LOOP2
02124  E339  C9 13       NXT61  CMP #$13
02125  E33B  D0 03              BNE JLP2
02126  E33D  20 4B E0           JSR CLSR
02127  E340  4C A6 E1    JLP2   JMP LOOP2
02128  E343  38          NXLN   SEC
02129  E344  46 A3              LSR LSXP
02130  E346  A6 D8              LDX TBLX
02131  E348  E8          NXLN2  INX
02132  E349  E0 19              CPX #25
02133  E34B  D0 03              BNE NXLN1
02134  E34D  20 69 E3           JSR SCROL
02135  E350  B5 E0       NXLN1  LDA LDTB1,X
02136  E352  10 F4              BPL NXLN2
02137  E354  86 D8              STX TBLX
02138  E356  4C 7F E0           JMP STUPT
02139  E359  A9 00       NXT1   LDA #0
02140  E35B  85 DC              STA INSRT
02141  E35D  85 9F              STA RVS
02142  E35F  85 CD              STA QTSW
02143  E361  85 C6              STA PNTR
02144  E363  20 43 E3           JSR NXLN
02145  E366  4C A6 E1           JMP LOOP2
02146  E369              .FILE  OA2SRC






SCREEN EDITOR & I/O......PAGE 0031

LINE# LOC   CODE        LINE


02148  E369  A0 00       SCROL  LDY #0
02149  E36B  84 C4              STY POINT-1
02150  E36D  A9 80              LDA #$80
02151  E36F  85 C8              STA SAH
02152  E371  85 C5              STA POINT
02153  E373  A9 28              LDA #40
02154  E375  24 E1              BIT LDTB1+1
02155  E377  30 02              BMI SCRL1
02156  E379  A9 50              LDA #80
02157  E37B  85 C7       SCRL1  STA SAL
02158  E37D  A9 34              LDA #$34
02159  E37F  8D 11 E8           STA PIAL1
02160  E382  B1 C7       MLP1   LDA (SAL)Y
02161  E384  91 C4              STA (POINT-1)Y
02162  E386  C8                 INY
02163  E387  D0 F9              BNE MLP1
02164  E389  E6 C8              INC SAH
02165  E38B  E6 C5              INC POINT
02166  E38D  A9 84              LDA #$84
02167  E38F  C5 C8              CMP SAH
02168  E391  D0 EF              BNE MLP1
02169  E393  A9 E8              LDA #232
02170  E395  85 C4              STA PNT
02171  E397  C6 C5              DEC POINT
02172  E399  A9 20              LDA #' 
02173  E39B  C6 C4       MLP2   DEC PNT
02174  E39D  C6 C7              DEC SAL
02175  E39F  91 C4              STA (PNT)Y
02176  E3A1  D0 F8              BNE MLP2
02177  E3A3  A2 19              LDX #25
02178  E3A5  86 D8              STX TBLX
02179  E3A7  A2 00       SCRL4  LDX #0
02180  E3A9  C6 D8              DEC TBLX
02181  E3AB  B5 E0       SCRL5  LDA LDTB1,X
02182  E3AD  29 7F              AND #$7F
02183  E3AF  B4 E1              LDY LDTB1+1,X
02184  E3B1  10 02              BPL SCRL3
02185  E3B3  09 80              ORA #$80
02186  E3B5  95 E0       SCRL3  STA LDTB1,X
02187  E3B7  E8                 INX
02188  E3B8  E0 19              CPX #25
02189  E3BA  D0 EF              BNE SCRL5
02190  E3BC  A9 83              LDA #$83
02191  E3BE  85 F8              STA LDTB1+24
02192  E3C0  A5 E0              LDA LDTB1
02193  E3C2  10 E3              BPL SCRL4
02194  E3C4  A9 3C              LDA #$3C
02195  E3C6  8D 11 E8           STA PIAL1
02196  E3C9  A9 FE              LDA #$FE
02197  E3CB  CD 12 E8           CMP PIAK
02198  E3CE  D0 0F              BNE MLP42
02199  E3D0  A0 08              LDY #8
02200  E3D2  8D 45 E8    MLP4   STA TIH
02201  E3D5  2C 4D E8    MLP41  BIT IFR
02202  E3D8  50 FB              BVC MLP41






SCREEN EDITOR & I/O......PAGE 0032

LINE# LOC   CODE        LINE


02203  E3DA  88                 DEY
02204  E3DB  D0 F5              BNE MLP4
02205  E3DD  84 9E              STY NDX
02206  E3DF  A6 D8       MLP42  LDX TBLX
02207  E3E1  60                 RTS
02208  E3E2  A6 D8       NEWLN  LDX TBLX
02209  E3E4  E8                 INX
02210  E3E5  A9 34              LDA #$34
02211  E3E7  8D 11 E8           STA PIAL1
02212  E3EA  E0 18              CPX #24
02213  E3EC  F0 33              BEQ BLKLN
02214  E3EE  90 03              BCC NEWLX
02215  E3F0  4C C4 E1           JMP SCRL
02216  E3F3  A2 17       NEWLX  LDX #23
02217  E3F5  B5 E1       NEWL1  LDA LDTB1+1,X
02218  E3F7  09 80              ORA #$80
02219  E3F9  85 C8              STA SAH
02220  E3FB  B4 E0              LDY LDTB1,X
02221  E3FD  30 02              BMI NEWLA
02222  E3FF  29 7F              AND #$7F
02223  E401  95 E1       NEWLA  STA LDTB1+1,X
02224  E403  98                 TYA
02225  E404  09 80              ORA #$80
02226  E406  85 C5              STA POINT
02227  E408  A0 27              LDY #39
02228  E40A  BD 5C E6           LDA LDTB2+1,X
02229  E40D  85 C7              STA SAL
02230  E40F  BD 5B E6           LDA LDTB2,X
02231  E412  85 C4              STA PNT
02232  E414  B1 C4       NELL   LDA (PNT)Y
02233  E416  91 C7              STA (SAL)Y
02234  E418  88                 DEY
02235  E419  10 F9              BPL NELL
02236  E41B  CA                 DEX
02237  E41C  E4 D8              CPX TBLX
02238  E41E  D0 D5              BNE NEWL1
02239  E420  E8                 INX
02240  E421  B5 E0       BLKLN  LDA LDTB1,X
02241  E423  09 80              ORA #$80
02242  E425  85 C5              STA POINT
02243  E427  29 7F              AND #$7F
02244  E429  95 E0              STA LDTB1,X
02245  E42B  BD 5B E6           LDA LDTB2,X
02246  E42E  85 C4              STA PNT
02247  E430  A0 27              LDY #39
02248  E432  A9 20              LDA #' 
02249  E434  91 C4       BLKL   STA (PNT)Y
02250  E436  88                 DEY
02251  E437  10 FB              BPL BLKL
02252  E439  A9 3C              LDA #$3C
02253  E43B  8D 11 E8           STA PIAL1
02254  E43E  58                 CLI
02255  E43F  4C 7F E0           JMP STUPT
02256  E442  48          PULS   PHA
02257  E443  8A                 TXA






SCREEN EDITOR & I/O......PAGE 0033

LINE# LOC   CODE        LINE


02258  E444  48                 PHA
02259  E445  98                 TYA
02260  E446  48                 PHA
02261  E447  BA                 TSX
02262  E448  BD 04 01           LDA $104,X
02263  E44B  29 10              AND #$10
02264  E44D  F0 03              BEQ PULS1
02265  E44F  6C 92 00           JMP (CBINV)
02266  E452  6C 90 00    PULS1  JMP (CINV)
02267  E455  20 68 F7    KEY    JSR UDTIM
02268  E458  A5 A7              LDA BLNSW
02269  E45A  D0 18              BNE KEY4
02270  E45C  C6 A8              DEC BLNCT
02271  E45E  D0 14              BNE KEY4
02272  E460  A9 14              LDA #20
02273  E462  85 A8              STA BLNCT
02274  E464  A4 C6              LDY PNTR
02275  E466  46 AA              LSR BLNON
02276  E468  B1 C4              LDA (POINT-1)Y
02277  E46A  B0 04              BCS KEY5
02278  E46C  E6 AA              INC BLNON
02279  E46E  85 A9              STA GDBLN
02280  E470  49 80       KEY5   EOR #$80
02281  E472  91 C4              STA (POINT-1)Y
02282  E474  A2 FF       KEY4   LDX #$FF
02283  E476  86 A6              STX SFDX
02284  E478  E8                 INX
02285  E479  86 98              STX SFST
02286  E47B  A2 50              LDX #80
02287  E47D  AD 10 E8           LDA PIAL
02288  E480  29 F0              AND #$F0
02289  E482  8D 10 E8           STA PIAL
02290  E485  A0 00              LDY #0
02291  E487  AD 10 E8           LDA PIAL
02292  E48A  0A                 ASL A
02293  E48B  0A                 ASL A
02294  E48C  0A                 ASL A
02295  E48D  10 06              BPL KEY3
02296  E48F  84 F9              STY CAS1
02297  E491  A9 3D              LDA #$3D
02298  E493  D0 06              BNE KL24
02299  E495  A5 F9       KEY3   LDA CAS1
02300  E497  D0 05              BNE KL2
02301  E499  A9 35              LDA #$35
02302  E49B  8D 13 E8    KL24   STA PIAS
02303  E49E  90 09       KL2    BCC KL23
02304  E4A0  84 FA              STY CAS2
02305  E4A2  AD 40 E8           LDA PIA
02306  E4A5  09 10              ORA #$10
02307  E4A7  D0 09              BNE KL25
02308  E4A9  A5 FA       KL23   LDA CAS2
02309  E4AB  D0 08              BNE KL22
02310  E4AD  AD 40 E8           LDA PIA
02311  E4B0  29 EF              AND #$EF
02312  E4B2  8D 40 E8    KL25   STA PIA






SCREEN EDITOR & I/O......PAGE 0034

LINE# LOC   CODE        LINE


02313  E4B5  A0 08       KL22   LDY #8
02314  E4B7  AD 12 E8           LDA PIAK
02315  E4BA  CD 12 E8           CMP PIAK
02316  E4BD  D0 F6              BNE KL22
02317  E4BF  4A          KL1    LSR A
02318  E4C0  B0 1C              BCS CKIT
02319  E4C2  48                 PHA
02320  E4C3  BD 0A E6           LDA CHAR-1,X
02321  E4C6  D0 06              BNE CKIS1
02322  E4C8  A9 01              LDA #1
02323  E4CA  85 98              STA SFST
02324  E4CC  D0 0F              BNE CKUT
02325  E4CE  C9 FF       CKIS1  CMP #$FF
02326  E4D0  F0 0B              BEQ CKUT
02327  E4D2  C9 3C              CMP #$3C
02328  E4D4  D0 05              BNE SPCK
02329  E4D6  2C 11 E8           BIT PIAL1
02330  E4D9  30 02              BMI CKUT
02331  E4DB  86 A6       SPCK   STX SFDX
02332  E4DD  68          CKUT   PLA
02333  E4DE  CA          CKIT   DEX
02334  E4DF  F0 08              BEQ CKIT1
02335  E4E1  88                 DEY
02336  E4E2  D0 DB              BNE KL1
02337  E4E4  EE 10 E8           INC PIAL
02338  E4E7  D0 CC              BNE KL22
02339  E4E9  A5 A6       CKIT1  LDA SFDX
02340  E4EB  C5 97              CMP LSTX
02341  E4ED  F0 1C              BEQ PREND0
02342  E4EF  85 97              STA LSTX
02343  E4F1  AA                 TAX
02344  E4F2  30 17              BMI PREND0
02345  E4F4  BD 0A E6           LDA CHAR-1,X
02346  E4F7  46 98              LSR SFST
02347  E4F9  90 02              BCC KN1
02348  E4FB  09 80              ORA #$80
02349  E4FD  A6 9E       KN1    LDX NDX
02350  E4FF  9D 6F 02           STA KEYD,X
02351  E502  E8                 INX
02352  E503  E0 0A              CPX #10
02353  E505  D0 02              BNE KEYF
02354  E507  A2 00              LDX #0
02355  E509  86 9E       KEYF   STX NDX
02356  E50B  4C 00 E6    PREND0 JMP PREND
02357  E50E                     * =$6600+OFFSET ;SOFT OFFSET
02358  E600  68          PREND  PLA
02359  E601  A8                 TAY
02360  E602  68                 PLA
02361  E603  AA                 TAX
02362  E604  68                 PLA
02363  E605  40                 RTI
02364  E606  A4 C6       DSPP   LDY PNTR
02365  E608  91 C4              STA (POINT-1)Y
02366  E60A  60                 RTS
02367  E60B  3D          CHAR   .BYT $3D,$2E






SCREEN EDITOR & I/O......PAGE 0035

LINE# LOC   CODE        LINE


02367  E60C  2E 
02368  E60D  FF                 .BYT $FF,$3,$3C,$20,$5B,$12
02368  E60E  03 
02368  E60F  3C 
02368  E610  20 
02368  E611  5B 
02368  E612  12 
02369  E613  2D                 .BYT $2D,$30,0,$3E,$FF,$5D,$40,0
02369  E614  30 
02369  E615  00 
02369  E616  3E 
02369  E617  FF 
02369  E618  5D 
02369  E619  40 
02369  E61A  00 
02370  E61B  2B                 .BYT $2B,$32,$FF,$3F,$2C,$4E,$56,$58
02370  E61C  32 
02370  E61D  FF 
02370  E61E  3F 
02370  E61F  2C 
02370  E620  4E 
02370  E621  56 
02370  E622  58 
02371  E623  33                 .BYT $33,$31,$D,$3B,$4D,$42,$43,$5A
02371  E624  31 
02371  E625  0D 
02371  E626  3B 
02371  E627  4D 
02371  E628  42 
02371  E629  43 
02371  E62A  5A 
02372  E62B  2A                 .BYT $2A,$35,$FF,$3A,$4B,$48,$46,$53
02372  E62C  35 
02372  E62D  FF 
02372  E62E  3A 
02372  E62F  4B 
02372  E630  48 
02372  E631  46 
02372  E632  53 
02373  E633  36                 .BYT $36,$34,$FF,$4C,$4A,$47,$44,$41
02373  E634  34 
02373  E635  FF 
02373  E636  4C 
02373  E637  4A 
02373  E638  47 
02373  E639  44 
02373  E63A  41 
02374  E63B  2F                 .BYT $2F,$38,$FF,$50,$49,$59,$52,$57
02374  E63C  38 
02374  E63D  FF 
02374  E63E  50 
02374  E63F  49 
02374  E640  59 
02374  E641  52 
02374  E642  57 






SCREEN EDITOR & I/O......PAGE 0036

LINE# LOC   CODE        LINE


02375  E643  39                 .BYT $39,$37,$5E,$4F,$55,$54,$45,$51
02375  E644  37 
02375  E645  5E 
02375  E646  4F 
02375  E647  55 
02375  E648  54 
02375  E649  45 
02375  E64A  51 
02376  E64B  14                 .BYT $14,$11,$FF,$29,$5C,$27,$24,$22
02376  E64C  11 
02376  E64D  FF 
02376  E64E  29 
02376  E64F  5C 
02376  E650  27 
02376  E651  24 
02376  E652  22 
02377  E653  1D                 .BYT $1D,$13,$5F,$28,$26,$25,$23,$21
02377  E654  13 
02377  E655  5F 
02377  E656  28 
02377  E657  26 
02377  E658  25 
02377  E659  23 
02377  E65A  21 
02378  E65B  00          LDTB2  .BYT 0,40,80,120,160,200
02378  E65C  28 
02378  E65D  50 
02378  E65E  78 
02378  E65F  A0 
02378  E660  C8 
02379  E661  F0                 .BYT 240,280-256,320-256,360-256
02379  E662  18 
02379  E663  40 
02379  E664  68 
02380  E665  90                 .BYT 400-256,440-256,480-256
02380  E666  B8 
02380  E667  E0 
02381  E668  08                 .BYT 520-512,560-512
02381  E669  30 
02382  E66A  58                 .BYT 600-512,640-512,680-512
02382  E66B  80 
02382  E66C  A8 
02383  E66D  D0                 .BYT 720-512,760-512,800-768
02383  E66E  F8 
02383  E66F  20 
02384  E670  48                 .BYT 840-768,880-768,920-768,960-768
02384  E671  70 
02384  E672  98 
02384  E673  C0 
02385  E674  44          RUNTB  .BYT 'D',$CC,'"*',$D,'RUN',$D
02385  E675  CC 
02385  E676  22 2A 
02385  E678  0D 
02385  E679  52 55 4E 
02385  E67C  0D 






SCREEN EDITOR & I/O......PAGE 0037

LINE# LOC   CODE        LINE


02386  E67D              ;
02387  E67D  00          CKSUME .BYT 0          ;E-PAGE CHECKSUM
02388  E67E              ;
02389  E67E              .FILE  OB1SRC

























































MESSAGES & IEEE......PAGE 0038

LINE# LOC   CODE        LINE


02391  E67E                     *=$7000+OFFSET  ;SOFT OFFSET
02392  F000              MSG1
02393  F000  54 4F       MS1    .BYT 'TOO MANY FILE',$D3
02393  F00D  D3 
02394  F00E  46 49       MS2    .BYT 'FILE OPE',$CE
02394  F016  CE 
02395  F017  46 49       MS3    .BYT 'FILE NOT OPE',$CE
02395  F023  CE 
02396  F024  46 49       MS4    .BYT 'FILE NOT FOUN',$C4
02396  F031  C4 
02397  F032  0D          MS5    .BYT $D,'SEARCH'
02397  F033  53 45 
02398  F039  49 4E 47    MS20   .BYT 'ING',$A0
02398  F03C  A0 
02399  F03D  46 4F 52    MS6    .BYT 'FOR',$A0
02399  F040  A0 
02400  F041  0D          MS7    .BYT $D,'PRESS PLAY',$A0
02400  F042  50 52 
02400  F04C  A0 
02401  F04D  26 20       MS8    .BYT '& RECORD',$A0
02401  F055  A0 
02402  F056  4F 4E       MS9    .BYT 'ON TAPE ',$A3
02402  F05E  A3 
02403  F05F  0D          MS10   .BYT $D
02404  F060  4C 4F 41    MS22   .BYT 'LOA',$C4
02404  F063  C4 
02405  F064  0D          MS11   .BYT $D,'WRITING',$A0
02405  F065  57 52 
02405  F06C  A0 
02406  F06D  0D          MS21   .BYT $D
02407  F06E  56 45       MS12   .BYT 'VERIF',$D9
02407  F073  D9 
02408  F074  44 45       MS13   .BYT 'DEVICE NOT PRESEN',$D4
02408  F085  D4 
02409  F086  4E 4F       MS15   .BYT 'NOT INPUT FIL',$C5
02409  F093  C5 
02410  F094  4E 4F       MS16   .BYT 'NOT OUTPUT FIL',$C5
02410  F0A2  C5 
02411  F0A3  0D          MS17   .BYT $D,'FOUND',$A0
02411  F0A4  46 4F 
02411  F0A9  A0 
02412  F0AA  0D          MS18   .BYT $D,'OK',$8D
02412  F0AB  4F 4B 
02412  F0AD  8D 
02413  F0AE  0D          MS19   .BYT $D,'READY.',$8D
02413  F0AF  52 45 
02413  F0B5  8D 
02414  F0B6  0D          MSG30  .BYT $D,'ARE YOU SURE ',$BF
02414  F0B7  41 52 
02414  F0C4  BF 
02415  F0C5  0D          MSG31  .BYT $D,'? BAD DISK ',$8D
02415  F0C6  3F 20 
02415  F0D1  8D 
02416  F0D2  A9 40       TALK   LDA #$40
02417  F0D4  2C                 .BYT $2C        ;SKIP TWO BYTES






MESSAGES & IEEE......PAGE 0039

LINE# LOC   CODE        LINE


02418  F0D5  A9 20       LISTN  LDA #' 
02419  F0D7  48          LIST1  PHA
02420  F0D8  AD 40 E8           LDA PIA
02421  F0DB  09 02              ORA #2
02422  F0DD  8D 40 E8           STA PIA
02423  F0E0  A9 3C              LDA #$3C
02424  F0E2  8D 21 E8           STA IEEIS
02425  F0E5  24 A0              BIT C3P0
02426  F0E7  F0 11              BEQ LIST2
02427  F0E9  A9 34              LDA #$34
02428  F0EB  8D 11 E8           STA PIAL1
02429  F0EE  20 09 F1           JSR ISOUR
02430  F0F1  A9 00              LDA #0
02431  F0F3  85 A0              STA C3P0
02432  F0F5  A9 3C              LDA #$3C
02433  F0F7  8D 11 E8           STA PIAL1
02434  F0FA  68          LIST2  PLA
02435  F0FB  05 D4              ORA FA
02436  F0FD  85 A5              STA BSOUR
02437  F0FF  AD 40 E8    LIST4  LDA PIA
02438  F102  10 FB              BPL LIST4
02439  F104  29 FB              AND #$FB
02440  F106  8D 40 E8           STA PIA
02441  F109  A9 3C       ISOUR  LDA #$3C
02442  F10B  8D 23 E8           STA IEEOS
02443  F10E  AD 40 E8           LDA PIA
02444  F111  29 41              AND #$41
02445  F113  C9 41              CMP #$41
02446  F115  F0 55              BEQ ERRP7
02447  F117  A5 A5              LDA BSOUR
02448  F119  49 FF              EOR #$FF
02449  F11B  8D 22 E8           STA IEEO
02450  F11E  2C 40 E8    ISR1   BIT PIA
02451  F121  50 FB              BVC ISR1
02452  F123  A9 34              LDA #$34
02453  F125  8D 23 E8           STA IEEOS
02454  F128  A9 FF       ISR0   LDA #$FF
02455  F12A  8D 45 E8           STA TIH
02456  F12D  AD 40 E8    ISR2   LDA PIA
02457  F130  2C 4D E8           BIT IFR
02458  F133  70 1C              BVS ERRS3
02459  F135  4A                 LSR A
02460  F136  90 F5              BCC ISR2
02461  F138  A9 3C       ISR3   LDA #$3C
02462  F13A  8D 23 E8           STA IEEOS
02463  F13D  A9 FF              LDA #$FF
02464  F13F  8D 22 E8           STA IEEO
02465  F142  60                 RTS
02466  F143  85 A5       SECND  STA BSOUR
02467  F145  20 09 F1           JSR ISOUR
02468  F148  AD 40 E8    SCATN  LDA PIA
02469  F14B  09 04              ORA #4
02470  F14D  8D 40 E8           STA PIA
02471  F150  60                 RTS
02472  F151  AD FC 03    ERRS3  LDA BOB         ;CHECK TIMEOUT FLAG






MESSAGES & IEEE......PAGE 003A

LINE# LOC   CODE        LINE


02473  F154  10 0F              BPL ERRP0
02474  F156  20 43 F3           JSR STOP
02475  F159  D0 CD              BNE ISR0
02476  F15B  AD FC 03    ERRS4  LDA BOB
02477  F15E  10 10              BPL ERRP1
02478  F160  20 43 F3           JSR STOP
02479  F163  D0 68              BNE ACP00
02480  F165  A9 01       ERRP0  LDA #1
02481  F167  20 C4 FB    ERR01  JSR UDST
02482  F16A  D0 CC              BNE ISR3
02483  F16C  A9 80       ERRP7  LDA #$80
02484  F16E  30 F7              BMI ERR01
02485  F170  A9 02       ERRP1  LDA #2
02486  F172  20 C4 FB           JSR UDST
02487  F175  AD 40 E8    ER001  LDA PIA
02488  F178  29 FD              AND #$FD
02489  F17A  8D 40 E8           STA PIA
02490  F17D  A9 34              LDA #$34
02491  F17F  8D 21 E8           STA IEEIS
02492  F182  A9 0D              LDA #$0D
02493  F184  60                 RTS
02494  F185  B9 00 F0    MSG    LDA MS1,Y
02495  F188  08                 PHP
02496  F189  29 7F              AND #$7F
02497  F18B  20 02 E2           JSR PRT
02498  F18E  C8                 INY
02499  F18F  28                 PLP
02500  F190  10 F3              BPL MSG
02501  F192  60                 RTS
02502  F193  85 A5       TKSA   STA BSOUR
02503  F195  20 09 F1           JSR ISOUR
02504  F198  20 75 F1    TKATN  JSR ER001
02505  F19B  4C 48 F1           JMP SCATN
02506  F19E  24 A0       CIOUT  BIT C3P0
02507  F1A0  30 04              BMI CI2
02508  F1A2  C6 A0              DEC C3P0
02509  F1A4  D0 05              BNE CI4
02510  F1A6  48          CI2    PHA
02511  F1A7  20 09 F1           JSR ISOUR
02512  F1AA  68                 PLA
02513  F1AB  85 A5       CI4    STA BSOUR
02514  F1AD  60                 RTS
02515  F1AE  AD 40 E8    UNTLK  LDA PIA         ;PULL ATN FIRST
02516  F1B1  29 FB              AND #$FB
02517  F1B3  8D 40 E8           STA PIA
02518  F1B6  A9 5F              LDA #$5F
02519  F1B8  2C                 .BYT $2C        ;SKIP TWO BYTES
02520  F1B9  A9 3F       UNLSN  LDA #$3F
02521  F1BB  20 D7 F0           JSR LIST1
02522  F1BE  D0 88              BNE SCATN
02523  F1C0  A9 34       ACPTR  LDA #$34
02524  F1C2  8D 21 E8           STA IEEIS
02525  F1C5  AD 40 E8           LDA PIA
02526  F1C8  09 02              ORA #2
02527  F1CA  8D 40 E8           STA PIA






MESSAGES & IEEE......PAGE 003B

LINE# LOC   CODE        LINE


02528  F1CD  A9 FF       ACP00  LDA #$FF
02529  F1CF  8D 45 E8           STA TIH
02530  F1D2  2C 4D E8    ACP01  BIT IFR
02531  F1D5  70 84              BVS ERRS4
02532  F1D7  2C 40 E8           BIT PIA
02533  F1DA  30 F6              BMI ACP01
02534  F1DC  AD 40 E8           LDA PIA
02535  F1DF  29 FD              AND #$FD
02536  F1E1  8D 40 E8           STA PIA
02537  F1E4  2C 10 E8           BIT PIAL
02538  F1E7  70 05              BVS ACP03
02539  F1E9  A9 40              LDA #$40
02540  F1EB  20 C4 FB           JSR UDST
02541  F1EE  AD 20 E8    ACP03  LDA IEEI
02542  F1F1  49 FF              EOR #$FF
02543  F1F3  48                 PHA
02544  F1F4  A9 3C              LDA #$3C
02545  F1F6  8D 21 E8           STA IEEIS
02546  F1F9  2C 40 E8    ACP05  BIT PIA
02547  F1FC  10 FB              BPL ACP05
02548  F1FE  A9 34              LDA #$34
02549  F200  8D 21 E8           STA IEEIS
02550  F203  68                 PLA
02551  F204  60                 RTS
02552  F205  A9 00       GETIN  LDA #0
02553  F207  85 96              STA SATUS
02554  F209  A5 AF              LDA DFLTN
02555  F20B  D0 17              BNE BN10
02556  F20D  A5 9E              LDA NDX
02557  F20F  F0 51              BEQ BN32
02558  F211  78                 SEI
02559  F212  4C A7 E0           JMP LP2
02560  F215  A5 AF       BASIN  LDA DFLTN
02561  F217  D0 0B              BNE BN10 .
02562  F219  A5 C6              LDA PNTR
02563  F21B  85 A4              STA LSTP
02564  F21D  A5 D8              LDA TBLX
02565  F21F  85 A3              STA LSXP
02566  F221  4C 16 E1           JMP LOOP5
02567  F224  C9 03       BN10   CMP #3
02568  F226  D0 09              BNE BN20
02569  F228  85 AC              STA CRSW
02570  F22A  A5 D5              LDA LNMX
02571  F22C  85 A1              STA INDX
02572  F22E  4C 16 E1           JMP LOOP5
02573  F231  B0 29       BN20   BCS BN30
02574  F233  86 AD              STX XSAV
02575  F235  20 49 F2           JSR JTGET
02576  F238  48                 PHA
02577  F239  20 49 F2           JSR JTGET
02578  F23C  D0 05              BNE JTG35
02579  F23E  A9 40              LDA #64
02580  F240  20 C4 FB           JSR UDST
02581  F243  D6 BA       JTG35  DEC BUFPT-1,X
02582  F245  A6 AD              LDX XSAV






MESSAGES & IEEE......PAGE 003C

LINE# LOC   CODE        LINE


02583  F247  68                 PLA
02584  F248  60                 RTS
02585  F249  20 4B F8    JTGET  JSR JTP20
02586  F24C  D0 0B              BNE JTG10
02587  F24E  20 9A F8           JSR RBLK
02588  F251  A6 D4              LDX FA
02589  F253  A9 00              LDA #0
02590  F255  95 BA              STA BUFPT-1,X
02591  F257  F0 F0              BEQ JTGET
02592  F259  B1 D6       JTG10  LDA (TBUF)Y
02593  F25B  60                 RTS
02594  F25C  A5 96       BN30   LDA SATUS
02595  F25E  F0 03              BEQ BN35
02596  F260  A9 0D              LDA #$D
02597  F262  60          BN32   RTS
02598  F263  4C C0 F1    BN35   JMP ACPTR
02599  F266  48          BSOUT  PHA
02600  F267  A5 B0              LDA DFLTO
02601  F269  C9 03              CMP #3
02602  F26B  D0 04              BNE BO10
02603  F26D  68                 PLA
02604  F26E  4C 02 E2           JMP PRT
02605  F271  30 04       BO10   BMI BO20
02606  F273  68                 PLA
02607  F274  4C 9E F1           JMP CIOUT
02608  F277  68          BO20   PLA
02609  F278  85 B4       BO21   STA T1
02610  F27A  C9 0A              CMP #$A
02611  F27C  F0 E4              BEQ BN32
02612  F27E  48                 PHA
02613  F27F  8A                 TXA
02614  F280  48                 PHA
02615  F281  98                 TYA
02616  F282  48                 PHA
02617  F283  20 4B F8           JSR JTP20
02618  F286  D0 10              BNE JTP10
02619  F288  20 CB F8           JSR WBLK
02620  F28B  A6 D4              LDX FA
02621  F28D  A9 01              LDA #1
02622  F28F  95 BA              STA BUFPT-1,X
02623  F291  A0 00              LDY #0
02624  F293  A9 02              LDA #BDF
02625  F295  91 D6              STA (TBUF)Y
02626  F297  C8                 INY
02627  F298  A5 B4       JTP10  LDA T1
02628  F29A  91 D6              STA (TBUF)Y
02629  F29C  68          RSTOR  PLA
02630  F29D  A8                 TAY
02631  F29E  68                 PLA
02632  F29F  AA                 TAX
02633  F2A0  68                 PLA
02634  F2A1  60                 RTS
02635  F2A2  A9 00       CLALL  LDA #0
02636  F2A4  85 AE              STA LDTND
02637  F2A6              CLRCHN






MESSAGES & IEEE......PAGE 003D

LINE# LOC   CODE        LINE


02638  F2A6  A5 B0       CLRCH  LDA DFLTO
02639  F2A8  C9 04              CMP #4
02640  F2AA  90 03              BCC JX750
02641  F2AC  20 B9 F1           JSR UNLSN
02642  F2AF  A5 AF       JX750  LDA DFLTN
02643  F2B1  C9 04              CMP #4
02644  F2B3  90 03              BCC JX770
02645  F2B5  20 AE F1           JSR UNTLK
02646  F2B8  A9 03       JX770  LDA #3
02647  F2BA  85 B0              STA DFLTO
02648  F2BC  A9 00              LDA #0
02649  F2BE  85 AF              STA DFLTN
02650  F2C0  60                 RTS
02651  F2C1  A6 AE       JLTLK  LDX LDTND
02652  F2C3  CA          JX600  DEX
02653  F2C4  30 16              BMI JZ101
02654  F2C6  DD 51 02           CMP LAT,X
02655  F2C9  F0 11              BEQ JZ101
02656  F2CB  D0 F6              BNE JX600
02657  F2CD  BD 51 02    JZ100  LDA LAT,X
02658  F2D0  85 D2              STA LA
02659  F2D2  BD 5B 02           LDA FAT,X
02660  F2D5  85 D4              STA FA
02661  F2D7  BD 65 02           LDA SAT,X
02662  F2DA  85 D3              STA SA
02663  F2DC  60          JZ101  RTS
02664  F2DD              .FILE  OB2SRC


































CLOSE-LOAD-OPEN......PAGE 003E

LINE# LOC   CODE        LINE


02666  F2DD  20 0D F5    CLOSE  JSR PARS2
02667  F2E0  A5 D2              LDA LA
02668  F2E2              CLOS5                  ;DOUBLE LABEL
02669  F2E2  20 C1 F2    FCLOSE JSR JLTLK
02670  F2E5  D0 4D              BNE JX170
02671  F2E7  20 CD F2    CLOS10 JSR JZ100
02672  F2EA  8A                 TXA
02673  F2EB  48                 PHA
02674  F2EC  A5 D4              LDA FA
02675  F2EE  F0 28              BEQ JX150
02676  F2F0  C9 03              CMP #3
02677  F2F2  F0 24              BEQ JX150
02678  F2F4  B0 1F              BCS JX120
02679  F2F6  A5 D3              LDA SA          ;READ?
02680  F2F8  29 0F              AND #$F
02681  F2FA  F0 1C              BEQ JX150       ;YES
02682  F2FC  20 95 F6           JSR ZZZ         ;NO    .IT IS WRITE
02683  F2FF  A9 00              LDA #0
02684  F301  20 78 F2           JSR BO21
02685  F304  20 CB F8           JSR WBLK        ;EMPTY LAST BUFFER
02686  F307  A5 D3              LDA SA
02687  F309  C9 62              CMP #$62        ;WRITE END OF TAPE BLOCK
02688  F30B  D0 0B              BNE JX150
02689  F30D  A9 05              LDA #EOT        ;YES
02690  F30F  20 19 F6           JSR TAPEH
02691  F312  4C 18 F3           JMP JX150
02692  F315  20 2F F7    JX120  JSR CLSE1
02693  F318              ;
02694  F318              ;ENTRY TO REMOVE A GIVE LOGICAL FILE
02695  F318              ;FROM TABLE OF LOGICAL, PRIMARY,
02696  F318              ;AND SECONDARY ADDRESSES
02697  F318              ;
02698  F318  68          JX150  PLA
02699  F319  AA                 TAX
02700  F31A  C6 AE              DEC LDTND
02701  F31C  E4 AE              CPX LDTND
02702  F31E  F0 14              BEQ JX170
02703  F320  A4 AE              LDY LDTND
02704  F322  B9 51 02           LDA LAT,Y
02705  F325  9D 51 02           STA LAT,X
02706  F328  B9 5B 02           LDA FAT,Y
02707  F32B  9D 5B 02           STA FAT,X
02708  F32E  B9 65 02           LDA SAT,Y
02709  F331  9D 65 02           STA SAT,X
02710  F334  60          JX170  RTS
02711  F335  A5 9B       STOP1  LDA STKEY
02712  F337  C9 EF              CMP #$EF
02713  F339  D0 07              BNE STOP2
02714  F33B  08                 PHP
02715  F33C  20 A6 F2           JSR CLRCH
02716  F33F  85 9E              STA NDX
02717  F341  28                 PLP
02718  F342  60          STOP2  RTS
02719  F343  20 35 F3    STOP   JSR STOP1
02720  F346  4C C6 B7           JMP BSTOP






CLOSE-LOAD-OPEN......PAGE 003F

LINE# LOC   CODE        LINE


02721  F349  20 51 F3    SPMSG  JSR TXTST
02722  F34C  D0 F4              BNE STOP2
02723  F34E  4C 85 F1           JMP MSG
02724  F351  A5 78       TXTST  LDA TXTPTR+1
02725  F353  C9 02              CMP #2
02726  F355  60          TXTRT  RTS
02727  F356  A5 D4       LD15   LDA FA ***MONITOR ENTRY
02728  F358  D0 03              BNE *+5
02729  F35A  4C 00 BF    LD20   JMP SNERR
02730  F35D  C9 03              CMP #3
02731  F35F  F0 F9              BEQ LD20
02732  F361  90 71              BCC LD100
02733  F363  A9 60              LDA #$60
02734  F365  85 D3              STA SA
02735  F367  A4 D1              LDY FNLEN
02736  F369  D0 03              BNE *+5
02737  F36B  4C 00 BF           JMP SNERR
02738  F36E  20 49 F4           JSR LD300
02739  F371  20 A5 F4           JSR OPENI
02740  F374  20 D2 F0           JSR TALK
02741  F377  A5 D3              LDA SA
02742  F379  20 93 F1           JSR TKSA
02743  F37C  20 C0 F1           JSR ACPTR
02744  F37F  85 FB              STA STAL
02745  F381  A5 96              LDA SATUS       ;TEST STATUS FOR ERROR
02746  F383  4A                 LSR A
02747  F384  4A                 LSR A
02748  F385  B0 3A              BCS LD90
02749  F387  20 C0 F1           JSR ACPTR
02750  F38A  85 FC              STA STAH
02751  F38C  20 6D F4    LD30   JSR LD400

02753  F38F  A9 FD       LD40   LDA #$FD        ;MASK OFF TIMEOUT
02754  F391  25 96              AND SATUS
02755  F393  85 96              STA SATUS
02756  F395  20 43 F3           JSR STOP        ;EXIT ON STOP KEY
02757  F398  20 C0 F1           JSR ACPTR       ;GET BYTE OFF IEEE
02758  F39B  AA                 TAX
02759  F39C  A5 96              LDA SATUS       ;WAS THERE A TIMEOUT?
02760  F39E  4A                 LSR A
02761  F39F  4A                 LSR A
02762  F3A0  B0 ED              BCS LD40        ;YES... RETRY

02764  F3A2  8A                 TXA
02765  F3A3  A4 9D              LDY VERCK       ;PERFORMING VERIFY?
02766  F3A5  F0 0C              BEQ LD50        ;NO...A LOAD
02767  F3A7  88                 DEY             ;.Y IS A 1...MAKE IT 0
02768  F3A8  D1 FB              CMP (STAL)Y     ;COMPARE TO MEMORY
02769  F3AA  F0 09              BEQ LD60        ;VERIFIES O.K.
02770  F3AC  A9 10              LDA #SPERR      ;NO GOOD... VERIFY ERROR
02771  F3AE  05 96              ORA SATUS
02772  F3B0  85 96              STA SATUS
02773  F3B2  2C                 .BYT $2C        ;SKIP OVER MEMORY STORE
02774  F3B3  91 FB       LD50   STA (STAL)Y
02775  F3B5  E6 FB       LD60   INC STAL        ;INCREMENT POINTER






CLOSE-LOAD-OPEN......PAGE 0040

LINE# LOC   CODE        LINE


02776  F3B7  D0 02              BNE LD64
02777  F3B9  E6 FC              INC STAH
02778  F3BB  24 96       LD64   BIT SATUS       ;EOI ?
02779  F3BD  70 07              BVS LD65        ;YES... DONE
02780  F3BF  50 CE              BVC LD40        ;NO... CONTINUE LOAD

02782  F3C1  A0 24       LD90   LDY #MS4-MS1    ;FILE NOT FOUND ERROR
02783  F3C3  4C AF F5           JMP ERMSG
02784  F3C6  A5 FB       LD65   LDA STAL
02785  F3C8  85 C9              STA EAL
02786  F3CA  A5 FC              LDA STAH
02787  F3CC  85 CA              STA EAH
02788  F3CE  20 AE F1           JSR UNTLK
02789  F3D1  4C 2F F7           JMP CLSE1
02790  F3D4  20 95 F6    LD100  JSR ZZZ
02791  F3D7  20 57 F8           JSR CSTE1
02792  F3DA  20 49 F4           JSR LD300
02793  F3DD  A5 D1       LD112  LDA FNLEN
02794  F3DF  F0 08              BEQ LD150
02795  F3E1  20 D3 F4           JSR FAF
02796  F3E4  D0 08              BNE LD170
02797  F3E6  4C AD F5    LD120  JMP OP160
02798  F3E9  20 E5 F5    LD150  JSR FAH
02799  F3EC  F0 F8              BEQ LD120
02800  F3EE  E0 01       LD170  CPX #BLF
02801  F3F0  D0 EB              BNE LD112
02802  F3F2  A5 96              LDA SATUS
02803  F3F4  29 10              AND #SPERR
02804  F3F6  D0 74              BNE LD115
02805  F3F8  20 7B F6           JSR LDAD2
02806  F3FB  20 6D F4           JSR LD400
02807  F3FE  4C A3 F8           JMP TRD
02808  F401  A9 00       LOAD   LDA #0
02809  F403  85 9D              STA VERCK
02810  F405  20 7D F4    LD10   JSR PARS1 ***VERIFY ENTRY
02811  F408  20 CC F6    LOADNP JSR SV60
02812  F40B  A9 FF              LDA #$FF
02813  F40D  C5 9B       LD11   CMP STKEY
02814  F40F  D0 FC              BNE LD11
02815  F411  C5 9B              CMP STKEY
02816  F413  D0 F8              BNE LD11
02817  F415  20 56 F3           JSR LD15
02818  F418  A5 9D              LDA VERCK
02819  F41A  D0 50              BNE LD115
02820  F41C  20 2B F9           JSR TWAIT
02821  F41F  A5 96              LDA SATUS
02822  F421  29 10              AND #SPERR
02823  F423  F0 09              BEQ LD210
02824  F425  A0 00       LD209  LDY #0
02825  F427  84 9E              STY NDX
02826  F429  A0 60              LDY #MS22-MS1
02827  F42B  4C AF F5           JMP ERMSG
02828  F42E  A0 AE       LD210  LDY #MS19-MS1
02829  F430  20 49 F3           JSR SPMSG
02830  F433  20 51 F3           JSR TXTST






CLOSE-LOAD-OPEN......PAGE 0041

LINE# LOC   CODE        LINE


02831  F436  D0 0B              BNE LD205
02832  F438  A5 CA              LDA EAH
02833  F43A  85 2B              STA VARTAB+1
02834  F43C  A5 C9              LDA EAL
02835  F43E  85 2A              STA VARTAB
02836  F440  4C AD B4           JMP FINI
02837  F443  20 22 B6    LD205  JSR STXTPT
02838  F446  4C 0B B6           JMP FLOAD
02839  F449  20 51 F3    LD300  JSR TXTST
02840  F44C  D0 1E              BNE LD115
02841  F44E  A0 32              LDY #MS5-MS1
02842  F450  20 85 F1           JSR MSG
02843  F453  A5 D1              LDA FNLEN
02844  F455  F0 15              BEQ LD115
02845  F457  A0 3D              LDY #MS6-MS1
02846  F459  20 85 F1           JSR MSG
02847  F45C  A4 D1       LD105  LDY FNLEN
02848  F45E  F0 0C              BEQ LD115
02849  F460  A0 00              LDY #0
02850  F462  B1 DA       LD110  LDA (FNADR)Y
02851  F464  20 66 F2           JSR BSOUT
02852  F467  C8                 INY
02853  F468  C4 D1              CPY FNLEN
02854  F46A  D0 F6              BNE LD110
02855  F46C  60          LD115  RTS
02856  F46D  A0 5F       LD400  LDY #MS10-MS1
02857  F46F  A5 9D              LDA VERCK
02858  F471  F0 02              BEQ LD410
02859  F473  A0 6D              LDY #MS21-MS1
02860  F475  20 49 F3    LD410  JSR SPMSG
02861  F478  A0 39              LDY #MS20-MS1
02862  F47A  4C 49 F3           JMP SPMSG
02863  F47D              ;USES BASIC ROUTINES TO PARSE
02864  F47D              ;LOAD,SAVE,VERIFY STATEMENTS
02865  F47D              ;     LOAD
02866  F47D              ;          (FILE NAME OPTION)
02867  F47D              ;          (OPT DEVICE #) DFLT=1
02868  F47D              ;          (EOT CMD) DFLT=0=NO
02869  F47D  A2 00       PARS1  LDX #0
02870  F47F  86 96              STX SATUS
02871  F481  86 D1              STX FNLEN
02872  F483  86 D3              STX SA
02873  F485  E8                 INX
02874  F486  86 D4              STX FA
02875  F488  20 4D F5           JSR PR140
02876  F48B  20 3C F5           JSR PR200
02877  F48E  20 4D F5           JSR PR140
02878  F491  20 9F F4           JSR PR070
02879  F494  86 D4              STX FA
02880  F496  20 4D F5           JSR PR140
02881  F499  20 9F F4           JSR PR070
02882  F49C  86 D3              STX SA
02883  F49E  60          PR060  RTS
02884  F49F  20 55 F5    PR070  JSR PR150
02885  F4A2  4C D4 C8           JMP GETBYT






CLOSE-LOAD-OPEN......PAGE 0042

LINE# LOC   CODE        LINE


02886  F4A5  A5 D3       OPENI  LDA SA
02887  F4A7  30 F5              BMI PR060
02888  F4A9  A4 D1              LDY FNLEN
02889  F4AB  F0 F1              BEQ PR060
02890  F4AD  20 D5 F0           JSR LISTN
02891  F4B0  A5 D3              LDA SA
02892  F4B2  09 F0              ORA #$F0
02893  F4B4  20 43 F1    OPENIB JSR SECND
02894  F4B7  A5 96              LDA SATUS
02895  F4B9  10 05              BPL OP35
02896  F4BB  A0 74       OP37   LDY #MS13-MS1
02897  F4BD  4C AF F5           JMP ERMSG
02898  F4C0  A5 D1       OP35   LDA FNLEN
02899  F4C2  F0 0C              BEQ OP45
02900  F4C4  A0 00              LDY #0
02901  F4C6  B1 DA       OP40   LDA (FNADR)Y
02902  F4C8  20 9E F1           JSR CIOUT
02903  F4CB  C8                 INY
02904  F4CC  C4 D1              CPY FNLEN
02905  F4CE  D0 F6              BNE OP40
02906  F4D0  4C B9 F1    OP45   JMP UNLSN
02907  F4D3  20 E5 F5    FAF    JSR FAH
02908  F4D6  F0 1D              BEQ FAF40
02909  F4D8  A0 05              LDY #5
02910  F4DA  84 B5              STY T2
02911  F4DC  A0 00              LDY #0
02912  F4DE  84 B4              STY T1
02913  F4E0  C4 D1       FAF20  CPY FNLEN
02914  F4E2  F0 10              BEQ FAF30
02915  F4E4  B1 DA              LDA (FNADR)Y
02916  F4E6  A4 B5              LDY T2
02917  F4E8  D1 D6              CMP (TBUF)Y
02918  F4EA  D0 E7              BNE FAF
02919  F4EC  E6 B4              INC T1
02920  F4EE  E6 B5              INC T2
02921  F4F0  A4 B4              LDY T1
02922  F4F2  D0 EC              BNE FAF20
02923  F4F4  98          FAF30  TYA
02924  F4F5  60          FAF40  RTS
02925  F4F6  A9 01       VER    LDA #1
02926  F4F8  85 9D              STA VERCK
02927  F4FA  20 05 F4           JSR LD10
02928  F4FD  A5 96              LDA SATUS
02929  F4FF  29 10              AND #SPERR
02930  F501  F0 05              BEQ VER10
02931  F503  A0 6E              LDY #MS12-MS1
02932  F505  4C AF F5           JMP ERMSG
02933  F508  A0 AA       VER10  LDY #MS18-MS1
02934  F50A  4C 85 F1           JMP MSG
02935  F50D              ;USES BASIC ROUTINES TO PARSE
02936  F50D              ;OPEN,CLOSE
02937  F50D              ;     OPEN LFN (NO DEFAULT)
02938  F50D              ;          DEV # (DFLT=1)
02939  F50D              ;         2ND ADR (DFLT=0 OR NONE)
02940  F50D              ;          FILE NM STRNG (DEF=NUL)






CLOSE-LOAD-OPEN......PAGE 0043

LINE# LOC   CODE        LINE


02941  F50D  A2 00       PARS2  LDX #0
02942  F50F  86 D3              STX SA
02943  F511  86 96              STX SATUS
02944  F513  86 D1              STX FNLEN
02945  F515  E8                 INX
02946  F516  86 D4              STX FA
02947  F518  20 58 F5           JSR PR130
02948  F51B  20 D4 C8           JSR GETBYT
02949  F51E  86 D2              STX LA
02950  F520  20 4D F5           JSR PR140
02951  F523  20 9F F4           JSR PR070
02952  F526  86 D4              STX FA
02953  F528  E0 03              CPX #3
02954  F52A  90 02              BCC PR100
02955  F52C  C6 D3              DEC SA
02956  F52E  20 4D F5    PR100  JSR PR140
02957  F531  20 9F F4           JSR PR070
02958  F534  86 D3              STX SA
02959  F536  20 4D F5    PR111  JSR PR140
02960  F539  20 55 F5           JSR PR150
02961  F53C  20 98 BD    PR200  JSR FRMEVL
02962  F53F  20 B5 C7           JSR FRESTR
02963  F542  85 D1              STA FNLEN
02964  F544  A5 1F              LDA INDEX1
02965  F546  85 DA              STA FNADR
02966  F548  A5 20              LDA INDEX1+1
02967  F54A  85 DB              STA FNADR+1
02968  F54C  60                 RTS
02969  F54D  20 76 00    PR140  JSR CHRGOT
02970  F550  D0 02              BNE PR147
02971  F552  68                 PLA
02972  F553  68                 PLA
02973  F554  60          PR147  RTS
02974  F555  20 F5 BE    PR150  JSR CHKCOM
02975  F558  20 76 00    PR130  JSR CHRGOT
02976  F55B  D0 F7              BNE PR147
02977  F55D  4C 00 BF    PR135  JMP SNERR
02978  F560  20 0D F5    OPEN   JSR PARS2
02979  F563  A5 D2       OP94   LDA LA
02980  F565  F0 F6       FOPEN  BEQ PR135
02981  F567  A0 0E       OP98   LDY #MS2-MS1
02982  F569  20 C1 F2           JSR JLTLK
02983  F56C  F0 41              BEQ ERMSG
02984  F56E  A6 AE       OP100  LDX LDTND
02985  F570  A0 00              LDY #0
02986  F572  84 96              STY SATUS
02987  F574  E0 0A              CPX #10
02988  F576  F0 37              BEQ ERMSG
02989  F578  E6 AE              INC LDTND
02990  F57A              ;STORE GPEN FILE PARMS INTO TABLE
02991  F57A  A5 D2              LDA LA
02992  F57C  9D 51 02           STA LAT,X
02993  F57F  A5 D3              LDA SA
02994  F581  09 60              ORA #$60
02995  F583  85 D3              STA SA






CLOSE-LOAD-OPEN......PAGE 0044

LINE# LOC   CODE        LINE


02996  F585  9D 65 02           STA SAT,X
02997  F588  A5 D4              LDA FA
02998  F58A  9D 5B 02           STA FAT,X
02999  F58D  F0 55              BEQ OP175
03000  F58F  C9 03              CMP #3
03001  F591  F0 51              BEQ OP175
03002  F593  90 03              BCC OP150
03003  F595  4C A5 F4           JMP OPENI
03004  F598  A5 D3       OP150  LDA SA
03005  F59A  29 0F              AND #$F
03006  F59C  D0 2B              BNE OP200
03007  F59E  20 57 F8           JSR CSTE1
03008  F5A1  20 49 F4           JSR LD300
03009  F5A4  A5 D1              LDA FNLEN
03010  F5A6  F0 1A              BEQ OP170
03011  F5A8  20 D3 F4           JSR FAF
03012  F5AB  D0 24              BNE OP171
03013  F5AD  A0 24       OP160  LDY #MS4-MS1
03014  F5AF  20 A2 F2    ERMSG  JSR CLALL
03015  F5B2  A9 0D              LDA #$D
03016  F5B4  20 66 F2           JSR BSOUT
03017  F5B7  A9 3F              LDA #$3F
03018  F5B9  20 66 F2           JSR BSOUT
03019  F5BC  20 85 F1           JSR MSG
03020  F5BF  4C ED B3           JMP TYPERR
03021  F5C2  20 E5 F5    OP170  JSR FAH
03022  F5C5  F0 E6              BEQ OP160
03023  F5C7  D0 08              BNE OP171
03024  F5C9  20 8C F8    OP200  JSR CSTE2
03025  F5CC  A9 04              LDA #BDFH
03026  F5CE  20 19 F6           JSR TAPEH
03027  F5D1  A6 D4       OP171  LDX FA
03028  F5D3  A9 BF              LDA #BUFSZ-1
03029  F5D5  A4 D3              LDY SA
03030  F5D7  C0 60              CPY #$60        ;OPEN FOR READ?
03031  F5D9  F0 07              BEQ OP172
03032  F5DB  A0 00              LDY #0
03033  F5DD  A9 02              LDA #BDF
03034  F5DF  91 D6              STA (TBUF)Y
03035  F5E1  98                 TYA
03036  F5E2  95 BA       OP172  STA BUFPT-1,X
03037  F5E4  60          OP175  RTS
03038  F5E5              .FILE  OB3SRC


















SAVE-SYS-TIME......PAGE 0045

LINE# LOC   CODE        LINE


03040  F5E5  A5 9D       FAH    LDA VERCK
03041  F5E7  48                 PHA
03042  F5E8  20 9A F8    FAH30  JSR RBLK
03043  F5EB  A0 00              LDY #0
03044  F5ED  B1 D6              LDA (TBUF)Y
03045  F5EF  C9 05              CMP #EOT
03046  F5F1  F0 21              BEQ FAH40
03047  F5F3  C9 01              CMP #BLF
03048  F5F5  F0 04              BEQ FAH50
03049  F5F7  C9 04              CMP #BDFH
03050  F5F9  D0 ED              BNE FAH30
03051  F5FB  AA          FAH50  TAX
03052  F5FC  20 51 F3           JSR TXTST
03053  F5FF  D0 11              BNE FAH45
03054  F601  A0 A3              LDY #MS17-MS1
03055  F603  20 85 F1           JSR MSG
03056  F606  A0 05              LDY #5
03057  F608  B1 D6       FAH55  LDA (TBUF)Y
03058  F60A  20 D2 FF           JSR $FFD2
03059  F60D  C8                 INY
03060  F60E  C0 15              CPY #21
03061  F610  D0 F6              BNE FAH55
03062  F612  A0 01       FAH45  LDY #1
03063  F614  68          FAH40  PLA
03064  F615  85 9D              STA VERCK
03065  F617  98                 TYA
03066  F618  60                 RTS
03067  F619  85 B4       TAPEH  STA T1
03068  F61B  20 95 F6           JSR ZZZ
03069  F61E  A5 FC              LDA STAH
03070  F620  48                 PHA
03071  F621  A5 FB              LDA STAL
03072  F623  48                 PHA
03073  F624  A5 CA              LDA EAH
03074  F626  48                 PHA
03075  F627  A5 C9              LDA EAL
03076  F629  48                 PHA
03077  F62A  A0 BF              LDY #BUFSZ-1
03078  F62C  A9 20              LDA #' 
03079  F62E  91 D6       BLNK2  STA (TBUF)Y
03080  F630  88                 DEY
03081  F631  D0 FB              BNE BLNK2
03082  F633  A5 B4              LDA T1
03083  F635  91 D6              STA (TBUF)Y
03084  F637  C8                 INY
03085  F638  A5 FB              LDA STAL
03086  F63A  91 D6              STA (TBUF)Y
03087  F63C  C8                 INY
03088  F63D  A5 FC              LDA STAH
03089  F63F  91 D6              STA (TBUF)Y
03090  F641  C8                 INY
03091  F642  A5 C9              LDA EAL
03092  F644  91 D6              STA (TBUF)Y
03093  F646  C8                 INY
03094  F647  A5 CA              LDA EAH






SAVE-SYS-TIME......PAGE 0046

LINE# LOC   CODE        LINE


03095  F649  91 D6              STA (TBUF)Y
03096  F64B  C8                 INY
03097  F64C  84 B5              STY T2
03098  F64E  A0 00              LDY #0
03099  F650  84 B4              STY T1
03100  F652  A4 B4       TH20   LDY T1
03101  F654  C4 D1              CPY FNLEN
03102  F656  F0 0C              BEQ TH30
03103  F658  B1 DA              LDA (FNADR)Y
03104  F65A  A4 B5              LDY T2
03105  F65C  91 D6              STA (TBUF)Y
03106  F65E  E6 B4              INC T1
03107  F660  E6 B5              INC T2
03108  F662  D0 EE              BNE TH20
03109  F664  20 AB F6    TH30   JSR LDAD1
03110  F667  A9 69              LDA #$69
03111  F669  85 C3              STA SHCNH
03112  F66B  20 D5 F8           JSR TWRT2
03113  F66E  68                 PLA
03114  F66F  85 C9              STA EAL
03115  F671  68                 PLA
03116  F672  85 CA              STA EAH
03117  F674  68                 PLA
03118  F675  85 FB              STA STAL
03119  F677  68                 PLA
03120  F678  85 FC              STA STAH
03121  F67A  60                 RTS
03122  F67B  20 2B F9    LDAD2  JSR TWAIT
03123  F67E  A2 00              LDX #0
03124  F680  A0 01              LDY #1
03125  F682  B1 D6       LDAD3  LDA (TBUF)Y
03126  F684  95 C7              STA SAL,X
03127  F686  E8                 INX
03128  F687  C8                 INY
03129  F688  E0 04              CPX #4
03130  F68A  D0 F6              BNE LDAD3
03131  F68C  A5 C7              LDA SAL
03132  F68E  85 FB              STA STAL
03133  F690  A5 C8              LDA SAH
03134  F692  85 FC              STA STAH
03135  F694  60                 RTS
03136  F695  A9 7A       ZZZ    LDA #<TAPE1
03137  F697  85 D6              STA TBUF
03138  F699  A9 02              LDA #>TAPE1
03139  F69B  85 D7              STA TBUF+1
03140  F69D  A5 D4              LDA FA
03141  F69F  4A                 LSR A
03142  F6A0  B0 08              BCS ZZ10
03143  F6A2  A9 3A              LDA #<TAPE2
03144  F6A4  85 D6              STA TBUF
03145  F6A6  A9 03              LDA #>TAPE2
03146  F6A8  85 D7              STA TBUF+1
03147  F6AA  60          ZZ10   RTS
03148  F6AB  20 2B F9    LDAD1  JSR TWAIT
03149  F6AE  20 95 F6           JSR ZZZ






SAVE-SYS-TIME......PAGE 0047

LINE# LOC   CODE        LINE


03150  F6B1  A5 D6              LDA TBUF
03151  F6B3  85 FB              STA STAL
03152  F6B5  18                 CLC
03153  F6B6  69 C0              ADC #BUFSZ
03154  F6B8  85 C9              STA EAL
03155  F6BA  A5 D7              LDA TBUF+1
03156  F6BC  85 FC              STA STAH
03157  F6BE  69 00              ADC #0
03158  F6C0  85 CA              STA EAH
03159  F6C2  60                 RTS
03160  F6C3  20 84 BD    SYS    JSR FRMNUM
03161  F6C6  20 2D C9           JSR GETADR
03162  F6C9  6C 11 00           JMP (LINNUM)
03163  F6CC  A5 2A       SV60   LDA VARTAB
03164  F6CE  85 C9              STA EAL
03165  F6D0  A5 2B              LDA VARTAB+1
03166  F6D2  85 CA              STA EAH
03167  F6D4  A5 29              LDA TXTTAB+1
03168  F6D6  85 FC              STA STAH
03169  F6D8  A5 28              LDA TXTTAB
03170  F6DA  85 FB              STA STAL
03171  F6DC  60                 RTS
03172  F6DD  20 7D F4    SAVE   JSR PARS1
03173  F6E0  20 CC F6    SV3    JSR SV60
03174  F6E3  A5 D4       SV5    LDA FA ***MONITOR ENTRY
03175  F6E5  D0 05              BNE SV20
03176  F6E7  A0 74       SV10   LDY #MS13-MS1
03177  F6E9  4C AF F5           JMP ERMSG
03178  F6EC  C9 03       SV20   CMP #3
03179  F6EE  F0 F7              BEQ SV10
03180  F6F0  90 50              BCC SV100
03181  F6F2  A9 61              LDA #$61
03182  F6F4  85 D3              STA SA
03183  F6F6  A4 D1              LDY FNLEN
03184  F6F8  D0 03              BNE *+5
03185  F6FA  4C 00 BF           JMP SNERR
03186  F6FD  20 A5 F4           JSR OPENI
03187  F700  20 D5 F0           JSR LISTN
03188  F703  A5 D3              LDA SA
03189  F705  20 43 F1           JSR SECND
03190  F708  A0 00              LDY #0
03191  F70A  20 BB FB           JSR RD300
03192  F70D  A5 C7              LDA SAL
03193  F70F  20 9E F1           JSR CIOUT
03194  F712  A5 C8              LDA SAH
03195  F714  20 9E F1           JSR CIOUT
03196  F717  20 0B FD    SV30   JSR WRT62
03197  F71A  F0 10              BEQ SV50
03198  F71C  B1 C7              LDA (SAL)Y
03199  F71E  20 9E F1           JSR CIOUT
03200  F721  20 43 F3           JSR STOP
03201  F724  E6 C7              INC SAL
03202  F726  D0 EF              BNE SV30
03203  F728  E6 C8              INC SAH
03204  F72A  D0 EB              BNE SV30






SAVE-SYS-TIME......PAGE 0048

LINE# LOC   CODE        LINE


03205  F72C  20 B9 F1    SV50   JSR UNLSN
03206  F72F  24 D3       CLSE1  BIT SA
03207  F731  30 78              BMI UD65
03208  F733  20 D5 F0           JSR LISTN
03209  F736  A5 D3              LDA SA
03210  F738  29 EF              AND #$EF
03211  F73A  09 E0              ORA #$E0
03212  F73C  20 43 F1           JSR SECND
03213  F73F  4C B9 F1           JMP UNLSN
03214  F742  20 95 F6    SV100  JSR ZZZ
03215  F745  20 8C F8           JSR CSTE2
03216  F748  20 51 F3           JSR TXTST
03217  F74B  D0 08              BNE SV105
03218  F74D  A0 64              LDY #MS11-MS1
03219  F74F  20 85 F1           JSR MSG
03220  F752  20 5C F4           JSR LD105
03221  F755  A9 01       SV105  LDA #BLF
03222  F757  20 19 F6           JSR TAPEH
03223  F75A  20 CE F8           JSR TWRT
03224  F75D  A5 D3              LDA SA
03225  F75F  29 02              AND #2
03226  F761  F0 48              BEQ UD65
03227  F763  A9 05              LDA #EOT
03228  F765  4C 19 F6           JMP TAPEH
03229  F768  E6 99       UDTIM  INC CRFAC
03230  F76A  A5 99              LDA CRFAC
03231  F76C  D0 02              BNE UD10
03232  F76E  E6 9A              INC CRFAC+1
03233  F770  C9 6F       UD10   CMP #$6F
03234  F772  D0 06              BNE UD20
03235  F774  A5 9A              LDA CRFAC+1
03236  F776  C9 02              CMP #2
03237  F778  F0 21              BEQ UD50
03238  F77A  E6 8F       UD20   INC TIME+2
03239  F77C  D0 06              BNE UD30
03240  F77E  E6 8E              INC TIME+1
03241  F780  D0 02              BNE UD30
03242  F782  E6 8D              INC TIME
03243  F784  A2 00       UD30   LDX #0
03244  F786  B5 8D       UD40   LDA TIME,X
03245  F788  DD AC F7           CMP UD70,X
03246  F78B  90 14              BCC UD60
03247  F78D  E8                 INX
03248  F78E  E0 03              CPX #3
03249  F790  D0 F4              BNE UD40
03250  F792  A9 00              LDA #0
03251  F794  95 8C       UD45   STA TIME-1,X
03252  F796  CA                 DEX
03253  F797  D0 FB              BNE UD45
03254  F799  F0 06              BEQ UD60
03255  F79B  A9 00       UD50   LDA #0
03256  F79D  85 99              STA CRFAC
03257  F79F  85 9A              STA CRFAC+1
03258  F7A1  AD 12 E8    UD60   LDA PIAK
03259  F7A4  CD 12 E8           CMP PIAK






SAVE-SYS-TIME......PAGE 0049

LINE# LOC   CODE        LINE


03260  F7A7  D0 F8              BNE UD60
03261  F7A9  85 9B              STA STKEY
03262  F7AB  60          UD65   RTS
03263  F7AC  4F          UD70   .BYT $4F,$1A,1
03263  F7AD  1A 
03263  F7AE  01 
03264  F7AF              .FILE  OB4SRC






















































O/C CHAN,R/W TAPE......PAGE 004A

LINE# LOC   CODE        LINE


03266  F7AF  48          CHKIN  PHA
03267  F7B0  8A                 TXA
03268  F7B1  48                 PHA
03269  F7B2  98                 TYA
03270  F7B3  48                 PHA
03271  F7B4  A9 00              LDA #0
03272  F7B6  85 96              STA SATUS
03273  F7B8  8A                 TXA
03274  F7B9  20 C1 F2           JSR JLTLK
03275  F7BC  F0 05              BEQ JX310
03276  F7BE  A0 17       JX300  LDY #MS3-MS1
03277  F7C0  4C AF F5    JX305  JMP ERMSG
03278  F7C3  20 CD F2    JX310  JSR JZ100
03279  F7C6  A5 D4              LDA FA
03280  F7C8  F0 10              BEQ JX320
03281  F7CA  C9 03              CMP #3
03282  F7CC  F0 0C              BEQ JX320
03283  F7CE  B0 0F              BCS JX330
03284  F7D0  A6 D3              LDX SA
03285  F7D2  E0 60              CPX #$60
03286  F7D4  F0 04              BEQ JX320
03287  F7D6  A0 86              LDY #MS15-MS1
03288  F7D8  D0 E6              BNE JX305
03289  F7DA  85 AF       JX320  STA DFLTN
03290  F7DC  4C 9C F2           JMP RSTOR
03291  F7DF  48          JX330  PHA
03292  F7E0  20 E1 DB           JSR OLDCLR      ;KILL DS$
03293  F7E3  20 D2 F0    JX3301 JSR TALK
03294  F7E6  A5 D3              LDA SA
03295  F7E8  10 06              BPL JX340
03296  F7EA  20 98 F1           JSR TKATN
03297  F7ED  4C F3 F7           JMP JX350
03298  F7F0  20 93 F1    JX340  JSR TKSA
03299  F7F3  A5 96       JX350  LDA SATUS
03300  F7F5  10 03              BPL *+5
03301  F7F7  4C BB F4           JMP OP37
03302  F7FA  68                 PLA
03303  F7FB  4C DA F7           JMP JX320
03304  F7FE              CHKOUT
03305  F7FE  48          CKOUT  PHA
03306  F7FF  8A                 TXA
03307  F800  48                 PHA
03308  F801  98                 TYA
03309  F802  48                 PHA
03310  F803  A9 00              LDA #0
03311  F805  85 96              STA SATUS
03312  F807  8A                 TXA
03313  F808  20 C1 F2           JSR JLTLK
03314  F80B  D0 B1              BNE JX300
03315  F80D  20 CD F2           JSR JZ100
03316  F810  A5 D4              LDA FA
03317  F812  D0 04              BNE CK10
03318  F814  A0 94              LDY #MS16-MS1
03319  F816  D0 A8              BNE JX305
03320  F818  C9 03       CK10   CMP #3






O/C CHAN,R/W TAPE......PAGE 004B

LINE# LOC   CODE        LINE


03321  F81A  F0 0C              BEQ JX360
03322  F81C  B0 0F              BCS JX370
03323  F81E  A6 D3              LDX SA
03324  F820  E0 60              CPX #$60
03325  F822  D0 04              BNE JX360
03326  F824  A0 94              LDY #MS16-MS1
03327  F826  D0 98              BNE JX305
03328  F828  85 B0       JX360  STA DFLTO
03329  F82A  4C 9C F2           JMP RSTOR
03330  F82D  48          JX370  PHA
03331  F82E  20 E1 DB           JSR OLDCLR      ;KILL DS$
03332  F831  20 D5 F0    JX3701 JSR LISTN
03333  F834  A5 D3              LDA SA
03334  F836  10 05              BPL JX380
03335  F838  20 48 F1           JSR SCATN
03336  F83B  D0 03              BNE JX390
03337  F83D  20 43 F1    JX380  JSR SECND
03338  F840  A5 96       JX390  LDA SATUS
03339  F842  10 03              BPL *+5
03340  F844  4C BB F4           JMP OP37
03341  F847  68                 PLA
03342  F848  4C 28 F8           JMP JX360
03343  F84B  20 95 F6    JTP20  JSR ZZZ
03344  F84E  A6 D4              LDX FA
03345  F850  F6 BA              INC BUFPT-1,X
03346  F852  B4 BA              LDY BUFPT-1,X
03347  F854  C0 C0              CPY #BUFSZ
03348  F856  60                 RTS
03349  F857              ;STAYS IN ROUTINE TILL PLAY SWITCH
03350  F857  20 7A F8    CSTE1  JSR CS10
03351  F85A  F0 2F              BEQ CS25
03352  F85C  A0 41              LDY #MS7-MS1    ;"PRESS PLAY"
03353  F85E  20 85 F1    CS30   JSR MSG
03354  F861  A0 56              LDY #MS9-MS1    ;"ON CASSETTE #"
03355  F863  20 85 F1           JSR MSG
03356  F866  A5 D4              LDA FA
03357  F868  09 30              ORA #'0
03358  F86A  20 02 E2           JSR PRT         ;PRINT CASSETTE #
03359  F86D  20 35 F9    CS40   JSR TSTOP       ;WATCH FOR STOP KEY
03360  F870  20 7A F8           JSR CS10        ;WATCH CASSETTE SWITCHES
03361  F873  D0 F8              BNE CS40
03362  F875  A0 AA              LDY #MS18-MS1   ;"OK"
03363  F877  4C 85 F1           JMP MSG
03364  F87A              ;SUBR RETURNS <> FOR CASSETTE SWITCH
03365  F87A  A9 10       CS10   LDA #$10        ;ASSUME CASSETTE #1
03366  F87C  A6 D4              LDX FA
03367  F87E  CA                 DEX             ;REALLY CASSETTE 1
03368  F87F  F0 02              BEQ CS20        ;YES.   .
03369  F881  A9 20              LDA #$20        ;NO. . .CASSETTE #2
03370  F883  2C 10 E8    CS20   BIT PIAL        ;CLOSED
03371  F886  D0 03              BNE CS25        ;NO. . .
03372  F888  2C 10 E8           BIT PIAL        ;CHECK AGAIN TO DEBOUNCE
03373  F88B  60          CS25   RTS
03374  F88C              ;CHECKS FOR PLAY & RECORD
03375  F88C  20 7A F8    CSTE2  JSR CS10






O/C CHAN,R/W TAPE......PAGE 004C

LINE# LOC   CODE        LINE


03376  F88F  F0 FA              BEQ CS25
03377  F891  A0 41              LDY #MS7-MS1    ;"PRESS PLAY AND"
03378  F893  20 85 F1           JSR MSG
03379  F896  A0 4D              LDY #MS8-MS1    ;"RECORD"
03380  F898  D0 C4              BNE CS30
03381  F89A  A9 00       RBLK   LDA #0
03382  F89C  85 96              STA SATUS
03383  F89E  85 9D              STA VERCK
03384  F8A0  20 AB F6           JSR LDAD1
03385  F8A3  20 2B F9    TRD    JSR TWAIT
03386  F8A6  20 57 F8           JSR CSTE1
03387  F8A9  78                 SEI
03388  F8AA  A9 00              LDA #0
03389  F8AC  85 C2              STA RDFLG
03390  F8AE  85 CE              STA SNSW1
03391  F8B0  85 CB              STA CMP0
03392  F8B2  85 C0              STA PTR1
03393  F8B4  85 C1              STA PTR2
03394  F8B6  85 B2              STA DPSW
03395  F8B8  A6 D4              LDX FA
03396  F8BA  CA                 DEX
03397  F8BB  F0 07              BEQ TRD2
03398  F8BD  A9 90              LDA #$90
03399  F8BF  8D 4E E8           STA IER
03400  F8C2  D0 03              BNE TRD3
03401  F8C4  EE 11 E8    TRD2   INC PIAL1
03402  F8C7  A2 0E       TRD3   LDX #14
03403  F8C9  D0 15              BNE TAPE
03404  F8CB  20 AB F6    WBLK   JSR LDAD1
03405  F8CE  20 2B F9    TWRT   JSR TWAIT
03406  F8D1  A9 14              LDA #20
03407  F8D3  85 C3              STA SHCNH
03408  F8D5  20 8C F8    TWRT2  JSR CSTE2
03409  F8D8  78                 SEI
03410  F8D9  A9 A0              LDA #$A0
03411  F8DB  8D 4E E8           STA IER
03412  F8DE  A2 08              LDX #8
03413  F8E0  20 E0 FC    TAPE   JSR BSIV
03414  F8E3  A9 02              LDA #2
03415  F8E5  85 DE              STA FSBLK
03416  F8E7  20 C9 FB           JSR NEWCH
03417  F8EA  CE 13 E8           DEC PIAS
03418  F8ED  A6 D4              LDX FA
03419  F8EF  CA                 DEX
03420  F8F0  D0 09              BNE TP20
03421  F8F2  A9 34              LDA #$34
03422  F8F4  8D 13 E8           STA PIAS
03423  F8F7  85 F9              STA CAS1
03424  F8F9  D0 0A              BNE TP30
03425  F8FB  AD 40 E8    TP20   LDA PIA
03426  F8FE  86 FA              STX CAS2
03427  F900  29 EF              AND #$EF
03428  F902  8D 40 E8           STA PIA
03429  F905  A2 FF       TP30   LDX #$FF
03430  F907  A0 FF       TP32   LDY #$FF






O/C CHAN,R/W TAPE......PAGE 004D

LINE# LOC   CODE        LINE


03431  F909  88          TP35   DEY
03432  F90A  D0 FD              BNE TP35
03433  F90C  CA                 DEX
03434  F90D  D0 F8              BNE TP32
03435  F90F  8D 49 E8           STA T2H
03436  F912  58                 CLI
03437  F913  A9 E4       TP40   LDA #>KEY
03438  F915  C5 91              CMP CINV+1
03439  F917  F0 11              BEQ TP50
03440  F919  20 35 F9           JSR TSTOP
03441  F91C  2C 13 E8           BIT PIAS
03442  F91F  10 F2              BPL TP40
03443  F921  2C 12 E8           BIT PIAK
03444  F924  20 68 F7           JSR UDTIM
03445  F927  4C 13 F9           JMP TP40
03446  F92A  60          TP50   RTS
03447  F92B  20 35 F9    TWAIT  JSR TSTOP
03448  F92E  A9 E4              LDA #>KEY
03449  F930  C5 91              CMP CINV+1
03450  F932  D0 F7              BNE TWAIT
03451  F934  60                 RTS
03452  F935  20 35 F3    TSTOP  JSR STOP1
03453  F938  D0 08              BNE STOP3
03454  F93A  20 C0 FC           JSR TNIF
03455  F93D  20 B8 F2           JSR JX770
03456  F940  85 10              STA CHANL
03457  F942  4C C6 B7    STOP3  JMP BSTOP
03458  F945  86 CC       STT1   STX TEMP
03459  F947  A5 CB              LDA CMP0
03460  F949  0A                 ASL A
03461  F94A  0A                 ASL A
03462  F94B  18                 CLC
03463  F94C  65 CB              ADC CMP0
03464  F94E  18                 CLC
03465  F94F  65 CC              ADC TEMP
03466  F951  85 CC              STA TEMP
03467  F953  A9 00              LDA #0
03468  F955  24 CB              BIT CMP0
03469  F957  30 01              BMI STT2
03470  F959  2A                 ROL A
03471  F95A  06 CC       STT2   ASL TEMP
03472  F95C  2A                 ROL A
03473  F95D  06 CC              ASL TEMP
03474  F95F  2A                 ROL A
03475  F960  AA                 TAX
03476  F961  AD 48 E8    STT3   LDA T2L
03477  F964  C9 15              CMP #21
03478  F966  90 F9              BCC STT3
03479  F968  65 CC              ADC TEMP
03480  F96A  8D 44 E8           STA TIL
03481  F96D  8A                 TXA
03482  F96E  6D 49 E8           ADC T2H
03483  F971  8D 45 E8           STA TIH
03484  F974  58                 CLI
03485  F975  60                 RTS






O/C CHAN,R/W TAPE......PAGE 004E

LINE# LOC   CODE        LINE


03486  F976              .FILE  OB5SRC




























































CASSETTE READ......PAGE 004F

LINE# LOC   CODE        LINE


03488  F976  AE 49 E8    READ   LDX T2H
03489  F979  A0 FF              LDY #$FF
03490  F97B  98                 TYA
03491  F97C  ED 48 E8           SBC T2L
03492  F97F  EC 49 E8           CPX T2H
03493  F982  D0 F2              BNE READ
03494  F984  86 CC       RD1    STX TEMP
03495  F986  AA                 TAX
03496  F987  8C 48 E8           STY T2L
03497  F98A  8C 49 E8           STY T2H
03498  F98D  98                 TYA
03499  F98E  E5 CC              SBC TEMP
03500  F990  86 CC              STX TEMP
03501  F992  4A                 LSR A
03502  F993  66 CC              ROR TEMP
03503  F995  4A                 LSR A
03504  F996  66 CC       RADS   ROR TEMP
03505  F998  A5 CB       RD3    LDA CMP0
03506  F99A  18                 CLC
03507  F99B  69 3C              ADC #60
03508  F99D  2C 40 E8           BIT PIA
03509  F9A0  2C 10 E8           BIT PIAL
03510  F9A3  C5 CC              CMP TEMP
03511  F9A5  B0 4A              BCS RDBK
03512  F9A7  A6 B2              LDX DPSW
03513  F9A9  F0 03              BEQ RJDJ
03514  F9AB  4C 9C FA    JRADJ  JMP RADJ
03515  F9AE  A6 B7       RJDJ   LDX PCNTR
03516  F9B0  30 1B              BMI JRAD2
03517  F9B2  A2 00              LDX #0
03518  F9B4  69 30              ADC #48
03519  F9B6  65 CB              ADC CMP0
03520  F9B8  C5 CC              CMP TEMP
03521  F9BA  B0 1C              BCS RADX2
03522  F9BC  E8                 INX
03523  F9BD  69 26              ADC #38
03524  F9BF  65 CB              ADC CMP0
03525  F9C1  C5 CC              CMP TEMP
03526  F9C3  B0 17              BCS RADL
03527  F9C5  69 2C              ADC #44
03528  F9C7  65 CB              ADC CMP0
03529  F9C9  C5 CC              CMP TEMP
03530  F9CB  90 03              BCC SRER
03531  F9CD  4C 4C FA    JRAD2  JMP RAD2
03532  F9D0  A5 CE       SRER   LDA SNSW1
03533  F9D2  F0 1D              BEQ RDBK
03534  F9D4  85 BE              STA RER
03535  F9D6  D0 19              BNE RDBK
03536  F9D8  E6 BF       RADX2  INC REZ
03537  F9DA  B0 02              BCS RAD5
03538  F9DC  C6 BF       RADL   DEC REZ
03539  F9DE  38          RAD5   SEC
03540  F9DF  E9 13              SBC #19
03541  F9E1  E5 CC              SBC TEMP
03542  F9E3  65 9C              ADC SVXT






CASSETTE READ......PAGE 0050

LINE# LOC   CODE        LINE


03543  F9E5  85 9C              STA SVXT
03544  F9E7  A5 B9              LDA FIRT
03545  F9E9  49 01              EOR #1
03546  F9EB  85 B9              STA FIRT
03547  F9ED  F0 21              BEQ RAD3
03548  F9EF  86 D9              STX DATA
03549  F9F1  A5 CE       RDBK   LDA SNSW1
03550  F9F3  F0 18              BEQ RADBK
03551  F9F5  2C 4D E8           BIT IFR
03552  F9F8  50 13              BVC RADBK
03553  F9FA  A9 00              LDA #0
03554  F9FC  85 B9              STA FIRT
03555  F9FE  A5 B7              LDA PCNTR
03556  FA00  10 31              BPL RAD4
03557  FA02  30 C9              BMI JRAD2
03558  FA04  A2 A6       RADP   LDX #166
03559  FA06  20 45 F9           JSR STT1
03560  FA09  A5 B1              LDA PRTY
03561  FA0B  D0 C3              BNE SRER
03562  FA0D  4C 00 E6    RADBK  JMP PREND
03563  FA10  A5 9C       RAD3   LDA SVXT
03564  FA12  F0 08              BEQ ROUT1
03565  FA14  30 04              BMI ROUT2
03566  FA16  C6 CB              DEC CMP0
03567  FA18  C6 CB              DEC CMP0
03568  FA1A  E6 CB       ROUT2  INC CMP0
03569  FA1C  A9 00       ROUT1  LDA #0
03570  FA1E  85 9C              STA SVXT
03571  FA20  E4 D9              CPX DATA
03572  FA22  D0 0F              BNE RAD4
03573  FA24  8A                 TXA
03574  FA25  D0 A9              BNE SRER
03575  FA27  A5 BF              LDA REZ
03576  FA29  30 C6              BMI RDBK
03577  FA2B  C9 10              CMP #16
03578  FA2D  90 C2              BCC RDBK
03579  FA2F  85 AB       RAD3G  STA SYNO
03580  FA31  B0 BE              BCS RDBK
03581  FA33  8A          RAD4   TXA
03582  FA34  45 B1              EOR PRTY
03583  FA36  85 B1              STA PRTY
03584  FA38  A5 CE              LDA SNSW1
03585  FA3A  F0 D1              BEQ RADBK
03586  FA3C  C6 B7              DEC PCNTR
03587  FA3E  30 C4              BMI RADP
03588  FA40  46 D9              LSR DATA
03589  FA42  66 DF              ROR MYCH
03590  FA44  A2 DA              LDX #218
03591  FA46  20 45 F9           JSR STT1
03592  FA49  4C 00 E6           JMP PREND
03593  FA4C  A5 AB       RAD2   LDA SYNO
03594  FA4E  F0 04              BEQ RAD2Y
03595  FA50  A5 CE              LDA SNSW1
03596  FA52  F0 07              BEQ RAD2X
03597  FA54  A5 B7       RAD2Y  LDA PCNTR






CASSETTE READ......PAGE 0051

LINE# LOC   CODE        LINE


03598  FA56  30 03              BMI RAD2X
03599  FA58  4C DC F9           JMP RADL
03600  FA5B  46 CC       RAD2X  LSR TEMP
03601  FA5D  A9 93              LDA #147
03602  FA5F  38                 SEC
03603  FA60  E5 CC              SBC TEMP
03604  FA62  65 CB              ADC CMP0
03605  FA64  0A                 ASL A
03606  FA65  AA                 TAX
03607  FA66  20 45 F9           JSR STT1
03608  FA69  E6 B2              INC DPSW
03609  FA6B  A5 CE       RADQ   LDA SNSW1
03610  FA6D  D0 11              BNE RADQ2
03611  FA6F  A5 AB       RADQ1  LDA SYNO
03612  FA71  F0 26              BEQ RDBK2
03613  FA73  85 BE              STA RER
03614  FA75  A9 00              LDA #0
03615  FA77  85 AB              STA SYNO
03616  FA79  A9 C0              LDA #$C0
03617  FA7B  8D 4E E8           STA IER
03618  FA7E  85 CE              STA SNSW1
03619  FA80  A5 AB       RADQ2  LDA SYNO
03620  FA82  85 CF              STA DIFF
03621  FA84  F0 09              BEQ RADK
03622  FA86  A9 00              LDA #0
03623  FA88  85 CE              STA SNSW1
03624  FA8A  A9 40              LDA #$40
03625  FA8C  8D 4E E8           STA IER
03626  FA8F  A5 DF       RADK   LDA MYCH
03627  FA91  85 DD              STA OCHAR
03628  FA93  A5 BE              LDA RER
03629  FA95  05 BF       RADR1  ORA REZ
03630  FA97  85 D0              STA PRP
03631  FA99  4C 00 E6    RDBK2  JMP PREND
03632  FA9C  20 C9 FB    RADJ   JSR NEWCH
03633  FA9F  85 B2              STA DPSW
03634  FAA1  A2 DA              LDX #218
03635  FAA3  20 45 F9           JSR STT1
03636  FAA6  A5 DE              LDA FSBLK
03637  FAA8  F0 02              BEQ RD15
03638  FAAA  85 BD              STA SHCNL
03639  FAAC              SPERR=16
03640  FAAC              CKERR=32
03641  FAAC              SBERR=4
03642  FAAC              LBERR=8
03643  FAAC  A9 0F       RD15   LDA #$F
03644  FAAE  24 C2              BIT RDFLG
03645  FAB0  10 17              BPL RD20
03646  FAB2  A5 CF              LDA DIFF
03647  FAB4  D0 0C              BNE RD12
03648  FAB6  A6 DE              LDX FSBLK
03649  FAB8  CA                 DEX
03650  FAB9  D0 0B              BNE RD10
03651  FABB              ;LONG BLOCK ERROR
03652  FABB  A9 08              LDA #LBERR






CASSETTE READ......PAGE 0052

LINE# LOC   CODE        LINE


03653  FABD  20 C4 FB           JSR UDST
03654  FAC0  D0 04              BNE RD10
03655  FAC2  A9 00       RD12   LDA #0
03656  FAC4  85 C2              STA RDFLG
03657  FAC6  4C 00 E6    RD10   JMP PREND
03658  FAC9  70 31       RD20   BVS RD60
03659  FACB  D0 18              BNE RD200
03660  FACD  A5 CF              LDA DIFF
03661  FACF  D0 F5              BNE RD10
03662  FAD1  A5 D0              LDA PRP
03663  FAD3  D0 F1              BNE RD10
03664  FAD5  A5 BD              LDA SHCNL
03665  FAD7  4A                 LSR A
03666  FAD8  A5 DD              LDA OCHAR
03667  FADA  30 03              BMI RD22
03668  FADC  90 18              BCC RD40
03669  FADE  18                 CLC
03670  FADF  B0 15       RD22   BCS RD40
03671  FAE1  29 0F              AND #$F
03672  FAE3  85 C2              STA RDFLG
03673  FAE5  C6 C2       RD200  DEC RDFLG
03674  FAE7  D0 DD              BNE RD10
03675  FAE9  A9 40              LDA #$40
03676  FAEB  85 C2              STA RDFLG
03677  FAED  20 BB FB           JSR RD300
03678  FAF0  A9 00              LDA #0
03679  FAF2  85 C3              STA SHCNH
03680  FAF4  F0 D0              BEQ RD10
03681  FAF6  A9 80       RD40   LDA #$80
03682  FAF8  85 C2              STA RDFLG
03683  FAFA  D0 CA              BNE RD10
03684  FAFC  A5 CF       RD60   LDA DIFF
03685  FAFE  F0 0A              BEQ RD70
03686  FB00  A9 04              LDA #SBERR
03687  FB02              ; SHORT BLOCK ERROR
03688  FB02  20 C4 FB           JSR UDST
03689  FB05  A9 00              LDA #0
03690  FB07  4C 8B FB           JMP RD161
03691  FB0A  20 0B FD    RD70   JSR WRT62
03692  FB0D  D0 03              BNE *+5
03693  FB0F  4C 89 FB           JMP RD160
03694  FB12  A6 BD              LDX SHCNL
03695  FB14  CA                 DEX
03696  FB15  F0 2D              BEQ RD58
03697  FB17  A5 9D              LDA VERCK
03698  FB19  F0 0C              BEQ RD80
03699  FB1B  A0 00              LDY #0
03700  FB1D  A5 DD              LDA OCHAR
03701  FB1F  D1 C7              CMP (SAL)Y
03702  FB21  F0 04              BEQ RD80
03703  FB23  A9 01              LDA #1
03704  FB25  85 D0              STA PRP
03705  FB27  A5 D0       RD80   LDA PRP
03706  FB29  F0 4C              BEQ RD59
03707  FB2B  A2 3D              LDX #61






CASSETTE READ......PAGE 0053

LINE# LOC   CODE        LINE


03708  FB2D  E4 C0              CPX PTR1
03709  FB2F  90 3F              BCC RD55
03710  FB31  A6 C0       RD56   LDX PTR1
03711  FB33  A5 C8              LDA SAH
03712  FB35  9D 01 01           STA BAD+1,X
03713  FB38  A5 C7              LDA SAL
03714  FB3A  9D 00 01           STA BAD,X
03715  FB3D  E8                 INX
03716  FB3E  E8                 INX
03717  FB3F  86 C0              STX PTR1
03718  FB41  4C 77 FB           JMP RD59
03719  FB44  A6 C1       RD58   LDX PTR2
03720  FB46  E4 C0              CPX PTR1
03721  FB48  F0 37              BEQ RD90
03722  FB4A  A5 C7              LDA SAL
03723  FB4C  DD 00 01           CMP BAD,X
03724  FB4F  D0 30              BNE RD90
03725  FB51  A5 C8              LDA SAH
03726  FB53  DD 01 01           CMP BAD+1,X
03727  FB56  D0 29              BNE RD90
03728  FB58  E6 C1              INC PTR2
03729  FB5A  E6 C1              INC PTR2
03730  FB5C  A5 9D              LDA VERCK
03731  FB5E  F0 0C              BEQ RD52
03732  FB60  A5 DD              LDA OCHAR
03733  FB62  A0 00              LDY #0
03734  FB64  D1 C7              CMP (SAL)Y
03735  FB66  F0 19              BEQ RD90
03736  FB68  A9 01              LDA #1
03737  FB6A  85 D0              STA PRP
03738  FB6C  A5 D0       RD52   LDA PRP
03739  FB6E  F0 07              BEQ RD59
03740  FB70              ;SECOND PASS ERR
03741  FB70  A9 10       RD55   LDA #SPERR
03742  FB72  20 C4 FB           JSR UDST
03743  FB75  D0 0A              BNE RD90
03744  FB77  A5 9D       RD59   LDA VERCK
03745  FB79  D0 06              BNE RD90
03746  FB7B  A5 DD              LDA OCHAR
03747  FB7D  A0 00              LDY #0
03748  FB7F  91 C7              STA (SAL)Y
03749  FB81  E6 C7       RD90   INC SAL
03750  FB83  D0 33              BNE RD180
03751  FB85  E6 C8              INC SAH
03752  FB87  D0 2F              BNE RD180
03753  FB89  A9 80       RD160  LDA #$80
03754  FB8B  85 C2       RD161  STA RDFLG
03755  FB8D  A6 DE              LDX FSBLK
03756  FB8F  CA                 DEX
03757  FB90  30 02              BMI RD167
03758  FB92  86 DE              STX FSBLK
03759  FB94  C6 BD       RD167  DEC SHCNL
03760  FB96  F0 08              BEQ RD175
03761  FB98  A5 C0              LDA PTR1
03762  FB9A  D0 1C              BNE RD180






CASSETTE READ......PAGE 0054

LINE# LOC   CODE        LINE


03763  FB9C  85 DE              STA FSBLK
03764  FB9E  F0 18              BEQ RD180
03765  FBA0  20 C0 FC    RD175  JSR TNIF
03766  FBA3  20 BB FB           JSR RD300
03767  FBA6  A0 00              LDY #0
03768  FBA8  84 C3              STY SHCNH
03769  FBAA  20 F9 FC           JSR VPRTY
03770  FBAD  A5 C3              LDA SHCNH
03771  FBAF  45 DD              EOR OCHAR
03772  FBB1  F0 05              BEQ RD180
03773  FBB3  A9 20              LDA #CKERR
03774  FBB5              ;CHKSUM ERROR
03775  FBB5  20 C4 FB           JSR UDST
03776  FBB8  4C 00 E6    RD180  JMP PREND
03777  FBBB  A5 FC       RD300  LDA STAH
03778  FBBD  85 C8              STA SAH
03779  FBBF  A5 FB              LDA STAL
03780  FBC1  85 C7              STA SAL
03781  FBC3  60                 RTS
03782  FBC4  05 96       UDST   ORA SATUS
03783  FBC6  85 96              STA SATUS
03784  FBC8  60                 RTS
03785  FBC9  A9 08       NEWCH  LDA #8
03786  FBCB  85 B7              STA PCNTR
03787  FBCD  A9 00              LDA #0
03788  FBCF  85 B9              STA FIRT
03789  FBD1  85 BE              STA RER
03790  FBD3  85 B1              STA PRTY
03791  FBD5  85 BF              STA REZ
03792  FBD7  60                 RTS
03793  FBD8              .FILE  OB6SRC






























TAPE WRITE & INIT......PAGE 0055

LINE# LOC   CODE        LINE


03795  FBD8  A5 DD       WRITE  LDA OCHAR
03796  FBDA  4A                 LSR A
03797  FBDB  A9 60              LDA #96
03798  FBDD  90 02              BCC WRT1
03799  FBDF  A9 B0       WRTW   LDA #176
03800  FBE1  A2 00       WRT1   LDX #0
03801  FBE3  8D 48 E8    WRTX   STA T2L
03802  FBE6  8E 49 E8           STX T2H
03803  FBE9  AD 40 E8           LDA PIA
03804  FBEC  49 08              EOR #8
03805  FBEE  8D 40 E8           STA PIA
03806  FBF1  29 08              AND #8
03807  FBF3  60                 RTS
03808  FBF4  38          WRTL3  SEC
03809  FBF5  66 C8              ROR SAH
03810  FBF7  30 3C              BMI WRT3
03811  FBF9  A5 BE       WRTN   LDA RER
03812  FBFB  D0 12              BNE WRTN1
03813  FBFD  A9 10              LDA #16
03814  FBFF  A2 01              LDX #1
03815  FC01  20 E3 FB           JSR WRTX
03816  FC04  D0 2F              BNE WRT3
03817  FC06  E6 BE              INC RER
03818  FC08  A5 C8              LDA SAH
03819  FC0A  10 29              BPL WRT3
03820  FC0C  4C 86 FC           JMP WRNC
03821  FC0F  A5 BF       WRTN1  LDA REZ
03822  FC11  D0 09              BNE WRTN2
03823  FC13  20 DF FB           JSR WRTW
03824  FC16  D0 1D              BNE WRT3
03825  FC18  E6 BF              INC REZ
03826  FC1A  D0 19              BNE WRT3
03827  FC1C  20 D8 FB    WRTN2  JSR WRITE
03828  FC1F  D0 14              BNE WRT3
03829  FC21  A5 B9              LDA FIRT
03830  FC23  49 01              EOR #1
03831  FC25  85 B9              STA FIRT
03832  FC27  F0 0F              BEQ WRT2
03833  FC29  A5 DD              LDA OCHAR
03834  FC2B  49 01              EOR #1
03835  FC2D  85 DD              STA OCHAR
03836  FC2F  29 01              AND #1
03837  FC31  45 B1              EOR PRTY
03838  FC33  85 B1              STA PRTY
03839  FC35  4C 00 E6    WRT3   JMP PREND
03840  FC38  46 DD       WRT2   LSR OCHAR
03841  FC3A  C6 B7              DEC PCNTR
03842  FC3C  A5 B7              LDA PCNTR
03843  FC3E  F0 3D              BEQ WRT4
03844  FC40  10 F3              BPL WRT3
03845  FC42  20 C9 FB    WRTS   JSR NEWCH
03846  FC45  58                 CLI
03847  FC46  A5 BA              LDA CNTDN
03848  FC48  F0 12              BEQ WRT6
03849  FC4A  A2 00              LDX #0






TAPE WRITE & INIT......PAGE 0056

LINE# LOC   CODE        LINE


03850  FC4C  86 D9              STX DATA
03851  FC4E  C6 BA       WRTS1  DEC CNTDN
03852  FC50  A6 DE              LDX FSBLK
03853  FC52  E0 02              CPX #2
03854  FC54  D0 02              BNE WRT61
03855  FC56  09 80              ORA #$80
03856  FC58  85 DD       WRT61  STA OCHAR
03857  FC5A  D0 D9              BNE WRT3
03858  FC5C  20 0B FD    WRT6   JSR WRT62
03859  FC5F  90 0A              BCC WRT7 
03860  FC61  D0 91              BNE WRTL3
03861  FC63  E6 C8              INC SAH
03862  FC65  A5 D9              LDA DATA
03863  FC67  85 DD              STA OCHAR
03864  FC69  B0 CA              BCS WRT3
03865  FC6B  A0 00       WRT7   LDY #0
03866  FC6D  B1 C7              LDA (SAL)Y
03867  FC6F  85 DD              STA OCHAR
03868  FC71  45 D9              EOR DATA
03869  FC73  85 D9              STA DATA
03870  FC75  E6 C7              INC SAL
03871  FC77  D0 BC              BNE WRT3
03872  FC79  E6 C8              INC SAH
03873  FC7B  D0 B8              BNE WRT3
03874  FC7D  A5 B1       WRT4   LDA PRTY
03875  FC7F  49 01              EOR #1
03876  FC81  85 DD              STA OCHAR
03877  FC83  4C 00 E6    WRTBK  JMP PREND
03878  FC86  C6 DE       WRNC   DEC FSBLK
03879  FC88  D0 03              BNE WREND
03880  FC8A  20 EB FC           JSR TNOF
03881  FC8D  A9 50       WREND  LDA #80
03882  FC8F  85 BD              STA SHCNL
03883  FC91  A2 08              LDX #8
03884  FC93  78                 SEI
03885  FC94  20 E0 FC           JSR BSIV
03886  FC97  D0 EA              BNE WRTBK
03887  FC99  A9 78       WRTZ   LDA #120
03888  FC9B  20 E1 FB           JSR WRT1
03889  FC9E  D0 E3              BNE WRTBK
03890  FCA0  C6 BD              DEC SHCNL
03891  FCA2  D0 DF              BNE WRTBK
03892  FCA4  20 C9 FB           JSR NEWCH
03893  FCA7  C6 C3              DEC SHCNH
03894  FCA9  10 D8              BPL WRTBK
03895  FCAB  A2 0A              LDX #10
03896  FCAD  20 E0 FC           JSR BSIV
03897  FCB0  58                 CLI
03898  FCB1  E6 C3              INC SHCNH
03899  FCB3  A5 DE              LDA FSBLK
03900  FCB5  F0 24              BEQ STKY
03901  FCB7  20 BB FB           JSR RD300
03902  FCBA  A2 09              LDX #9
03903  FCBC  86 BA              STX CNTDN
03904  FCBE  D0 82              BNE WRTS






TAPE WRITE & INIT......PAGE 0057

LINE# LOC   CODE        LINE


03905  FCC0  08          TNIF   PHP
03906  FCC1  78                 SEI
03907  FCC2  20 EB FC           JSR TNOF
03908  FCC5  A9 7F              LDA #$7F
03909  FCC7  8D 4E E8           STA IER
03910  FCCA  A9 3C              LDA #$3C
03911  FCCC  8D 11 E8           STA PIAL1
03912  FCCF  A9 3D              LDA #$3D
03913  FCD1  8D 13 E8           STA PIAS
03914  FCD4  A2 0C              LDX #12
03915  FCD6  20 E0 FC           JSR BSIV
03916  FCD9  28                 PLP
03917  FCDA  60                 RTS
03918  FCDB  20 C0 FC    STKY   JSR TNIF
03919  FCDE  F0 A3              BEQ WRTBK
03920  FCE0  BD 4C FD    BSIV   LDA BSIT,X
03921  FCE3  85 90              STA CINV
03922  FCE5  BD 4D FD           LDA BSIT+1,X
03923  FCE8  85 91              STA CINV+1
03924  FCEA  60                 RTS
03925  FCEB  A9 3C       TNOF   LDA #$3C
03926  FCED  8D 13 E8           STA PIAS
03927  FCF0  AD 40 E8           LDA PIA
03928  FCF3  09 10              ORA #$10
03929  FCF5  8D 40 E8           STA PIA
03930  FCF8  60                 RTS
03931  FCF9  B1 C7       VPRTY  LDA (SAL)Y
03932  FCFB  45 C3              EOR SHCNH
03933  FCFD  85 C3              STA SHCNH
03934  FCFF  E6 C7              INC SAL
03935  FD01  D0 02              BNE VP10
03936  FD03  E6 C8              INC SAH
03937  FD05  20 0B FD    VP10   JSR WRT62
03938  FD08  D0 EF              BNE VPRTY
03939  FD0A  60                 RTS
03940  FD0B  A5 C8       WRT62  LDA SAH
03941  FD0D  C5 CA              CMP EAH
03942  FD0F  D0 04              BNE WRT64
03943  FD11  A5 C7              LDA SAL
03944  FD13  C5 C9              CMP EAL
03945  FD15  60          WRT64  RTS
03946  FD16  A2 FF       START  LDX #$FF
03947  FD18  78                 SEI
03948  FD19  9A                 TXS
03949  FD1A  D8                 CLD
03950  FD1B  20 00 E0           JSR CINT
03951  FD1E  A9 FF              LDA #<READY
03952  FD20  85 94              STA NMINV
03953  FD22  A9 B3              LDA #>READY
03954  FD24  85 95              STA NMINV+1
03955  FD26  A9 78              LDA #<BRKE
03956  FD28  85 92              STA CBINV
03957  FD2A  A9 D4              LDA #>BRKE
03958  FD2C  85 93              STA CBINV+1
03959  FD2E  A9 A4              LDA #<ERROPR






TAPE WRITE & INIT......PAGE 0058

LINE# LOC   CODE        LINE


03960  FD30  8D FA 03           STA USRCMD
03961  FD33  A9 D7              LDA #>ERROPR
03962  FD35  8D FB 03           STA USRCMD+1
03963  FD38  A9 00              LDA #$00        ;SET TIMEOUT FLAG
03964  FD3A  8D FC 03           STA BOB
03965  FD3D  58                 CLI
03966  FD3E  AD 10 E8           LDA PIAL
03967  FD41  30 03              BMI *+5
03968  FD43  4C 72 D4           JMP CALLE
03969  FD46  4C B6 D3           JMP INIT
03970  FD49  6C 94 00    NMI    JMP (NMINV)
03971  FD4C  00 00       BSIT   .WOR 0,0,0,0    ;BSYI1,BCI1,0,BCI2
03971  FD4E  00 00 
03971  FD50  00 00 
03971  FD52  00 00 
03972  FD54  99 FC              .WOR WRTZ,WRTN,KEY,READ
03972  FD56  F9 FB 
03972  FD58  55 E4 
03972  FD5A  76 F9 
03973  FD5C              .FIL   OB7SRC
03974  FD5C  00          CKSUMF .BYT 0          ;D-PAGE CHECKSUM
03975  FD5D                     *=$7F93+OFFSET
03976  FF93  4C C7 DA           JMP CONCAT
03977  FF96  4C 42 D9           JMP DOPEN
03978  FF99  4C 07 DA           JMP DCLOSE
03979  FF9C  4C AF D7           JMP RECORD
03980  FF9F  4C D2 D9           JMP FORMAT
03981  FFA2  4C 65 DA           JMP COLECT
03982  FFA5  4C 7E DA           JMP BACKUP
03983  FFA8  4C A7 DA           JMP COPY
03984  FFAB  4C 77 D9           JMP APPEND
03985  FFAE  4C 0D DB           JMP DSAVE
03986  FFB1  4C 3A DB           JMP DLOAD
03987  FFB4  4C 73 D8           JMP CATLOG
03988  FFB7  4C 55 DB           JMP RENAME
03989  FFBA  4C 66 DB           JMP SCRTCH
03990  FFBD  4C 95 D9           JMP GETDS
03991  FFC0  4C 60 F5           JMP OPEN
03992  FFC3  4C DD F2           JMP CLOSE
03993  FFC6  4C AF F7           JMP CHKIN
03994  FFC9  4C FE F7           JMP CKOUT
03995  FFCC  4C A6 F2           JMP CLRCH
03996  FFCF  4C 15 F2           JMP BASIN
03997  FFD2  4C 66 F2           JMP BSOUT
03998  FFD5  4C 01 F4           JMP LOAD
03999  FFD8  4C DD F6           JMP SAVE
04000  FFDB  4C F6 F4           JMP VER
04001  FFDE  4C C3 F6           JMP SYS
04002  FFE1  4C 43 F3           JMP STOP
04003  FFE4  4C 05 F2           JMP GETIN
04004  FFE7  4C A2 F2           JMP CLALL
04005  FFEA  4C 68 F7           JMP UDTIM
04006  FFED                     *=$FFFA
04007  FFFA  49 FD              .WOR NMI
04008  FFFC  16 FD              .WOR START






TAPE WRITE & INIT......PAGE 0059

LINE# LOC   CODE        LINE


04009  FFFE  42 E4              .WOR PULS
04010  0000              .END


ERRORS = 00000


SYMBOL TABLE

SYMBOL VALUE
 A4       D627    A5       D629    A9       D631    ACC      0203
 ACP00    F1CD    ACP01    F1D2    ACP03    F1EE    ACP05    F1F9
 ACPTR    F1C0    ACR      E84B    ADRH     D54C    ADRL     D554
 AL2      D606    AL3      D618    ALTM     D61D    ALTR     D5FB
 ALTRIT   D579    ANSBYE   DBD6    ANSNO    DBCB    ANSYES   DBD5
 APEN     0041    APPEND   D977    ASC1     D741    ASCII    D73A
 B3       D491    B5       D4AC    BACKUP   DA7E    BAD      0100
 BADDIS   DBD7    BASIN    F215    BBACK    DA8A    BDF      0002
 BDFH     0004    BEQS1    D5F5    BERRO    DA87    BK1      E23F
 BK2      E24A    BKLN     E1DE    BKLN1    E1EA    BLF      0001
 BLKL     E434    BLKLN    E421    BLNCT    00A8    BLNK2    F62E
 BLNON    00AA    BLNSW    00A7    BN10     F224    BN20     F231
 BN30     F25C    BN32     F262    BN35     F263    BO10     F271
 BO20     F277    BO21     F278    BOB      03FC    BOBREC   DA31
 BRKE     D478    BSIT     FD4C    BSIV     FCE0    BSOUR    00A5
 BSOUT    F266    BSTOP    B7C6    BUF      0200    BUFPT    00BB
 BUFSZ    00C0    BY3      D51D    BYTE     D50B    C3P0     00A0
 CALLE    D472    CAS1     00F9    CAS2     00FA    CATALG   D87D
 CATBLD   D889    CATLOG   D873    CBINV    0092    CHANL    0010
 CHAR     E60B    CHK1     D804    CHK2     D80B    CHK3     D818
 CHK4     D81D    CHK5     D824    CHK6     D82E    CHKCLS   BEEF
 CHKCOM   BEF5    CHKER1   D808    CHKIN    F7AF    CHKOPN   BEF2
 CHKOUT   F7FE    CHRGET   0070    CHRGOT   0076    CI2      F1A6
 CI4      F1AB    CINT     E000    CINV     0090    CIOUT    F19E
 CK10     F818    CKERR    0020    CKIS1    E4CE    CKIT     E4DE
 CKIT1    E4E9    CKOUT    F7FE    CKSUMD   DE9D    CKSUME   E67D
 CKSUMF   FD5C    CKUT     E4DD    CLALL    F2A2    CLOS10   F2E7
 CLOS5    F2E2    CLOSE    F2DD    CLP1     E158    CLP2     E141
 CLP21    E156    CLP2A    E153    CLP5     E0F2    CLP6     E0FB
 CLP7     E166    CLRCH    F2A6    CLRCHN   F2A6    CLSE1    F72F
 CLSR     E04B    CMDS     D544    CMP0     00CB    CNC3     E254
 CNC3X    E230    CNTDN    00BA    COLECT   DA65    CONCAT   DAC7
 CONT     DE8F    COPCON   DABD    COPY     DAA7    COPY2    DAB7
 COPY3    DAC0    COUNT    0341    CR       000D    CRFAC    0099
 CRLF     D534    CRSW     00AC    CS10     F87A    CS20     F883
 CS25     F88B    CS30     F85E    CS40     F86D    CSTE1    F857
 CSTE2    F88C    D2       D589    DAPPEN   D984    DATA     00D9
 DBACKU   DA91    DCLALL   DA1B    DCLBYE   DA30    DCLLP    DA1F
 DCLOSE   DA07    DCLSE    DA11    DCOLL0   DA7A    DCOLLE   DA6B
 DDIREC   DB99    DELIM1   DD96    DELIM2   DE0F    DFLTN    00AF
 DFLTO    00B0    DFORMA   D9E1    DIDCHK   033D    DIFF     00CF
 DISKID   033F    DLOAD    DB3A    DLOAD2   DB47    DLOERR   DB44
 DM       D4F7    DM1      D4FB    DONE     DE23    DONE1    DD03
 DONER    D7FE    DOPEN    D942    DOPEN2   D94F    DOSPAR   DC68








SYMBOL TABLE

SYMBOL VALUE
 DPSW     00B2    DREBLD   DA43    DRECG    DA3D    DREN     DB5F
 DRIVE1   033B    DRIVE2   033C    DRV1     DD15    DRV2     DDD0
 DSAVE    DB0D    DSAVE2   DB1A    DSCRAT   DB6C    DSDESC   000D
 DSP1     D5D2    DSPLYM   D5BC    DSPLYR   D587    DSPP     E606
 DXCR0    DB9D    EAH      00CA    EAL      00C9    ECHKS    D9AB
 ENTRY0   D92F    ENTRY1   D931    ENTRY2   D935    EOT      0005
 ER001    F175    EREAD    D9B3    ERMSG    F5AF    ERR01    F167
 ERRCHL   D991    ERREND   D9CB    ERRFC    0035    ERRL     D672
 ERRLEN   DE74    ERRLS    00B0    ERROPR   D7A4    ERROR    B3CF
 ERRP0    F165    ERRP1    F170    ERRP7    F16C    ERRS1    D5F8
 ERRS3    F151    ERRS4    F15B    EXIT     D66B    FA       00D4
 FAF      F4D3    FAF20    F4E0    FAF30    F4F4    FAF40    F4F5
 FAH      F5E5    FAH30    F5E8    FAH40    F614    FAH45    F612
 FAH50    F5FB    FAH55    F608    FAT      025B    FBUILD   D9EA
 FCLOSE   F2E2    FCONT    D9F5    FERRO    D9DE    FERRP    DA04
 FERRS    D9F8    FINI     B4AD    FIRT     00B9    FLGS     0202
 FLOAD    B60B    FNADR    00DA    FNADR2   00FD    FNLEN    00D1
 FNLEN2   033A    FOPEN    F565    FORMAT   D9D2    FRESTR   C7B5
 FRMEVL   BD98    FRMNUM   BD84    FSBLK    00DE    G1       D646
 GDBLN    00A9    GETADR   C92D    GETBYT   C8D4    GETDS    D995
 GETIN    F205    GETSPA   C61D    GETVAL   DE87    GO       D633
 GTVL2    DE8A    HEX09    D797    HEXIT    D78D    IDCON    DD41
 IDENT    DD37    IEEI     E820    IEEIS    E821    IEEO     E822
 IEEOS    E823    IER      E84E    IFR      E84D    INCTMP   D539
 INDEX1   001F    INDX     00A1    INIT     D3B6    INS1     E2D5
 INS2     E2D7    INS3     E2CE    INSRT    00DC    INVH     0207
 INVL     0208    ISOUR    F109    ISR0     F128    ISR1     F11E
 ISR2     F12D    ISR3     F138    JLP2     E340    JLTLK    F2C1
 JPL3     E28C    JPL4     E275    JRAD2    F9CD    JRADJ    F9AB
 JSTS     E185    JSTS1    E19F    JSTS2    E1CD    JSTSX    E1B3
 JSXB     E1BD    JTG10    F259    JTG35    F243    JTGET    F249
 JTP10    F298    JTP20    F84B    JTS2     E1BE    JX120    F315
 JX150    F318    JX170    F334    JX300    F7BE    JX305    F7C0
 JX310    F7C3    JX320    F7DA    JX330    F7DF    JX3301   F7E3
 JX340    F7F0    JX350    F7F3    JX360    F828    JX370    F82D
 JX3701   F831    JX380    F83D    JX390    F840    JX600    F2C3
 JX750    F2AF    JX770    F2B8    JZ100    F2CD    JZ101    F2DC
 KEY      E455    KEY3     E495    KEY4     E474    KEY5     E470
 KEYD     026F    KEYF     E509    KL1      E4BF    KL2      E49E
 KL22     E4B5    KL23     E4A9    KL24     E49B    KL25     E4B2
 KN1      E4FD    L1       D688    L10      D6D2    L11      D6D6
 L12      D6E3    L13      D6F0    L14      D709    L2       D695
 L20      D700    L3       D697    L4       D6A9    L5       D6AD
 L6       D6B1    L7       D6BD    L8       D6C2    L9       D6CB
 LA       00D2    LASTWR   D472    LAT      0251    LBERR    0008
 LD       D675    LD10     F405    LD100    F3D4    LD105    F45C
 LD11     F40D    LD110    F462    LD112    F3DD    LD115    F46C
 LD120    F3E6    LD15     F356    LD150    F3E9    LD170    F3EE
 LD20     F35A    LD205    F443    LD209    F425    LD210    F42E
 LD30     F38C    LD300    F449    LD40     F38F    LD400    F46D
 LD410    F475    LD50     F3B3    LD60     F3B5    LD64     F3BB
 LD65     F3C6    LD90     F3C1    LDAD1    F6AB    LDAD2    F67B
 LDAD3    F682    LDTB1    00E0    LDTB2    E65B    LDTND    00AE
 LEAV     D95D    LEAV1    D970    LENCHK   DE6C    LINNUM   0011
 LINPRT   CF83    LIST1    F0D7    LIST2    F0FA    LIST4    F0FF








SYMBOL TABLE

SYMBOL VALUE
 LISTN    F0D5    LNMX     00D5    LOAD     F401    LOADNP   F408
 LOGADR   DCBD    LOOP1    D9BF    LOOP2    E1A6    LOOP3    E0BF
 LOOP4    E0BC    LOOP5    E116    LOOP6    DD77    LOP2     E1AE
 LOP5     E11E    LOP51    E124    LOP52    E134    LOP53    E138
 LOP54    E12E    LP1      E0AC    LP2      E0A7    LP21     E0D3
 LP22     E0EA    LP23     E0DF    LPS1     E04F    LPS2     E05D
 LPS3     E05E    LPS4     E06A    LRECL    033D    LSTP     00A4
 LSTX     0097    LSXP     00A3    MLP1     E382    MLP2     E39B
 MLP4     E3D2    MLP41    E3D5    MLP42    E3DF    MS1      F000
 MS10     F05F    MS11     F064    MS12     F06E    MS13     F074
 MS15     F086    MS16     F094    MS17     F0A3    MS18     F0AA
 MS19     F0AE    MS2      F00E    MS20     F039    MS21     F06D
 MS22     F060    MS3      F017    MS4      F024    MS5      F032
 MS6      F03D    MS7      F041    MS8      F04D    MS9      F056
 MSG      F185    MSG1     F000    MSG30    F0B6    MSG31    F0C5
 MYCH     00DF    NAMCON   DD85    NAME1    DD60    NAME11   DD06
 NAME2    DDF8    NC1      E25D    NC2      E264    NC3      E17A
 NC3W     E257    NCMDS    0008    NCX2     E27A    NCZ2     E277
 NDX      009E    NELL     E414    NEWCH    FBC9    NEWL1    E3F5
 NEWLA    E401    NEWLN    E3E2    NEWLX    E3F3    NEWNAM   DE49
 NEXT3    DD45    NEXT4    DD4B    NEXT5    DE81    NEXT6    DDA8
 NEXT6A   DDAF    NEXT7    DCB2    NJT1     E21D    NMI      FD49
 NMINV    0094    NTCN     E229    NTCN1    E250    NTCN2    E1F3
 NUMADR   D7DB    NUMBYE   DB98    NUMERC   DE9A    NUMLP    DB87
 NUMPRT   DB93    NUMSCR   DB78    NVS      E17C    NVS1     E182
 NXLN     E343    NXLN1    E350    NXLN2    E348    NXT1     E359
 NXT2     E322    NXT3     E176    NXT33    E174    NXT6     E32A
 NXT61    E339    NXTD     E079    NXTX     E2A4    NXTX1    E2AC
 NXX5     DE82    NXXT5    DE79    NXXX     DD9E    OCHAR    00DD
 OFFSET   8000    OLDCL1   DBF1    OLDCLR   DBE1    ON       DE2C
 ON1      DD09    ON2      DDEC    ONTK     0091    OP100    F56E
 OP150    F598    OP160    F5AD    OP170    F5C2    OP171    F5D1
 OP172    F5E2    OP175    F5E4    OP200    F5C9    OP35     F4C0
 OP37     F4BB    OP40     F4C6    OP45     F4D0    OP94     F563
 OP98     F567    OPEN     F560    OPENI    F4A5    OPENIB   F4B4
 P2DA     E843    P2DB     E842    PARCHK   033E    PARNXT   DC9F
 PARS1    F47D    PARS2    F50D    PARSE2   DDB6    PARSEL   DC89
 PATCH5   DE9E    PCH      0200    PCL      0201    PCNTR    00B7
 PCR      E84C    PIA      E840    PIAK     E812    PIAL     E810
 PIAL1    E811    PIAS     E813    PNT      00C4    PNTR     00C6
 POINT    00C5    POKER    0011    POS      033A    PR060    F49E
 PR070    F49F    PR100    F52E    PR111    F536    PR130    F558
 PR135    F55D    PR140    F54D    PR147    F554    PR150    F555
 PR200    F53C    PREND    E600    PREND0   E50B    PRP      00D0
 PRT      E202    PRT1     E28F    PRT2     E297    PRTY     00B1
 PTCH     00B8    PTR1     00C0    PTR2     00C1    PULS     E442
 PULS1    E452    PUTP     D4EC    PX1      E009    QTSW     00CD
 QTSWC    E167    QTSWL    E173    QTYER1   D801    QTYER2   DD34
 QTYERR   DE27    RAD2     FA4C    RAD2X    FA5B    RAD2Y    FA54
 RAD3     FA10    RAD3G    FA2F    RAD4     FA33    RAD5     F9DE
 RADBK    FA0D    RADJ     FA9C    RADK     FA8F    RADL     F9DC
 RADP     FA04    RADQ     FA6B    RADQ1    FA6F    RADQ2    FA80
 RADR1    FA95    RADS     F996    RADX2    F9D8    RBLK     F89A
 RCNT     00B5    RD1      F984    RD10     FAC6    RD12     FAC2
 RD15     FAAC    RD160    FB89    RD161    FB8B    RD167    FB94








SYMBOL TABLE

SYMBOL VALUE
 RD175    FBA0    RD180    FBB8    RD20     FAC9    RD200    FAE5
 RD22     FADF    RD3      F998    RD300    FBBB    RD40     FAF6
 RD52     FB6C    RD55     FB70    RD56     FB31    RD58     FB44
 RD59     FB77    RD60     FAFC    RD70     FB0A    RD80     FB27
 RD90     FB81    RDBK     F9F1    RDBK2    FA99    RDEXIT   D762
 RDFLG    00C2    RDFN     DAE1    RDMOV    DAEA    RDOA     D754
 RDOA2    D75B    RDOB     D763    RDOB1    D76B    RDOB2    D778
 RDOB3    D785    RDOC     D798    RDRT0    DAF8    RDRT1    DAF9
 READ     F976    READY    B3FF    RECLCK   D95B    RECLEN   DCD8
 RECON    DCF8    RECOO    DCEA    RECORD   D7AF    REGK     D55C
 RENAME   DB55    RER      00BE    REXNEX   D7E1    REZ      00BF
 RFOUND   D93F    RID      DAFD    RJDJ     F9AE    ROUT1    FA1C
 ROUT2    FA1A    RPLCE    DC46    RSFN     DAD4    RSTOR    F29C
 RUNTB    E674    RUSUR1   DBA3    RUSUR2   DBAB    RUSURE   DB9E
 RVS      009F    RWRT     DC57    RWRT1    DC60    RWRTS    DC67
 RXD1     DC34    RXD2     DC3D    RXDD     DC44    RXFN1    DC0D
 RXFN2    DC14    RXID     DC24    RXREC    DC1B    RXWRT    DC2B
 S0       D4D4    S1       D4D6    S2       D4E6    SA       00D3
 SAH      00C8    SAL      00C7    SAT      0265    SATUS    0096
 SAVE     F6DD    SAVLD0   DB23    SAVLD1   DB32    SAVNAM   0209
 SAVX     00B4    SBERR    0004    SCATN    F148    SCRL     E1C4
 SCRL1    E37B    SCRL3    E3B5    SCRL4    E3A7    SCRL5    E3AB
 SCROL    E369    SCRTCH   DB66    SECND    F143    SENDP    DBFA
 SENDP1   DBFC    SENDP2   DC02    SETR     D523    SETWR    D543
 SFDX     00A6    SFST     0098    SHCNH    00C3    SHCNL    00BD
 SIGNON   DEA4    SKIPB    D8D2    SNER1    DCBA    SNER2    DDCD
 SNER3    DE20    SNER8    DDB3    SNERR    BF00    SNSW     00A2
 SNSW1    00CE    SP       0206    SPAC2    D52E    SPACE    D531
 SPCK     E4DB    SPERR    0010    SPMSG    F349    SR       E84A
 SRER     F9D0    ST1      D4C9    STAH     00FC    STAL     00FB
 START    FD16    STKEY    009B    STKY     FCDB    STOP     F343
 STOP1    F335    STOP2    F342    STOP3    F942    STRT     D4BA
 STT1     F945    STT2     F95A    STT3     F961    STUPR    E0A6
 STUPT    E07F    STUPZ    E09C    STXTPT   B622    SUBA     D91A
 SUBB     D923    SUBBR    D92E    SV10     F6E7    SV100    F742
 SV105    F755    SV20     F6EC    SV3      F6E0    SV30     F717
 SV5      F6E3    SV50     F72C    SV60     F6CC    SVXT     009C
 SYNC     E841    SYNC1    E84F    SYNCHR   BEF7    SYNERR   D7AC
 SYNO     00AB    SYS      F6C3    T1       00B4    T2       00B5
 T2H      E849    T2L      E848    T2T2     D744    T2T21    D746
 T3       00B6    TABLD    D838    TALK     F0D2    TAPE     F8E0
 TAPE1    027A    TAPE2    033A    TAPEH    F619    TBLX     00D8
 TBUF     00D6    TBUF2    0342    TBUFF    0353    TEMP     00CC
 TH20     F652    TH30     F664    TIH      E845    TIL      E844
 TILH     E847    TILL     E846    TIME     008D    TKATN    F198
 TKSA     F193    TMP0     00FB    TMP2     00FD    TMPC     00B5
 TMPC2    00B6    TNIF     FCC0    TNOF     FCEB    TOTK     00A4
 TP20     F8FB    TP30     F905    TP32     F907    TP35     F909
 TP40     F913    TP50     F92A    TRANR    DC4C    TRANS    DA98
 TRANS1   DA9B    TRD      F8A3    TRD2     F8C4    TRD3     F8C7
 TSTOP    F935    TWAIT    F92B    TWRT     F8CE    TWRT2    F8D5
 TXTPTR   0077    TXTRT    F355    TXTST    F351    TXTTAB   0028
 TYPERR   B3ED    UD10     F770    UD20     F77A    UD30     F784
 UD40     F786    UD45     F794    UD50     F79B    UD60     F7A1
 UD65     F7AB    UD70     F7AC    UDST     FBC4    UDTIM    F768








SYMBOL TABLE

SYMBOL VALUE
 UNIT     DE33    UNIT1    DD0F    UNIT2    DDF2    UNLSN    F1B9
 UNTLK    F1AE    UP1      E303    UP2      E2F3    UP3      E312
 UP5      E2BA    UP6      E2EE    UP9      E2EA    USRCMD   03FA
 VARTAB   002A    VER      F4F6    VER10    F508    VERCK    009D
 VP10     FD05    VPRTY    FCF9    WBLK     F8CB    WG220    D8A5
 WG230    D912    WG235    D911    WG240    D905    WG250    D8D8
 WG255    D8FE    WRAP     00DE    WREND    FC8D    WRITE    FBD8
 WRNC     FC86    WROA     D717    WROA1    D719    WROB     D722
 WRT1     FBE1    WRT2     FC38    WRT3     FC35    WRT4     FC7D
 WRT6     FC5C    WRT61    FC58    WRT62    FD0B    WRT64    FD15
 WRT7     FC6B    WRTBK    FC83    WRTL3    FBF4    WRTN     FBF9
 WRTN1    FC0F    WRTN2    FC1C    WRTS     FC42    WRTS1    FC4E
 WRTW     FBDF    WRTWO    D731    WRTX     FBE3    WRTZ     FC99
 WSW      00B3    XD1      00D1    XD2      00D2    XFN1     00F1
 XFN2     00F2    XID      00D0    XR       0204    XREC     00E0
 XSAV     00AD    XWRT     00E1    YR       0205    ZZ1      D61C
 ZZ10     F6AA    ZZ2      D5FA    ZZ3      D586    ZZ4      D5BB
 ZZ5      D632    ZZ6      D66A    ZZ7      D674    ZZ8      D674
 ZZZ      F695    ZZZ1     0209   

END OF ASSEMBLY
