bassrc......PAGE 0001

LINE# LOC   CODE        LINE


00001  0000              ;**********************************
00002  0000              ;*COMMODORE PET BASIC             *
00003  0000              ;*                                *
00004  0000              ;*VERSION 1                       *
00005  0000              ;*COPYRIGHT 1977 BY               *
00006  0000              ;*COMMODORE INTERNATIONAL LIMITED *
00007  0000              ;*ROMS PRODUCED: 901439-01        *
00008  0000              ;*               901439-05        *
00009  0000              ;*               901439-02        *
00010  0000              ;*               901439-06        *
00011  0000              ;*               901439-03        *
00012  0000              ;*RECONSTRUCTED: M.HOFFMANN-VETTER*
00013  0000              ;**********************************

00015  0000              OFFSET =$8000          ;RAM/ROM SWITCH
00016  0000              ROMLOC =$4000+OFFSET   ;START THIS VERSION

00018  0000              ;VERSION 1 - AUGUST 1977
00019  0000              ;     ORIGINAL MICROSOFT RELEASE



00021  0000              ;*****LISTING DATE: ??? ??, ????*****



00023  0000              ;CONSTANTS FROM PET OS
00024  0000              CTIMR  =$0200          ;(TIME)
00025  0000              CSTAT  =$020C          ;(SATUS)
00026  0000              CHTIM  =$9044          ;(TIL)
00027  0000              PNTR   =$E2
00028  0000              LE7F3  =$E7F3



00030  0000              ;OS ROUTINES IN JUMP TABLE
00031  0000                     * =$7FC0+OFFSET
00032  FFC0              COPEN  *=*+3           ;OPEN FILE
00033  FFC3              CCLOS  *=*+3           ;CLOSE FILE
00034  FFC6              COIN   *=*+3           ;OPEN INPUT CHAHNEL
00035  FFC9              COOUT  *=*+3           ;OPEN OUTPUT CHAHHEL
00036  FFCC              CLSCHN
00037  FFCC              CCCHN  *=*+3           ;CLOSE I/O CHANNELS
00038  FFCF              CINCH  *=*+3           ;INPUT CHARACTER(S)
00039  FFD2              OUTCH  *=*+3           ;OUTPUT CHARACTER
00040  FFD5              CLOAD  *=*+3           ;CASSETTE LOAD
00041  FFD8              CSAVE  *=*+3           ;CASSETTE SAVE
00042  FFDB              CVERF  *=*+3           ;CASSETTE VERIFY
00043  FFDE              CSYS   *=*+3           ;SYS FUNCTION
00044  FFE1              ISCNTC *=*+3           ;SCAN STOP KEY
00045  FFE4              CGETL  *=*+3           ;GET CHARACTER
00046  FFE7              CCALL  *=*+3           ;CLOSE ALL FILES









bassrc......PAGE 0002

LINE# LOC   CODE        LINE


00048  FFEA              LINLEN =40
00049  FFEA              FORSIZ =@22
00050  FFEA              BUFLEN =80
00051  FFEA              ADDPRC =1
00052  FFEA              STKEND =511
00053  FFEA              CLMWID =10
00054  FFEA              PI     =255
00055  FFEA              NUMLEV =23
00056  FFEA              STRSIZ =3
00057  FFEA              RAMLOC =$0400





00059  FFEA              ;ZERO PAGE STORAGE
00060  FFEA                     * =0
00061  0000              USRPOK *=*+3
00062  0003              CHANNL *=*+1
00063  0004              NULCNT *=*+1
00064  0005              TRMPOS *=*+1
00065  0006                     *=*+2
00066  0008              VARTXT
00067  0008              POKER
00068  0008              LINNUM *=*+2
00069  000A              BUF    *=*+80
00070  005A              INTEGR
00071  005A              CHARAC *=*+1
00072  005B              ENDCHR *=*+1
00073  005C              COUNT  *=*+1
00074  005D              DIMFLG *=*+1
00075  005E              VALTYP *=*+1
00076  005F              INTFLG *=*+1
00077  0060              GARBFL 
00078  0060              DORES  *=*+1
00079  0061              SUBFLG *=*+1
00080  0062              INPFLG *=*+1
00081  0063              DOMASK
00082  0063              TANSGN *=*+1
00083  0064              CNTWFL *=*+1
00084  0065              TEMPPT *=*+1
00085  0066              LASTPT *=*+2
00086  0068              TEMPST *=*+9
00087  0071              INDEX
00088  0071              INDEX1 *=*+2
00089  0073              INDEX2 *=*+2
00090  0075              RESHO  *=*+1
00091  0076              RESMOH *=*+1
00092  0077              ADDEND
00093  0077              RESMO  *=*+1
00094  0078              RESLO  *=*+1
00095  0079                     *=*+1
00096  007A              TXTTAB *=*+2
00097  007C              VARTAB *=*+2
00098  007E              ARYTAB *=*+2






bassrc......PAGE 0003

LINE# LOC   CODE        LINE


00099  0080              STREND *=*+2
00100  0082              FRETOP *=*+2
00101  0084              FRESPC *=*+2
00102  0086              MEMSIZ *=*+2
00103  0088              CURLIN *=*+2
00104  008A              OLDLIN *=*+2
00105  008C              OLDTXT *=*+2
00106  008E              DATLIN *=*+2
00107  0090              DATPTR *=*+2
00108  0092              INPPTR *=*+2
00109  0094              VARNAM *=*+2
00110  0096              FDECPT
00111  0096              VARPNT *=*+2
00112  0098              LSTPNT
00113  0098              ANDMSK
00114  0098              FORPNT *=*+2
00115  009A              EORMSK =FORPNT+1
00116  009A              OPPTR  *=*+2
00117  009C              OPMASK *=*+1
00118  009D              GRBPNT
00119  009D              TEMPF3
00120  009D              DEFPNT *=*+2
00121  009F              DSCPNT *=*+2
00122  00A1                     *=*+1
00123  00A2              FOUR6  *=*+1
00124  00A3              JMPER  *=*+1
00125  00A4              SIZE   *=*+1
00126  00A5              OLDOV  *=*+1
00127  00A6              TEMPF1 *=*+1
00128  00A7              ARYPNT
00129  00A7              HIGHDS *=*+2
00130  00A9              HIGHTR *=*+2
00131  00AB              TEMPF2 *=*+1
00132  00AC              DECCNT
00133  00AC              LOWDS  *=*+2
00134  00AE              GRBTOP
00135  00AE              DPTFLG
00136  00AE              LOWTR  *=*+1
00137  00AF              EXPSGN *=*+1
00138  00B0              TENEXP =LOWDS+1
00139  00B0              EPSGN  =LOWTR+1
00140  00B0              DSCTMP
00141  00B0              FAC
00142  00B0              FACEXP *=*+1
00143  00B1              FACHO  *=*+1
00144  00B2              FACMOH *=*+1
00145  00B3              INDICE
00146  00B3              FACMO  *=*+1
00147  00B4              FACLO  *=*+1
00148  00B5              FACSGN *=*+1
00149  00B6              DEGREE
00150  00B6              SGNFLG *=*+1
00151  00B7              BITS   *=*+1
00152  00B8              ARGEXP *=*+1
00153  00B9              ARGHO  *=*+1






bassrc......PAGE 0004

LINE# LOC   CODE        LINE


00154  00BA              ARGMOH *=*+1
00155  00BB              ARGMO  *=*+1
00156  00BC              ARGLO  *=*+1
00157  00BD              ARGSGN *=*+1
00158  00BE              STRNG1
00159  00BE              ARISGN *=*+1
00160  00BF              FACOV  *=*+1
00161  00C0              BUFPTR
00162  00C0              STRNG2
00163  00C0              POLYPT
00164  00C0              CURTOL
00165  00C0              FBUFPT *=*+2
00166  00C2              CHRGET *=*+6
00167  00C8              CHRGOT *=*+1
00168  00C9              TXTPTR *=*+6
00169  00CF              QNUM   *=*+10
00170  00D9              CHRRTS *=*+1
00171  00DA              RNDX   *=*+5





00173  00DF                     * =$FF
00174  00FF              LOFBUF *=*+1
00175  0100              FBUFFR *=*+1
00176  0101              .FIL   TOKENS





00178  0101              ;STATEMENT DISPATCH TABLE
00179  0101                     * =ROMLOC



























bassrc......PAGE 0005

LINE# LOC   CODE        LINE


00181  C000  1D C7       STMDSP .WOR END-1
00182  C002  48 C6              .WOR FOR-1
00183  C004  35 CC              .WOR NEXT-1
00184  C006  EF C7              .WOR DATA-1
00185  C008  C5 CA              .WOR INPUTN-1
00186  C00A  DF CA              .WOR INPUT-1
00187  C00C  70 CF              .WOR DIM-1
00188  C00E  23 CB              .WOR READ-1
00189  C010  9C C8              .WOR LET-1
00190  C012  9C C7              .WOR GOTO-1
00191  C014  74 C7              .WOR RUN-1
00192  C016  1F C8              .WOR IF-1
00193  C018  0C C7              .WOR RESTOR-1
00194  C01A  7F C7              .WOR GOSUB-1
00195  C01C  C9 C7              .WOR RETURN-1
00196  C01E  32 C8              .WOR REM-1
00197  C020  1B C7              .WOR STOP-1
00198  C022  42 C8              .WOR ONGOTO-1
00199  C024  01 D7              .WOR FNWAIT-1
00200  C026  D4 FF              .WOR CLOAD-1
00201  C028  D7 FF              .WOR CSAVE-1
00202  C02A  DA FF              .WOR CVERF-1
00203  C02C  94 D2              .WOR DEF-1
00204  C02E  F8 D6              .WOR POKE-1
00205  C030  7E C9              .WOR PRINTN-1
00206  C032  9E C9              .WOR PRINT-1
00207  C034  44 C7              .WOR CONT-1
00208  C036  A7 C5              .WOR LIST-1
00209  C038  6F C7              .WOR CLEAR-1
00210  C03A  84 C9              .WOR CMD-1
00211  C03C  DD FF              .WOR CSYS-1
00212  C03E  BF FF              .WOR COPEN-1
00213  C040  C2 FF              .WOR CCLOS-1
00214  C042  9E CA              .WOR GET-1
00215  C044  50 C5              .WOR SCRATH-1
00216  C046  0B DB       FUNDSP .WOR SGN
00217  C048  9E DB              .WOR INT
00218  C04A  2A DB              .WOR ABS
00219  C04C  00 00       USRLOC .WOR USRPOK
00220  C04E  64 D2              .WOR FRE
00221  C050  85 D2              .WOR POS
00222  C052  24 DE              .WOR SQR
00223  C054  45 DF              .WOR RND
00224  C056  BF D8              .WOR LOG
00225  C058  A0 DE              .WOR EXP
00226  C05A  9E DF              .WOR COS
00227  C05C  A5 DF              .WOR SIN
00228  C05E  EE DF              .WOR TAN
00229  C060  48 E0              .WOR ATN
00230  C062  E6 D6              .WOR PEEK
00231  C064  54 D6              .WOR LEN
00232  C066  49 D3              .WOR STRD
00233  C068  85 D6              .WOR VAL
00234  C06A  63 D6              .WOR ASC
00235  C06C  C4 D5              .WOR CHRD






bassrc......PAGE 0006

LINE# LOC   CODE        LINE


00236  C06E  D8 D5              .WOR LEFTD
00237  C070  04 D6              .WOR RIGHTD
00238  C072  0F D6              .WOR MIDD
00239  C074  79          OPTAB  .BYT 121
00240  C075  3E D7              .WOR FADDT-1
00241  C077  79                 .BYT 121
00242  C078  27 D7              .WOR FSUBT-1
00243  C07A  7B                 .BYT 123
00244  C07B  FF D8              .WOR FMULTT-1
00245  C07D  7B                 .BYT 123
00246  C07E  E3 D9              .WOR FDIVT-1
00247  C080  7F                 .BYT 127
00248  C081  2D DE              .WOR FPWRT-1
00249  C083  50                 .BYT 80
00250  C084  D8 CE              .WOR ANDOP-1
00251  C086  46                 .BYT 70
00252  C087  D5 CE              .WOR OROP-1
00253  C089  7D          NEGTAB .BYT 125
00254  C08A  66 DE              .WOR NEGOP-1
00255  C08C  5A          NOTTAB .BYT 90
00256  C08D  E7 CD              .WOR NOTOP-1
00257  C08F  64          PTDORL .BYT 100
00258  C090  05 CF              .WOR DOREL-1





00260  C092              ;RESERVED WORD LIST

00262  C092  45 4E       RESLST .BYT 'EN',$C4
00262  C094  C4 
00263  C095              ENDTK  =@200
00264  C095  46 4F              .BYT 'FO',$D2
00264  C097  D2 
00265  C098              FORTK  =@201
00266  C098  4E 45 58           .BYT 'NEX',$D4
00266  C09B  D4 
00267  C09C  44 41 54           .BYT 'DAT',$C1
00267  C09F  C1 
00268  C0A0              DATATK =@203
00269  C0A0  49 4E              .BYT 'INPUT',$A3
00269  C0A5  A3 
00270  C0A6  49 4E              .BYT 'INPU',$D4
00270  C0AA  D4 
00271  C0AB  44 49              .BYT 'DI',$CD
00271  C0AD  CD 
00272  C0AE  52 45 41           .BYT 'REA',$C4
00272  C0B1  C4 
00273  C0B2  4C 45              .BYT 'LE',$D4
00273  C0B4  D4 
00274  C0B5  47 4F 54           .BYT 'GOT',$CF
00274  C0B8  CF 
00275  C0B9              GOTOTK =@211
00276  C0B9  52 55              .BYT 'RU',$CE






bassrc......PAGE 0007

LINE# LOC   CODE        LINE


00276  C0BB  CE 
00277  C0BC  49                 .BYT 'I',$C6
00277  C0BD  C6 
00278  C0BE  52 45              .BYT 'RESTOR',$C5
00278  C0C4  C5 
00279  C0C5  47 4F              .BYT 'GOSU',$C2
00279  C0C9  C2 
00280  C0CA              GOSUTK =@215
00281  C0CA  52 45              .BYT 'RETUR',$CE
00281  C0CF  CE 
00282  C0D0  52 45              .BYT 'RE',$CD
00282  C0D2  CD 
00283  C0D3              REMTK  =@217
00284  C0D3  53 54 4F           .BYT 'STO',$D0
00284  C0D6  D0 
00285  C0D7  4F                 .BYT 'O',$CE
00285  C0D8  CE 
00286  C0D9  57 41 49           .BYT 'WAI',$D4
00286  C0DC  D4 
00287  C0DD  4C 4F 41           .BYT 'LOA',$C4
00287  C0E0  C4 
00288  C0E1  53 41 56           .BYT 'SAV',$C5
00288  C0E4  C5 
00289  C0E5  56 45              .BYT 'VERIF',$D9
00289  C0EA  D9 
00290  C0EB  44 45              .BYT 'DE',$C6
00290  C0ED  C6 
00291  C0EE  50 4F 4B           .BYT 'POK',$C5
00291  C0F1  C5 
00292  C0F2  50 52              .BYT 'PRINT',$A3
00292  C0F7  A3 
00293  C0F8  50 52              .BYT 'PRIN',$D4
00293  C0FC  D4 
00294  C0FD              PRINTK =@231
00295  C0FD  43 4F 4E           .BYT 'CON',$D4
00295  C100  D4 
00296  C101  4C 49 53           .BYT 'LIS',$D4
00296  C104  D4 
00297  C105  43 4C              .BYT 'CL',$D2
00297  C107  D2 
00298  C108  43 4D              .BYT 'CM',$C4
00298  C10A  C4 
00299  C10B  53 59              .BYT 'SY',$D3
00299  C10D  D3 
00300  C10E  4F 50 45           .BYT 'OPE',$CE
00300  C111  CE 
00301  C112  43 4C              .BYT 'CLOS',$C5
00301  C116  C5 
00302  C117  47 45              .BYT 'GE',$D4
00302  C119  D4 
00303  C11A  4E 45              .BYT 'NE',$D7
00303  C11C  D7 
00304  C11D              SCRATK =@242
00305  C11D              .FIL   TOKEN2
00306  C11D              ;TOKEN2






bassrc......PAGE 0008

LINE# LOC   CODE        LINE


00307  C11D  54 41 42           .BYT 'TAB',$A8
00307  C120  A8 
00308  C121              TABTK  =@243
00309  C121  54                 .BYT 'T',$CF
00309  C122  CF 
00310  C123              TOTK   =@244
00311  C123  46                 .BYT 'F',$CE
00311  C124  CE 
00312  C125              FNTK   =@245
00313  C125  53 50 43           .BYT 'SPC',$A8
00313  C128  A8 
00314  C129              SPCTK  =@246
00315  C129  54 48 45           .BYT 'THE',$CE
00315  C12C  CE 
00316  C12D              THENTK =@247
00317  C12D  4E 4F              .BYT 'NO',$D4
00317  C12F  D4 
00318  C130              NOTTK  =@250
00319  C130  53 54 45           .BYT 'STE',$D0
00319  C133  D0 
00320  C134              STEPTK =@251
00321  C134  AB                 .BYT $AB
00322  C135              PLUSTK =@252
00323  C135  AD                 .BYT $AD
00324  C136              MINUTK =@253
00325  C136  AA                 .BYT $AA
00326  C137  AF                 .BYT $AF
00327  C138  DE                 .BYT $DE
00328  C139  41 4E              .BYT 'AN',$C4
00328  C13B  C4 
00329  C13C  4F                 .BYT 'O',$D2
00329  C13D  D2 
00330  C13E  BE                 .BYT 190
00331  C13F              GREATK =@261
00332  C13F  BD                 .BYT $BD
00333  C140              EQULTK =@262
00334  C140  BC                 .BYT 188
00335  C141              LESSTK =@263
00336  C141  53 47              .BYT 'SG',$CE
00336  C143  CE 
00337  C144              ONEFUN =@264
00338  C144  49 4E              .BYT 'IN',$D4
00338  C146  D4 
00339  C147  41 42              .BYT 'AB',$D3
00339  C149  D3 
00340  C14A  55 53              .BYT 'US',$D2
00340  C14C  D2 
00341  C14D  46 52              .BYT 'FR',$C5
00341  C14F  C5 
00342  C150  50 4F              .BYT 'PO',$D3
00342  C152  D3 
00343  C153  53 51              .BYT 'SQ',$D2
00343  C155  D2 
00344  C156  52 4E              .BYT 'RN',$C4
00344  C158  C4 






bassrc......PAGE 0009

LINE# LOC   CODE        LINE


00345  C159  4C 4F              .BYT 'LO',$C7
00345  C15B  C7 
00346  C15C  45 58              .BYT 'EX',$D0
00346  C15E  D0 
00347  C15F  43 4F              .BYT 'CO',$D3
00347  C161  D3 
00348  C162  53 49              .BYT 'SI',$CE
00348  C164  CE 
00349  C165  54 41              .BYT 'TA',$CE
00349  C167  CE 
00350  C168  41 54              .BYT 'AT',$CE
00350  C16A  CE 
00351  C16B  50 45 45           .BYT 'PEE',$CB
00351  C16E  CB 
00352  C16F  4C 45              .BYT 'LE',$CE
00352  C171  CE 
00353  C172  53 54 52           .BYT 'STR',$A4
00353  C175  A4 
00354  C176  56 41              .BYT 'VA',$CC
00354  C178  CC 
00355  C179  41 53              .BYT 'AS',$C3
00355  C17B  C3 
00356  C17C  43 48 52           .BYT 'CHR',$A4
00356  C17F  A4 
00357  C180              LASNUM =@307
00358  C180  4C 45              .BYT 'LEFT',$A4
00358  C184  A4 
00359  C185  52 49              .BYT 'RIGHT',$A4
00359  C18A  A4 
00360  C18B  4D 49 44           .BYT 'MID',$A4
00360  C18E  A4 
00361  C18F  00                 .BYT 0

00363  C190              ;BASIC ERROR MESSAGES

00365  C190  4E 45       ERRTAB .BYT 'NEXT WITHOUT FO',$D2
00365  C19F  D2 
00366  C1A0              ERRNF  =@0
00367  C1A0  53 59              .BYT 'SYNTA',$D8
00367  C1A5  D8 
00368  C1A6              ERRSN  =@20
00369  C1A6  52 45              .BYT 'RETURN WITHOUT GOSU',$C2
00369  C1B9  C2 
00370  C1BA              ERRRG  =@26
00371  C1BA  4F 55              .BYT 'OUT OF DAT',$C1
00371  C1C4  C1 
00372  C1C5              ERROD  =@52
00373  C1C5  49 4C              .BYT 'ILLEGAL QUANTIT',$D9
00373  C1D4  D9 
00374  C1D5              ERRFC  =@65
00375  C1D5  00                 .BYT 0,0,0,0,0
00375  C1D6  00 
00375  C1D7  00 
00375  C1D8  00 
00375  C1D9  00 






bassrc......PAGE 000A

LINE# LOC   CODE        LINE


00376  C1DA  4F 56              .BYT 'OVERFLO',$D7
00376  C1E1  D7 
00377  C1E2              ERROV  =@112
00378  C1E2  4F 55              .BYT 'OUT OF MEMOR',$D9
00378  C1EE  D9 
00379  C1EF              ERROM  =@122
00380  C1EF  55 4E              .BYT 'UNDEF',$27
00380  C1F4  27 
00381  C1F5  44 20              .BYT 'D STATEMEN',$D4
00381  C1FF  D4 
00382  C200              ERRUS  =@137
00383  C200  42 41              .BYT 'BAD SUBSCRIP',$D4
00383  C20C  D4 
00384  C20D              ERRBS  =@160
00385  C20D  52 45              .BYT 'REDIM',$27,'D ARRA',$D9
00385  C212  27 
00385  C213  44 20 
00385  C219  D9 
00386  C21A              ERRDD  =@175
00387  C21A  44 49              .BYT 'DIVISION BY ZER',$CF
00387  C229  CF 
00388  C22A              ERRDVO =@212
00389  C22A  49 4C              .BYT 'ILLEGAL DIREC',$D4
00389  C237  D4 
00390  C238              ERRID  =@232
00391  C238  54 59              .BYT 'TYPE MISMATC',$C8
00391  C244  C8 
00392  C245              ERRTM  =@250
00393  C245  53 54              .BYT 'STRING TOO LON',$C7
00393  C253  C7 
00394  C254              ERRLS  =@265
00395  C254  42 41              .BYT 'BAD DAT',$C1
00395  C25B  C1 
00396  C25C              ERRBD  =@304
00397  C25C  46 4F              .BYT 'FORMULA TOO COMPLE',$D8
00397  C26E  D8 
00398  C26F              ERRST  =@314
00399  C26F  43 41 4E           .BYT 'CAN',$27,'T CONTINU',$C5
00399  C272  27 
00399  C273  54 20 
00399  C27C  C5 
00400  C27D              ERRCN  =@337
00401  C27D  55 4E              .BYT 'UNDEF',$27,'D FUNCTIO',$CE
00401  C282  27 
00401  C283  44 20 
00401  C28C  CE 
00402  C28D              ERRUF  =@355
00403  C28D  20 45       ERR    .BYT ' ERROR',0
00403  C293  00 
00404  C294  20 49       INTXT  .BYT ' IN ',0
00404  C298  00 
00405  C299  0D          REDDY  .BYT $D,$A,'READY.',$D,$A,0
00405  C29A  0A 
00405  C29B  52 45 
00405  C2A1  0D 






bassrc......PAGE 000B

LINE# LOC   CODE        LINE


00405  C2A2  0A 
00405  C2A3  00 
00406  C2A4  0D          BRKTXT .BYT $D,$A,'BREAK',0
00406  C2A5  0A 
00406  C2A6  42 52 
00406  C2AB  00 























































PET BASIC......PAGE 000C

LINE# LOC   CODE        LINE


00408  C2AC              ;START OF INTERPRETER CODE
00409  C2AC  BA          FNDFOR TSX
00410  C2AD  E8                 INX
00411  C2AE  E8                 INX
00412  C2AF  E8                 INX
00413  C2B0  E8                 INX
00414  C2B1  BD 01 01    FFLOOP LDA 257,X
00415  C2B4  C9 81              CMP #FORTK
00416  C2B6  D0 21              BNE FFRTS
00417  C2B8  A5 99              LDA FORPNT+1
00418  C2BA  D0 0A              BNE CMPFOR
00419  C2BC  BD 02 01           LDA 258,X
00420  C2BF  85 98              STA FORPNT
00421  C2C1  BD 03 01           LDA 259,X
00422  C2C4  85 99              STA FORPNT+1
00423  C2C6  DD 03 01    CMPFOR CMP 259,X
00424  C2C9  D0 07              BNE ADDFRS
00425  C2CB  A5 98              LDA FORPNT
00426  C2CD  DD 02 01           CMP 258,X
00427  C2D0  F0 07              BEQ FFRTS
00428  C2D2  8A          ADDFRS TXA
00429  C2D3  18                 CLC
00430  C2D4  69 12              ADC #FORSIZ
00431  C2D6  AA                 TAX
00432  C2D7  D0 D8              BNE FFLOOP
00433  C2D9  60          FFRTS  RTS
00434  C2DA  20 2A C3    BLTU   JSR REASON
00435  C2DD  85 80              STA STREND
00436  C2DF  84 81              STY STREND+1
00437  C2E1  38          BLTUC  SEC
00438  C2E2  A5 A9              LDA HIGHTR
00439  C2E4  E5 AE              SBC LOWTR
00440  C2E6  85 71              STA INDEX
00441  C2E8  A8                 TAY
00442  C2E9  A5 AA              LDA HIGHTR+1
00443  C2EB  E5 AF              SBC LOWTR+1
00444  C2ED  AA                 TAX
00445  C2EE  E8                 INX
00446  C2EF  98                 TYA
00447  C2F0  F0 23              BEQ DECBLT
00448  C2F2  A5 A9              LDA HIGHTR
00449  C2F4  38                 SEC
00450  C2F5  E5 71              SBC INDEX
00451  C2F7  85 A9              STA HIGHTR
00452  C2F9  B0 03              BCS BLT1
00453  C2FB  C6 AA              DEC HIGHTR+1
00454  C2FD  38                 SEC
00455  C2FE  A5 A7       BLT1   LDA HIGHDS
00456  C300  E5 71              SBC INDEX
00457  C302  85 A7              STA HIGHDS
00458  C304  B0 08              BCS MOREN1
00459  C306  C6 A8              DEC HIGHDS+1
00460  C308  90 04              BCC MOREN1
00461  C30A  B1 A9       BLTLP  LDA (HIGHTR)Y
00462  C30C  91 A7              STA (HIGHDS)Y






PET BASIC......PAGE 000D

LINE# LOC   CODE        LINE


00463  C30E  88          MOREN1 DEY
00464  C30F  D0 F9              BNE BLTLP
00465  C311  B1 A9              LDA (HIGHTR),Y
00466  C313  91 A7              STA (HIGHDS),Y
00467  C315  C6 AA       DECBLT DEC HIGHTR+1
00468  C317  C6 A8              DEC HIGHDS+1
00469  C319  CA                 DEX
00470  C31A  D0 F2              BNE MOREN1
00471  C31C  60                 RTS
00472  C31D  0A          GETSTK ASL A
00473  C31E  69 36              ADC #NUMLEV+NUMLEV+8
00474  C320  B0 35              BCS OMERR
00475  C322  85 71              STA INDEX
00476  C324  BA                 TSX
00477  C325  E4 71              CPX INDEX
00478  C327  90 2E              BCC OMERR
00479  C329  60                 RTS
00480  C32A  C4 83       REASON CPY FRETOP+1
00481  C32C  90 28              BCC REARTS
00482  C32E  D0 04              BNE TRYMOR
00483  C330  C5 82              CMP FRETOP
00484  C332  90 22              BCC REARTS
00485  C334  48          TRYMOR PHA
00486  C335  A2 09              LDX #8+ADDPRC
00487  C337  98                 TYA
00488  C338  48          REASAV PHA
00489  C339  B5 A6              LDA HIGHDS-1,X
00490  C33B  CA                 DEX
00491  C33C  10 FA              BPL REASAV
00492  C33E  20 04 D4           JSR GARBA2
00493  C341  A2 F7              LDX #248-ADDPRC
00494  C343  68          REASTO PLA
00495  C344  95 B0              STA HIGHDS+8+ADDPRC,X
00496  C346  E8                 INX
00497  C347  30 FA              BMI REASTO
00498  C349  68                 PLA
00499  C34A  A8                 TAY
00500  C34B  68                 PLA
00501  C34C  C4 83              CPY FRETOP+1
00502  C34E  90 06              BCC REARTS
00503  C350  D0 05              BNE OMERR
00504  C352  C5 82              CMP FRETOP
00505  C354  B0 01              BCS OMERR
00506  C356  60          REARTS RTS
00507  C357              .FIL   CODE1
00508  C357              ;*****CODE1*****
00509  C357  A2 52       OMERR  LDX #ERROM



00511  C359  46 64       ERROR  LSR CNTWFL
00512  C35B  A5 03              LDA CHANNL
00513  C35D  F0 07              BEQ ERRCRD
00514  C35F  20 CC FF           JSR CLSCHN
00515  C362  A9 00              LDA #0






PET BASIC......PAGE 000E

LINE# LOC   CODE        LINE


00516  C364  85 03              STA CHANNL
00517  C366  20 D2 C9    ERRCRD JSR CRDO
00518  C369  20 47 CA           JSR OUTQST
00519  C36C  BD 90 C1    GETERR LDA ERRTAB,X
00520  C36F  48                 PHA
00521  C370  29 7F              AND #127
00522  C372  20 49 CA           JSR OUTDO
00523  C375  E8                 INX
00524  C376  68                 PLA
00525  C377  10 F3              BPL GETERR
00526  C379  20 84 C5    TYPERR JSR STKINI
00527  C37C  A9 8D              LDA #<ERR
00528  C37E  A0 C2              LDY #>ERR
00529  C380  20 27 CA    ERRFIN JSR STROUT
00530  C383  A4 89              LDY CURLIN+1
00531  C385  C8                 INY
00532  C386  F0 03              BEQ READY
00533  C388  20 94 DC           JSR INPRT



00535  C38B  46 64       READY  LSR CNTWFL
00536  C38D  A9 99              LDA #<REDDY
00537  C38F  A0 C2              LDY #>REDDY
00538  C391  20 27 CA           JSR STROUT



00540  C394  20 68 C4    MAIN   JSR INLIN
00541  C397  86 C9              STX TXTPTR
00542  C399  84 CA              STY TXTPTR+1
00543  C39B  20 C2 00           JSR CHRGET
00544  C39E  F0 F4              BEQ MAIN
00545  C3A0  A2 FF              LDX #255
00546  C3A2  86 89              STX CURLIN+1
00547  C3A4  90 06              BCC MAIN1
00548  C3A6  20 8D C4           JSR CRUNCH
00549  C3A9  4C E9 C6           JMP GONE
00550  C3AC  20 63 C8    MAIN1  JSR LINGET
00551  C3AF  20 8D C4           JSR CRUNCH
00552  C3B2  84 5C              STY COUNT
00553  C3B4  20 22 C5           JSR FNDLIN
00554  C3B7  90 44              BCC NODEL
00555  C3B9  A0 01              LDY #1
00556  C3BB  B1 AE              LDA (LOWTR)Y
00557  C3BD  85 72              STA INDEX1+1
00558  C3BF  A5 7C              LDA VARTAB
00559  C3C1  85 71              STA INDEX1
00560  C3C3  A5 AF              LDA LOWTR+1
00561  C3C5  85 74              STA INDEX2+1
00562  C3C7  A5 AE              LDA LOWTR
00563  C3C9  88                 DEY
00564  C3CA  F1 AE              SBC (LOWTR)Y
00565  C3CC  18                 CLC
00566  C3CD  65 7C              ADC VARTAB






PET BASIC......PAGE 000F

LINE# LOC   CODE        LINE


00567  C3CF  85 7C              STA VARTAB
00568  C3D1  85 73              STA INDEX2
00569  C3D3  A5 7D              LDA VARTAB+1
00570  C3D5  69 FF              ADC #255
00571  C3D7  85 7D              STA VARTAB+1
00572  C3D9  E5 AF              SBC LOWTR+1
00573  C3DB  AA                 TAX
00574  C3DC  38                 SEC
00575  C3DD  A5 AE              LDA LOWTR
00576  C3DF  E5 7C              SBC VARTAB
00577  C3E1  A8                 TAY
00578  C3E2  B0 03              BCS QDECT1
00579  C3E4  E8                 INX
00580  C3E5  C6 74              DEC INDEX2+1
00581  C3E7  18          QDECT1 CLC
00582  C3E8  65 71              ADC INDEX1
00583  C3EA  90 03              BCC MLOOP
00584  C3EC  C6 72              DEC INDEX1+1
00585  C3EE  18                 CLC
00586  C3EF  B1 71       MLOOP  LDA (INDEX1)Y
00587  C3F1  91 73              STA (INDEX2)Y
00588  C3F3  C8                 INY
00589  C3F4  D0 F9              BNE MLOOP
00590  C3F6  E6 72              INC INDEX1+1
00591  C3F8  E6 74              INC INDEX2+1
00592  C3FA  CA                 DEX
00593  C3FB  D0 F2              BNE MLOOP
00594  C3FD  A5 0A       NODEL  LDA BUF
00595  C3FF  F0 2F              BEQ FINI
00596  C401  A5 86              LDA MEMSIZ
00597  C403  A4 87              LDY MEMSIZ+1
00598  C405  85 82              STA FRETOP
00599  C407  84 83              STY FRETOP+1
00600  C409  A5 7C              LDA VARTAB
00601  C40B  85 A9              STA HIGHTR
00602  C40D  65 5C              ADC COUNT
00603  C40F  85 A7              STA HIGHDS
00604  C411  A4 7D              LDY VARTAB+1
00605  C413  84 AA              STY HIGHTR+1
00606  C415  90 01              BCC NODELC
00607  C417  C8                 INY
00608  C418  84 A8       NODELC STY HIGHDS+1
00609  C41A  20 DA C2           JSR BLTU
00610  C41D  A5 80              LDA STREND
00611  C41F  A4 81              LDY STREND+1
00612  C421  85 7C              STA VARTAB
00613  C423  84 7D              STY VARTAB+1
00614  C425  A4 5C              LDY COUNT
00615  C427  88                 DEY
00616  C428  B9 06 00    STOLOP LDA BUF-4,Y
00617  C42B  91 AE              STA (LOWTR)Y
00618  C42D  88                 DEY
00619  C42E  10 F8              BPL STOLOP
00620  C430  20 67 C5    FINI   JSR RUNC
00621  C433  A5 7A       LNKPRG LDA TXTTAB






PET BASIC......PAGE 0010

LINE# LOC   CODE        LINE


00622  C435  A4 7B              LDY TXTTAB+1
00623  C437  85 71              STA INDEX
00624  C439  84 72              STY INDEX+1
00625  C43B  18                 CLC
00626  C43C  A0 01       CHEAD  LDY #1
00627  C43E  B1 71              LDA (INDEX)Y
00628  C440  D0 03              BNE *+5
00629  C442  4C 94 C3           JMP MAIN
00630  C445  A0 04              LDY #4
00631  C447  C8          CZLOOP INY
00632  C448  B1 71              LDA (INDEX)Y
00633  C44A  D0 FB              BNE CZLOOP
00634  C44C  C8                 INY
00635  C44D  98                 TYA
00636  C44E  65 71              ADC INDEX
00637  C450  AA                 TAX
00638  C451  A0 00              LDY #0
00639  C453  91 71              STA (INDEX)Y
00640  C455  A5 72              LDA INDEX+1
00641  C457  69 00              ADC #0
00642  C459  C8                 INY
00643  C45A  91 71              STA (INDEX)Y
00644  C45C  86 71              STX INDEX
00645  C45E  85 72              STA INDEX+1
00646  C460  90 DA              BCC CHEAD
00647  C462  CA          LINLIN DEX
00648  C463  10 05              BPL INLINC
00649  C465  20 D2 C9    INLINN JSR CRDO
00650  C468  A2 00       INLIN  LDX #0
00651  C46A  20 79 C4    INLINC JSR INCHR
00652  C46D  C9 0D              CMP #13
00653  C46F  F0 05              BEQ FININ1
00654  C471  95 0A              STA BUF,X
00655  C473  E8                 INX
00656  C474  D0 F4              BNE INLINC
00657  C476  4C C8 C9    FININ1 JMP FININL
00658  C479  20 CF FF    INCHR  JSR CINCH
00659  C47C  A4 03              LDY CHANNL
00660  C47E  D0 0C              BNE INCRTS
00661  C480  C9 0F              CMP #$0F
00662  C482  D0 08              BNE INCRTS
00663  C484  48                 PHA
00664  C485  A5 64              LDA CNTWFL
00665  C487  49 FF              EOR #$FF
00666  C489  85 64              STA CNTWFL
00667  C48B  68                 PLA
00668  C48C  60          INCRTS RTS
00669  C48D              .FIL   CODE2
00670  C48D              ;*****CODE2*****
00671  C48D              BUFOFS =0
00672  C48D  A6 C9       CRUNCH LDX TXTPTR
00673  C48F  A0 04              LDY #4
00674  C491  84 60              STY DORES
00675  C493  B5 00       KLOOP  LDA BUFOFS,X
00676  C495  10 07              BPL CMPSPC






PET BASIC......PAGE 0011

LINE# LOC   CODE        LINE


00677  C497  C9 FF              CMP #PI
00678  C499  F0 41              BEQ STUFFH
00679  C49B  E8                 INX
00680  C49C  D0 F5              BNE KLOOP
00681  C49E  C9 20       CMPSPC CMP #' 
00682  C4A0  F0 3A              BEQ STUFFH
00683  C4A2  85 5B              STA ENDCHR
00684  C4A4  C9 22              CMP #34
00685  C4A6  F0 58              BEQ STRNG
00686  C4A8  24 60              BIT DORES
00687  C4AA  70 30              BVS STUFFH
00688  C4AC  C9 3F              CMP #'?
00689  C4AE  D0 04              BNE KLOOP1
00690  C4B0  A9 99              LDA #PRINTK
00691  C4B2  D0 28              BNE STUFFH
00692  C4B4  C9 30       KLOOP1 CMP #'0
00693  C4B6  90 04              BCC MUSTCR
00694  C4B8  C9 3C              CMP #60
00695  C4BA  90 20              BCC STUFFH
00696  C4BC  84 C0       MUSTCR STY BUFPTR
00697  C4BE  A0 00              LDY #0
00698  C4C0  84 5C              STY COUNT
00699  C4C2  88                 DEY
00700  C4C3  86 C9              STX TXTPTR
00701  C4C5  CA                 DEX
00702  C4C6  C8          RESER  INY
00703  C4C7  E8          RESPUL INX
00704  C4C8  B5 00       RESCON LDA BUFOFS,X
00705  C4CA  C9 20              CMP #' 
00706  C4CC  F0 F9              BEQ RESPUL
00707  C4CE  38                 SEC
00708  C4CF  F9 92 C0           SBC RESLST,Y
00709  C4D2  F0 F2              BEQ RESER
00710  C4D4  C9 80              CMP #128
00711  C4D6  D0 2F              BNE NTHIS
00712  C4D8  05 5C              ORA COUNT
00713  C4DA  A4 C0       GETBPT LDY BUFPTR
00714  C4DC  E8          STUFFH INX
00715  C4DD  C8                 INY
00716  C4DE  99 05 00           STA BUF-5,Y
00717  C4E1  B9 05 00           LDA BUF-5,Y
00718  C4E4  F0 34              BEQ CRDONE
00719  C4E6  38                 SEC
00720  C4E7  E9 3A              SBC #':
00721  C4E9  F0 04              BEQ COLIS
00722  C4EB  C9 49              CMP #DATATK-$3A
00723  C4ED  D0 02              BNE NODATT
00724  C4EF  85 60       COLIS  STA DORES
00725  C4F1  38          NODATT SEC
00726  C4F2  E9 55              SBC #REMTK-$3A
00727  C4F4  D0 9D              BNE KLOOP
00728  C4F6  85 5B              STA ENDCHR
00729  C4F8  B5 00       STR1   LDA BUFOFS,X
00730  C4FA  F0 E0              BEQ STUFFH
00731  C4FC  C5 5B              CMP ENDCHR






PET BASIC......PAGE 0012

LINE# LOC   CODE        LINE


00732  C4FE  F0 DC              BEQ STUFFH
00733  C500  C8          STRNG  INY
00734  C501  99 05 00           STA BUF-5,Y
00735  C504  E8                 INX
00736  C505  D0 F1              BNE STR1
00737  C507  A6 C9       NTHIS  LDX TXTPTR
00738  C509  E6 5C              INC COUNT



00740  C50B              ;LOOK FOR END OF RESERVED WORD
00741  C50B  C8          NTHIS1 INY
00742  C50C  B9 91 C0           LDA RESLST-1,Y
00743  C50F  10 FA              BPL NTHIS1



00745  C511              ;LOOK FOR END OF RESLST
00746  C511  B9 92 C0           LDA RESLST,Y
00747  C514  D0 B2              BNE RESCON
00748  C516  B5 00              LDA BUFOFS,X
00749  C518  10 C0              BPL GETBPT



00751  C51A  99 07 00    CRDONE STA BUF-3,Y
00752  C51D              ZZ1    =BUF-1
00753  C51D  A9 09              LDA #<ZZ1
00754  C51F  85 C9              STA TXTPTR
00755  C521  60                 RTS
00756  C522  A5 7A       FNDLIN LDA TXTTAB
00757  C524  A6 7B              LDX TXTTAB+1
00758  C526  A0 01       FNDLNC LDY #1
00759  C528  85 AE              STA LOWTR
00760  C52A  86 AF              STX LOWTR+1
00761  C52C  B1 AE              LDA (LOWTR)Y
00762  C52E  F0 1F              BEQ FLINRT
00763  C530  C8                 INY
00764  C531  C8                 INY
00765  C532  A5 09              LDA LINNUM+1
00766  C534  D1 AE              CMP (LOWTR)Y
00767  C536  90 18              BCC FLNRTS
00768  C538  F0 03              BEQ FNDLO1
00769  C53A  88                 DEY
00770  C53B  D0 09              BNE AFFRTS
00771  C53D  A5 08       FNDLO1 LDA LINNUM
00772  C53F  88                 DEY
00773  C540  D1 AE              CMP (LOWTR)Y
00774  C542  90 0C              BCC FLNRTS
00775  C544  F0 0A              BEQ FLNRTS
00776  C546  88          AFFRTS DEY
00777  C547  B1 AE              LDA (LOWTR)Y
00778  C549  AA                 TAX
00779  C54A  88                 DEY
00780  C54B  B1 AE              LDA (LOWTR)Y






PET BASIC......PAGE 0013

LINE# LOC   CODE        LINE


00781  C54D  B0 D7              BCS FNDLNC
00782  C54F  18          FLINRT CLC
00783  C550  60          FLNRTS RTS
00784  C551  D0 FD       SCRATH BNE FLNRTS
00785  C553  A9 00       SCRTCH LDA #0
00786  C555  A8                 TAY
00787  C556  91 7A              STA (TXTTAB)Y
00788  C558  C8                 INY
00789  C559  91 7A              STA (TXTTAB)Y
00790  C55B  A5 7A              LDA TXTTAB
00791  C55D  69 02              ADC #2
00792  C55F  85 7C              STA VARTAB
00793  C561  A5 7B              LDA TXTTAB+1
00794  C563  69 00              ADC #0
00795  C565  85 7D              STA VARTAB+1
00796  C567  20 9A C5    RUNC   JSR STXTPT
00797  C56A  A5 86       CLEARC LDA MEMSIZ
00798  C56C  A4 87              LDY MEMSIZ+1
00799  C56E  85 82              STA FRETOP
00800  C570  84 83              STY FRETOP+1
00801  C572  20 E7 FF           JSR CCALL
00802  C575  A5 7C              LDA VARTAB
00803  C577  A4 7D              LDY VARTAB+1
00804  C579  85 7E              STA ARYTAB
00805  C57B  84 7F              STY ARYTAB+1
00806  C57D  85 80              STA STREND
00807  C57F  84 81              STY STREND+1
00808  C581  20 0D C7    FLOAD  JSR RESTOR
00809  C584  A2 68       STKINI LDX #TEMPST
00810  C586  86 65              STX TEMPPT
00811  C588  68                 PLA
00812  C589  8D FD 01           STA STKEND-2
00813  C58C  68                 PLA
00814  C58D  8D FE 01           STA STKEND-1
00815  C590  A2 FC              LDX #STKEND-259
00816  C592  9A                 TXS
00817  C593  A9 00              LDA #0
00818  C595  85 8D              STA OLDTXT+1
00819  C597  85 61              STA SUBFLG
00820  C599  60          STKRTS RTS
00821  C59A  18          STXTPT CLC
00822  C59B  A5 7A              LDA TXTTAB
00823  C59D  69 FF              ADC #255
00824  C59F  85 C9              STA TXTPTR
00825  C5A1  A5 7B              LDA TXTTAB+1
00826  C5A3  69 FF              ADC #255
00827  C5A5  85 CA              STA TXTPTR+1
00828  C5A7  60                 RTS
00829  C5A8              .FIL   CODE3
00830  C5A8              ;*****CODE3*****
00831  C5A8  90 06       LIST   BCC GOLST
00832  C5AA  F0 04              BEQ GOLST
00833  C5AC  C9 AB              CMP #MINUTK
00834  C5AE  D0 E9              BNE STKRTS
00835  C5B0  20 63 C8    GOLST  JSR LINGET






PET BASIC......PAGE 0014

LINE# LOC   CODE        LINE


00836  C5B3  20 22 C5           JSR FNDLIN
00837  C5B6  20 C8 00           JSR CHRGOT
00838  C5B9  F0 0C              BEQ LSTEND
00839  C5BB  C9 AB              CMP #MINUTK
00840  C5BD  D0 91              BNE FLNRTS
00841  C5BF  20 C2 00           JSR CHRGET
00842  C5C2  20 63 C8           JSR LINGET
00843  C5C5  D0 89              BNE FLNRTS
00844  C5C7  68          LSTEND PLA
00845  C5C8  68                 PLA
00846  C5C9  A5 08              LDA LINNUM
00847  C5CB  05 09              ORA LINNUM+1
00848  C5CD  D0 06              BNE LIST4
00849  C5CF  A9 FF              LDA #255
00850  C5D1  85 08              STA LINNUM
00851  C5D3  85 09              STA LINNUM+1
00852  C5D5  A0 01       LIST4  LDY #1
00853  C5D7  84 60              STY DORES
00854  C5D9  B1 AE              LDA (LOWTR)Y
00855  C5DB  F0 41              BEQ GRODY
00856  C5DD  20 E1 FF           JSR ISCNTC
00857  C5E0  20 D2 C9           JSR CRDO
00858  C5E3  C8                 INY
00859  C5E4  B1 AE              LDA (LOWTR)Y
00860  C5E6  AA                 TAX
00861  C5E7  C8                 INY
00862  C5E8  B1 AE              LDA (LOWTR)Y
00863  C5EA  C5 09              CMP LINNUM+1
00864  C5EC  D0 04              BNE TSTDUN
00865  C5EE  E4 08              CPX LINNUM
00866  C5F0  F0 02              BEQ TYPLIN
00867  C5F2  B0 2A       TSTDUN BCS GRODY
00868  C5F4  84 98       TYPLIN STY LSTPNT
00869  C5F6  20 9F DC           JSR LINPRT
00870  C5F9  A9 20              LDA #' 
00871  C5FB  A4 98       PRIT4  LDY LSTPNT
00872  C5FD  29 7F              AND #127
00873  C5FF  20 49 CA    PLOOP  JSR OUTDO
00874  C602  C9 22              CMP #34
00875  C604  D0 06              BNE PLOOP1
00876  C606  A5 60              LDA DORES
00877  C608  49 FF              EOR #@377
00878  C60A  85 60              STA DORES
00879  C60C  C8          PLOOP1 INY
00880  C60D  B1 AE              LDA (LOWTR)Y
00881  C60F  D0 10              BNE QPLOP
00882  C611  A8                 TAY
00883  C612  B1 AE              LDA (LOWTR)Y
00884  C614  AA                 TAX
00885  C615  C8                 INY
00886  C616  B1 AE              LDA (LOWTR)Y
00887  C618  86 AE              STX LOWTR
00888  C61A  85 AF              STA LOWTR+1
00889  C61C  D0 B7              BNE LIST4
00890  C61E  4C 8B C3    GRODY  JMP READY






PET BASIC......PAGE 0015

LINE# LOC   CODE        LINE


00891  C621  10 DC       QPLOP  BPL PLOOP
00892  C623  C9 FF              CMP #PI
00893  C625  F0 D8              BEQ PLOOP
00894  C627  24 60              BIT DORES
00895  C629  30 D4              BMI PLOOP
00896  C62B  38                 SEC
00897  C62C  E9 7F              SBC #127
00898  C62E  AA                 TAX
00899  C62F  84 98              STY LSTPNT
00900  C631  A0 FF              LDY #255
00901  C633  CA          RESRCH DEX
00902  C634  F0 08              BEQ PRIT3
00903  C636  C8          RESCR1 INY
00904  C637  B9 92 C0           LDA RESLST,Y
00905  C63A  10 FA              BPL RESCR1
00906  C63C  30 F5              BMI RESRCH
00907  C63E  C8          PRIT3  INY
00908  C63F  B9 92 C0           LDA RESLST,Y
00909  C642  30 B7              BMI PRIT4
00910  C644  20 49 CA           JSR OUTDO
00911  C647  D0 F5              BNE PRIT3
00912  C649  A9 80       FOR    LDA #128
00913  C64B  85 61              STA SUBFLG
00914  C64D  20 9D C8           JSR LET
00915  C650  20 AC C2           JSR FNDFOR
00916  C653  D0 05              BNE NOTOL
00917  C655  8A                 TXA
00918  C656  69 0F              ADC #FORSIZ-3
00919  C658  AA                 TAX
00920  C659  9A                 TXS
00921  C65A  68          NOTOL  PLA
00922  C65B  68                 PLA
00923  C65C  A9 09              LDA #8+ADDPRC
00924  C65E  20 1D C3           JSR GETSTK
00925  C661  20 FE C7           JSR DATAN
00926  C664  18                 CLC
00927  C665  98                 TYA
00928  C666  65 C9              ADC TXTPTR
00929  C668  48                 PHA
00930  C669  A5 CA              LDA TXTPTR+1
00931  C66B  69 00              ADC #0
00932  C66D  48                 PHA
00933  C66E  A5 89              LDA CURLIN+1
00934  C670  48                 PHA
00935  C671  A5 88              LDA CURLIN
00936  C673  48                 PHA
00937  C674  A9 A4              LDA #TOTK
00938  C676  20 13 CE           JSR SYNCHR
00939  C679  20 A7 CC           JSR CHKNUM
00940  C67C  20 A4 CC           JSR FRMNUM
00941  C67F  A5 B5              LDA FACSGN
00942  C681  09 7F              ORA #127
00943  C683  25 B1              AND FACHO
00944  C685  85 B1              STA FACHO
00945  C687  A9 92              LDA #<LDFONE






PET BASIC......PAGE 0016

LINE# LOC   CODE        LINE


00946  C689  A0 C6              LDY #>LDFONE
00947  C68B  85 71              STA INDEX1
00948  C68D  84 72              STY INDEX1+1
00949  C68F  4C 5D CD           JMP FORPSH
00950  C692  A9 91       LDFONE LDA #<FONE
00951  C694  A0 D8              LDY #>FONE
00952  C696  20 74 DA           JSR MOVFM
00953  C699  20 C8 00           JSR CHRGOT
00954  C69C  C9 A9              CMP #STEPTK
00955  C69E  D0 06              BNE ONEON
00956  C6A0  20 C2 00           JSR CHRGET
00957  C6A3  20 A4 CC           JSR FRMNUM
00958  C6A6  20 FD DA    ONEON  JSR SIGN
00959  C6A9  20 52 CD           JSR PUSHF
00960  C6AC  A5 99              LDA FORPNT+1
00961  C6AE  48                 PHA
00962  C6AF  A5 98              LDA FORPNT
00963  C6B1  48                 PHA
00964  C6B2  A9 81              LDA #FORTK
00965  C6B4  48                 PHA
00966  C6B5              .FIL   CODE4








































CODE4......PAGE 0017

LINE# LOC   CODE        LINE


00968  C6B5  20 E1 FF    NEWSTT JSR ISCNTC
00969  C6B8  A5 C9              LDA TXTPTR
00970  C6BA  A4 CA              LDY TXTPTR+1
00971  C6BC  F0 06              BEQ DIRCON
00972  C6BE  85 8C              STA OLDTXT
00973  C6C0  84 8D              STY OLDTXT+1
00974  C6C2  A0 00              LDY #0
00975  C6C4  B1 C9       DIRCON LDA (TXTPTR)Y
00976  C6C6  F0 07              BEQ CKEOL
00977  C6C8  C9 3A       MORSTS CMP #':
00978  C6CA  F0 1D              BEQ GONE
00979  C6CC  4C 1C CE    SNERR1 JMP SNERR
00980  C6CF  A0 02       CKEOL  LDY #2
00981  C6D1  B1 C9              LDA (TXTPTR)Y
00982  C6D3  18                 CLC
00983  C6D4  F0 5F              BEQ ENDCON
00984  C6D6  C8                 INY
00985  C6D7  B1 C9              LDA (TXTPTR)Y
00986  C6D9  85 88              STA CURLIN
00987  C6DB  C8                 INY
00988  C6DC  B1 C9              LDA (TXTPTR)Y
00989  C6DE  85 89              STA CURLIN+1
00990  C6E0  98                 TYA
00991  C6E1  65 C9              ADC TXTPTR
00992  C6E3  85 C9              STA TXTPTR
00993  C6E5  90 02              BCC GONE
00994  C6E7  E6 CA              INC TXTPTR+1
00995  C6E9  20 C2 00    GONE   JSR CHRGET
00996  C6EC  20 F2 C6           JSR GONE3
00997  C6EF  4C B5 C6           JMP NEWSTT
00998  C6F2  F0 6A       GONE3  BEQ CONTRT
00999  C6F4  38                 SEC
01000  C6F5  E9 80       GONE2  SBC #ENDTK
01001  C6F7  B0 03              BCS *+5
01002  C6F9  4C 9D C8    GLET   JMP LET
01003  C6FC  C9 23              CMP #SCRATK-ENDTK+1
01004  C6FE  B0 CC              BCS SNERR1
01005  C700  0A                 ASL A
01006  C701  A8                 TAY
01007  C702  B9 01 C0           LDA STMDSP+1,Y 
01008  C705  48                 PHA
01009  C706  B9 00 C0           LDA STMDSP,Y
01010  C709  48                 PHA
01011  C70A  4C C2 00           JMP CHRGET



01013  C70D  38          RESTOR SEC
01014  C70E  A5 7A              LDA TXTTAB
01015  C710  E9 01              SBC #1
01016  C712  A4 7B              LDY TXTTAB+1
01017  C714  B0 01              BCS RESFIN
01018  C716  88                 DEY
01019  C717  85 90       RESFIN STA DATPTR
01020  C719  84 91              STY DATPTR+1






CODE4......PAGE 0018

LINE# LOC   CODE        LINE


01021  C71B  60          ISCRTS RTS
01022  C71C  B0 01       STOP   BCS STOPC
01023  C71E  18          END    CLC
01024  C71F  D0 3D       STOPC  BNE CONTRT
01025  C721  A5 C9              LDA TXTPTR
01026  C723  A4 CA              LDY TXTPTR+1
01027  C725  F0 0C              BEQ DIRIS
01028  C727  85 8C              STA OLDTXT
01029  C729  84 8D              STY OLDTXT+1
01030  C72B  A5 88       STPEND LDA CURLIN
01031  C72D  A4 89              LDY CURLIN+1
01032  C72F  85 8A              STA OLDLIN
01033  C731  84 8B              STY OLDLIN+1
01034  C733  68          DIRIS  PLA
01035  C734  68                 PLA
01036  C735  A9 A4       ENDCON LDA #<BRKTXT
01037  C737  A0 C2              LDY #>BRKTXT
01038  C739  A2 00              LDX #0
01039  C73B  86 64              STX CNTWFL
01040  C73D  90 03              BCC GORDY
01041  C73F  4C 80 C3           JMP ERRFIN
01042  C742  4C 8B C3    GORDY  JMP READY
01043  C745  D0 17       CONT   BNE CONTRT
01044  C747  A2 DF              LDX #ERRCN
01045  C749  A4 8D              LDY OLDTXT+1
01046  C74B  D0 03              BNE *+5
01047  C74D  4C 59 C3           JMP ERROR
01048  C750  A5 8C              LDA OLDTXT
01049  C752  85 C9              STA TXTPTR
01050  C754  84 CA              STY TXTPTR+1
01051  C756  A5 8A              LDA OLDLIN
01052  C758  A4 8B              LDY OLDLIN+1
01053  C75A  85 88              STA CURLIN
01054  C75C  84 89              STY CURLIN+1
01055  C75E  60          CONTRT RTS
01056  C75F  20 76 D6    NULL   JSR GETBYT
01057  C762  D0 FA              BNE CONTRT
01058  C764  E8                 INX
01059  C765  E0 0A              CPX #$0A
01060  C767  B0 04              BCS FCERR1
01061  C769  CA                 DEX
01062  C76A  86 04              STX NULCNT
01063  C76C  60                 RTS
01064  C76D  4C 30 D1    FCERR1 JMP FCERR
01065  C770  D0 EC       CLEAR  BNE CONTRT
01066  C772  4C 6A C5           JMP CLEARC
01067  C775  D0 03       RUN    BNE *+5
01068  C777  4C 67 C5           JMP RUNC
01069  C77A  20 6A C5           JSR CLEARC
01070  C77D  4C 94 C7           JMP RUNC2
01071  C780  A9 03       GOSUB  LDA #3
01072  C782  20 1D C3           JSR GETSTK
01073  C785  A5 CA              LDA TXTPTR+1
01074  C787  48                 PHA
01075  C788  A5 C9              LDA TXTPTR






CODE4......PAGE 0019

LINE# LOC   CODE        LINE


01076  C78A  48                 PHA
01077  C78B  A5 89              LDA CURLIN+1
01078  C78D  48                 PHA
01079  C78E  A5 88              LDA CURLIN
01080  C790  48                 PHA
01081  C791  A9 8D              LDA #GOSUTK
01082  C793  48                 PHA
01083  C794  20 C8 00    RUNC2  JSR CHRGOT
01084  C797  20 9D C7           JSR GOTO
01085  C79A  4C B5 C6           JMP NEWSTT
01086  C79D  20 63 C8    GOTO   JSR LINGET
01087  C7A0  20 01 C8           JSR REMN
01088  C7A3  A5 89              LDA CURLIN+1
01089  C7A5  C5 09              CMP LINNUM+1
01090  C7A7  B0 0B              BCS LUK4IT
01091  C7A9  98                 TYA
01092  C7AA  38                 SEC
01093  C7AB  65 C9              ADC TXTPTR
01094  C7AD  A6 CA              LDX TXTPTR+1
01095  C7AF  90 07              BCC LUKALL
01096  C7B1  E8                 INX
01097  C7B2  B0 04              BCS LUKALL
01098  C7B4  A5 7A       LUK4IT LDA TXTTAB
01099  C7B6  A6 7B              LDX TXTTAB+1
01100  C7B8  20 26 C5    LUKALL JSR FNDLNC
01101  C7BB  90 1E              BCC USERR
01102  C7BD  A5 AE              LDA LOWTR
01103  C7BF  E9 01              SBC #1
01104  C7C1              .FIL   CODE5
































CODE5......PAGE 001A

LINE# LOC   CODE        LINE


01106  C7C1  85 C9              STA TXTPTR
01107  C7C3  A5 AF              LDA LOWTR+1
01108  C7C5  E9 00              SBC #0
01109  C7C7  85 CA              STA TXTPTR+1
01110  C7C9  60          GORTS  RTS
01111  C7CA  D0 FD       RETURN BNE GORTS
01112  C7CC  A9 FF              LDA #255
01113  C7CE  85 98              STA FORPNT
01114  C7D0  20 AC C2           JSR FNDFOR
01115  C7D3  9A                 TXS
01116  C7D4  C9 8D              CMP #GOSUTK
01117  C7D6  F0 0B              BEQ RETU1
01118  C7D8  A2 16              LDX #ERRRG
01119  C7DA  2C                 .BYT $2C
01120  C7DB  A2 5F       USERR  LDX #ERRUS
01121  C7DD  4C 59 C3           JMP ERROR
01122  C7E0  4C 1C CE    SNERR2 JMP SNERR
01123  C7E3  68          RETU1  PLA
01124  C7E4  68                 PLA
01125  C7E5  85 88              STA CURLIN
01126  C7E7  68                 PLA
01127  C7E8  85 89              STA CURLIN+1
01128  C7EA  68                 PLA
01129  C7EB  85 C9              STA TXTPTR
01130  C7ED  68                 PLA
01131  C7EE  85 CA              STA TXTPTR+1
01132  C7F0  20 FE C7    DATA   JSR DATAN
01133  C7F3  98          ADDON  TYA
01134  C7F4  18                 CLC
01135  C7F5  65 C9              ADC TXTPTR
01136  C7F7  85 C9              STA TXTPTR
01137  C7F9  90 02              BCC REMRTS
01138  C7FB  E6 CA              INC TXTPTR+1
01139  C7FD  60          REMRTS RTS
01140  C7FE  A2 3A       DATAN  LDX #':
01141  C800  2C                 .BYT $2C
01142  C801  A2 00       REMN   LDX #0
01143  C803  86 5A              STX CHARAC
01144  C805  A0 00              LDY #0
01145  C807  84 5B              STY ENDCHR
01146  C809  A5 5B       EXCHQT LDA ENDCHR
01147  C80B  A6 5A              LDX CHARAC
01148  C80D  85 5A              STA CHARAC
01149  C80F  86 5B              STX ENDCHR
01150  C811  B1 C9       REMER  LDA (TXTPTR)Y
01151  C813  F0 E8              BEQ REMRTS
01152  C815  C5 5B              CMP ENDCHR
01153  C817  F0 E4              BEQ REMRTS
01154  C819  C8                 INY
01155  C81A  C9 22              CMP #34
01156  C81C  F0 EB              BEQ EXCHQT
01157  C81E  D0 F1              BNE REMER
01158  C820  20 B8 CC    IF     JSR FRMEVL
01159  C823  20 C8 00           JSR CHRGOT
01160  C826  C9 89              CMP #GOTOTK






CODE5......PAGE 001B

LINE# LOC   CODE        LINE


01161  C828  F0 05              BEQ OKGOTO
01162  C82A  A9 A7              LDA #THENTK
01163  C82C  20 13 CE           JSR SYNCHR
01164  C82F  A5 B0       OKGOTO LDA FACEXP
01165  C831  D0 05              BNE DOCOND
01166  C833  20 01 C8    REM    JSR REMN
01167  C836  F0 BB              BEQ ADDON
01168  C838  20 C8 00    DOCOND JSR CHRGOT
01169  C83B  B0 03              BCS DOCO
01170  C83D  4C 9D C7           JMP GOTO
01171  C840  4C F2 C6    DOCO   JMP GONE3
01172  C843  20 76 D6    ONGOTO JSR GETBYT
01173  C846  48                 PHA
01174  C847  C9 8D              CMP #GOSUTK
01175  C849  F0 04              BEQ ONGLOP
01176  C84B  C9 89       SNERR3 CMP #GOTOTK
01177  C84D  D0 91              BNE SNERR2
01178  C84F  C6 B4       ONGLOP DEC FACLO
01179  C851  D0 04              BNE ONGLP1
01180  C853  68                 PLA
01181  C854  4C F5 C6           JMP GONE2
01182  C857  20 C2 00    ONGLP1 JSR CHRGET
01183  C85A  20 63 C8           JSR LINGET
01184  C85D  C9 2C              CMP #44
01185  C85F  F0 EE              BEQ ONGLOP
01186  C861  68                 PLA
01187  C862  60          ONGRTS RTS
01188  C863  A2 00       LINGET LDX #0
01189  C865  86 08              STX LINNUM
01190  C867  86 09              STX LINNUM+1
01191  C869  B0 F7       MORLIN BCS ONGRTS
01192  C86B  E9 2F              SBC #$2F
01193  C86D  85 5A              STA CHARAC
01194  C86F  A5 09              LDA LINNUM+1
01195  C871  85 71              STA INDEX
01196  C873  C9 19              CMP #25
01197  C875  B0 D4              BCS SNERR3
01198  C877  A5 08              LDA LINNUM
01199  C879  0A                 ASL A
01200  C87A  26 71              ROL INDEX
01201  C87C  0A                 ASL A
01202  C87D  26 71              ROL INDEX
01203  C87F  65 08              ADC LINNUM
01204  C881  85 08              STA LINNUM
01205  C883  A5 71              LDA INDEX
01206  C885  65 09              ADC LINNUM+1
01207  C887  85 09              STA LINNUM+1
01208  C889  06 08              ASL LINNUM
01209  C88B  26 09              ROL LINNUM+1
01210  C88D  A5 08              LDA LINNUM
01211  C88F  65 5A              ADC CHARAC
01212  C891  85 08              STA LINNUM
01213  C893  90 02              BCC NXTLGC
01214  C895  E6 09              INC LINNUM+1
01215  C897  20 C2 00    NXTLGC JSR CHRGET






CODE5......PAGE 001C

LINE# LOC   CODE        LINE


01216  C89A  4C 69 C8           JMP MORLIN
01217  C89D  20 7B CF    LET    JSR PTRGET
01218  C8A0  85 98              STA FORPNT
01219  C8A2  84 99              STY FORPNT+1
01220  C8A4  A9 B2              LDA #$B2
01221  C8A6  20 13 CE           JSR SYNCHR
01222  C8A9  A5 5F              LDA INTFLG
01223  C8AB  48                 PHA
01224  C8AC  A5 5E              LDA VALTYP
01225  C8AE  48                 PHA
01226  C8AF  20 B8 CC           JSR FRMEVL
01227  C8B2  68                 PLA
01228  C8B3  2A                 ROL A
01229  C8B4  20 AA CC           JSR CHKVAL
01230  C8B7  D0 18              BNE COPSTR
01231  C8B9  68                 PLA
01232  C8BA  10 12       QINTGR BPL COPFLT
01233  C8BC  20 ED DA           JSR ROUND
01234  C8BF  20 A7 D0           JSR AYINT
01235  C8C2  A0 00              LDY #0
01236  C8C4  A5 B3              LDA FACMO
01237  C8C6  91 98              STA (FORPNT)Y
01238  C8C8  C8                 INY
01239  C8C9  A5 B4              LDA FACLO
01240  C8CB  91 98              STA (FORPNT)Y
01241  C8CD  60                 RTS
01242  C8CE  4C A2 DA    COPFLT JMP MOVVF
01243  C8D1  68          COPSTR PLA
01244  C8D2  A4 99       INPCOM LDY FORPNT+1
01245  C8D4  C0 D0              CPY #>ZERO
01246  C8D6  D0 53              BNE GETSPT
01247  C8D8  20 7E D5           JSR FREFAC
01248  C8DB  C9 06              CMP #6
01249  C8DD  F0 03              BEQ *+5
01250  C8DF  4C 30 D1           JMP FCERR
01251  C8E2  A0 00              LDY #0
01252  C8E4  84 B0              STY FACEXP
01253  C8E6  84 B5              STY FACSGN
01254  C8E8              .FIL   CODE6






















CODE6......PAGE 001D

LINE# LOC   CODE        LINE


01256  C8E8  84 C0       TIMELP STY FBUFPT
01257  C8EA  20 1C C9           JSR TIMNUM
01258  C8ED  20 B4 D9           JSR MUL10
01259  C8F0  E6 C0              INC FBUFPT
01260  C8F2  A4 C0              LDY FBUFPT
01261  C8F4  20 1C C9           JSR TIMNUM
01262  C8F7  20 DE DA           JSR MOVAF
01263  C8FA  AA                 TAX
01264  C8FB  F0 05              BEQ NOML6
01265  C8FD  E8                 INX
01266  C8FE  8A                 TXA
01267  C8FF  20 BF D9           JSR FINML6
01268  C902  A4 C0       NOML6  LDY FBUFPT
01269  C904  C8                 INY
01270  C905  C0 06              CPY #6
01271  C907  D0 DF              BNE TIMELP
01272  C909  20 B4 D9           JSR MUL10
01273  C90C  20 6D DB           JSR QINT
01274  C90F  A2 02              LDX #2
01275  C911  78                 SEI
01276  C912  B5 B2       TIMEST LDA FACMOH,X
01277  C914  9D 00 02           STA CTIMR,X
01278  C917  CA                 DEX
01279  C918  10 F8              BPL TIMEST
01280  C91A  58                 CLI
01281  C91B  60                 RTS
01282  C91C  B1 71       TIMNUM LDA (INDEX)Y
01283  C91E  20 CF 00           JSR QNUM
01284  C921  90 03              BCC GOTNUM
01285  C923  4C 30 D1           JMP FCERR
01286  C926  E9 2F       GOTNUM SBC #$2F
01287  C928  4C 50 DC           JMP FINLOG
01288  C92B  A0 02       GETSPT LDY #2
01289  C92D  B1 B3              LDA (FACMO)Y
01290  C92F  C5 83              CMP FRETOP+1
01291  C931  90 17              BCC DNTCPY
01292  C933  D0 07              BNE QVARIA
01293  C935  88                 DEY
01294  C936  B1 B3              LDA (FACMO)Y
01295  C938  C5 82              CMP FRETOP
01296  C93A  90 0E              BCC DNTCPY
01297  C93C  A4 B4       QVARIA LDY FACLO
01298  C93E  C4 7D              CPY VARTAB+1
01299  C940  90 08              BCC DNTCPY
01300  C942  D0 0D              BNE COPY
01301  C944  A5 B3              LDA FACMO
01302  C946  C5 7C              CMP VARTAB
01303  C948  B0 07              BCS COPY
01304  C94A  A5 B3       DNTCPY LDA FACMO
01305  C94C  A4 B4              LDY FACMO+1
01306  C94E  4C 67 C9           JMP COPYC
01307  C951  A0 00       COPY   LDY #0
01308  C953  B1 B3              LDA (FACMO)Y
01309  C955  20 59 D3           JSR STRINI
01310  C958  A5 9F              LDA DSCPNT






CODE6......PAGE 001E

LINE# LOC   CODE        LINE


01311  C95A  A4 A0              LDY DSCPNT+1
01312  C95C  85 BE              STA STRNG1
01313  C95E  84 BF              STY STRNG1+1
01314  C960  20 52 D5           JSR MOVINS
01315  C963  A9 B0              LDA #<DSCTMP
01316  C965  A0 00              LDY #>DSCTMP
01317  C967  85 9F       COPYC  STA DSCPNT
01318  C969  84 A0              STY DSCPNT+1
01319  C96B  20 B3 D5           JSR FRETMS
01320  C96E  A0 00              LDY #0
01321  C970  B1 9F              LDA (DSCPNT)Y
01322  C972  91 98              STA (LSTPNT)Y
01323  C974  C8                 INY
01324  C975  B1 9F              LDA (DSCPNT)Y
01325  C977  91 98              STA (LSTPNT)Y
01326  C979  C8                 INY
01327  C97A  B1 9F              LDA (DSCPNT)Y
01328  C97C  91 98              STA (LSTPNT)Y
01329  C97E  60                 RTS





01331  C97F  20 85 C9    PRINTN JSR CMD
01332  C982  4C D6 CA           JMP IODONE
01333  C985  20 76 D6    CMD    JSR GETBYT
01334  C988  F0 05              BEQ SAVEIT
01335  C98A  A9 2C              LDA #44
01336  C98C  20 13 CE           JSR SYNCHR
01337  C98F  08          SAVEIT PHP
01338  C990  20 C9 FF           JSR COOUT
01339  C993  86 03              STX CHANNL
01340  C995  28                 PLP
01341  C996  4C 9F C9           JMP PRINT
01342  C999  20 2A CA    STRDON JSR STRPRT
01343  C99C  20 C8 00    NEWCHR JSR CHRGOT
01344  C99F  F0 31       PRINT  BEQ CRDO
01345  C9A1  F0 55       PRINTC BEQ PRTRTS
01346  C9A3  C9 A3              CMP #TABTK
01347  C9A5  F0 5F              BEQ TABER
01348  C9A7  C9 A6              CMP #SPCTK
01349  C9A9  F0 5B              BEQ TABER
01350  C9AB  C9 2C              CMP #44
01351  C9AD  F0 4A              BEQ COMPRT
01352  C9AF  C9 3B              CMP #59
01353  C9B1  F0 6E              BEQ NOTABR
01354  C9B3  20 B8 CC           JSR FRMEVL
01355  C9B6  24 5E              BIT VALTYP
01356  C9B8  30 DF              BMI STRDON
01357  C9BA  20 AF DC           JSR FOUT
01358  C9BD  20 6B D3           JSR STRLIT
01359  C9C0  20 2A CA           JSR STRPRT
01360  C9C3  20 44 CA           JSR CRTSKP
01361  C9C6  D0 D4              BNE NEWCHR






CODE6......PAGE 001F

LINE# LOC   CODE        LINE


01362  C9C8  A0 00       FININL LDY #0
01363  C9CA  94 0A              STY BUF,X
01364  C9CC              ZZ5=BUF-1
01365  C9CC  A2 09              LDX #<ZZ5
01366  C9CE  A5 03              LDA CHANNL
01367  C9D0  D0 26              BNE PRTRTS
01368  C9D2  A5 03       CRDO   LDA CHANNL
01369  C9D4  D0 02              BNE LC9D8
01370  C9D6  85 05              STA TRMPOS
01371  C9D8  A9 0D       LC9D8  LDA #13
01372  C9DA  20 49 CA           JSR OUTDO
01373  C9DD  A9 0A              LDA #$0A        ;LINE FEED
01374  C9DF  20 49 CA           JSR OUTDO
01375  C9E2  A5 03       CRFIN  LDA CHANNL
01376  C9E4  D0 12              BNE PRTRTS
01377  C9E6  8A                 TXA
01378  C9E7  48                 PHA
01379  C9E8  A6 04              LDX NULCNT
01380  C9EA  F0 08              BEQ CLRPOS
01381  C9EC  A9 00              LDA #0
01382  C9EE  20 49 CA    PRTNUL JSR OUTDO
01383  C9F1  CA                 DEX
01384  C9F2  D0 FA              BNE PRTNUL
01385  C9F4  86 05       CLRPOS STX TRMPOS
01386  C9F6  68                 PLA
01387  C9F7  AA                 TAX
01388  C9F8  60          PRTRTS RTS
01389  C9F9  A5 05       COMPRT LDA TRMPOS
01390  C9FB              NCMPOS =@36
01391  C9FB  38                 SEC
01392  C9FC  E9 0A       MORCO1 SBC #CLMWID
01393  C9FE  B0 FC              BCS MORCO1
01394  CA00  49 FF              EOR #255
01395  CA02  69 01              ADC #1
01396  CA04  D0 14              BNE ASPAC
01397  CA06  48          TABER  PHA
01398  CA07  20 73 D6           JSR GTBYTC
01399  CA0A  C9 29              CMP #41
01400  CA0C  D0 75              BNE SNERR4
01401  CA0E  68                 PLA
01402  CA0F  C9 A3              CMP #TABTK
01403  CA11  D0 08              BNE XSPAC1
01404  CA13  8A                 TXA
01405  CA14  E5 05              SBC TRMPOS
01406  CA16  90 09              BCC NOTABR
01407  CA18  F0 07              BEQ NOTABR
01408  CA1A  AA          ASPAC  TAX
01409  CA1B  20 44 CA    XSPAC1 JSR CRTSKP
01410  CA1E  CA          XSPAC2 DEX
01411  CA1F  D0 FA              BNE XSPAC1
01412  CA21  20 C2 00    NOTABR JSR CHRGET
01413  CA24  4C A1 C9           JMP PRINTC
01414  CA27              .FIL   CODE7








CODE7......PAGE 0020

LINE# LOC   CODE        LINE


01416  CA27  20 6B D3    STROUT JSR STRLIT
01417  CA2A  20 7E D5    STRPRT JSR FREFAC
01418  CA2D  AA                 TAX
01419  CA2E  A0 00              LDY #0
01420  CA30  E8                 INX
01421  CA31  CA          STRPR2 DEX
01422  CA32  F0 C4              BEQ PRTRTS
01423  CA34  B1 71              LDA (INDEX)Y
01424  CA36  20 49 CA           JSR OUTDO
01425  CA39  C8                 INY
01426  CA3A  C9 0D              CMP #13
01427  CA3C  D0 F3              BNE STRPR2
01428  CA3E  20 E2 C9           JSR CRFIN
01429  CA41  4C 31 CA           JMP STRPR2
01430  CA44  A9 1D       CRTSKP LDA #29
01431  CA46  2C                 .BYT $2C
01432  CA47  A9 3F       OUTQST LDA #'?
01433  CA49  24 64       OUTDO  BIT CNTWFL
01434  CA4B  30 27              BMI OUTRTS
01435  CA4D  48                 PHA
01436  CA4E  C9 1D              CMP #29
01437  CA50  F0 18              BEQ OUTDO1
01438  CA52  C9 9D              CMP #$9D
01439  CA54  F0 04              BEQ LCA5A
01440  CA56  C9 14              CMP #20
01441  CA58  D0 0A              BNE LCA64
01442  CA5A  A5 05       LCA5A  LDA TRMPOS
01443  CA5C  F0 12              BEQ TRYOUT
01444  CA5E  A5 03              LDA CHANNL
01445  CA60  D0 0E              BNE TRYOUT
01446  CA62  C6 05              DEC TRMPOS
01447  CA64  29 7F       LCA64  AND #127
01448  CA66  C9 20              CMP #' 
01449  CA68  90 06              BCC TRYOUT
01450  CA6A  A5 03       OUTDO1 LDA CHANNL
01451  CA6C              ;       BNE TRYOUT
01452  CA6C              ;       INC TRMPOS
01453  CA6C  20 CC E1           JSR PATCH6
01454  CA6F  EA                 NOP
01455  CA70  68          TRYOUT PLA
01456  CA71  20 D2 FF           JSR OUTCH
01457  CA74  29 FF       OUTRTS AND #255
01458  CA76  60                 RTS
01459  CA77  A5 62       TRMNOK LDA INPFLG
01460  CA79  F0 0B              BEQ TRMNO1
01461  CA7B              GETDTL
01462  CA7B              ;       LDA DATLIN
01463  CA7B              ;       LDY DATLIN+1
01464  CA7B  20 C2 E1           JSR PATCH5
01465  CA7E  EA                 NOP
01466  CA7F  85 88       STCURL STA CURLIN
01467  CA81  84 89              STY CURLIN+1
01468  CA83  4C 1C CE    SNERR4 JMP SNERR
01469  CA86  A5 03       TRMNO1 LDA CHANNL
01470  CA88  F0 05              BEQ DOAGIN






CODE7......PAGE 0021

LINE# LOC   CODE        LINE


01471  CA8A  A2 C4              LDX #ERRBD
01472  CA8C  4C 59 C3           JMP ERROR
01473  CA8F  A9 23       DOAGIN LDA #<TRYAGN
01474  CA91  A0 CC              LDY #>TRYAGN
01475  CA93  20 27 CA           JSR STROUT
01476  CA96  A5 8C              LDA OLDTXT
01477  CA98  A4 8D              LDY OLDTXT+1
01478  CA9A  85 C9              STA TXTPTR
01479  CA9C  84 CA              STY TXTPTR+1
01480  CA9E  60                 RTS
01481  CA9F  20 8B D2    GET    JSR ERRDIR
01482  CAA2  C9 23              CMP #'#
01483  CAA4  D0 10              BNE GETTTY
01484  CAA6  20 C2 00           JSR CHRGET
01485  CAA9  20 76 D6           JSR GETBYT
01486  CAAC  A9 2C              LDA #44
01487  CAAE  20 13 CE           JSR SYNCHR
01488  CAB1  20 C6 FF           JSR COIN
01489  CAB4  86 03              STX CHANNL
01490  CAB6              ZZ2=BUF+1
01491  CAB6  A2 0B       GETTTY LDX #<ZZ2
01492  CAB8  A0 00              LDY #0
01493  CABA  84 0B              STY BUF+1
01494  CABC  A9 40              LDA #64
01495  CABE  20 2A CB           JSR INPCO1
01496  CAC1  A6 03              LDX CHANNL
01497  CAC3  D0 13              BNE IORELE
01498  CAC5  60                 RTS
01499  CAC6  20 76 D6    INPUTN JSR GETBYT
01500  CAC9  A9 2C              LDA #44
01501  CACB  20 13 CE           JSR SYNCHR
01502  CACE  20 C6 FF           JSR COIN
01503  CAD1  86 03              STX CHANNL
01504  CAD3  20 F1 CA           JSR NOTQTI
01505  CAD6  A5 03       IODONE LDA CHANNL
01506  CAD8  20 CC FF    IORELE JSR CCCHN
01507  CADB  A2 00              LDX #0
01508  CADD  86 03              STX CHANNL
01509  CADF  60                 RTS
01510  CAE0  46 64       INPUT  LSR CNTWFL
01511  CAE2  C9 22              CMP #34
01512  CAE4  D0 0B              BNE NOTQTI
01513  CAE6  20 D1 CD           JSR STRTXT
01514  CAE9  A9 3B              LDA #59
01515  CAEB  20 13 CE           JSR SYNCHR
01516  CAEE  20 2A CA           JSR STRPRT
01517  CAF1  20 8B D2    NOTQTI JSR ERRDIR
01518  CAF4  A9 2C              LDA #44
01519  CAF6  85 09              STA BUF-1
01520  CAF8  20 17 CB    GETAGN JSR QINLIN
01521  CAFB  A5 03              LDA CHANNL
01522  CAFD  F0 0D              BEQ BUFFUL
01523  CAFF  AD 0C 02           LDA CSTAT
01524  CB02  29 02              AND #2
01525  CB04  F0 06              BEQ BUFFUL






CODE7......PAGE 0022

LINE# LOC   CODE        LINE


01526  CB06  20 D6 CA           JSR IODONE
01527  CB09  4C F0 C7           JMP DATA
01528  CB0C  A5 0A       BUFFUL LDA BUF
01529  CB0E  D0 19              BNE INPCON
01530  CB10  A5 03              LDA CHANNL
01531  CB12  D0 E4              BNE GETAGN
01532  CB14              ;       JMP STPEND
01533  CB14  4C 9B E1           JMP PATCH1
01534  CB17  A5 03       QINLIN LDA CHANNL
01535  CB19  D0 06              BNE GINLIN
01536  CB1B  20 47 CA           JSR OUTQST
01537  CB1E  20 44 CA           JSR CRTSKP
01538  CB21  4C 68 C4    GINLIN JMP INLIN
01539  CB24  A6 90       READ   LDX DATPTR
01540  CB26  A4 91              LDY DATPTR+1
01541  CB28  A9                 .BYT $A9
01542  CB29  98          INPCON TYA
01543  CB2A  85 62       INPCO1 STA INPFLG
01544  CB2C  86 92              STX INPPTR
01545  CB2E  84 93              STY INPPTR+1
01546  CB30  20 7B CF    INLOOP JSR PTRGET
01547  CB33  85 98              STA FORPNT
01548  CB35  84 99              STY FORPNT+1
01549  CB37  A5 C9              LDA TXTPTR
01550  CB39  A4 CA              LDY TXTPTR+1
01551  CB3B  85 08              STA VARTXT
01552  CB3D  84 09              STY VARTXT+1
01553  CB3F  A6 92              LDX INPPTR
01554  CB41  A4 93              LDY INPPTR+1
01555  CB43  86 C9              STX TXTPTR
01556  CB45  84 CA              STY TXTPTR+1
01557  CB47  20 C8 00           JSR CHRGOT
01558  CB4A  D0 1F              BNE DATBK1
01559  CB4C  24 62              BIT INPFLG
01560  CB4E  50 0B              BVC QDATA
01561  CB50  20 E4 FF           JSR CGETL
01562  CB53  85 0A              STA BUF
01563  CB55              ZZ4=BUF-1
01564  CB55  A0 00              LDY #>ZZ4
01565  CB57  A2 09              LDX #<ZZ4
01566  CB59  D0 0C              BNE DATBK
01567  CB5B  30 72       QDATA  BMI DATLOP
01568  CB5D  A5 03              LDA CHANNL
01569  CB5F  D0 03              BNE GETNTH
01570  CB61  20 47 CA           JSR OUTQST
01571  CB64  20 17 CB    GETNTH JSR QINLIN
01572  CB67  86 C9       DATBK  STX TXTPTR
01573  CB69  84 CA              STY TXTPTR+1
01574  CB6B              .FIL   CODE8












CODE8......PAGE 0023

LINE# LOC   CODE        LINE


01576  CB6B  20 C2 00    DATBK1 JSR CHRGET
01577  CB6E  24 5E              BIT VALTYP
01578  CB70  10 2E              BPL NUMINS
01579  CB72  24 62              BIT INPFLG
01580  CB74  50 06              BVC SETQUT
01581  CB76  A9 00              LDA #0
01582  CB78              ;       STA CHARAC
01583  CB78              ;       BEQ RESETC
01584  CB78  20 BC E1           JSR PATCH4
01585  CB7B  EA                 NOP
01586  CB7C  85 5A       SETQUT STA CHARAC
01587  CB7E  C9 22              CMP #34
01588  CB80  F0 07              BEQ NOWGET
01589  CB82  A9 3A              LDA #':
01590  CB84  85 5A              STA CHARAC
01591  CB86  A9 2C              LDA #44
01592  CB88  18          RESETC CLC
01593  CB89  85 5B       NOWGET STA ENDCHR
01594  CB8B  A5 C9              LDA TXTPTR
01595  CB8D  A4 CA              LDY TXTPTR+1
01596  CB8F  69 00              ADC #0
01597  CB91  90 01              BCC NOWGE1
01598  CB93  C8                 INY
01599  CB94  20 71 D3    NOWGE1 JSR STRLT2
01600  CB97  20 BB D6           JSR ST2TXT
01601  CB9A  20 D2 C8           JSR INPCOM
01602  CB9D  4C A8 CB           JMP STRDN2
01603  CBA0  20 C5 DB    NUMINS JSR FIN
01604  CBA3  A5 5F              LDA INTFLG
01605  CBA5  20 BA C8           JSR QINTGR
01606  CBA8  20 C8 00    STRDN2 JSR CHRGOT
01607  CBAB  F0 07              BEQ TRMOK
01608  CBAD  C9 2C              CMP #44
01609  CBAF  F0 03              BEQ *+5
01610  CBB1  4C 77 CA           JMP TRMNOK
01611  CBB4  A5 C9       TRMOK  LDA TXTPTR
01612  CBB6  A4 CA              LDY TXTPTR+1
01613  CBB8  85 92              STA INPPTR
01614  CBBA  84 93              STY INPPTR+1
01615  CBBC  A5 08              LDA VARTXT
01616  CBBE  A4 09              LDY VARTXT+1
01617  CBC0  85 C9              STA TXTPTR
01618  CBC2  84 CA              STY TXTPTR+1
01619  CBC4  20 C8 00           JSR CHRGOT
01620  CBC7  F0 2C              BEQ VAREND
01621  CBC9  20 11 CE           JSR CHKCOM
01622  CBCC  4C 30 CB           JMP INLOOP
01623  CBCF  20 FE C7    DATLOP JSR DATAN
01624  CBD2  C8                 INY
01625  CBD3  AA                 TAX
01626  CBD4  D0 12              BNE NOWLIN
01627  CBD6  A2 2A              LDX #ERROD
01628  CBD8  C8                 INY
01629  CBD9  B1 C9              LDA (TXTPTR)Y
01630  CBDB  F0 6D              BEQ ERRGO5






CODE8......PAGE 0024

LINE# LOC   CODE        LINE


01631  CBDD  C8                 INY
01632  CBDE  B1 C9              LDA (TXTPTR)Y
01633  CBE0  85 8E              STA DATLIN
01634  CBE2  C8                 INY
01635  CBE3  B1 C9              LDA (TXTPTR)Y
01636  CBE5  C8                 INY
01637  CBE6  85 8F              STA DATLIN+1
01638  CBE8  B1 C9       NOWLIN LDA (TXTPTR)Y
01639  CBEA  AA                 TAX
01640  CBEB  20 F3 C7           JSR ADDON
01641  CBEE  E0 83              CPX #DATATK
01642  CBF0  D0 DD              BNE DATLOP
01643  CBF2  4C 6B CB           JMP DATBK1
01644  CBF5  A5 92       VAREND LDA INPPTR
01645  CBF7  A4 93              LDY INPPTR+1
01646  CBF9  A6 62              LDX INPFLG
01647  CBFB  10 03              BPL VARY0
01648  CBFD  4C 17 C7           JMP RESFIN
01649  CC00  A0 00       VARY0  LDY #0
01650  CC02  B1 92              LDA (INPPTR)Y
01651  CC04  F0 0B              BEQ INPRTS
01652  CC06  A5 03              LDA CHANNL
01653  CC08  D0 07              BNE INPRTS
01654  CC0A  A9 12              LDA #<EXIGNT
01655  CC0C  A0 CC              LDY #>EXIGNT
01656  CC0E  4C 27 CA           JMP STROUT
01657  CC11  60          INPRTS RTS
01658  CC12  3F 45       EXIGNT .BYT '?EXTRA IGNORED'
01659  CC20  0D                 .BYT $D,$A
01659  CC21  0A 
01660  CC22  00                 .BYT 0
01661  CC23  3F 52       TRYAGN .BYT '?REDO FROM START'
01662  CC33  0D                 .BYT $D,$A
01662  CC34  0A 
01663  CC35  00                 .BYT 0
01664  CC36  D0 04       NEXT   BNE GETFOR
01665  CC38  A0 00              LDY #0
01666  CC3A  F0 03              BEQ STXFOR
01667  CC3C  20 7B CF    GETFOR JSR PTRGET
01668  CC3F  85 98       STXFOR STA FORPNT
01669  CC41  84 99              STY FORPNT+1
01670  CC43  20 AC C2           JSR FNDFOR
01671  CC46  F0 04              BEQ HAVFOR
01672  CC48  A2 00              LDX #ERRNF
01673  CC4A  F0 69       ERRGO5 BEQ ERRGO4
01674  CC4C  9A          HAVFOR TXS
01675  CC4D  E8                 INX
01676  CC4E  E8                 INX
01677  CC4F  E8                 INX
01678  CC50  E8                 INX
01679  CC51  8A                 TXA
01680  CC52  E8                 INX
01681  CC53  E8                 INX
01682  CC54  E8                 INX
01683  CC55  E8                 INX






CODE8......PAGE 0025

LINE# LOC   CODE        LINE


01684  CC56  E8                 INX
01685  CC57  E8                 INX
01686  CC58  86 73              STX INDEX2
01687  CC5A  A0 01              LDY #1
01688  CC5C  20 74 DA           JSR MOVFM
01689  CC5F  BA                 TSX
01690  CC60  BD 09 01           LDA ADDPRC+264,X
01691  CC63  85 B5              STA FACSGN
01692  CC65  A5 98              LDA FORPNT
01693  CC67  A4 99              LDY FORPNT+1
01694  CC69  20 3C D7           JSR FADD
01695  CC6C  20 A2 DA           JSR MOVVF
01696  CC6F  A0 01              LDY #1
01697  CC71  20 2F DB           JSR FCOMPN
01698  CC74  BA                 TSX
01699  CC75  38                 SEC
01700  CC76  FD 09 01           SBC ADDPRC+264,X
01701  CC79  F0 17              BEQ LOOPDN
01702  CC7B  BD 0F 01           LDA 269+ADDPRC+ADDPRC,X
01703  CC7E  85 88              STA CURLIN
01704  CC80  BD 10 01           LDA 270+ADDPRC+ADDPRC,X
01705  CC83  85 89              STA CURLIN+1
01706  CC85  BD 12 01           LDA 272+ADDPRC+ADDPRC,X
01707  CC88  85 C9              STA TXTPTR
01708  CC8A  BD 11 01           LDA 271+ADDPRC+ADDPRC,X
01709  CC8D  85 CA              STA TXTPTR+1
01710  CC8F  4C B5 C6    NEWSGO JMP NEWSTT
01711  CC92  8A          LOOPDN TXA
01712  CC93  69 11              ADC #15+ADDPRC+ADDPRC
01713  CC95  AA                 TAX
01714  CC96  9A                 TXS
01715  CC97  20 C8 00           JSR CHRGOT
01716  CC9A  C9 2C              CMP #44
01717  CC9C  D0 F1              BNE NEWSGO
01718  CC9E  20 C2 00           JSR CHRGET
01719  CCA1  20 3C CC           JSR GETFOR
01720  CCA4  20 B8 CC    FRMNUM JSR FRMEVL
01721  CCA7  18          CHKNUM CLC
01722  CCA8  24                 .BYT $24
01723  CCA9  38          CHKSTR SEC
01724  CCAA  24 5E       CHKVAL BIT VALTYP
01725  CCAC              .FIL   CODE9



















CODE9......PAGE 0026

LINE# LOC   CODE        LINE


01727  CCAC  30 03              BMI DOCSTR
01728  CCAE  B0 03              BCS CHKERR
01729  CCB0  60          CHKOK  RTS
01730  CCB1  B0 FD       DOCSTR BCS CHKOK
01731  CCB3  A2 A8       CHKERR LDX #ERRTM
01732  CCB5  4C 59 C3    ERRGO4 JMP ERROR
01733  CCB8  A6 C9       FRMEVL LDX TXTPTR
01734  CCBA  D0 02              BNE FRMEV1
01735  CCBC  C6 CA              DEC TXTPTR+1
01736  CCBE  C6 C9       FRMEV1 DEC TXTPTR
01737  CCC0  A2 00              LDX #0
01738  CCC2  24                 .BYT $24
01739  CCC3  48          LPOPER PHA
01740  CCC4  8A                 TXA
01741  CCC5  48                 PHA
01742  CCC6  A9 01              LDA #1
01743  CCC8  20 1D C3           JSR GETSTK
01744  CCCB  20 9D CD           JSR EVAL
01745  CCCE  A9 00              LDA #0
01746  CCD0  85 9C              STA OPMASK
01747  CCD2  20 C8 00    TSTOP  JSR CHRGOT
01748  CCD5  38          LOPREL SEC
01749  CCD6  E9 B1              SBC #GREATK
01750  CCD8  90 17              BCC ENDREL
01751  CCDA  C9 03              CMP #LESSTK-GREATK+1
01752  CCDC  B0 13              BCS ENDREL
01753  CCDE  C9 01              CMP #1
01754  CCE0  2A                 ROL A
01755  CCE1  49 01              EOR #1
01756  CCE3  45 9C              EOR OPMASK
01757  CCE5  C5 9C              CMP OPMASK
01758  CCE7  90 61              BCC SNERR5
01759  CCE9  85 9C              STA OPMASK
01760  CCEB  20 C2 00           JSR CHRGET
01761  CCEE  4C D5 CC           JMP LOPREL
01762  CCF1  A6 9C       ENDREL LDX OPMASK
01763  CCF3  D0 2C              BNE FINREL
01764  CCF5  B0 7B              BCS QOP
01765  CCF7  69 07              ADC #GREATK-PLUSTK
01766  CCF9  90 77              BCC QOP
01767  CCFB  65 5E              ADC VALTYP
01768  CCFD  D0 03              BNE *+5
01769  CCFF  4C 15 D5           JMP CAT
01770  CD02  69 FF              ADC #$FF
01771  CD04  85 71              STA INDEX1
01772  CD06  0A                 ASL A
01773  CD07  65 71              ADC INDEX1
01774  CD09  A8                 TAY
01775  CD0A  68          QPREC  PLA
01776  CD0B  D9 74 C0           CMP OPTAB,Y
01777  CD0E  B0 67              BCS QCHNUM
01778  CD10  20 A7 CC           JSR CHKNUM
01779  CD13  48          DOPREC PHA
01780  CD14  20 3A CD    NEGPRC JSR DOPRE1
01781  CD17  68                 PLA






CODE9......PAGE 0027

LINE# LOC   CODE        LINE


01782  CD18  A4 9A              LDY OPPTR
01783  CD1A  10 17              BPL QPREC1
01784  CD1C  AA                 TAX
01785  CD1D  F0 56              BEQ QOPGO
01786  CD1F  D0 5F              BNE PULSTK
01787  CD21  46 5E       FINREL LSR VALTYP
01788  CD23  8A                 TXA
01789  CD24  2A                 ROL A
01790  CD25  A6 C9              LDX TXTPTR
01791  CD27  D0 02              BNE FINRE2
01792  CD29  C6 CA              DEC TXTPTR+1
01793  CD2B  C6 C9       FINRE2 DEC TXTPTR
01794  CD2D  A0 1B              LDY #PTDORL-OPTAB
01795  CD2F  85 9C              STA OPMASK
01796  CD31  D0 D7              BNE QPREC
01797  CD33  D9 74 C0    QPREC1 CMP OPTAB,Y
01798  CD36  B0 48              BCS PULSTK
01799  CD38  90 D9              BCC DOPREC
01800  CD3A  B9 76 C0    DOPRE1 LDA OPTAB+2,Y
01801  CD3D  48                 PHA
01802  CD3E  B9 75 C0           LDA OPTAB+1,Y
01803  CD41  48                 PHA
01804  CD42  20 4D CD           JSR PUSHF1
01805  CD45  A5 9C              LDA OPMASK
01806  CD47  4C C3 CC           JMP LPOPER
01807  CD4A  4C 1C CE    SNERR5 JMP SNERR
01808  CD4D  A5 B5       PUSHF1 LDA FACSGN
01809  CD4F  BE 74 C0           LDX OPTAB,Y
01810  CD52  A8          PUSHF  TAY
01811  CD53  68                 PLA
01812  CD54  85 71              STA INDEX1
01813  CD56  E6 71              INC INDEX1
01814  CD58  68                 PLA
01815  CD59  85 72              STA INDEX1+1
01816  CD5B  98                 TYA
01817  CD5C  48                 PHA
01818  CD5D  20 ED DA    FORPSH JSR ROUND
01819  CD60  A5 B4              LDA FACLO
01820  CD62  48                 PHA
01821  CD63  A5 B3              LDA FACMO
01822  CD65  48                 PHA
01823  CD66  A5 B2              LDA FACMOH
01824  CD68  48                 PHA
01825  CD69  A5 B1              LDA FACHO
01826  CD6B  48                 PHA
01827  CD6C  A5 B0              LDA FACEXP
01828  CD6E  48                 PHA
01829  CD6F  6C 71 00           JMP (INDEX1)
01830  CD72  A0 FF       QOP    LDY #255
01831  CD74  68                 PLA
01832  CD75  F0 23       QOPGO  BEQ QOPRTS
01833  CD77  C9 64       QCHNUM CMP #100
01834  CD79  F0 03              BEQ UNPSTK
01835  CD7B  20 A7 CC           JSR CHKNUM
01836  CD7E  84 9A       UNPSTK STY OPPTR






CODE9......PAGE 0028

LINE# LOC   CODE        LINE


01837  CD80  68          PULSTK PLA
01838  CD81  4A                 LSR A
01839  CD82  85 63              STA DOMASK
01840  CD84  68                 PLA
01841  CD85  85 B8              STA ARGEXP
01842  CD87  68                 PLA
01843  CD88  85 B9              STA ARGHO
01844  CD8A  68                 PLA
01845  CD8B  85 BA              STA ARGMOH
01846  CD8D  68                 PLA
01847  CD8E  85 BB              STA ARGMO
01848  CD90  68                 PLA
01849  CD91  85 BC              STA ARGLO
01850  CD93  68                 PLA
01851  CD94  85 BD              STA ARGSGN
01852  CD96  45 B5              EOR FACSGN
01853  CD98  85 BE              STA ARISGN
01854  CD9A  A5 B0       QOPRTS LDA FACEXP
01855  CD9C  60          UNPRTS RTS
01856  CD9D  A9 00       EVAL   LDA #0
01857  CD9F  85 5E              STA VALTYP
01858  CDA1  20 C2 00    EVAL0  JSR CHRGET
01859  CDA4  B0 03              BCS EVAL2
01860  CDA6  4C C5 DB    EVAL1  JMP FIN
01861  CDA9  20 05 D0    EVAL2  JSR ISLETC
01862  CDAC  B0 7A              BCS ISVAR
01863  CDAE  C9 FF              CMP #PI
01864  CDB0  D0 0F              BNE QDOT
01865  CDB2  A9 BC              LDA #<PIVAL
01866  CDB4  A0 CD              LDY #>PIVAL
01867  CDB6  20 74 DA           JSR MOVFM
01868  CDB9  4C C2 00           JMP CHRGET
01869  CDBC  82          PIVAL  .BYT @202
01870  CDBD  49                 .BYT @111
01871  CDBE  0F                 .BYT @017
01872  CDBF  DA                 .BYT @332
01873  CDC0  A1                 .BYT @241
01874  CDC1  C9 2E       QDOT   CMP #'.
01875  CDC3  F0 E1              BEQ EVAL1
01876  CDC5  C9 AB              CMP #MINUTK
01877  CDC7  F0 58              BEQ DOMIN
01878  CDC9  C9 AA              CMP #PLUSTK
01879  CDCB  F0 D4              BEQ EVAL0
01880  CDCD  C9 22              CMP #34
01881  CDCF  D0 0F              BNE EVAL3
01882  CDD1  A5 C9       STRTXT LDA TXTPTR
01883  CDD3  A4 CA              LDY TXTPTR+1
01884  CDD5  69 00              ADC #0
01885  CDD7  90 01              BCC STRTX2
01886  CDD9  C8                 INY
01887  CDDA  20 6B D3    STRTX2 JSR STRLIT
01888  CDDD  4C BB D6           JMP ST2TXT
01889  CDE0  C9 A8       EVAL3  CMP #NOTTK
01890  CDE2  D0 13              BNE EVAL4
01891  CDE4  A0 18              LDY #24






CODE9......PAGE 0029

LINE# LOC   CODE        LINE


01892  CDE6  D0 3B              BNE GONPRC
01893  CDE8  20 A7 D0    NOTOP  JSR AYINT
01894  CDEB  A5 B4              LDA FACLO
01895  CDED  49 FF              EOR #255
01896  CDEF  A8                 TAY
01897  CDF0  A5 B3              LDA FACMO
01898  CDF2  49 FF              EOR #255
01899  CDF4  4C 78 D2           JMP GIVAYF
01900  CDF7  C9 A5       EVAL4  CMP #FNTK
01901  CDF9  D0 03              BNE *+5
01902  CDFB  4C D6 D2           JMP FNDOER
01903  CDFE  C9 B4              CMP #ONEFUN
01904  CE00  90 03              BCC PARCHK
01905  CE02  4C 97 CE           JMP ISFUN
01906  CE05  20 0E CE    PARCHK JSR CHKOPN
01907  CE08  20 B8 CC           JSR FRMEVL
01908  CE0B  A9 29       CHKCLS LDA #41
01909  CE0D  2C                 .BYT $2C
01910  CE0E  A9 28       CHKOPN LDA #40
01911  CE10  2C                 .BYT $2C
01912  CE11  A9 2C       CHKCOM LDA #44
01913  CE13  A0 00       SYNCHR LDY #0
01914  CE15  D1 C9              CMP (TXTPTR)Y
01915  CE17  D0 03              BNE SNERR
01916  CE19  4C C2 00           JMP CHRGET
01917  CE1C  A2 10       SNERR  LDX #ERRSN
01918  CE1E  4C 59 C3           JMP ERROR
01919  CE21  A0 15       DOMIN  LDY #21
01920  CE23  68          GONPRC PLA
01921  CE24  68                 PLA
01922  CE25  4C 14 CD           JMP NEGPRC
01923  CE28              .FIL   CODE10





























CODE10......PAGE 002A

LINE# LOC   CODE        LINE


01925  CE28  20 7B CF    ISVAR  JSR PTRGET
01926  CE2B  85 B3       ISVRET STA FACMO
01927  CE2D  84 B4              STY FACLO
01928  CE2F  A5 94              LDA VARNAM
01929  CE31  A4 95              LDY VARNAM+1
01930  CE33  A6 5E              LDX VALTYP
01931  CE35  F0 1D              BEQ GOOO
01932  CE37              ;       CMP #'T
01933  CE37              ;       BNE STRRTS
01934  CE37  4C 9F E1           JMP PATCH2
01935  CE3A  18                 .BYT $18
01936  CE3B  C0 C9       LCE3B  CPY #$C9
01937  CE3D  D0 14              BNE STRRTS
01938  CE3F  20 76 CE           JSR GETTIM
01939  CE42  84 AD              STY TENEXP
01940  CE44  88                 DEY
01941  CE45  84 C0              STY FBUFPT
01942  CE47  A0 06              LDY #6
01943  CE49  84 AC              STY DECCNT
01944  CE4B  A0 24              LDY #FDCEND-FOUTBL
01945  CE4D  20 3A DD           JSR FOUTIM
01946  CE50  4C 53 D3           JMP TIMSTR
01947  CE53  60          STRRTS RTS
01948  CE54  A6 5F       GOOO   LDX INTFLG
01949  CE56  10 0D              BPL GOOOOO
01950  CE58  A0 00              LDY #0
01951  CE5A  B1 B3              LDA (FACMO)Y
01952  CE5C  AA                 TAX
01953  CE5D  C8                 INY
01954  CE5E  B1 B3              LDA (FACMO)Y
01955  CE60  A8                 TAY
01956  CE61  8A                 TXA
01957  CE62  4C 78 D2           JMP GIVAYF
01958  CE65              GOOOOO 
01959  CE65              ;       CMP #'T
01960  CE65              ;       BNE QSTATV
01961  CE65  4C AB E1           JMP PATCH3
01962  CE68  19                 .BYT $19
01963  CE69  C0 49       LCE69  CPY #'I
01964  CE6B  D0 15              BNE QSTATV
01965  CE6D  20 76 CE           JSR GETTIM
01966  CE70  98                 TYA
01967  CE71  A2 A0              LDX #160
01968  CE73  4C 21 DB           JMP FLOATB
01969  CE76              ZZ7=CTIMR-2
01970  CE76  A9 FE       GETTIM LDA #<ZZ7
01971  CE78  A0 01              LDY #>ZZ7
01972  CE7A  78                 SEI
01973  CE7B  20 74 DA           JSR MOVFM
01974  CE7E  58                 CLI
01975  CE7F  84 B1              STY FACHO
01976  CE81  60                 RTS
01977  CE82  C9 53       QSTATV CMP #'S
01978  CE84  D0 0A              BNE GOMOVF
01979  CE86  C0 54              CPY #'T






CODE10......PAGE 002B

LINE# LOC   CODE        LINE


01980  CE88  D0 06              BNE GOMOVF
01981  CE8A  AD 0C 02           LDA CSTAT
01982  CE8D  4C 0E DB           JMP FLOAT
01983  CE90  A5 B3       GOMOVF LDA FACMO
01984  CE92  A4 B4              LDY FACMO+1
01985  CE94  4C 74 DA           JMP MOVFM
01986  CE97  0A          ISFUN  ASL A
01987  CE98  48                 PHA
01988  CE99  AA                 TAX
01989  CE9A  20 C2 00           JSR CHRGET
01990  CE9D  E0 8F              CPX #LASNUM+LASNUM-255
01991  CE9F  90 20              BCC OKNORM
01992  CEA1  20 0E CE           JSR CHKOPN
01993  CEA4  20 B8 CC           JSR FRMEVL
01994  CEA7  20 11 CE           JSR CHKCOM
01995  CEAA  20 A9 CC           JSR CHKSTR
01996  CEAD  68                 PLA
01997  CEAE  AA                 TAX
01998  CEAF  A5 B4              LDA FACMO+1
01999  CEB1  48                 PHA
02000  CEB2  A5 B3              LDA FACMO
02001  CEB4  48                 PHA
02002  CEB5  8A                 TXA
02003  CEB6  48                 PHA
02004  CEB7  20 76 D6           JSR GETBYT
02005  CEBA  68                 PLA
02006  CEBB  A8                 TAY
02007  CEBC  8A                 TXA
02008  CEBD  48                 PHA
02009  CEBE  4C C6 CE           JMP FINGO
02010  CEC1  20 05 CE    OKNORM JSR PARCHK
02011  CEC4  68                 PLA
02012  CEC5  A8                 TAY
02013  CEC6  B9 DE BF    FINGO  LDA FUNDSP-ONEFUN-ONEFUN+256,Y
02014  CEC9  85 A4              STA JMPER+1
02015  CECB  B9 DF BF           LDA FUNDSP-ONEFUN-ONEFUN+257,Y
02016  CECE  85 A5              STA JMPER+2
02017  CED0  20 A3 00           JSR JMPER
02018  CED3  4C A7 CC           JMP CHKNUM
02019  CED6  A0 FF       OROP   LDY #255
02020  CED8  2C                 .BYT $2C
02021  CED9  A0 00       ANDOP  LDY #0
02022  CEDB  84 5C              STY COUNT
02023  CEDD  20 A7 D0           JSR AYINT
02024  CEE0  A5 B3              LDA FACMO
02025  CEE2  45 5C              EOR COUNT
02026  CEE4  85 5A              STA INTEGR
02027  CEE6  A5 B4              LDA FACLO
02028  CEE8  45 5C              EOR COUNT
02029  CEEA  85 5B              STA INTEGR+1
02030  CEEC  20 CE DA           JSR MOVFA
02031  CEEF  20 A7 D0           JSR AYINT
02032  CEF2  A5 B4              LDA FACLO
02033  CEF4  45 5C              EOR COUNT
02034  CEF6  25 5B              AND INTEGR+1






CODE10......PAGE 002C

LINE# LOC   CODE        LINE


02035  CEF8  45 5C              EOR COUNT
02036  CEFA  A8                 TAY
02037  CEFB  A5 B3              LDA FACMO
02038  CEFD  45 5C              EOR COUNT
02039  CEFF  25 5A              AND INTEGR
02040  CF01  45 5C              EOR COUNT
02041  CF03  4C 78 D2           JMP GIVAYF
02042  CF06  20 AA CC    DOREL  JSR CHKVAL
02043  CF09  B0 13              BCS STRCMP
02044  CF0B  A5 BD              LDA ARGSGN
02045  CF0D  09 7F              ORA #127
02046  CF0F  25 B9              AND ARGHO
02047  CF11  85 B9              STA ARGHO
02048  CF13  A9 B8              LDA #<ARGEXP
02049  CF15  A0 00              LDY #>ARGEXP
02050  CF17  20 2D DB           JSR FCOMP
02051  CF1A  AA                 TAX
02052  CF1B  4C 51 CF           JMP QCOMP
02053  CF1E  A9 00       STRCMP LDA #0
02054  CF20  85 5E              STA VALTYP
02055  CF22  C6 9C              DEC OPMASK
02056  CF24  20 7E D5           JSR FREFAC
02057  CF27  85 B0              STA DSCTMP
02058  CF29  86 B1              STX DSCTMP+1
02059  CF2B  84 B2              STY DSCTMP+2
02060  CF2D  A5 BB              LDA ARGMO
02061  CF2F  A4 BC              LDY ARGMO+1
02062  CF31  20 82 D5           JSR FRETMP
02063  CF34  86 BB              STX ARGMO
02064  CF36  84 BC              STY ARGMO+1
02065  CF38  AA                 TAX
02066  CF39  38                 SEC
02067  CF3A  E5 B0              SBC DSCTMP
02068  CF3C  F0 08              BEQ STASGN
02069  CF3E  A9 01              LDA #1
02070  CF40  90 04              BCC STASGN
02071  CF42  A6 B0              LDX DSCTMP
02072  CF44  A9 FF              LDA #$FF
02073  CF46  85 B5       STASGN STA FACSGN
02074  CF48  A0 FF              LDY #255
02075  CF4A  E8                 INX
02076  CF4B  C8          NXTCMP INY
02077  CF4C  CA                 DEX
02078  CF4D  D0 07              BNE GETCMP
02079  CF4F  A6 B5              LDX FACSGN
02080  CF51  30 0F       QCOMP  BMI DOCMP
02081  CF53  18                 CLC
02082  CF54  90 0C              BCC DOCMP
02083  CF56  B1 BB       GETCMP LDA (ARGMO)Y
02084  CF58              .FIL   CODE11
02085  CF58              ;*****CODE11*****
02086  CF58  D1 B1              CMP (DSCTMP+1)Y
02087  CF5A  F0 EF              BEQ NXTCMP
02088  CF5C  A2 FF              LDX #$FF
02089  CF5E  B0 02              BCS DOCMP






CODE10......PAGE 002D

LINE# LOC   CODE        LINE


02090  CF60  A2 01              LDX #1
02091  CF62  E8          DOCMP  INX
02092  CF63  8A                 TXA
02093  CF64  2A                 ROL A
02094  CF65  25 63              AND DOMASK
02095  CF67  F0 02              BEQ GOFLOT
02096  CF69  A9 FF              LDA #$FF
02097  CF6B  4C 0E DB    GOFLOT JMP FLOAT
02098  CF6E  20 11 CE    DIM3   JSR CHKCOM
02099  CF71  AA          DIM    TAX
02100  CF72  20 80 CF           JSR PTRGT1
02101  CF75  20 C8 00           JSR CHRGOT
02102  CF78  D0 F4              BNE DIM3
02103  CF7A  60                 RTS
02104  CF7B  A2 00       PTRGET LDX #0
02105  CF7D  20 C8 00           JSR CHRGOT
02106  CF80  86 5D       PTRGT1 STX DIMFLG
02107  CF82  85 94       PTRGT2 STA VARNAM
02108  CF84  20 C8 00           JSR CHRGOT
02109  CF87  20 05 D0           JSR ISLETC
02110  CF8A  B0 03              BCS PTRGT3
02111  CF8C  4C 1C CE    INTERR JMP SNERR
02112  CF8F  A2 00       PTRGT3 LDX #0
02113  CF91  86 5E              STX VALTYP
02114  CF93  86 5F              STX INTFLG
02115  CF95  20 C2 00           JSR CHRGET
02116  CF98  90 05              BCC ISSEC
02117  CF9A  20 05 D0           JSR ISLETC
02118  CF9D  90 0B              BCC NOSEC
02119  CF9F  AA          ISSEC  TAX
02120  CFA0  20 C2 00    EATEM  JSR CHRGET
02121  CFA3  90 FB              BCC EATEM
02122  CFA5  20 05 D0           JSR ISLETC
02123  CFA8  B0 F6              BCS EATEM
02124  CFAA  C9 24       NOSEC  CMP #'$
02125  CFAC  D0 06              BNE NOTSTR
02126  CFAE  A9 FF              LDA #$FF
02127  CFB0  85 5E              STA VALTYP
02128  CFB2  D0 10              BNE TURNON
02129  CFB4  C9 25       NOTSTR CMP #'%
02130  CFB6  D0 13              BNE STRNAM
02131  CFB8  A5 61              LDA SUBFLG
02132  CFBA  D0 D0              BNE INTERR
02133  CFBC  A9 80              LDA #128
02134  CFBE  85 5F              STA INTFLG
02135  CFC0  05 94              ORA VARNAM
02136  CFC2  85 94              STA VARNAM
02137  CFC4  8A          TURNON TXA
02138  CFC5  09 80              ORA #128
02139  CFC7  AA                 TAX
02140  CFC8  20 C2 00           JSR CHRGET
02141  CFCB  86 95       STRNAM STX VARNAM+1
02142  CFCD  38                 SEC
02143  CFCE  05 61              ORA SUBFLG
02144  CFD0  E9 28              SBC #40






CODE10......PAGE 002E

LINE# LOC   CODE        LINE


02145  CFD2  D0 03              BNE *+5
02146  CFD4  4C B9 D0           JMP ISARY
02147  CFD7  A9 00              LDA #0
02148  CFD9  85 61              STA SUBFLG
02149  CFDB  A5 7C              LDA VARTAB
02150  CFDD  A6 7D              LDX VARTAB+1
02151  CFDF  A0 00              LDY #0
02152  CFE1  86 AF       STXFND STX LOWTR+1
02153  CFE3  85 AE       LOPFND STA LOWTR
02154  CFE5  E4 7F              CPX ARYTAB+1
02155  CFE7  D0 04              BNE LOPFN
02156  CFE9  C5 7E              CMP ARYTAB
02157  CFEB  F0 22              BEQ NOTFNS
02158  CFED  A5 94       LOPFN  LDA VARNAM
02159  CFEF  D1 AE              CMP (LOWTR)Y
02160  CFF1  D0 08              BNE NOTIT
02161  CFF3  A5 95              LDA VARNAM+1
02162  CFF5  C8                 INY
02163  CFF6  D1 AE              CMP (LOWTR)Y
02164  CFF8  F0 7F              BEQ FINPTR
02165  CFFA  88          NXTPTR DEY
02166  CFFB  18          NOTIT  CLC
02167  CFFC  A5 AE              LDA LOWTR
02168  CFFE  69 07              ADC #6+ADDPRC
02169  D000  90 E1              BCC LOPFND
02170  D002  E8                 INX
02171  D003  D0 DC              BNE STXFND
02172  D005  C9 41       ISLETC CMP #'A
02173  D007  90 05              BCC ISLRTS
02174  D009  E9 5B              SBC #$5B
02175  D00B  38                 SEC
02176  D00C  E9 A5              SBC #@245
02177  D00E  60          ISLRTS RTS
02178  D00F  68          NOTFNS PLA
02179  D010  48                 PHA
02180  D011              ZZ6=ISVRET-1
02181  D011  C9 2A              CMP #<ZZ6
02182  D013  D0 07              BNE NOTEVL
02183  D015  A9 1A       LDZR   LDA #<ZERO
02184  D017  A0 D0              LDY #>ZERO
02185  D019  60                 RTS
02186  D01A  00          ZERO   .BYT 0,0
02186  D01B  00 
02187  D01C  A5 94       NOTEVL LDA VARNAM
02188  D01E  A4 95              LDY VARNAM+1
02189  D020  C9 54              CMP #'T
02190  D022  D0 0B              BNE QSTAVR
02191  D024  C0 C9              CPY #@311
02192  D026  F0 ED              BEQ LDZR
02193  D028  C0 49              CPY #@111
02194  D02A  D0 03              BNE QSTAVR
02195  D02C  4C 1C CE    GOBADV JMP SNERR
02196  D02F  C9 53       QSTAVR CMP #'S
02197  D031  D0 04              BNE VAROK
02198  D033  C0 54              CPY #'T






CODE10......PAGE 002F

LINE# LOC   CODE        LINE


02199  D035  F0 F5              BEQ GOBADV
02200  D037  A5 7E       VAROK  LDA ARYTAB
02201  D039  A4 7F              LDY ARYTAB+1
02202  D03B  85 AE              STA LOWTR
02203  D03D  84 AF              STY LOWTR+1
02204  D03F  A5 80              LDA STREND
02205  D041  A4 81              LDY STREND+1
02206  D043  85 A9              STA HIGHTR
02207  D045  84 AA              STY HIGHTR+1
02208  D047  18                 CLC
02209  D048  69 07              ADC #6+ADDPRC
02210  D04A  90 01              BCC NOTEVE
02211  D04C  C8                 INY
02212  D04D  85 A7       NOTEVE STA HIGHDS
02213  D04F  84 A8              STY HIGHDS+1
02214  D051  20 DA C2           JSR BLTU
02215  D054  A5 A7              LDA HIGHDS
02216  D056  A4 A8              LDY HIGHDS+1
02217  D058  C8                 INY
02218  D059  85 7E              STA ARYTAB
02219  D05B  84 7F              STY ARYTAB+1
02220  D05D  A0 00       ARYDON LDY #0
02221  D05F  A5 94              LDA VARNAM
02222  D061  91 AE              STA (LOWTR)Y
02223  D063  C8                 INY
02224  D064  A5 95              LDA VARNAM+1
02225  D066  91 AE              STA (LOWTR)Y
02226  D068  A9 00              LDA #0
02227  D06A  C8                 INY
02228  D06B  91 AE              STA (LOWTR)Y
02229  D06D  C8                 INY
02230  D06E  91 AE              STA (LOWTR)Y
02231  D070  C8                 INY
02232  D071  91 AE              STA (LOWTR)Y
02233  D073  C8                 INY
02234  D074  91 AE              STA (LOWTR)Y
02235  D076  C8                 INY
02236  D077  91 AE              STA (LOWTR)Y
02237  D079  A5 AE       FINPTR LDA LOWTR
02238  D07B  18                 CLC
02239  D07C  69 02              ADC #2
02240  D07E  A4 AF              LDY LOWTR+1
02241  D080  90 01              BCC FINNOW
02242  D082  C8                 INY
02243  D083  85 96       FINNOW STA VARPNT
02244  D085  84 97              STY VARPNT+1
02245  D087  60                 RTS
02246  D088  A5 5C       FMAPTR LDA COUNT
02247  D08A  0A                 ASL A
02248  D08B  69 05              ADC #5
02249  D08D  65 AE              ADC LOWTR
02250  D08F  A4 AF              LDY LOWTR+1
02251  D091  90 01              BCC JSRGM
02252  D093  C8                 INY
02253  D094  85 A7       JSRGM  STA ARYPNT






CODE10......PAGE 0030

LINE# LOC   CODE        LINE


02254  D096  84 A8              STY ARYPNT+1
02255  D098  60                 RTS
02256  D099              .FIL   CODE12
02257  D099              ;*****CODE12*****
02258  D099  90          N32768 .BYT 144,128,0,0
02258  D09A  80 
02258  D09B  00 
02258  D09C  00 
02259  D09D  20 C2 00    INTIDX JSR CHRGET
02260  D0A0  20 A4 CC           JSR FRMNUM
02261  D0A3  A5 B5       POSINT LDA FACSGN
02262  D0A5  30 0D              BMI NONONO
02263  D0A7  A5 B0       AYINT  LDA FACEXP
02264  D0A9  C9 90              CMP #144
02265  D0AB  90 09              BCC QINTGO
02266  D0AD  A9 99              LDA #<N32768
02267  D0AF  A0 D0              LDY #>N32768
02268  D0B1  20 2D DB           JSR FCOMP
02269  D0B4  D0 7A       NONONO BNE FCERR
02270  D0B6  4C 6D DB    QINTGO JMP QINT
02271  D0B9  A5 5D       ISARY  LDA DIMFLG
02272  D0BB  05 5F              ORA INTFLG
02273  D0BD  48                 PHA
02274  D0BE  A5 5E              LDA VALTYP
02275  D0C0  48                 PHA
02276  D0C1  A0 00              LDY #0
02277  D0C3  98          INDLOP TYA
02278  D0C4  48                 PHA
02279  D0C5  A5 95              LDA VARNAM+1
02280  D0C7  48                 PHA
02281  D0C8  A5 94              LDA VARNAM
02282  D0CA  48                 PHA
02283  D0CB  20 9D D0           JSR INTIDX
02284  D0CE  68                 PLA
02285  D0CF  85 94              STA VARNAM
02286  D0D1  68                 PLA
02287  D0D2  85 95              STA VARNAM+1
02288  D0D4  68                 PLA
02289  D0D5  A8                 TAY
02290  D0D6  BA                 TSX
02291  D0D7  BD 02 01           LDA 258,X
02292  D0DA  48                 PHA
02293  D0DB  BD 01 01           LDA 257,X
02294  D0DE  48                 PHA
02295  D0DF  A5 B3              LDA INDICE
02296  D0E1  9D 02 01           STA 258,X
02297  D0E4  A5 B4              LDA INDICE+1
02298  D0E6  9D 01 01           STA 257,X
02299  D0E9  C8                 INY
02300  D0EA  20 C8 00           JSR CHRGOT
02301  D0ED  C9 2C              CMP #44
02302  D0EF  F0 D2              BEQ INDLOP
02303  D0F1  84 5C              STY COUNT
02304  D0F3  20 0B CE           JSR CHKCLS
02305  D0F6  68                 PLA






CODE10......PAGE 0031

LINE# LOC   CODE        LINE


02306  D0F7  85 5E              STA VALTYP
02307  D0F9  68                 PLA
02308  D0FA  85 5F              STA INTFLG
02309  D0FC  29 7F              AND #127
02310  D0FE  85 5D              STA DIMFLG
02311  D100  A6 7E              LDX ARYTAB
02312  D102  A5 7F              LDA ARYTAB+1
02313  D104  86 AE       LOPFDA STX LOWTR
02314  D106  85 AF              STA LOWTR+1
02315  D108  C5 81              CMP STREND+1
02316  D10A  D0 04              BNE LOPFDV
02317  D10C  E4 80              CPX STREND
02318  D10E  F0 39              BEQ NOTFDD
02319  D110  A0 00       LOPFDV LDY #0
02320  D112  B1 AE              LDA (LOWTR)Y
02321  D114  C8                 INY
02322  D115  C5 94              CMP VARNAM
02323  D117  D0 06              BNE NMARY1
02324  D119  A5 95              LDA VARNAM+1
02325  D11B  D1 AE              CMP (LOWTR)Y
02326  D11D  F0 16              BEQ GOTARY
02327  D11F  C8          NMARY1 INY
02328  D120  B1 AE              LDA (LOWTR)Y
02329  D122  18                 CLC
02330  D123  65 AE              ADC LOWTR
02331  D125  AA                 TAX
02332  D126  C8                 INY
02333  D127  B1 AE              LDA (LOWTR)Y
02334  D129  65 AF              ADC LOWTR+1
02335  D12B  90 D7              BCC LOPFDA
02336  D12D  A2 70       BSERR  LDX #ERRBS
02337  D12F  2C                 .BYT $2C
02338  D130  A2 35       FCERR  LDX #ERRFC
02339  D132  4C 59 C3    ERRGO3 JMP ERROR
02340  D135  A2 7D       GOTARY LDX #ERRDD
02341  D137  A5 5D              LDA DIMFLG
02342  D139  D0 F7              BNE ERRGO3
02343  D13B  20 88 D0           JSR FMAPTR
02344  D13E  A5 5C              LDA COUNT
02345  D140  A0 04              LDY #4
02346  D142  D1 AE              CMP (LOWTR)Y
02347  D144  D0 E7              BNE BSERR
02348  D146  4C D3 D1           JMP GETDEF
02349  D149  20 88 D0    NOTFDD JSR FMAPTR
02350  D14C  20 2A C3           JSR REASON
02351  D14F  A9 00              LDA #0
02352  D151  A8                 TAY
02353  D152  85 C1              STA CURTOL+1
02354  D154  A2 05              LDX #5
02355  D156  A5 94              LDA VARNAM
02356  D158  91 AE              STA (LOWTR)Y
02357  D15A  10 01              BPL NOTFLT
02358  D15C  CA                 DEX
02359  D15D  C8          NOTFLT INY
02360  D15E  A5 95              LDA VARNAM+1






CODE10......PAGE 0032

LINE# LOC   CODE        LINE


02361  D160  91 AE              STA (LOWTR)Y
02362  D162  10 02              BPL STOMLT
02363  D164  CA                 DEX
02364  D165  CA                 DEX
02365  D166  86 C0       STOMLT STX CURTOL
02366  D168  A5 5C              LDA COUNT
02367  D16A  C8                 INY
02368  D16B  C8                 INY
02369  D16C  C8                 INY
02370  D16D  91 AE              STA (LOWTR)Y
02371  D16F  A2 0B       LOPPTA LDX #11
02372  D171  A9 00              LDA #0
02373  D173  24 5D              BIT DIMFLG
02374  D175  50 08              BVC NOTDIM
02375  D177  68                 PLA
02376  D178  18                 CLC
02377  D179  69 01              ADC #1
02378  D17B  AA                 TAX
02379  D17C  68                 PLA
02380  D17D  69 00              ADC #0
02381  D17F  C8          NOTDIM INY
02382  D180  91 AE              STA (LOWTR)Y
02383  D182  C8                 INY
02384  D183  8A                 TXA
02385  D184  91 AE              STA (LOWTR)Y
02386  D186  20 33 D2           JSR UMULT
02387  D189  86 C0              STX CURTOL
02388  D18B  85 C1              STA CURTOL+1
02389  D18D  A4 71              LDY INDEX
02390  D18F  C6 5C              DEC COUNT
02391  D191  D0 DC              BNE LOPPTA
02392  D193  65 A8              ADC ARYPNT+1
02393  D195  B0 5D              BCS OMERR1
02394  D197  85 A8              STA ARYPNT+1
02395  D199  A8                 TAY
02396  D19A  8A                 TXA
02397  D19B  65 A7              ADC ARYPNT
02398  D19D  90 03              BCC GREASE
02399  D19F  C8                 INY
02400  D1A0  F0 52              BEQ OMERR1
02401  D1A2  20 2A C3    GREASE JSR REASON
02402  D1A5  85 80              STA STREND
02403  D1A7  84 81              STY STREND+1
02404  D1A9  A9 00              LDA #0
02405  D1AB  E6 C1              INC CURTOL+1
02406  D1AD              .FIL   CODE13















CODE13......PAGE 0033

LINE# LOC   CODE        LINE


02408  D1AD  A4 C0              LDY CURTOL
02409  D1AF  F0 05              BEQ DECCUR
02410  D1B1  88          ZERITA DEY
02411  D1B2  91 A7              STA (ARYPNT)Y
02412  D1B4  D0 FB              BNE ZERITA
02413  D1B6  C6 A8       DECCUR DEC ARYPNT+1
02414  D1B8  C6 C1              DEC CURTOL+1
02415  D1BA  D0 F5              BNE ZERITA
02416  D1BC  E6 A8              INC ARYPNT+1
02417  D1BE  38                 SEC
02418  D1BF  A5 80              LDA STREND
02419  D1C1  E5 AE              SBC LOWTR
02420  D1C3  A0 02              LDY #2
02421  D1C5  91 AE              STA (LOWTR)Y
02422  D1C7  A5 81              LDA STREND+1
02423  D1C9  C8                 INY
02424  D1CA  E5 AF              SBC LOWTR+1
02425  D1CC  91 AE              STA (LOWTR)Y
02426  D1CE  A5 5D              LDA DIMFLG
02427  D1D0  D0 60              BNE DIMRTS
02428  D1D2  C8                 INY
02429  D1D3  B1 AE       GETDEF LDA (LOWTR)Y
02430  D1D5  85 5C              STA COUNT
02431  D1D7  A9 00              LDA #0
02432  D1D9  85 C0              STA CURTOL
02433  D1DB  85 C1       INLPNM STA CURTOL+1
02434  D1DD  C8                 INY
02435  D1DE  68                 PLA
02436  D1DF  AA                 TAX
02437  D1E0  85 B3              STA INDICE
02438  D1E2  68                 PLA
02439  D1E3  85 B4              STA INDICE+1
02440  D1E5  D1 AE              CMP (LOWTR)Y
02441  D1E7  90 0E              BCC INLPN2
02442  D1E9  D0 06              BNE BSERR7
02443  D1EB  C8                 INY
02444  D1EC  8A                 TXA
02445  D1ED  D1 AE              CMP (LOWTR)Y
02446  D1EF  90 07              BCC INLPN1
02447  D1F1  4C 2D D1    BSERR7 JMP BSERR
02448  D1F4  4C 57 C3    OMERR1 JMP OMERR
02449  D1F7  C8          INLPN2 INY
02450  D1F8  A5 C1       INLPN1 LDA CURTOL+1
02451  D1FA  05 C0              ORA CURTOL
02452  D1FC  18                 CLC
02453  D1FD  F0 0A              BEQ ADDIND
02454  D1FF  20 33 D2           JSR UMULT
02455  D202  8A                 TXA
02456  D203  65 B3              ADC INDICE
02457  D205  AA                 TAX
02458  D206  98                 TYA
02459  D207  A4 71              LDY INDEX1
02460  D209  65 B4       ADDIND ADC INDICE+1
02461  D20B  86 C0              STX CURTOL
02462  D20D  C6 5C              DEC COUNT






CODE13......PAGE 0034

LINE# LOC   CODE        LINE


02463  D20F  D0 CA              BNE INLPNM
02464  D211  A2 05              LDX #5
02465  D213  A5 94              LDA VARNAM
02466  D215  10 01              BPL NOTFL1
02467  D217  CA                 DEX
02468  D218  A5 95       NOTFL1 LDA VARNAM+1
02469  D21A  10 02              BPL STOML1
02470  D21C  CA                 DEX
02471  D21D  CA                 DEX
02472  D21E  86 77       STOML1 STX ADDEND
02473  D220  A9 00              LDA #0
02474  D222  20 3C D2           JSR UMULTD
02475  D225  8A                 TXA
02476  D226  65 A7              ADC ARYPNT
02477  D228  85 96              STA VARPNT
02478  D22A  98                 TYA
02479  D22B  65 A8              ADC ARYPNT+1
02480  D22D  85 97              STA VARPNT+1
02481  D22F  A8                 TAY
02482  D230  A5 96              LDA VARPNT
02483  D232  60          DIMRTS RTS
02484  D233  84 71       UMULT  STY INDEX
02485  D235  B1 AE              LDA (LOWTR)Y
02486  D237  85 77              STA ADDEND
02487  D239  88                 DEY
02488  D23A  B1 AE              LDA (LOWTR)Y
02489  D23C  85 78       UMULTD STA ADDEND+1
02490  D23E  A9 10              LDA #16
02491  D240  85 AC              STA DECCNT
02492  D242  A2 00              LDX #0
02493  D244  A0 00              LDY #0
02494  D246  8A          UMULTC TXA
02495  D247  0A                 ASL A
02496  D248  AA                 TAX
02497  D249  98                 TYA
02498  D24A  2A                 ROL A
02499  D24B  A8                 TAY
02500  D24C  B0 A6              BCS OMERR1
02501  D24E  06 C0              ASL CURTOL
02502  D250  26 C1              ROL CURTOL+1
02503  D252  90 0B              BCC UMLCNT
02504  D254  18                 CLC
02505  D255  8A                 TXA
02506  D256  65 77              ADC ADDEND
02507  D258  AA                 TAX
02508  D259  98                 TYA
02509  D25A  65 78              ADC ADDEND+1
02510  D25C  A8                 TAY
02511  D25D  B0 95              BCS OMERR1
02512  D25F  C6 AC       UMLCNT DEC DECCNT
02513  D261  D0 E3              BNE UMULTC
02514  D263  60          UMLRTS RTS
02515  D264  A5 5E       FRE    LDA VALTYP
02516  D266  F0 03              BEQ NOFREF
02517  D268  20 7E D5           JSR FREFAC






CODE13......PAGE 0035

LINE# LOC   CODE        LINE


02518  D26B  20 04 D4    NOFREF JSR GARBA2
02519  D26E  38                 SEC
02520  D26F  A5 82              LDA FRETOP
02521  D271  E5 80              SBC STREND
02522  D273  A8                 TAY
02523  D274  A5 83              LDA FRETOP+1
02524  D276  E5 81              SBC STREND+1
02525  D278  A2 00       GIVAYF LDX #0
02526  D27A  86 5E              STX VALTYP
02527  D27C  85 B1              STA FACHO
02528  D27E  84 B2              STY FACHO+1
02529  D280  A2 90              LDX #144
02530  D282  4C 16 DB           JMP FLOATS
02531  D285  A4 05       POS    LDY TRMPOS
02532  D287  A9 00       SNGFLT LDA #0
02533  D289  F0 ED              BEQ GIVAYF
02534  D28B  A6 89       ERRDIR LDX CURLIN+1
02535  D28D  E8                 INX
02536  D28E  D0 A2              BNE DIMRTS
02537  D290  A2 9A              LDX #ERRID
02538  D292  4C 59 C3    ERRGO1 JMP ERROR
02539  D295  20 C3 D2    DEF    JSR GETFNM
02540  D298  20 8B D2           JSR ERRDIR
02541  D29B  20 0E CE           JSR CHKOPN
02542  D29E  A9 80              LDA #128
02543  D2A0  85 61              STA SUBFLG
02544  D2A2  20 7B CF           JSR PTRGET
02545  D2A5  20 A7 CC           JSR CHKNUM
02546  D2A8  20 0B CE           JSR CHKCLS
02547  D2AB  A9 B2              LDA #$B2
02548  D2AD  20 13 CE           JSR SYNCHR
02549  D2B0  48                 PHA
02550  D2B1  A5 97              LDA VARPNT+1
02551  D2B3  48                 PHA
02552  D2B4  A5 96              LDA VARPNT
02553  D2B6  48                 PHA
02554  D2B7  A5 CA              LDA TXTPTR+1
02555  D2B9              .FIL   CODE14























CODE14......PAGE 0036

LINE# LOC   CODE        LINE


02557  D2B9  48                 PHA
02558  D2BA  A5 C9              LDA TXTPTR
02559  D2BC  48                 PHA
02560  D2BD  20 F0 C7           JSR DATA
02561  D2C0  4C 33 D3           JMP DEFFIN
02562  D2C3  A9 A5       GETFNM LDA #FNTK
02563  D2C5  20 13 CE           JSR SYNCHR
02564  D2C8  09 80              ORA #128
02565  D2CA  85 61              STA SUBFLG
02566  D2CC  20 82 CF           JSR PTRGT2
02567  D2CF  85 9D              STA DEFPNT
02568  D2D1  84 9E              STY DEFPNT+1
02569  D2D3  4C A7 CC           JMP CHKNUM
02570  D2D6  20 C3 D2    FNDOER JSR GETFNM
02571  D2D9  A5 9E              LDA DEFPNT+1
02572  D2DB  48                 PHA
02573  D2DC  A5 9D              LDA DEFPNT
02574  D2DE  48                 PHA
02575  D2DF  20 05 CE           JSR PARCHK
02576  D2E2  20 A7 CC           JSR CHKNUM
02577  D2E5  68                 PLA
02578  D2E6  85 9D              STA DEFPNT
02579  D2E8  68                 PLA
02580  D2E9  85 9E              STA DEFPNT+1
02581  D2EB  A0 02              LDY #2
02582  D2ED  A2 ED              LDX #ERRUF
02583  D2EF  B1 9D              LDA (DEFPNT)Y
02584  D2F1  F0 9F              BEQ ERRGO1
02585  D2F3  85 96              STA VARPNT
02586  D2F5  AA                 TAX
02587  D2F6  C8                 INY
02588  D2F7  B1 9D              LDA (DEFPNT)Y
02589  D2F9  85 97              STA VARPNT+1
02590  D2FB  C8                 INY
02591  D2FC  B1 96       DEFSTF LDA (VARPNT)Y
02592  D2FE  48                 PHA
02593  D2FF  88                 DEY
02594  D300  10 FA              BPL DEFSTF
02595  D302  A4 97              LDY VARPNT+1
02596  D304  20 A6 DA           JSR MOVMF
02597  D307  A5 CA              LDA TXTPTR+1
02598  D309  48                 PHA
02599  D30A  A5 C9              LDA TXTPTR
02600  D30C  48                 PHA
02601  D30D  B1 9D              LDA (DEFPNT)Y
02602  D30F  85 C9              STA TXTPTR
02603  D311  C8                 INY
02604  D312  B1 9D              LDA (DEFPNT)Y
02605  D314  85 CA              STA TXTPTR+1
02606  D316  A5 97              LDA VARPNT+1
02607  D318  48                 PHA
02608  D319  A5 96              LDA VARPNT
02609  D31B  48                 PHA
02610  D31C  20 A4 CC           JSR FRMNUM
02611  D31F  68                 PLA






CODE14......PAGE 0037

LINE# LOC   CODE        LINE


02612  D320  85 9D              STA DEFPNT
02613  D322  68                 PLA
02614  D323  85 9E              STA DEFPNT+1
02615  D325  20 C8 00           JSR CHRGOT
02616  D328  F0 03              BEQ *+5
02617  D32A  4C 1C CE           JMP SNERR
02618  D32D  68                 PLA
02619  D32E  85 C9              STA TXTPTR
02620  D330  68                 PLA
02621  D331  85 CA              STA TXTPTR+1
02622  D333  A0 00       DEFFIN LDY #0
02623  D335  68                 PLA
02624  D336  91 9D              STA (DEFPNT)Y
02625  D338  68                 PLA
02626  D339  C8                 INY
02627  D33A  91 9D              STA (DEFPNT)Y
02628  D33C  68                 PLA
02629  D33D  C8                 INY
02630  D33E  91 9D              STA (DEFPNT)Y
02631  D340  68                 PLA
02632  D341  C8                 INY
02633  D342  91 9D              STA (DEFPNT)Y
02634  D344  68                 PLA
02635  D345  C8                 INY
02636  D346  91 9D              STA (DEFPNT)Y
02637  D348  60                 RTS
02638  D349  20 A7 CC    STRD   JSR CHKNUM
02639  D34C  A0 00              LDY #0
02640  D34E  20 B1 DC           JSR FOUTC
02641  D351  68                 PLA
02642  D352  68                 PLA
02643  D353  A9 FF       TIMSTR LDA #<LOFBUF
02644  D355  A0 00              LDY #>LOFBUF
02645  D357  F0 12              BEQ STRLIT
02646  D359  A6 B3       STRINI LDX FACMO
02647  D35B  A4 B4              LDY FACMO+1
02648  D35D  86 9F              STX DSCPNT
02649  D35F  84 A0              STY DSCPNT+1
02650  D361  20 D2 D3    STRSPA JSR GETSPA
02651  D364  86 B1              STX DSCTMP+1
02652  D366  84 B2              STY DSCTMP+2
02653  D368  85 B0              STA DSCTMP
02654  D36A  60                 RTS
02655  D36B  A2 22       STRLIT LDX #34
02656  D36D  86 5A              STX CHARAC
02657  D36F  86 5B              STX ENDCHR
02658  D371  85 BE       STRLT2 STA STRNG1
02659  D373  84 BF              STY STRNG1+1
02660  D375  85 B1              STA DSCTMP+1
02661  D377  84 B2              STY DSCTMP+2
02662  D379  A0 FF              LDY #255
02663  D37B  C8          STRGET INY
02664  D37C  B1 BE              LDA (STRNG1)Y
02665  D37E  F0 0C              BEQ STRFI1
02666  D380  C5 5A              CMP CHARAC






CODE14......PAGE 0038

LINE# LOC   CODE        LINE


02667  D382  F0 04              BEQ STRFIN
02668  D384  C5 5B              CMP ENDCHR
02669  D386  D0 F3              BNE STRGET
02670  D388  C9 22       STRFIN CMP #34
02671  D38A  F0 01              BEQ STRFI2
02672  D38C  18          STRFI1 CLC
02673  D38D  84 B0       STRFI2 STY DSCTMP
02674  D38F  98                 TYA
02675  D390  65 BE              ADC STRNG1
02676  D392  85 C0              STA STRNG2
02677  D394  A6 BF              LDX STRNG1+1
02678  D396  90 01              BCC STRST2
02679  D398  E8                 INX
02680  D399  86 C1       STRST2 STX STRNG2+1
02681  D39B  A5 BF              LDA STRNG1+1
02682  D39D  D0 0B              BNE PUTNEW
02683  D39F  98                 TYA
02684  D3A0  20 59 D3           JSR STRINI
02685  D3A3  A6 BE              LDX STRNG1
02686  D3A5  A4 BF              LDY STRNG1+1
02687  D3A7  20 60 D5           JSR MOVSTR
02688  D3AA  A6 65       PUTNEW LDX TEMPPT
02689  D3AC  E0 71              CPX #TEMPST+STRSIZ+STRSIZ+STRSIZ
02690  D3AE  D0 05              BNE PUTNW1
02691  D3B0  A2 CC              LDX #ERRST
02692  D3B2  4C 59 C3    ERRGO2 JMP ERROR
02693  D3B5  A5 B0       PUTNW1 LDA DSCTMP
02694  D3B7  95 00              STA 0,X
02695  D3B9  A5 B1              LDA DSCTMP+1
02696  D3BB  95 01              STA 1,X
02697  D3BD  A5 B2              LDA DSCTMP+2
02698  D3BF  95 02              STA 2,X
02699  D3C1  A0 00              LDY #0
02700  D3C3  86 B3              STX FACMO
02701  D3C5  84 B4              STY FACLO
02702  D3C7  88                 DEY
02703  D3C8  84 5E              STY VALTYP
02704  D3CA  86 66              STX LASTPT
02705  D3CC  E8                 INX
02706  D3CD  E8                 INX
02707  D3CE  E8                 INX
02708  D3CF  86 65              STX TEMPPT
02709  D3D1  60                 RTS
02710  D3D2  46 60       GETSPA LSR GARBFL
02711  D3D4  48          TRYAG2 PHA
02712  D3D5  49 FF              EOR #255
02713  D3D7  38                 SEC
02714  D3D8  65 82              ADC FRETOP
02715  D3DA  A4 83              LDY FRETOP+1
02716  D3DC  B0 01              BCS TRYAG3
02717  D3DE  88                 DEY
02718  D3DF  C4 81       TRYAG3 CPY STREND+1
02719  D3E1  90 11              BCC GARBAG
02720  D3E3  D0 04              BNE STRFRE
02721  D3E5  C5 80              CMP STREND






CODE14......PAGE 0039

LINE# LOC   CODE        LINE


02722  D3E7  90 0B              BCC GARBAG
02723  D3E9  85 82       STRFRE STA FRETOP
02724  D3EB  84 83              STY FRETOP+1
02725  D3ED  85 84              STA FRESPC
02726  D3EF  84 85              STY FRESPC+1
02727  D3F1  AA                 TAX
02728  D3F2  68                 PLA
02729  D3F3  60                 RTS
02730  D3F4  A2 52       GARBAG LDX #ERROM      ;OUT OF MEMORY
02731  D3F6  A5 60              LDA GARBFL
02732  D3F8  30 B8              BMI ERRGO2
02733  D3FA  20 04 D4           JSR GARBA2
02734  D3FD  A9 80              LDA #128
02735  D3FF  85 60              STA GARBFL
02736  D401  68                 PLA
02737  D402  D0 D0              BNE TRYAG2
02738  D404  A6 86       GARBA2 LDX MEMSIZ
02739  D406  A5 87              LDA MEMSIZ+1
02740  D408  86 82       FNDVAR STX FRETOP
02741  D40A  85 83              STA FRETOP+1
02742  D40C  A0 00              LDY #0
02743  D40E  84 9E              STY GRBPNT+1
02744  D410  A5 80              LDA STREND
02745  D412  A6 81              LDX STREND+1
02746  D414  85 AE              STA GRBTOP
02747  D416  86 AF              STX GRBTOP+1
02748  D418  A9 68              LDA #<TEMPST
02749  D41A  A2 00              LDX #>TEMPST
02750  D41C  85 71              STA INDEX1
02751  D41E  86 72              STX INDEX1+1
02752  D420  C5 65       TVAR   CMP TEMPPT
02753  D422  F0 05              BEQ SVARS
02754  D424  20 A1 D4           JSR DVAR
02755  D427  F0 F7              BEQ TVAR
02756  D429  A9 07       SVARS  LDA #6+ADDPRC
02757  D42B  85 A2              STA FOUR6
02758  D42D  A5 7C              LDA VARTAB
02759  D42F  A6 7D              LDX VARTAB+1
02760  D431              .FIL   CODE15






















CODE15......PAGE 003A

LINE# LOC   CODE        LINE


02762  D431  85 71              STA INDEX1
02763  D433  86 72              STX INDEX1+1
02764  D435  E4 7F       SVAR   CPX ARYTAB+1
02765  D437  D0 04              BNE SVARGO
02766  D439  C5 7E              CMP ARYTAB
02767  D43B  F0 05              BEQ ARYVAR
02768  D43D  20 97 D4    SVARGO JSR DVARS
02769  D440  F0 F3              BEQ SVAR
02770  D442  85 A7       ARYVAR STA ARYPNT
02771  D444  86 A8              STX ARYPNT+1
02772  D446  A9 03              LDA #STRSIZ
02773  D448  85 A2              STA FOUR6
02774  D44A  A5 A7       ARYVA2 LDA ARYPNT
02775  D44C  A6 A8              LDX ARYPNT+1
02776  D44E  E4 81       ARYVA3 CPX STREND+1
02777  D450  D0 07              BNE ARYVGO
02778  D452  C5 80              CMP STREND
02779  D454  D0 03              BNE *+5
02780  D456  4C E0 D4           JMP GRBPAS
02781  D459  85 71       ARYVGO STA INDEX1
02782  D45B  86 72              STX INDEX1+1
02783  D45D  A0 00              LDY #1-ADDPRC
02784  D45F  B1 71              LDA (INDEX1)Y
02785  D461  AA                 TAX
02786  D462  C8                 INY
02787  D463  B1 71              LDA (INDEX1)Y
02788  D465  08                 PHP
02789  D466  C8                 INY
02790  D467  B1 71              LDA (INDEX1)Y
02791  D469  65 A7              ADC ARYPNT
02792  D46B  85 A7              STA ARYPNT
02793  D46D  C8                 INY
02794  D46E  B1 71              LDA (INDEX1)Y
02795  D470  65 A8              ADC ARYPNT+1
02796  D472  85 A8              STA ARYPNT+1
02797  D474  28                 PLP
02798  D475  10 D3              BPL ARYVA2
02799  D477  8A                 TXA
02800  D478  30 D0              BMI ARYVA2
02801  D47A  C8                 INY
02802  D47B  B1 71              LDA (INDEX1)Y
02803  D47D  20 F3 E7           JSR LE7F3
02804  D480  65 71              ADC INDEX1
02805  D482  85 71              STA INDEX1
02806  D484  90 02              BCC ARYGET
02807  D486  E6 72              INC INDEX1+1
02808  D488  A6 72       ARYGET LDX INDEX1+1
02809  D48A  E4 A8       ARYSTR CPX ARYPNT+1
02810  D48C  D0 04              BNE GOGO
02811  D48E  C5 A7              CMP ARYPNT
02812  D490  F0 BC              BEQ ARYVA3
02813  D492  20 A1 D4    GOGO   JSR DVAR
02814  D495  F0 F3              BEQ ARYSTR
02815  D497  B1 71       DVARS  LDA (INDEX1)Y
02816  D499  30 35              BMI DVARTS






CODE15......PAGE 003B

LINE# LOC   CODE        LINE


02817  D49B  C8                 INY
02818  D49C  B1 71              LDA (INDEX1)Y
02819  D49E  10 30              BPL DVARTS
02820  D4A0  C8                 INY
02821  D4A1  B1 71       DVAR   LDA (INDEX1)Y
02822  D4A3  F0 2B              BEQ DVARTS
02823  D4A5  C8                 INY
02824  D4A6  B1 71              LDA (INDEX1)Y
02825  D4A8  AA                 TAX
02826  D4A9  C8                 INY
02827  D4AA  B1 71              LDA (INDEX1)Y
02828  D4AC  C5 83              CMP FRETOP+1
02829  D4AE  90 06              BCC DVAR2
02830  D4B0  D0 1E              BNE DVARTS
02831  D4B2  E4 82              CPX FRETOP
02832  D4B4  B0 1A              BCS DVARTS
02833  D4B6  C5 AF       DVAR2  CMP GRBTOP+1
02834  D4B8  90 16              BCC DVARTS
02835  D4BA  D0 04              BNE DVAR3
02836  D4BC  E4 AE              CPX GRBTOP
02837  D4BE  90 10              BCC DVARTS
02838  D4C0  86 AE       DVAR3  STX GRBTOP
02839  D4C2  85 AF              STA GRBTOP+1
02840  D4C4  A5 71              LDA INDEX1
02841  D4C6  A6 72              LDX INDEX1+1
02842  D4C8  85 9D              STA GRBPNT
02843  D4CA  86 9E              STX GRBPNT+1
02844  D4CC  A5 A2              LDA FOUR6
02845  D4CE  85 A4              STA SIZE
02846  D4D0  A5 A2       DVARTS LDA FOUR6
02847  D4D2  18                 CLC
02848  D4D3  65 71              ADC INDEX1
02849  D4D5  85 71              STA INDEX1
02850  D4D7  90 02              BCC GRBRTS
02851  D4D9  E6 72              INC INDEX1+1
02852  D4DB  A6 72       GRBRTS LDX INDEX1+1
02853  D4DD  A0 00              LDY #0
02854  D4DF  60                 RTS
02855  D4E0  A6 9E       GRBPAS LDX GRBPNT+1
02856  D4E2  F0 F7              BEQ GRBRTS
02857  D4E4  A5 A4              LDA SIZE
02858  D4E6  E9 03              SBC #3
02859  D4E8  4A                 LSR A
02860  D4E9  A8                 TAY
02861  D4EA  85 A4              STA SIZE
02862  D4EC  B1 9D              LDA (GRBPNT)Y
02863  D4EE  65 AE              ADC LOWTR
02864  D4F0  85 A9              STA HIGHTR
02865  D4F2  A5 AF              LDA LOWTR+1
02866  D4F4  69 00              ADC #0
02867  D4F6  85 AA              STA HIGHTR+1
02868  D4F8  A5 82              LDA FRETOP
02869  D4FA  A6 83              LDX FRETOP+1
02870  D4FC  85 A7              STA HIGHDS
02871  D4FE  86 A8              STX HIGHDS+1






CODE15......PAGE 003C

LINE# LOC   CODE        LINE


02872  D500  20 E1 C2           JSR BLTUC
02873  D503  A4 A4              LDY SIZE
02874  D505  C8                 INY
02875  D506  A5 A7              LDA HIGHDS
02876  D508  91 9D              STA (GRBPNT)Y
02877  D50A  AA                 TAX
02878  D50B  E6 A8              INC HIGHDS+1
02879  D50D  A5 A8              LDA HIGHDS+1
02880  D50F  C8                 INY
02881  D510  91 9D              STA (GRBPNT)Y
02882  D512  4C 08 D4           JMP FNDVAR
02883  D515  A5 B4       CAT    LDA FACLO
02884  D517  48                 PHA
02885  D518  A5 B3              LDA FACMO
02886  D51A  48                 PHA
02887  D51B  20 9D CD           JSR EVAL
02888  D51E  20 A9 CC           JSR CHKSTR
02889  D521  68                 PLA
02890  D522  85 BE              STA STRNG1
02891  D524  68                 PLA
02892  D525  85 BF              STA STRNG1+1
02893  D527  A0 00              LDY #0
02894  D529  B1 BE              LDA (STRNG1)Y
02895  D52B  18                 CLC
02896  D52C  71 B3              ADC (FACMO)Y
02897  D52E  90 05              BCC SIZEOK
02898  D530  A2 B5              LDX #ERRLS
02899  D532  4C 59 C3           JMP ERROR
02900  D535  20 59 D3    SIZEOK JSR STRINI
02901  D538  20 52 D5           JSR MOVINS
02902  D53B  A5 9F              LDA DSCPNT
02903  D53D  A4 A0              LDY DSCPNT+1
02904  D53F  20 82 D5           JSR FRETMP
02905  D542  20 64 D5           JSR MOVDO
02906  D545  A5 BE              LDA STRNG1
02907  D547  A4 BF              LDY STRNG1+1
02908  D549  20 82 D5           JSR FRETMP
02909  D54C  20 AA D3           JSR PUTNEW
02910  D54F  4C D2 CC           JMP TSTOP
02911  D552  A0 00       MOVINS LDY #0
02912  D554  B1 BE              LDA (STRNG1)Y
02913  D556  48                 PHA
02914  D557  C8                 INY
02915  D558              .FIL   CODE16

















CODE16......PAGE 003D

LINE# LOC   CODE        LINE


02917  D558  B1 BE              LDA (STRNG1)Y
02918  D55A  AA                 TAX
02919  D55B  C8                 INY
02920  D55C  B1 BE              LDA (STRNG1)Y
02921  D55E  A8                 TAY
02922  D55F  68                 PLA
02923  D560  86 71       MOVSTR STX INDEX
02924  D562  84 72              STY INDEX+1
02925  D564  A8          MOVDO  TAY
02926  D565  F0 0A              BEQ MVDONE
02927  D567  48                 PHA
02928  D568  88          MOVLP  DEY
02929  D569  B1 71              LDA (INDEX)Y
02930  D56B  91 84              STA (FRESPC)Y
02931  D56D  98                 TYA
02932  D56E  D0 F8              BNE MOVLP
02933  D570  68                 PLA
02934  D571  18          MVDONE CLC
02935  D572  65 84              ADC FRESPC
02936  D574  85 84              STA FRESPC
02937  D576  90 02              BCC MVSTRT
02938  D578  E6 85              INC FRESPC+1
02939  D57A  60          MVSTRT RTS
02940  D57B  20 A9 CC    FRESTR JSR CHKSTR
02941  D57E  A5 B3       FREFAC LDA FACMO
02942  D580  A4 B4              LDY FACMO+1
02943  D582  85 71       FRETMP STA INDEX
02944  D584  84 72              STY INDEX+1
02945  D586  20 B3 D5           JSR FRETMS
02946  D589  08                 PHP
02947  D58A  A0 00              LDY #0
02948  D58C  B1 71              LDA (INDEX),Y
02949  D58E  48                 PHA
02950  D58F  C8                 INY
02951  D590  B1 71              LDA (INDEX),Y
02952  D592  AA                 TAX
02953  D593  C8                 INY
02954  D594  B1 71              LDA (INDEX),Y
02955  D596  A8                 TAY
02956  D597  68                 PLA
02957  D598  28                 PLP
02958  D599  D0 13              BNE FRETRT
02959  D59B  C4 83              CPY FRETOP+1
02960  D59D  D0 0F              BNE FRETRT
02961  D59F  E4 82              CPX FRETOP
02962  D5A1  D0 0B              BNE FRETRT
02963  D5A3              ;
02964  D5A3              ;STRING WAS LAST INTO STRING SFACE
02965  D5A3              ;SAVE GARBAGE COLLECTION SOME TIME
02966  D5A3              ;BY FREEING UP. (LENGTH + 2)
02967  D5A3              ;
02968  D5A3  48                 PHA             ;SAVE LENGTH ON STACK
02969  D5A4  18                 CLC
02970  D5A5  65 82              ADC FRETOP
02971  D5A7  85 82              STA FRETOP






CODE16......PAGE 003E

LINE# LOC   CODE        LINE


02972  D5A9  90 02              BCC FREPLA
02973  D5AB  E6 83              INC FRETOP+1
02974  D5AD  68          FREPLA PLA             ;PULL LENGTH OFF STACK
02975  D5AE  86 71       FRETRT STX INDEX
02976  D5B0  84 72              STY INDEX+1
02977  D5B2  60                 RTS
02978  D5B3  C4 67       FRETMS CPY LASTPT+1
02979  D5B5  D0 0C              BNE FRERTS
02980  D5B7  C5 66              CMP LASTPT
02981  D5B9  D0 08              BNE FRERTS
02982  D5BB  85 65              STA TEMPPT
02983  D5BD  E9 03              SBC #STRSIZ
02984  D5BF  85 66              STA LASTPT
02985  D5C1  A0 00              LDY #0
02986  D5C3  60          FRERTS RTS
02987  D5C4  20 79 D6    CHRD   JSR CONINT
02988  D5C7  8A                 TXA
02989  D5C8  48                 PHA
02990  D5C9  A9 01              LDA #1
02991  D5CB  20 61 D3           JSR STRSPA
02992  D5CE  68                 PLA
02993  D5CF  A0 00              LDY #0
02994  D5D1  91 B1              STA (DSCTMP+1)Y
02995  D5D3  68                 PLA
02996  D5D4  68                 PLA
02997  D5D5  4C AA D3           JMP PUTNEW
02998  D5D8  20 37 D6    LEFTD  JSR PREAM
02999  D5DB  D1 9F              CMP (DSCPNT)Y
03000  D5DD  98                 TYA
03001  D5DE  90 04       RLEFT  BCC RLEFT1
03002  D5E0  B1 9F              LDA (DSCPNT)Y
03003  D5E2  AA                 TAX
03004  D5E3  98                 TYA
03005  D5E4  48          RLEFT1 PHA
03006  D5E5  8A          RLEFT2 TXA
03007  D5E6  48          RLEFT3 PHA
03008  D5E7  20 61 D3           JSR STRSPA
03009  D5EA  A5 9F              LDA DSCPNT
03010  D5EC  A4 A0              LDY DSCPNT+1
03011  D5EE  20 82 D5           JSR FRETMP
03012  D5F1  68                 PLA
03013  D5F2  A8                 TAY
03014  D5F3  68                 PLA
03015  D5F4  18                 CLC
03016  D5F5  65 71              ADC INDEX
03017  D5F7  85 71              STA INDEX
03018  D5F9  90 02              BCC PULMOR
03019  D5FB  E6 72              INC INDEX+1
03020  D5FD  98          PULMOR TYA
03021  D5FE  20 64 D5           JSR MOVDO
03022  D601  4C AA D3           JMP PUTNEW
03023  D604  20 37 D6    RIGHTD JSR PREAM
03024  D607  18                 CLC
03025  D608  F1 9F              SBC (DSCPNT)Y
03026  D60A  49 FF              EOR #255






CODE16......PAGE 003F

LINE# LOC   CODE        LINE


03027  D60C  4C DE D5           JMP RLEFT
03028  D60F  A9 FF       MIDD   LDA #255
03029  D611  85 B4              STA FACLO
03030  D613  20 C8 00           JSR CHRGOT
03031  D616  C9 29              CMP #41
03032  D618  F0 06              BEQ MID2
03033  D61A  20 11 CE           JSR CHKCOM
03034  D61D  20 76 D6           JSR GETBYT
03035  D620  20 37 D6    MID2   JSR PREAM
03036  D623  CA                 DEX
03037  D624  8A                 TXA
03038  D625  48                 PHA
03039  D626  18                 CLC
03040  D627  A2 00              LDX #0
03041  D629  F1 9F              SBC (DSCPNT)Y
03042  D62B  B0 B8              BCS RLEFT2
03043  D62D  49 FF              EOR #255
03044  D62F  C5 B4              CMP FACLO
03045  D631  90 B3              BCC RLEFT3
03046  D633  A5 B4              LDA FACLO
03047  D635  B0 AF              BCS RLEFT3
03048  D637  20 0B CE    PREAM  JSR CHKCLS
03049  D63A  68                 PLA
03050  D63B  85 A4              STA JMPER+1
03051  D63D  68                 PLA
03052  D63E  85 A5              STA JMPER+2
03053  D640  68                 PLA
03054  D641  68                 PLA
03055  D642  68                 PLA
03056  D643  AA                 TAX
03057  D644  68                 PLA
03058  D645  85 9F              STA DSCPNT
03059  D647  68                 PLA
03060  D648  85 A0              STA DSCPNT+1
03061  D64A  A0 00              LDY #0
03062  D64C  8A                 TXA
03063  D64D  F0 21              BEQ GOFUC
03064  D64F  E6 A4              INC JMPER+1
03065  D651  6C A4 00           JMP (JMPER+1)
03066  D654  20 5A D6    LEN    JSR LEN1
03067  D657  4C 87 D2    LD657  JMP SNGFLT
03068  D65A  20 7B D5    LEN1   JSR FRESTR
03069  D65D  A2 00              LDX #0
03070  D65F  86 5E              STX VALTYP
03071  D661  A8                 TAY
03072  D662  60                 RTS
03073  D663  20 5A D6    ASC    JSR LEN1
03074  D666  F0 08              BEQ GOFUC
03075  D668  A0 00              LDY #0
03076  D66A  B1 71              LDA (INDEX1)Y
03077  D66C  A8                 TAY
03078  D66D  4C 57 D6           JMP LD657
03079  D670  4C 30 D1    GOFUC  JMP FCERR
03080  D673  20 C2 00    GTBYTC JSR CHRGET
03081  D676              .FIL   CODE17






CODE16......PAGE 0040

LINE# LOC   CODE        LINE


03082  D676              ;'CODE17'
03083  D676  20 A4 CC    GETBYT JSR FRMNUM
03084  D679  20 A3 D0    CONINT JSR POSINT
03085  D67C  A6 B3              LDX FACMO
03086  D67E  D0 F0              BNE GOFUC
03087  D680  A6 B4              LDX FACLO
03088  D682  4C C8 00           JMP CHRGOT
03089  D685  20 5A D6    VAL    JSR LEN1
03090  D688  D0 03              BNE *+5
03091  D68A  4C CC D7           JMP ZEROFC
03092  D68D  A6 C9              LDX TXTPTR
03093  D68F  A4 CA              LDY TXTPTR+1
03094  D691  86 C0              STX STRNG2
03095  D693  84 C1              STY STRNG2+1
03096  D695  A6 71              LDX INDEX1
03097  D697  86 C9              STX TXTPTR
03098  D699  18                 CLC
03099  D69A  65 71              ADC INDEX1
03100  D69C  85 73              STA INDEX2
03101  D69E  A6 72              LDX INDEX1+1
03102  D6A0  86 CA              STX TXTPTR+1
03103  D6A2  90 01              BCC VAL2
03104  D6A4  E8                 INX 
03105  D6A5  86 74       VAL2   STX INDEX2+1
03106  D6A7  A0 00              LDY #0
03107  D6A9  B1 73              LDA (INDEX2)Y
03108  D6AB  48                 PHA
03109  D6AC  A9 00              LDA #0
03110  D6AE  91 73              STA (INDEX2)Y
03111  D6B0  20 C8 00           JSR CHRGOT
03112  D6B3  20 C5 DB           JSR FIN
03113  D6B6  68                 PLA
03114  D6B7  A0 00              LDY #0
03115  D6B9  91 73              STA (INDEX2)Y
03116  D6BB  A6 C0       ST2TXT LDX STRNG2
03117  D6BD  A4 C1              LDY STRNG2+1
03118  D6BF  86 C9              STX TXTPTR
03119  D6C1  84 CA              STY TXTPTR+1
03120  D6C3  60          VALRTS RTS
03121  D6C4  20 A4 CC    GETNUM JSR FRMNUM
03122  D6C7  20 D0 D6           JSR GETADR
03123  D6CA  20 11 CE    COMBYT JSR CHKCOM
03124  D6CD  4C 76 D6           JMP GETBYT
03125  D6D0  A5 B5       GETADR LDA FACSGN
03126  D6D2  30 9C              BMI GOFUC
03127  D6D4  A5 B0              LDA FACEXP
03128  D6D6  C9 91              CMP #145
03129  D6D8  B0 96              BCS GOFUC
03130  D6DA  20 6D DB           JSR QINT
03131  D6DD  A5 B3              LDA FACMO
03132  D6DF  A4 B4              LDY FACMO+1
03133  D6E1  84 08              STY POKER
03134  D6E3  85 09              STA POKER+1
03135  D6E5  60                 RTS
03136  D6E6  20 D0 D6    PEEK   JSR GETADR






CODE16......PAGE 0041

LINE# LOC   CODE        LINE


03137  D6E9  A0 00              LDY #0
03138  D6EB  C9 C0              CMP #$C0
03139  D6ED  90 04              BCC GETCON
03140  D6EF  C9 E1              CMP #$E1
03141  D6F1  90 03              BCC DOSGFL
03142  D6F3  B1 08       GETCON LDA (POKER)Y
03143  D6F5  A8                 TAY
03144  D6F6  4C 87 D2    DOSGFL JMP SNGFLT
03145  D6F9  20 C4 D6    POKE   JSR GETNUM
03146  D6FC  8A                 TXA
03147  D6FD  A0 00              LDY #0
03148  D6FF  91 08              STA (POKER)Y
03149  D701  60                 RTS
03150  D702  20 C4 D6    FNWAIT JSR GETNUM
03151  D705  86 98              STX ANDMSK
03152  D707  A2 00              LDX #0
03153  D709  20 C8 00           JSR CHRGOT
03154  D70C  F0 03              BEQ STORDO
03155  D70E  20 CA D6           JSR COMBYT
03156  D711  86 99       STORDO STX EORMSK
03157  D713  A0 00              LDY #0
03158  D715  B1 08       WAITER LDA (POKER)Y
03159  D717  45 99              EOR EORMSK
03160  D719  25 98              AND ANDMSK
03161  D71B  F0 F8              BEQ WAITER
03162  D71D  60          ZERRTS RTS
03163  D71E  A9 E3       FADDH  LDA #<FHALF
03164  D720  A0 DD              LDY #>FHALF
03165  D722  4C 3C D7           JMP FADD
03166  D725  20 5E D9    FSUB   JSR CONUPK
03167  D728  A5 B5       FSUBT  LDA FACSGN
03168  D72A  49 FF              EOR #@377
03169  D72C  85 B5              STA FACSGN
03170  D72E  45 BD              EOR ARGSGN
03171  D730  85 BE              STA ARISGN
03172  D732  A5 B0              LDA FACEXP
03173  D734  4C 3F D7           JMP FADDT
03174  D737  20 6E D8    FADD5  JSR SHIFTR
03175  D73A  90 3C              BCC FADD4
03176  D73C  20 5E D9    FADD   JSR CONUPK
03177  D73F  D0 03       FADDT  BNE *+5
03178  D741  4C CE DA           JMP MOVFA
03179  D744  A6 BF              LDX FACOV
03180  D746  86 A5              STX OLDOV
03181  D748  A2 B8              LDX #ARGEXP
03182  D74A  A5 B8              LDA ARGEXP
03183  D74C  A8          FADDC  TAY
03184  D74D  F0 CE              BEQ ZERRTS
03185  D74F  38                 SEC
03186  D750  E5 B0              SBC FACEXP
03187  D752  F0 24              BEQ FADD4
03188  D754  90 12              BCC FADDA
03189  D756  84 B0              STY FACEXP
03190  D758  A4 BD              LDY ARGSGN
03191  D75A  84 B5              STY FACSGN






CODE16......PAGE 0042

LINE# LOC   CODE        LINE


03192  D75C  49 FF              EOR #@377
03193  D75E  69 00              ADC #0
03194  D760  A0 00              LDY #0
03195  D762  84 A5              STY OLDOV
03196  D764  A2 B0              LDX #FAC
03197  D766  D0 04              BNE FADD1
03198  D768  A0 00       FADDA  LDY #0
03199  D76A  84 BF              STY FACOV
03200  D76C  C9 F9       FADD1  CMP #$F9
03201  D76E  30 C7              BMI FADD5
03202  D770  A8                 TAY
03203  D771  A5 BF              LDA FACOV
03204  D773  56 01              LSR 1,X
03205  D775  20 85 D8           JSR ROLSHF
03206  D778  24 BE       FADD4  BIT ARISGN
03207  D77A  10 57              BPL FADD2
03208  D77C  A0 B0              LDY #FACEXP
03209  D77E  E0 B8              CPX #ARGEXP
03210  D780  F0 02              BEQ SUBIT
03211  D782  A0 B8              LDY #ARGEXP
03212  D784  38          SUBIT  SEC
03213  D785  49 FF              EOR #@377
03214  D787  65 A5              ADC OLDOV
03215  D789  85 BF              STA FACOV
03216  D78B  B9 04 00           LDA 3+ADDPRC,Y
03217  D78E  F5 04              SBC 3+ADDPRC,X
03218  D790  85 B4              STA FACLO
03219  D792  B9 03 00           LDA ADDPRC+2,Y
03220  D795  F5 03              SBC 2+ADDPRC,X
03221  D797  85 B3              STA FACMO
03222  D799  B9 02 00           LDA 2,Y
03223  D79C  F5 02              SBC 2,X
03224  D79E  85 B2              STA FACMOH
03225  D7A0  B9 01 00           LDA 1,Y
03226  D7A3  F5 01              SBC 1,X
03227  D7A5  85 B1              STA FACHO
03228  D7A7  B0 03       FADFLT BCS NORMAL
03229  D7A9  20 1C D8           JSR NEGFAC
03230  D7AC  A0 00       NORMAL LDY #0
03231  D7AE  98                 TYA
03232  D7AF  18                 CLC
03233  D7B0  A6 B1       NORM3  LDX FACHO
03234  D7B2  D0 4A              BNE NORM1
03235  D7B4  A6 B2              LDX FACHO+1
03236  D7B6  86 B1              STX FACHO
03237  D7B8  A6 B3              LDX FACMOH+1
03238  D7BA              .FIL   CODE18














CODE18......PAGE 0043

LINE# LOC   CODE        LINE


03240  D7BA  86 B2              STX FACMOH
03241  D7BC  A6 B4              LDX FACMO+1
03242  D7BE  86 B3              STX FACMO
03243  D7C0  A6 BF              LDX FACOV
03244  D7C2  86 B4              STX FACLO
03245  D7C4  84 BF              STY FACOV
03246  D7C6  69 08              ADC #@10
03247  D7C8              ADDPR2 =ADDPRC+ADDPRC
03248  D7C8              ADDPR4 =ADDPR2+ADDPR2
03249  D7C8              ADDPR8 =ADDPR4+ADDPR4
03250  D7C8  C9 20              CMP #@30+ADDPR8
03251  D7CA  D0 E4              BNE NORM3
03252  D7CC  A9 00       ZEROFC LDA #0
03253  D7CE  85 B0       ZEROF1 STA FACEXP
03254  D7D0  85 B5       ZEROML STA FACSGN
03255  D7D2  60                 RTS
03256  D7D3  65 A5       FADD2  ADC OLDOV
03257  D7D5  85 BF              STA FACOV
03258  D7D7  A5 B4              LDA FACLO
03259  D7D9  65 BC              ADC ARGLO
03260  D7DB  85 B4              STA FACLO
03261  D7DD  A5 B3              LDA FACMO
03262  D7DF  65 BB              ADC ARGMO
03263  D7E1  85 B3              STA FACMO
03264  D7E3  A5 B2              LDA FACMOH
03265  D7E5  65 BA              ADC ARGMOH
03266  D7E7  85 B2              STA FACMOH
03267  D7E9  A5 B1              LDA FACHO
03268  D7EB  65 B9              ADC ARGHO
03269  D7ED  85 B1              STA FACHO
03270  D7EF  4C 0B D8           JMP SQUEEZ
03271  D7F2  69 01       NORM2  ADC #1
03272  D7F4  06 BF              ASL FACOV
03273  D7F6  26 B4              ROL FACLO
03274  D7F8  26 B3              ROL FACMO
03275  D7FA  26 B2              ROL FACMOH
03276  D7FC  26 B1              ROL FACHO
03277  D7FE  10 F2       NORM1  BPL NORM2
03278  D800  38                 SEC
03279  D801  E5 B0              SBC FACEXP
03280  D803  B0 C7              BCS ZEROFC
03281  D805  49 FF              EOR #@377
03282  D807  69 01              ADC #1
03283  D809  85 B0              STA FACEXP
03284  D80B  90 0E       SQUEEZ BCC RNDRTS
03285  D80D  E6 B0       RNDSHF INC FACEXP
03286  D80F  F0 42              BEQ OVERR
03287  D811  66 B1              ROR FACHO
03288  D813  66 B2              ROR FACMOH
03289  D815  66 B3              ROR FACMO
03290  D817  66 B4              ROR FACLO
03291  D819  66 BF              ROR FACOV
03292  D81B  60          RNDRTS RTS
03293  D81C  A5 B5       NEGFAC LDA FACSGN
03294  D81E  49 FF              EOR #@377






CODE18......PAGE 0044

LINE# LOC   CODE        LINE


03295  D820  85 B5              STA FACSGN
03296  D822  A5 B1       NEGFCH LDA FACHO
03297  D824  49 FF              EOR #@377
03298  D826  85 B1              STA FACHO
03299  D828  A5 B2              LDA FACMOH
03300  D82A  49 FF              EOR #@377
03301  D82C  85 B2              STA FACMOH
03302  D82E  A5 B3              LDA FACMO
03303  D830  49 FF              EOR #@377
03304  D832  85 B3              STA FACMO
03305  D834  A5 B4              LDA FACLO
03306  D836  49 FF              EOR #@377
03307  D838  85 B4              STA FACLO
03308  D83A  A5 BF              LDA FACOV
03309  D83C  49 FF              EOR #@377
03310  D83E  85 BF              STA FACOV
03311  D840  E6 BF              INC FACOV
03312  D842  D0 0E              BNE INCFRT
03313  D844  E6 B4       INCFAC INC FACLO
03314  D846  D0 0A              BNE INCFRT
03315  D848  E6 B3              INC FACMO
03316  D84A  D0 06              BNE INCFRT
03317  D84C  E6 B2              INC FACMOH
03318  D84E  D0 02              BNE INCFRT
03319  D850  E6 B1              INC FACHO
03320  D852  60          INCFRT RTS
03321  D853  A2 4A       OVERR  LDX #ERROV
03322  D855  4C 59 C3           JMP ERROR
03323  D858  A2 74       MULSHF LDX #RESHO-1
03324  D85A  B4 04       SHFTR2 LDY 3+ADDPRC,X
03325  D85C  84 BF              STY FACOV
03326  D85E  B4 03              LDY 3,X
03327  D860  94 04              STY 4,X
03328  D862  B4 02              LDY 2,X
03329  D864  94 03              STY 3,X
03330  D866  B4 01              LDY 1,X
03331  D868  94 02              STY 2,X
03332  D86A  A4 B7              LDY BITS
03333  D86C  94 01              STY 1,X
03334  D86E  69 08       SHIFTR ADC #@10
03335  D870  30 E8              BMI SHFTR2
03336  D872  F0 E6              BEQ SHFTR2
03337  D874  E9 08              SBC #@10
03338  D876  A8                 TAY
03339  D877  A5 BF              LDA FACOV
03340  D879  B0 14              BCS SHFTRT
03341  D87B  16 01       SHFTR3 ASL 1,X
03342  D87D  90 02              BCC SHFTR4
03343  D87F  F6 01              INC 1,X
03344  D881  76 01       SHFTR4 ROR 1,X
03345  D883  76 01              ROR 1,X
03346  D885  76 02       ROLSHF ROR 2,X
03347  D887  76 03              ROR 3,X
03348  D889  76 04              ROR 4,X
03349  D88B  6A                 ROR A






CODE18......PAGE 0045

LINE# LOC   CODE        LINE


03350  D88C  C8                 INY
03351  D88D  D0 EC              BNE SHFTR3
03352  D88F  18          SHFTRT CLC
03353  D890  60                 RTS
03354  D891  81          FONE   .BYT @201,0,0,0,0
03354  D892  00 
03354  D893  00 
03354  D894  00 
03354  D895  00 
03355  D896  03          LOGCN2 .BYT 3,@177,@136,@126
03355  D897  7F 
03355  D898  5E 
03355  D899  56 
03356  D89A  CB                 .BYT @313,@171,@200,@23
03356  D89B  79 
03356  D89C  80 
03356  D89D  13 
03357  D89E  9B                 .BYT @233,@13,@144,@200
03357  D89F  0B 
03357  D8A0  64 
03357  D8A1  80 
03358  D8A2  76                 .BYT @166,@70,@223,@26
03358  D8A3  38 
03358  D8A4  93 
03358  D8A5  16 
03359  D8A6  82                 .BYT @202,@70,@252,@73,@40
03359  D8A7  38 
03359  D8A8  AA 
03359  D8A9  3B 
03359  D8AA  20 
03360  D8AB  80          SQR05  .BYT @200,@65,4,@363,@64
03360  D8AC  35 
03360  D8AD  04 
03360  D8AE  F3 
03360  D8AF  34 
03361  D8B0  81          SQR20  .BYT @201,@65,@4,@363,@64
03361  D8B1  35 
03361  D8B2  04 
03361  D8B3  F3 
03361  D8B4  34 
03362  D8B5  80          NEGHLF .BYT @200,@200,0,0,0
03362  D8B6  80 
03362  D8B7  00 
03362  D8B8  00 
03362  D8B9  00 
03363  D8BA  80          LOG2   .BYT @200,@61,@162,@27,@370
03363  D8BB  31 
03363  D8BC  72 
03363  D8BD  17 
03363  D8BE  F8 
03364  D8BF              .FIL   CODE19










CODE19......PAGE 0046

LINE# LOC   CODE        LINE


03366  D8BF  20 FD DA    LOG    JSR SIGN
03367  D8C2  F0 02              BEQ LOGERR
03368  D8C4  10 03              BPL LOG1
03369  D8C6  4C 30 D1    LOGERR JMP FCERR
03370  D8C9  A5 B0       LOG1   LDA FACEXP
03371  D8CB  E9 7F              SBC #@177
03372  D8CD  48                 PHA
03373  D8CE  A9 80              LDA #@200
03374  D8D0  85 B0              STA FACEXP
03375  D8D2  A9 AB              LDA #<SQR05
03376  D8D4  A0 D8              LDY #>SQR05
03377  D8D6  20 3C D7           JSR FADD
03378  D8D9  A9 B0              LDA #<SQR20
03379  D8DB  A0 D8              LDY #>SQR20
03380  D8DD  20 E1 D9           JSR FDIV
03381  D8E0  A9 91              LDA #<FONE
03382  D8E2  A0 D8              LDY #>FONE
03383  D8E4  20 25 D7           JSR FSUB
03384  D8E7  A9 96              LDA #<LOGCN2
03385  D8E9  A0 D8              LDY #>LOGCN2
03386  D8EB  20 F3 DE           JSR POLYX
03387  D8EE  A9 B5              LDA #<NEGHLF
03388  D8F0  A0 D8              LDY #>NEGHLF
03389  D8F2  20 3C D7           JSR FADD
03390  D8F5  68                 PLA
03391  D8F6  20 50 DC           JSR FINLOG
03392  D8F9  A9 BA              LDA #<LOG2
03393  D8FB  A0 D8              LDY #>LOG2
03394  D8FD  20 5E D9    FMULT  JSR CONUPK
03395  D900  F0 5B       FMULTT BEQ MULTRT
03396  D902  20 89 D9           JSR MULDIV
03397  D905  A9 00              LDA #0
03398  D907  85 75              STA RESHO
03399  D909  85 76              STA RESMOH
03400  D90B  85 77              STA RESMO
03401  D90D  85 78              STA RESLO
03402  D90F  A5 BF              LDA FACOV
03403  D911  20 2B D9           JSR MLTPLY
03404  D914  A5 B4              LDA FACLO
03405  D916  20 2B D9           JSR MLTPLY
03406  D919  A5 B3              LDA FACMO
03407  D91B  20 2B D9           JSR MLTPLY
03408  D91E  A5 B2              LDA FACMOH
03409  D920  20 2B D9           JSR MLTPLY
03410  D923  A5 B1              LDA FACHO
03411  D925  20 30 D9           JSR MLTPL1
03412  D928  4C 61 DA           JMP MOVFR
03413  D92B  D0 03       MLTPLY BNE *+5
03414  D92D  4C 58 D8           JMP MULSHF
03415  D930  4A          MLTPL1 LSR A
03416  D931  09 80              ORA #@200
03417  D933  A8          MLTPL2 TAY
03418  D934  90 19              BCC MLTPL3
03419  D936  18                 CLC
03420  D937  A5 78              LDA RESLO






CODE19......PAGE 0047

LINE# LOC   CODE        LINE


03421  D939  65 BC              ADC ARGLO
03422  D93B  85 78              STA RESLO
03423  D93D  A5 77              LDA RESMO
03424  D93F  65 BB              ADC ARGMO
03425  D941  85 77              STA RESMO
03426  D943  A5 76              LDA RESMOH
03427  D945  65 BA              ADC ARGMOH
03428  D947  85 76              STA RESMOH
03429  D949  A5 75              LDA RESHO
03430  D94B  65 B9              ADC ARGHO
03431  D94D  85 75              STA RESHO
03432  D94F  66 75       MLTPL3 ROR RESHO
03433  D951  66 76              ROR RESMOH
03434  D953  66 77              ROR RESMO
03435  D955  66 78              ROR RESLO
03436  D957  66 BF              ROR FACOV
03437  D959  98                 TYA
03438  D95A  4A                 LSR A
03439  D95B  D0 D6              BNE MLTPL2
03440  D95D  60          MULTRT RTS
03441  D95E  85 71       CONUPK STA INDEX1
03442  D960  84 72              STY INDEX1+1
03443  D962  A0 04              LDY #4
03444  D964  B1 71              LDA (INDEX1)Y
03445  D966  85 BC              STA ARGLO
03446  D968  88                 DEY
03447  D969  B1 71              LDA (INDEX)Y
03448  D96B  85 BB              STA ARGMO
03449  D96D  88                 DEY
03450  D96E  B1 71              LDA (INDEX1)Y
03451  D970  85 BA              STA ARGMOH
03452  D972  88                 DEY
03453  D973  B1 71              LDA (INDEX1)Y
03454  D975  85 BD              STA ARGSGN
03455  D977  45 B5              EOR FACSGN
03456  D979  85 BE              STA ARISGN
03457  D97B  A5 BD              LDA ARGSGN
03458  D97D  09 80              ORA #@200
03459  D97F  85 B9              STA ARGHO
03460  D981  88                 DEY
03461  D982  B1 71              LDA (INDEX1)Y
03462  D984  85 B8              STA ARGEXP
03463  D986  A5 B0              LDA FACEXP
03464  D988  60                 RTS
03465  D989  A5 B8       MULDIV LDA ARGEXP
03466  D98B  F0 1F       MLDEXP BEQ ZEREMV
03467  D98D  18                 CLC
03468  D98E  65 B0              ADC FACEXP
03469  D990  90 04              BCC TRYOFF
03470  D992  30 1D              BMI GOOVER
03471  D994  18                 CLC
03472  D995  2C                 .BYT $2C
03473  D996  10 14       TRYOFF BPL ZEREMV
03474  D998  69 80              ADC #@200
03475  D99A  85 B0              STA FACEXP






CODE19......PAGE 0048

LINE# LOC   CODE        LINE


03476  D99C  D0 03              BNE *+5
03477  D99E  4C D0 D7           JMP ZEROML
03478  D9A1  A5 BE              LDA ARISGN
03479  D9A3  85 B5              STA FACSGN
03480  D9A5  60                 RTS
03481  D9A6  A5 B5       MLDVEX LDA FACSGN
03482  D9A8  49 FF              EOR #@377
03483  D9AA  30 05              BMI GOOVER
03484  D9AC  68          ZEREMV PLA
03485  D9AD  68                 PLA
03486  D9AE  4C CC D7           JMP ZEROFC
03487  D9B1  4C 53 D8    GOOVER JMP OVERR
03488  D9B4  20 DE DA    MUL10  JSR MOVAF
03489  D9B7  AA                 TAX
03490  D9B8  F0 10              BEQ MUL10R
03491  D9BA  18                 CLC
03492  D9BB  69 02              ADC #2
03493  D9BD  B0 F2              BCS GOOVER
03494  D9BF  A2 00       FINML6 LDX #0
03495  D9C1  86 BE              STX ARISGN
03496  D9C3  20 4C D7           JSR FADDC
03497  D9C6  E6 B0              INC FACEXP
03498  D9C8  F0 E7              BEQ GOOVER
03499  D9CA  60          MUL10R RTS
03500  D9CB  84          TENC   .BYT @204,@40,0,0,0
03500  D9CC  20 
03500  D9CD  00 
03500  D9CE  00 
03500  D9CF  00 
03501  D9D0  20 DE DA    DIV10  JSR MOVAF
03502  D9D3  A9 CB              LDA #<TENC
03503  D9D5  A0 D9              LDY #>TENC
03504  D9D7  A2 00              LDX #0
03505  D9D9  86 BE       FDIVF  STX ARISGN
03506  D9DB  20 74 DA           JSR MOVFM
03507  D9DE  4C E4 D9           JMP FDIVT
03508  D9E1  20 5E D9    FDIV   JSR CONUPK
03509  D9E4  F0 76       FDIVT  BEQ DV0ERR
03510  D9E6  20 ED DA           JSR ROUND
03511  D9E9  A9 00              LDA #0
03512  D9EB  38                 SEC
03513  D9EC  E5 B0              SBC FACEXP
03514  D9EE  85 B0              STA FACEXP
03515  D9F0  20 89 D9           JSR MULDIV
03516  D9F3  E6 B0              INC FACEXP
03517  D9F5  F0 BA              BEQ GOOVER
03518  D9F7  A2 FC              LDX #$FC
03519  D9F9  A9 01              LDA #1
03520  D9FB  A4 B9       DIVIDE LDY ARGHO
03521  D9FD  C4 B1              CPY FACHO
03522  D9FF  D0 10              BNE SAVQUO
03523  DA01  A4 BA              LDY ARGMOH
03524  DA03  C4 B2              CPY FACMOH
03525  DA05  D0 0A              BNE SAVQUO
03526  DA07  A4 BB              LDY ARGMO






CODE19......PAGE 0049

LINE# LOC   CODE        LINE


03527  DA09  C4 B3              CPY FACMO
03528  DA0B  D0 04              BNE SAVQUO
03529  DA0D  A4 BC              LDY ARGLO
03530  DA0F  C4 B4              CPY FACLO
03531  DA11  08          SAVQUO PHP
03532  DA12  2A                 ROL A
03533  DA13  90 09              BCC QSHFT
03534  DA15  E8                 INX
03535  DA16  95 78              STA RESLO,X
03536  DA18  F0 32              BEQ LD100
03537  DA1A  10 34              BPL DIVNRM
03538  DA1C  A9 01              LDA #1
03539  DA1E  28          QSHFT  PLP
03540  DA1F  B0 0E              BCS DIVSUB
03541  DA21  06 BC       SHFARG ASL ARGLO
03542  DA23  26 BB              ROL ARGMO
03543  DA25  26 BA              ROL ARGMOH
03544  DA27  26 B9              ROL ARGHO
03545  DA29  B0 E6              BCS SAVQUO
03546  DA2B  30 CE              BMI DIVIDE
03547  DA2D  10 E2              BPL SAVQUO
03548  DA2F  A8          DIVSUB TAY
03549  DA30  A5 BC              LDA ARGLO
03550  DA32  E5 B4              SBC FACLO
03551  DA34  85 BC              STA ARGLO
03552  DA36  A5 BB              LDA ARGMO
03553  DA38  E5 B3              SBC FACMO
03554  DA3A  85 BB              STA ARGMO
03555  DA3C  A5 BA              LDA ARGMOH
03556  DA3E  E5 B2              SBC FACMOH
03557  DA40  85 BA              STA ARGMOH
03558  DA42  A5 B9              LDA ARGHO
03559  DA44  E5 B1              SBC FACHO
03560  DA46  85 B9              STA ARGHO
03561  DA48  98                 TYA
03562  DA49  4C 21 DA           JMP SHFARG
03563  DA4C  A9 40       LD100  LDA #@100
03564  DA4E  D0 CE              BNE QSHFT
03565  DA50  0A          DIVNRM ASL A
03566  DA51  0A                 ASL A
03567  DA52  0A                 ASL A
03568  DA53  0A                 ASL A
03569  DA54  0A                 ASL A
03570  DA55  0A                 ASL A
03571  DA56  85 BF              STA FACOV
03572  DA58  28                 PLP
03573  DA59  4C 61 DA           JMP MOVFR
03574  DA5C  A2 8A       DV0ERR LDX #ERRDVO
03575  DA5E  4C 59 C3           JMP ERROR
03576  DA61              .FIL   CODE20











CODE20......PAGE 004A

LINE# LOC   CODE        LINE


03578  DA61  A5 75       MOVFR  LDA RESHO
03579  DA63  85 B1              STA FACHO
03580  DA65  A5 76              LDA RESMOH
03581  DA67  85 B2              STA FACMOH
03582  DA69  A5 77              LDA RESMO
03583  DA6B  85 B3              STA FACMO
03584  DA6D  A5 78              LDA RESLO
03585  DA6F  85 B4              STA FACLO
03586  DA71  4C AC D7           JMP NORMAL
03587  DA74  85 71       MOVFM  STA INDEX1
03588  DA76  84 72              STY INDEX1+1
03589  DA78  A0 04              LDY #3+ADDPRC
03590  DA7A  B1 71              LDA (INDEX1)Y
03591  DA7C  85 B4              STA FACLO
03592  DA7E  88                 DEY
03593  DA7F  B1 71              LDA (INDEX1)Y
03594  DA81  85 B3              STA FACMO
03595  DA83  88                 DEY
03596  DA84  B1 71              LDA (INDEX1)Y
03597  DA86  85 B2              STA FACMOH
03598  DA88  88                 DEY
03599  DA89  B1 71              LDA (INDEX1)Y
03600  DA8B  85 B5              STA FACSGN
03601  DA8D  09 80              ORA #@200
03602  DA8F  85 B1              STA FACHO
03603  DA91  88                 DEY
03604  DA92  B1 71              LDA (INDEX1)Y
03605  DA94  85 B0              STA FACEXP
03606  DA96  84 BF              STY FACOV
03607  DA98  60                 RTS
03608  DA99  A2 AB       MOV2F  LDX #TEMPF2
03609  DA9B  2C                 .BYT $2C
03610  DA9C  A2 A6       MOV1F  LDX #TEMPF1
03611  DA9E  A0 00              LDY #0
03612  DAA0  F0 04              BEQ MOVMF
03613  DAA2  A6 98       MOVVF  LDX FORPNT
03614  DAA4  A4 99              LDY FORPNT+1
03615  DAA6  20 ED DA    MOVMF  JSR ROUND
03616  DAA9  86 71              STX INDEX1
03617  DAAB  84 72              STY INDEX1+1
03618  DAAD  A0 04              LDY #3+ADDPRC
03619  DAAF  A5 B4              LDA FACLO
03620  DAB1  91 71              STA (INDEX)Y
03621  DAB3  88                 DEY
03622  DAB4  A5 B3              LDA FACMO
03623  DAB6  91 71              STA (INDEX)Y
03624  DAB8  88                 DEY
03625  DAB9  A5 B2              LDA FACMOH
03626  DABB  91 71              STA (INDEX)Y
03627  DABD  88                 DEY
03628  DABE  A5 B5              LDA FACSGN
03629  DAC0  09 7F              ORA #@177
03630  DAC2  25 B1              AND FACHO
03631  DAC4  91 71              STA (INDEX)Y
03632  DAC6  88                 DEY






CODE20......PAGE 004B

LINE# LOC   CODE        LINE


03633  DAC7  A5 B0              LDA FACEXP
03634  DAC9  91 71              STA (INDEX)Y
03635  DACB  84 BF              STY FACOV
03636  DACD  60                 RTS
03637  DACE  A5 BD       MOVFA  LDA ARGSGN
03638  DAD0  85 B5       MOVFA1 STA FACSGN
03639  DAD2  A2 05              LDX #4+ADDPRC
03640  DAD4  B5 B7       MOVFAL LDA ARGEXP-1,X
03641  DAD6  95 AF              STA FACEXP-1,X
03642  DAD8  CA                 DEX
03643  DAD9  D0 F9              BNE MOVFAL
03644  DADB  86 BF              STX FACOV
03645  DADD  60                 RTS
03646  DADE  20 ED DA    MOVAF  JSR ROUND
03647  DAE1  A2 06       MOVEF  LDX #5+ADDPRC
03648  DAE3  B5 AF       MOVAFL LDA FACEXP-1,X
03649  DAE5  95 B7              STA ARGEXP-1,X
03650  DAE7  CA                 DEX
03651  DAE8  D0 F9              BNE MOVAFL
03652  DAEA  86 BF              STX FACOV
03653  DAEC  60          MOVRTS RTS
03654  DAED  A5 B0       ROUND  LDA FACEXP
03655  DAEF  F0 FB              BEQ MOVRTS
03656  DAF1  06 BF              ASL FACOV
03657  DAF3  90 F7              BCC MOVRTS
03658  DAF5  20 44 D8    INCRND JSR INCFAC
03659  DAF8  D0 F2              BNE MOVRTS
03660  DAFA  4C 0D D8           JMP RNDSHF
03661  DAFD  A5 B0       SIGN   LDA FACEXP
03662  DAFF  F0 09              BEQ SIGNRT
03663  DB01  A5 B5       FCSIGN LDA FACSGN
03664  DB03  2A          FCOMPS ROL A
03665  DB04  A9 FF              LDA #$FF
03666  DB06  B0 02              BCS SIGNRT
03667  DB08  A9 01              LDA #1
03668  DB0A  60          SIGNRT RTS
03669  DB0B  20 FD DA    SGN    JSR SIGN
03670  DB0E  85 B1       FLOAT  STA FACHO
03671  DB10  A9 00              LDA #0
03672  DB12  85 B2              STA FACHO+1
03673  DB14  A2 88              LDX #@210
03674  DB16  A5 B1       FLOATS LDA FACHO
03675  DB18  49 FF              EOR #@377
03676  DB1A  2A                 ROL A
03677  DB1B  A9 00       FLOATC LDA #0
03678  DB1D  85 B4              STA FACLO
03679  DB1F  85 B3              STA FACMO
03680  DB21  86 B0       FLOATB STX FACEXP
03681  DB23  85 BF              STA FACOV
03682  DB25  85 B5              STA FACSGN
03683  DB27  4C A7 D7           JMP FADFLT
03684  DB2A  46 B5       ABS    LSR FACSGN
03685  DB2C  60                 RTS
03686  DB2D  85 73       FCOMP  STA INDEX2
03687  DB2F  84 74       FCOMPN STY INDEX2+1






CODE20......PAGE 004C

LINE# LOC   CODE        LINE


03688  DB31  A0 00              LDY #0
03689  DB33  B1 73              LDA (INDEX2)Y
03690  DB35  C8                 INY
03691  DB36  AA                 TAX
03692  DB37  F0 C4              BEQ SIGN
03693  DB39  B1 73              LDA (INDEX2)Y
03694  DB3B  45 B5              EOR FACSGN
03695  DB3D  30 C2              BMI FCSIGN
03696  DB3F  E4 B0              CPX FACEXP
03697  DB41  D0 21              BNE FCOMPC
03698  DB43  B1 73              LDA (INDEX2)Y
03699  DB45  09 80              ORA #@200
03700  DB47  C5 B1              CMP FACHO
03701  DB49  D0 19              BNE FCOMPC
03702  DB4B  C8                 INY
03703  DB4C  B1 73              LDA (INDEX2)Y
03704  DB4E  C5 B2              CMP FACMOH
03705  DB50  D0 12              BNE FCOMPC
03706  DB52  C8                 INY
03707  DB53  B1 73              LDA (INDEX2)Y
03708  DB55  C5 B3              CMP FACMO
03709  DB57  D0 0B              BNE FCOMPC
03710  DB59  C8                 INY
03711  DB5A  A9 7F              LDA #@177
03712  DB5C  C5 BF              CMP FACOV
03713  DB5E  B1 73              LDA (INDEX2)Y
03714  DB60  E5 B4              SBC FACLO
03715  DB62  F0 28              BEQ QINTRT
03716  DB64  A5 B5       FCOMPC LDA FACSGN
03717  DB66  90 02              BCC FCOMPD
03718  DB68  49 FF              EOR #@377
03719  DB6A  4C 03 DB    FCOMPD JMP FCOMPS
03720  DB6D              .FIL   CODE21




























CODE21......PAGE 004D

LINE# LOC   CODE        LINE


03722  DB6D  A5 B0       QINT   LDA FACEXP
03723  DB6F  F0 4A              BEQ CLRFAC
03724  DB71  38                 SEC
03725  DB72  E9 A0              SBC #ADDPR8+@230
03726  DB74  24 B5              BIT FACSGN
03727  DB76  10 09              BPL QISHFT
03728  DB78  AA                 TAX
03729  DB79  A9 FF              LDA #@377
03730  DB7B  85 B7              STA BITS
03731  DB7D  20 22 D8           JSR NEGFCH
03732  DB80  8A                 TXA
03733  DB81  A2 B0       QISHFT LDX #FAC
03734  DB83  C9 F9              CMP #$F9
03735  DB85  10 06              BPL QINT1
03736  DB87  20 6E D8           JSR SHIFTR
03737  DB8A  84 B7              STY BITS
03738  DB8C  60          QINTRT RTS
03739  DB8D  A8          QINT1  TAY
03740  DB8E  A5 B5              LDA FACSGN
03741  DB90  29 80              AND #@200
03742  DB92  46 B1              LSR FACHO
03743  DB94  05 B1              ORA FACHO
03744  DB96  85 B1              STA FACHO
03745  DB98  20 85 D8           JSR ROLSHF
03746  DB9B  84 B7              STY BITS
03747  DB9D  60                 RTS
03748  DB9E  A5 B0       INT    LDA FACEXP
03749  DBA0  C9 A0              CMP #ADDPR8+@230
03750  DBA2  B0 20              BCS INTRTS
03751  DBA4  20 6D DB           JSR QINT
03752  DBA7  84 BF              STY FACOV
03753  DBA9  A5 B5              LDA FACSGN
03754  DBAB  84 B5              STY FACSGN
03755  DBAD  49 80              EOR #@200
03756  DBAF  2A                 ROL A
03757  DBB0  A9 A0              LDA #@230+8
03758  DBB2  85 B0              STA FACEXP
03759  DBB4  A5 B4              LDA FACLO
03760  DBB6  85 5A              STA INTEGR
03761  DBB8  4C A7 D7           JMP FADFLT
03762  DBBB  85 B1       CLRFAC STA FACHO
03763  DBBD  85 B2              STA FACMOH
03764  DBBF  85 B3              STA FACMO
03765  DBC1  85 B4              STA FACLO
03766  DBC3  A8                 TAY
03767  DBC4  60          INTRTS RTS
03768  DBC5  A0 00       FIN    LDY #@0
03769  DBC7  A2 0A              LDX #@11+ADDPRC
03770  DBC9  94 AC       FINZLP STY DECCNT,X
03771  DBCB  CA                 DEX
03772  DBCC  10 FB              BPL FINZLP
03773  DBCE  90 0F              BCC FINDGQ
03774  DBD0  C9 2D              CMP #'-
03775  DBD2  D0 04              BNE QPLUS
03776  DBD4  86 B6              STX SGNFLG






CODE21......PAGE 004E

LINE# LOC   CODE        LINE


03777  DBD6  F0 04              BEQ FINC
03778  DBD8  C9 2B       QPLUS  CMP #'+
03779  DBDA  D0 05              BNE FIN1
03780  DBDC  20 C2 00    FINC   JSR CHRGET
03781  DBDF  90 5B       FINDGQ BCC FINDIG
03782  DBE1  C9 2E       FIN1   CMP #'.
03783  DBE3  F0 2E              BEQ FINDP
03784  DBE5  C9 45              CMP #'E
03785  DBE7  D0 30              BNE FINE
03786  DBE9  20 C2 00           JSR CHRGET
03787  DBEC  90 17              BCC FNEDG1
03788  DBEE  C9 AB              CMP #MINUTK
03789  DBF0  F0 0E              BEQ FINEC1
03790  DBF2  C9 2D              CMP #'-
03791  DBF4  F0 0A              BEQ FINEC1
03792  DBF6  C9 AA              CMP #PLUSTK
03793  DBF8  F0 08              BEQ FINEC
03794  DBFA  C9 2B              CMP #'+
03795  DBFC  F0 04              BEQ FINEC
03796  DBFE  D0 07              BNE FINEC2
03797  DC00  66 AF       FINEC1 ROR EXPSGN
03798  DC02  20 C2 00    FINEC  JSR CHRGET
03799  DC05  90 5C       FNEDG1 BCC FINEDG
03800  DC07  24 AF       FINEC2 BIT EXPSGN
03801  DC09  10 0E              BPL FINE
03802  DC0B  A9 00              LDA #0
03803  DC0D  38                 SEC
03804  DC0E  E5 AD              SBC TENEXP
03805  DC10  4C 1B DC           JMP FINE1
03806  DC13  66 AE       FINDP  ROR DPTFLG
03807  DC15  24 AE              BIT DPTFLG
03808  DC17  50 C3              BVC FINC
03809  DC19  A5 AD       FINE   LDA TENEXP
03810  DC1B  38          FINE1  SEC
03811  DC1C  E5 AC              SBC DECCNT
03812  DC1E  85 AD              STA TENEXP
03813  DC20  F0 12              BEQ FINQNG
03814  DC22  10 09              BPL FINMUL
03815  DC24  20 D0 D9    FINDIV JSR DIV10
03816  DC27  E6 AD              INC TENEXP
03817  DC29  D0 F9              BNE FINDIV
03818  DC2B  F0 07              BEQ FINQNG
03819  DC2D  20 B4 D9    FINMUL JSR MUL10
03820  DC30  C6 AD              DEC TENEXP
03821  DC32  D0 F9              BNE FINMUL
03822  DC34  A5 B6       FINQNG LDA SGNFLG
03823  DC36  30 01              BMI NEGXQS
03824  DC38  60                 RTS
03825  DC39  4C 67 DE    NEGXQS JMP NEGOP
03826  DC3C  48          FINDIG PHA
03827  DC3D  24 AE              BIT DPTFLG
03828  DC3F  10 02              BPL FINDG1
03829  DC41  E6 AC              INC DECCNT
03830  DC43  20 B4 D9    FINDG1 JSR MUL10
03831  DC46  68                 PLA






CODE21......PAGE 004F

LINE# LOC   CODE        LINE


03832  DC47  38                 SEC
03833  DC48  E9 30              SBC #'0
03834  DC4A  20 50 DC           JSR FINLOG
03835  DC4D  4C DC DB           JMP FINC
03836  DC50  48          FINLOG PHA
03837  DC51  20 DE DA           JSR MOVAF
03838  DC54  68                 PLA
03839  DC55  20 0E DB           JSR FLOAT
03840  DC58  A5 BD              LDA ARGSGN
03841  DC5A  45 B5              EOR FACSGN
03842  DC5C  85 BE              STA ARISGN
03843  DC5E  A6 B0              LDX FACEXP
03844  DC60  4C 3F D7           JMP FADDT
03845  DC63  A5 AD       FINEDG LDA TENEXP
03846  DC65  C9 0C              CMP #12
03847  DC67  90 09              BCC MLEX10
03848  DC69  24 AF              BIT EXPSGN
03849  DC6B  30 03              BMI MLEXMI
03850  DC6D  4C 53 D8           JMP OVERR
03851  DC70  A9 0B       MLEXMI LDA #11
03852  DC72  0A          MLEX10 ASL A
03853  DC73  0A                 ASL A
03854  DC74  18                 CLC
03855  DC75  65 AD              ADC TENEXP
03856  DC77  0A                 ASL A
03857  DC78  18                 CLC
03858  DC79  A0 00              LDY #0
03859  DC7B  71 C9              ADC (TXTPTR)Y
03860  DC7D  38                 SEC
03861  DC7E  E9 30              SBC #'0
03862  DC80  85 AD              STA TENEXP
03863  DC82  4C 02 DC           JMP FINEC
03864  DC85              .FIL   CODE22




























CODE22......PAGE 0050

LINE# LOC   CODE        LINE


03866  DC85  9B          N0999  .BYT @233,@76,@274,@37,@375
03866  DC86  3E 
03866  DC87  BC 
03866  DC88  1F 
03866  DC89  FD 
03867  DC8A  9E          N9999  .BYT @236,@156,@153,@47,@376
03867  DC8B  6E 
03867  DC8C  6B 
03867  DC8D  27 
03867  DC8E  FE 
03868  DC8F  9E          NMIL   .BYT @236,@156,@153,@50,0
03868  DC90  6E 
03868  DC91  6B 
03868  DC92  28 
03868  DC93  00 
03869  DC94  A9 94       INPRT  LDA #<INTXT
03870  DC96  A0 C2              LDY #>INTXT
03871  DC98  20 AC DC           JSR STROU2
03872  DC9B  A5 89              LDA CURLIN+1
03873  DC9D  A6 88              LDX CURLIN
03874  DC9F  85 B1       LINPRT STA FACHO
03875  DCA1  86 B2              STX FACHO+1
03876  DCA3  A2 90              LDX #@220
03877  DCA5  38                 SEC
03878  DCA6  20 1B DB           JSR FLOATC
03879  DCA9  20 AF DC           JSR FOUT
03880  DCAC  4C 27 CA    STROU2 JMP STROUT
03881  DCAF  A0 01       FOUT   LDY #1
03882  DCB1  A9 20       FOUTC  LDA #' 
03883  DCB3  24 B5              BIT FACSGN
03884  DCB5  10 02              BPL FOUT1
03885  DCB7  A9 2D              LDA #'-
03886  DCB9  99 FF 00    FOUT1  STA FBUFFR-1,Y
03887  DCBC  85 B5              STA FACSGN
03888  DCBE  84 C0              STY FBUFPT
03889  DCC0  C8                 INY
03890  DCC1  A9 30              LDA #'0
03891  DCC3  A6 B0              LDX FACEXP
03892  DCC5  D0 03              BNE *+5
03893  DCC7  4C D6 DD           JMP FOUT19
03894  DCCA  A9 00              LDA #0
03895  DCCC  E0 80              CPX #@200
03896  DCCE  F0 02              BEQ FOUT37
03897  DCD0  B0 09              BCS FOUT7
03898  DCD2  A9 8F       FOUT37 LDA #<NMIL
03899  DCD4  A0 DC              LDY #>NMIL
03900  DCD6  20 FD D8           JSR FMULT
03901  DCD9  A9 F7              LDA #250-ADDPR2-ADDPRC
03902  DCDB  85 AC       FOUT7  STA DECCNT
03903  DCDD  A9 8A       FOUT4  LDA #<N9999
03904  DCDF  A0 DC              LDY #>N9999
03905  DCE1  20 2D DB           JSR FCOMP
03906  DCE4  F0 1E              BEQ BIGGES
03907  DCE6  10 12              BPL FOUT9
03908  DCE8  A9 85       FOUT3  LDA #<N0999






CODE22......PAGE 0051

LINE# LOC   CODE        LINE


03909  DCEA  A0 DC              LDY #>N0999
03910  DCEC  20 2D DB           JSR FCOMP
03911  DCEF  F0 02              BEQ FOUT38
03912  DCF1  10 0E              BPL FOUT5
03913  DCF3  20 B4 D9    FOUT38 JSR MUL10
03914  DCF6  C6 AC              DEC DECCNT
03915  DCF8  D0 EE              BNE FOUT3
03916  DCFA  20 D0 D9    FOUT9  JSR DIV10
03917  DCFD  E6 AC              INC DECCNT
03918  DCFF  D0 DC              BNE FOUT4
03919  DD01  20 1E D7    FOUT5  JSR FADDH
03920  DD04  20 6D DB    BIGGES JSR QINT
03921  DD07  A2 01              LDX #1
03922  DD09  A5 AC              LDA DECCNT
03923  DD0B  18                 CLC
03924  DD0C  69 0A              ADC #ADDPR2+ADDPRC+7
03925  DD0E  30 09              BMI FOUTPI
03926  DD10  C9 0B              CMP #ADDPR2+ADDPRC+@10
03927  DD12  B0 06              BCS FOUT6
03928  DD14  69 FF              ADC #$FF
03929  DD16  AA                 TAX
03930  DD17  A9 02              LDA #2
03931  DD19  38          FOUTPI SEC
03932  DD1A  E9 02       FOUT6  SBC #2
03933  DD1C  85 AD              STA TENEXP
03934  DD1E  86 AC              STX DECCNT
03935  DD20  8A                 TXA
03936  DD21  F0 02              BEQ FOUT39
03937  DD23  10 13              BPL FOUT8
03938  DD25  A4 C0       FOUT39 LDY FBUFPT
03939  DD27  A9 2E              LDA #'.
03940  DD29  C8                 INY
03941  DD2A  99 FF 00           STA FBUFFR-1,Y
03942  DD2D  8A                 TXA
03943  DD2E  F0 06              BEQ FOUT16
03944  DD30  A9 30              LDA #'0
03945  DD32  C8                 INY
03946  DD33  99 FF 00           STA FBUFFR-1,Y
03947  DD36  84 C0       FOUT16 STY FBUFPT
03948  DD38  A0 00       FOUT8  LDY #0
03949  DD3A  A2 80       FOUTIM LDX #@200
03950  DD3C  A5 B4       FOUT2  LDA FACLO
03951  DD3E  18                 CLC
03952  DD3F  79 EB DD           ADC FOUTBL+2+ADDPRC,Y
03953  DD42  85 B4              STA FACLO
03954  DD44  A5 B3              LDA FACMO
03955  DD46  79 EA DD           ADC FOUTBL+1+ADDPRC,Y
03956  DD49  85 B3              STA FACMO
03957  DD4B  A5 B2              LDA FACMOH
03958  DD4D  79 E9 DD           ADC FOUTBL+1,Y
03959  DD50  85 B2              STA FACMOH
03960  DD52  A5 B1              LDA FACHO
03961  DD54  79 E8 DD           ADC FOUTBL,Y
03962  DD57  85 B1              STA FACHO
03963  DD59  E8                 INX






CODE22......PAGE 0052

LINE# LOC   CODE        LINE


03964  DD5A  B0 04              BCS FOUT41
03965  DD5C  10 DE              BPL FOUT2
03966  DD5E  30 02              BMI FOUT40
03967  DD60  30 DA       FOUT41 BMI FOUT2
03968  DD62  8A          FOUT40 TXA
03969  DD63  90 04              BCC FOUTYP
03970  DD65  49 FF              EOR #@377
03971  DD67  69 0A              ADC #@12
03972  DD69  69 2F       FOUTYP ADC #@57
03973  DD6B  C8                 INY
03974  DD6C  C8                 INY
03975  DD6D  C8                 INY
03976  DD6E  C8                 INY
03977  DD6F  84 96              STY FDECPT
03978  DD71  A4 C0              LDY FBUFPT
03979  DD73  C8                 INY
03980  DD74  AA                 TAX
03981  DD75  29 7F              AND #@177
03982  DD77  99 FF 00           STA FBUFFR-1,Y
03983  DD7A  C6 AC              DEC DECCNT
03984  DD7C  D0 06              BNE STXBUF
03985  DD7E  A9 2E              LDA #'.
03986  DD80  C8                 INY
03987  DD81  99 FF 00           STA FBUFFR-1,Y
03988  DD84  84 C0       STXBUF STY FBUFPT
03989  DD86  A4 96              LDY FDECPT
03990  DD88  8A                 TXA
03991  DD89  49 FF              EOR #@377
03992  DD8B  29 80              AND #@200
03993  DD8D  AA                 TAX
03994  DD8E  C0 24              CPY #FDCEND-FOUTBL
03995  DD90  F0 04              BEQ FOULDY
03996  DD92  C0 3C              CPY #TIMEND-FOUTBL
03997  DD94  D0 A6              BNE FOUT2
03998  DD96  A4 C0       FOULDY LDY FBUFPT
03999  DD98  B9 FF 00    FOUT11 LDA FBUFFR-1,Y
04000  DD9B  88                 DEY
04001  DD9C  C9 30              CMP #'0
04002  DD9E  F0 F8              BEQ FOUT11
04003  DDA0  C9 2E              CMP #'.
04004  DDA2  F0 01              BEQ FOUT12
04005  DDA4  C8                 INY
04006  DDA5  A9 2B       FOUT12 LDA #'+
04007  DDA7  A6 AD              LDX TENEXP
04008  DDA9  F0 2E              BEQ FOUT17
04009  DDAB  10 08              BPL FOUT14
04010  DDAD  A9 00              LDA #0
04011  DDAF  38                 SEC
04012  DDB0  E5 AD              SBC TENEXP
04013  DDB2  AA                 TAX
04014  DDB3              .FIL   CODE23










CODE23......PAGE 0053

LINE# LOC   CODE        LINE


04016  DDB3  A9 2D              LDA #'-
04017  DDB5  99 01 01    FOUT14 STA FBUFFR+1,Y
04018  DDB8  A9 45              LDA #'E
04019  DDBA  99 00 01           STA FBUFFR,Y
04020  DDBD  8A                 TXA
04021  DDBE  A2 2F              LDX #@57
04022  DDC0  38                 SEC
04023  DDC1  E8          FOUT15 INX
04024  DDC2  E9 0A              SBC #@12
04025  DDC4  B0 FB              BCS FOUT15
04026  DDC6  69 3A              ADC #@72
04027  DDC8  99 03 01           STA FBUFFR+3,Y
04028  DDCB  8A                 TXA
04029  DDCC  99 02 01           STA FBUFFR+2,Y
04030  DDCF  A9 00              LDA #0
04031  DDD1  99 04 01           STA FBUFFR+4,Y
04032  DDD4  F0 08              BEQ FOUT20
04033  DDD6  99 FF 00    FOUT19 STA FBUFFR-1,Y
04034  DDD9  A9 00       FOUT17 LDA #0
04035  DDDB  99 00 01           STA FBUFFR,Y
04036  DDDE  A9 00       FOUT20 LDA #<FBUFFR
04037  DDE0  A0 01              LDY #>FBUFFR
04038  DDE2  60                 RTS
04039  DDE3  80          FHALF  .BYT @200,0,0,0,0
04039  DDE4  00 
04039  DDE5  00 
04039  DDE6  00 
04039  DDE7  00 
04040  DDE8  FA          FOUTBL .BYT @372,@12,@37,0,0
04040  DDE9  0A 
04040  DDEA  1F 
04040  DDEB  00 
04040  DDEC  00 
04041  DDED  98                 .BYT @230,@226,@200,@377
04041  DDEE  96 
04041  DDEF  80 
04041  DDF0  FF 
04042  DDF1  F0                 .BYT @360,@275,@300,0
04042  DDF2  BD 
04042  DDF3  C0 
04042  DDF4  00 
04043  DDF5  01                 .BYT 1,@206,@240,@377
04043  DDF6  86 
04043  DDF7  A0 
04043  DDF8  FF 
04044  DDF9  FF                 .BYT @377,@330,@360,0,0
04044  DDFA  D8 
04044  DDFB  F0 
04044  DDFC  00 
04044  DDFD  00 
04045  DDFE  03                 .BYT 3,@350,@377,@377
04045  DDFF  E8 
04045  DE00  FF 
04045  DE01  FF 
04046  DE02  FF                 .BYT @377,@234,0,0,0,@12






CODE23......PAGE 0054

LINE# LOC   CODE        LINE


04046  DE03  9C 
04046  DE04  00 
04046  DE05  00 
04046  DE06  00 
04046  DE07  0A 
04047  DE08  FF                 .BYT @377,@377,@377,@377
04047  DE09  FF 
04047  DE0A  FF 
04047  DE0B  FF 
04048  DE0C  FF          FDCEND .BYT @377,@337,@12,@200
04048  DE0D  DF 
04048  DE0E  0A 
04048  DE0F  80 
04049  DE10  00                 .BYT 0,3,@113,@300,@377
04049  DE11  03 
04049  DE12  4B 
04049  DE13  C0 
04049  DE14  FF 
04050  DE15  FF                 .BYT @377,@163,@140,0,0
04050  DE16  73 
04050  DE17  60 
04050  DE18  00 
04050  DE19  00 
04051  DE1A  0E                 .BYT @16,@20,@377,@377
04051  DE1B  10 
04051  DE1C  FF 
04051  DE1D  FF 
04052  DE1E  FD                 .BYT @375,@250,0,0,0,@74
04052  DE1F  A8 
04052  DE20  00 
04052  DE21  00 
04052  DE22  00 
04052  DE23  3C 
04053  DE24              TIMEND
04054  DE24  20 DE DA    SQR    JSR MOVAF
04055  DE27  A9 E3              LDA #<FHALF
04056  DE29  A0 DD              LDY #>FHALF
04057  DE2B  20 74 DA           JSR MOVFM
04058  DE2E  F0 70       FPWRT  BEQ EXP
04059  DE30  A5 B8              LDA ARGEXP
04060  DE32  D0 03              BNE FPWRT1
04061  DE34  4C CE D7           JMP ZEROF1
04062  DE37  A2 9D       FPWRT1 LDX #<TEMPF3
04063  DE39  A0 00              LDY #>TEMPF3
04064  DE3B  20 A6 DA           JSR MOVMF
04065  DE3E  A5 BD              LDA ARGSGN
04066  DE40  10 0F              BPL FPWR1
04067  DE42  20 9E DB           JSR INT
04068  DE45  A9 9D              LDA #<TEMPF3
04069  DE47  A0 00              LDY #>TEMPF3
04070  DE49  20 2D DB           JSR FCOMP
04071  DE4C  D0 03              BNE FPWR1
04072  DE4E  98                 TYA
04073  DE4F  A4 5A              LDY INTEGR
04074  DE51  20 D0 DA    FPWR1  JSR MOVFA1






CODE23......PAGE 0055

LINE# LOC   CODE        LINE


04075  DE54  98                 TYA
04076  DE55  48                 PHA
04077  DE56  20 BF D8           JSR LOG
04078  DE59  A9 9D              LDA #<TEMPF3
04079  DE5B  A0 00              LDY #>TEMPF3
04080  DE5D  20 FD D8           JSR FMULT
04081  DE60  20 A0 DE           JSR EXP
04082  DE63  68                 PLA
04083  DE64  4A                 LSR A
04084  DE65  90 0A              BCC NEGRTS
04085  DE67  A5 B0       NEGOP  LDA FACEXP
04086  DE69  F0 06              BEQ NEGRTS
04087  DE6B  A5 B5              LDA FACSGN
04088  DE6D  49 FF              EOR #@377
04089  DE6F  85 B5              STA FACSGN
04090  DE71  60          NEGRTS RTS
04091  DE72              .FIL   CODE24












































CODE24......PAGE 0056

LINE# LOC   CODE        LINE


04093  DE72  81          LOGEB2 .BYT @201,@70,@252,@73,@51
04093  DE73  38 
04093  DE74  AA 
04093  DE75  3B 
04093  DE76  29 
04094  DE77  07          EXPCON .BYT 7,@161,@64,@130,@76
04094  DE78  71 
04094  DE79  34 
04094  DE7A  58 
04094  DE7B  3E 
04095  DE7C  56                 .BYT @126,@164,@26,@176
04095  DE7D  74 
04095  DE7E  16 
04095  DE7F  7E 
04096  DE80  B3                 .BYT @263,@33,@167,@57
04096  DE81  1B 
04096  DE82  77 
04096  DE83  2F 
04097  DE84  EE                 .BYT @356,@343,@205,@172
04097  DE85  E3 
04097  DE86  85 
04097  DE87  7A 
04098  DE88  1D                 .BYT @35,@204,@34,@52
04098  DE89  84 
04098  DE8A  1C 
04098  DE8B  2A 
04099  DE8C  7C                 .BYT @174,@143,@131,@130
04099  DE8D  63 
04099  DE8E  59 
04099  DE8F  58 
04100  DE90  0A                 .BYT @12,@176,@165,@375
04100  DE91  7E 
04100  DE92  75 
04100  DE93  FD 
04101  DE94  E7                 .BYT @347,@306,@200,@61
04101  DE95  C6 
04101  DE96  80 
04101  DE97  31 
04102  DE98  72                 .BYT @162,@30,@20,@201
04102  DE99  18 
04102  DE9A  10 
04102  DE9B  81 
04103  DE9C  00                 .BYT 0,0,0,0
04103  DE9D  00 
04103  DE9E  00 
04103  DE9F  00 
04104  DEA0  A9 72       EXP    LDA #<LOGEB2
04105  DEA2  A0 DE              LDY #>LOGEB2
04106  DEA4  20 FD D8           JSR FMULT
04107  DEA7  A5 BF              LDA FACOV
04108  DEA9  69 50              ADC #@120
04109  DEAB  90 03              BCC STOLD
04110  DEAD  20 F5 DA           JSR INCRND
04111  DEB0              .FIL   CODE25
04112  DEB0              ;CODE25






CODE24......PAGE 0057

LINE# LOC   CODE        LINE


04113  DEB0  85 A5       STOLD  STA OLDOV
04114  DEB2  20 E1 DA           JSR MOVEF
04115  DEB5  A5 B0              LDA FACEXP
04116  DEB7  C9 88              CMP #@210
04117  DEB9  90 03              BCC EXP1
04118  DEBB  20 A6 D9    GOMLDV JSR MLDVEX
04119  DEBE  20 9E DB    EXP1   JSR INT
04120  DEC1  A5 5A              LDA INTEGR
04121  DEC3  18                 CLC
04122  DEC4  69 81              ADC #@201
04123  DEC6  F0 F3              BEQ GOMLDV
04124  DEC8  38                 SEC
04125  DEC9  E9 01              SBC #1
04126  DECB  48                 PHA
04127  DECC  A2 05              LDX #4+ADDPRC
04128  DECE  B5 B8       SWAPLP LDA ARGEXP,X
04129  DED0  B4 B0              LDY FACEXP,X
04130  DED2  95 B0              STA FACEXP,X
04131  DED4  94 B8              STY ARGEXP,X
04132  DED6  CA                 DEX
04133  DED7  10 F5              BPL SWAPLP
04134  DED9  A5 A5              LDA OLDOV
04135  DEDB  85 BF              STA FACOV
04136  DEDD  20 28 D7           JSR FSUBT
04137  DEE0  20 67 DE           JSR NEGOP
04138  DEE3  A9 77              LDA #<EXPCON
04139  DEE5  A0 DE              LDY #>EXPCON
04140  DEE7  20 09 DF           JSR POLY
04141  DEEA  A9 00              LDA #0
04142  DEEC  85 BE              STA ARISGN
04143  DEEE  68                 PLA
04144  DEEF  20 8B D9           JSR MLDEXP
04145  DEF2  60                 RTS
04146  DEF3  85 C0       POLYX  STA POLYPT
04147  DEF5  84 C1              STY POLYPT+1
04148  DEF7  20 9C DA           JSR MOV1F
04149  DEFA  A9 A6              LDA #TEMPF1
04150  DEFC  20 FD D8           JSR FMULT
04151  DEFF  20 0D DF           JSR POLY1
04152  DF02  A9 A6              LDA #<TEMPF1
04153  DF04  A0 00              LDY #>TEMPF1
04154  DF06  4C FD D8           JMP FMULT
04155  DF09  85 C0       POLY   STA POLYPT
04156  DF0B  84 C1              STY POLYPT+1
04157  DF0D  20 99 DA    POLY1  JSR MOV2F
04158  DF10  B1 C0              LDA (POLYPT)Y
04159  DF12  85 B6              STA DEGREE
04160  DF14  A4 C0              LDY POLYPT
04161  DF16  C8                 INY
04162  DF17  98                 TYA
04163  DF18  D0 02              BNE POLY3
04164  DF1A  E6 C1              INC POLYPT+1
04165  DF1C  85 C0       POLY3  STA POLYPT
04166  DF1E  A4 C1              LDY POLYPT+1
04167  DF20  20 FD D8    POLY2  JSR FMULT






CODE24......PAGE 0058

LINE# LOC   CODE        LINE


04168  DF23  A5 C0              LDA POLYPT
04169  DF25  A4 C1              LDY POLYPT+1
04170  DF27  18                 CLC
04171  DF28  69 05              ADC #4+ADDPRC
04172  DF2A  90 01              BCC POLY4
04173  DF2C  C8                 INY
04174  DF2D  85 C0       POLY4  STA POLYPT
04175  DF2F  84 C1              STY POLYPT+1
04176  DF31  20 3C D7           JSR FADD
04177  DF34  A9 AB              LDA #<TEMPF2
04178  DF36  A0 00              LDY #>TEMPF2
04179  DF38  C6 B6              DEC DEGREE
04180  DF3A  D0 E4              BNE POLY2
04181  DF3C  60                 RTS
04182  DF3D  98          RMULC  .BYT @230,@65,@104,@172
04182  DF3E  35 
04182  DF3F  44 
04182  DF40  7A 
04183  DF41  68          RADDC  .BYT @150,@50,@261,@106
04183  DF42  28 
04183  DF43  B1 
04183  DF44  46 
04184  DF45  20 FD DA    RND    JSR SIGN
04185  DF48  30 2E              BMI RND1
04186  DF4A  D0 17              BNE QSETNR
04187  DF4C  AD 44 90           LDA CHTIM
04188  DF4F  85 B1              STA FACHO
04189  DF51  AD 48 90           LDA CHTIM+4
04190  DF54  85 B2              STA FACMOH
04191  DF56  AD 45 90           LDA CHTIM+1
04192  DF59  85 B3              STA FACMO
04193  DF5B  AD 49 90           LDA CHTIM+5
04194  DF5E  85 B4              STA FACLO
04195  DF60  4C 88 DF           JMP STRNEX
04196  DF63  A9 DA       QSETNR LDA #<RNDX
04197  DF65  A0 00              LDY #>RNDX
04198  DF67  20 74 DA           JSR MOVFM
04199  DF6A  A9 3D              LDA #<RMULC
04200  DF6C  A0 DF              LDY #>RMULC
04201  DF6E  20 FD D8           JSR FMULT
04202  DF71  A9 41              LDA #<RADDC
04203  DF73  A0 DF              LDY #>RADDC
04204  DF75  20 3C D7           JSR FADD
04205  DF78  A6 B4       RND1   LDX FACLO
04206  DF7A  A5 B1              LDA FACHO
04207  DF7C  85 B4              STA FACLO
04208  DF7E  86 B1              STX FACHO
04209  DF80  A6 B2              LDX FACMOH
04210  DF82  A5 B3              LDA FACMO
04211  DF84  85 B2              STA FACMOH
04212  DF86  86 B3              STX FACMO
04213  DF88  A9 00       STRNEX LDA #0
04214  DF8A  85 B5              STA FACSGN
04215  DF8C  A5 B0              LDA FACEXP
04216  DF8E  85 BF              STA FACOV






CODE24......PAGE 0059

LINE# LOC   CODE        LINE


04217  DF90  A9 80              LDA #@200
04218  DF92  85 B0              STA FACEXP
04219  DF94  20 AC D7           JSR NORMAL
04220  DF97  A2 DA              LDX #<RNDX
04221  DF99  A0 00              LDY #>RNDX
04222  DF9B  4C A6 DA    GMOVMF JMP MOVMF
04223  DF9E  A9 1A       COS    LDA #<PI2
04224  DFA0  A0 E0              LDY #>PI2
04225  DFA2  20 3C D7           JSR FADD
04226  DFA5  20 DE DA    SIN    JSR MOVAF
04227  DFA8  A9 1F              LDA #<TWOPI
04228  DFAA  A0 E0              LDY #>TWOPI
04229  DFAC  A6 BD              LDX ARGSGN
04230  DFAE  20 D9 D9           JSR FDIVF
04231  DFB1  20 DE DA           JSR MOVAF
04232  DFB4  20 9E DB           JSR INT
04233  DFB7  A9 00              LDA #0
04234  DFB9  85 BE              STA ARISGN
04235  DFBB  20 28 D7           JSR FSUBT
04236  DFBE  A9 24              LDA #<FR4
04237  DFC0  A0 E0              LDY #>FR4
04238  DFC2  20 25 D7           JSR FSUB
04239  DFC5  A5 B5              LDA FACSGN
04240  DFC7  48                 PHA
04241  DFC8  10 0D              BPL SIN1
04242  DFCA  20 1E D7           JSR FADDH
04243  DFCD  A5 B5              LDA FACSGN
04244  DFCF  30 09              BMI SIN2
04245  DFD1  A5 63              LDA TANSGN
04246  DFD3  49 FF              EOR #$FF
04247  DFD5  85 63              STA TANSGN
04248  DFD7  20 67 DE    SIN1   JSR NEGOP
04249  DFDA  A9 24       SIN2   LDA #<FR4
04250  DFDC  A0 E0              LDY #>FR4
04251  DFDE  20 3C D7           JSR FADD
04252  DFE1  68                 PLA
04253  DFE2  10 03              BPL SIN3
04254  DFE4  20 67 DE           JSR NEGOP
04255  DFE7  A9 29       SIN3   LDA #<SINCON
04256  DFE9  A0 E0              LDY #>SINCON
04257  DFEB  4C F3 DE           JMP POLYX
04258  DFEE  20 9C DA    TAN    JSR MOV1F
04259  DFF1  A9 00              LDA #0
04260  DFF3  85 63              STA TANSGN
04261  DFF5  20 A5 DF           JSR SIN
04262  DFF8  A2 9D              LDX #<TEMPF3
04263  DFFA  A0 00              LDY #>TEMPF3
04264  DFFC  20 9B DF           JSR GMOVMF
04265  DFFF  A9 A6              LDA #<TEMPF1
04266  E001  A0 00              LDY #>TEMPF1
04267  E003  20 74 DA           JSR MOVFM
04268  E006  A9 00              LDA #0
04269  E008  85 B5              STA FACSGN
04270  E00A  A5 63              LDA TANSGN
04271  E00C  20 16 E0           JSR COSC






CODE24......PAGE 005A

LINE# LOC   CODE        LINE


04272  E00F  A9 9D              LDA #<TEMPF3
04273  E011  A0 00              LDY #>TEMPF3
04274  E013  4C E1 D9           JMP FDIV
04275  E016  48          COSC   PHA
04276  E017  4C D7 DF           JMP SIN1
04277  E01A  81          PI2    .BYT @201,@111,@17,@332,@242
04277  E01B  49 
04277  E01C  0F 
04277  E01D  DA 
04277  E01E  A2 
04278  E01F  83          TWOPI  .BYT @203,@111,@17,@332,@242
04278  E020  49 
04278  E021  0F 
04278  E022  DA 
04278  E023  A2 
04279  E024  7F          FR4    .BYT @177,0,0,0,0
04279  E025  00 
04279  E026  00 
04279  E027  00 
04279  E028  00 
04280  E029  05          SINCON .BYT 5,@204,@346,@32,@55
04280  E02A  84 
04280  E02B  E6 
04280  E02C  1A 
04280  E02D  2D 
04281  E02E  1B                 .BYT @33,@206,@50,@7,@373
04281  E02F  86 
04281  E030  28 
04281  E031  07 
04281  E032  FB 
04282  E033  F8                 .BYT @370,@207,@231,@150,@211
04282  E034  87 
04282  E035  99 
04282  E036  68 
04282  E037  89 
04283  E038  01                 .BYT 1,@207,@43,@65,@337,@341
04283  E039  87 
04283  E03A  23 
04283  E03B  35 
04283  E03C  DF 
04283  E03D  E1 
04284  E03E  86                 .BYT @206,@245,@135,@347,@50,@203
04284  E03F  A5 
04284  E040  5D 
04284  E041  E7 
04284  E042  28 
04284  E043  83 
04285  E044  49                 .BYT @111,@17,@332,@242
04285  E045  0F 
04285  E046  DA 
04285  E047  A2 
04286  E048  A5 B5       ATN    LDA FACSGN
04287  E04A  48                 PHA
04288  E04B  10 03              BPL ATN1
04289  E04D  20 67 DE           JSR NEGOP






CODE24......PAGE 005B

LINE# LOC   CODE        LINE


04290  E050  A5 B0       ATN1   LDA FACEXP
04291  E052  48                 PHA
04292  E053  C9 81              CMP #@201
04293  E055  90 07              BCC ATN2
04294  E057  A9 91              LDA #<FONE
04295  E059  A0 D8              LDY #>FONE
04296  E05B  20 E1 D9           JSR FDIV
04297  E05E  A9 78       ATN2   LDA #<ATNCON
04298  E060  A0 E0              LDY #>ATNCON
04299  E062  20 F3 DE           JSR POLYX
04300  E065  68                 PLA
04301  E066  C9 81              CMP #@201
04302  E068  90 07              BCC ATN3
04303  E06A  A9 1A              LDA #<PI2
04304  E06C  A0 E0              LDY #>PI2
04305  E06E  20 25 D7           JSR FSUB
04306  E071  68          ATN3   PLA
04307  E072  10 03              BPL ATN4
04308  E074  4C 67 DE           JMP NEGOP
04309  E077  60          ATN4   RTS
04310  E078  0B          ATNCON .BYT @13,@166,@263,@203
04310  E079  76 
04310  E07A  B3 
04310  E07B  83 
04311  E07C  BD                 .BYT @275,@323,@171,@36,@364
04311  E07D  D3 
04311  E07E  79 
04311  E07F  1E 
04311  E080  F4 
04312  E081  A6                 .BYT @246,@365,@173,@203,@374
04312  E082  F5 
04312  E083  7B 
04312  E084  83 
04312  E085  FC 
04313  E086  B0                 .BYT @260,@20
04313  E087  10 
04314  E088  7C                 .BYT @174,@14,@37,@147,@312
04314  E089  0C 
04314  E08A  1F 
04314  E08B  67 
04314  E08C  CA 
04315  E08D  7C                 .BYT @174,@336,@123,@313,@301
04315  E08E  DE 
04315  E08F  53 
04315  E090  CB 
04315  E091  C1 
04316  E092  7D                 .BYT @175,@24,@144,@160,@114
04316  E093  14 
04316  E094  64 
04316  E095  70 
04316  E096  4C 
04317  E097  7D                 .BYT @175,@267,@352,@121,@172
04317  E098  B7 
04317  E099  EA 
04317  E09A  51 






CODE24......PAGE 005C

LINE# LOC   CODE        LINE


04317  E09B  7A 
04318  E09C  7D                 .BYT @175,@143,@60,@210,@176
04318  E09D  63 
04318  E09E  30 
04318  E09F  88 
04318  E0A0  7E 
04319  E0A1  7E                 .BYT @176,@222,@104,@231,@72
04319  E0A2  92 
04319  E0A3  44 
04319  E0A4  99 
04319  E0A5  3A 
04320  E0A6  7E                 .BYT @176,@114,@314,@221,@307
04320  E0A7  4C 
04320  E0A8  CC 
04320  E0A9  91 
04320  E0AA  C7 
04321  E0AB  7F                 .BYT @177,@252,@252,@252,@23
04321  E0AC  AA 
04321  E0AD  AA 
04321  E0AE  AA 
04321  E0AF  13 
04322  E0B0  81                 .BYT @201,0,0,0,0
04322  E0B1  00 
04322  E0B2  00 
04322  E0B3  00 
04322  E0B4  00 
04323  E0B5              .FIL   CODE26


































CODE26......PAGE 005D

LINE# LOC   CODE        LINE


04325  E0B5  E6 C9       INITAT INC CHRGET+7
04326  E0B7  D0 02              BNE CHDGOT
04327  E0B9  E6 CA              INC CHRGET+8
04328  E0BB  AD 60 EA    CHDGOT LDA 60000
04329  E0BE  C9 3A              CMP #':
04330  E0C0  B0 0A              BCS CHDRTS
04331  E0C2  C9 20              CMP #' 
04332  E0C4  F0 EF              BEQ INITAT
04333  E0C6  38                 SEC
04334  E0C7  E9 30              SBC #'0
04335  E0C9  38                 SEC
04336  E0CA  E9 D0              SBC #$D0
04337  E0CC  60          CHDRTS RTS
04338  E0CD  80                 .BYT 128,79,199,82,89
04338  E0CE  4F 
04338  E0CF  C7 
04338  E0D0  52 
04338  E0D1  59 
04339  E0D2  A2 FF       INIT   LDX #255
04340  E0D4  86 89              STX CURLIN+1
04341  E0D6  9A                 TXS
04342  E0D7  A9 4C              LDA #76
04343  E0D9  85 A3              STA JMPER
04344  E0DB  85 00              STA USRPOK
04345  E0DD  A9 30              LDA #<FCERR
04346  E0DF  A0 D1              LDY #>FCERR
04347  E0E1  85 01              STA USRPOK+1
04348  E0E3  84 02              STY USRPOK+2
04349  E0E5  A2 1C              LDX #RNDX+4-CHRGET
04350  E0E7  BD B4 E0    MOVCHG LDA INITAT-1,X
04351  E0EA  95 C1              STA CHRGET-1,X
04352  E0EC  CA                 DEX
04353  E0ED  D0 F8              BNE MOVCHG
04354  E0EF  8A                 TXA
04355  E0F0  85 B7              STA BITS
04356  E0F2  85 03              STA CHANNL
04357  E0F4  85 67              STA LASTPT+1
04358  E0F6  85 04              STA NULCNT
04359  E0F8  85 05              STA TRMPOS
04360  E0FA  48                 PHA
04361  E0FB  85 64              STA CNTWFL
04362  E0FD  A9 03              LDA #STRSIZ
04363  E0FF  85 A2              STA FOUR6
04364  E101  A9 2C              LDA #',
04365  E103  85 09              STA LINNUM+1
04366  E105  20 D2 C9           JSR CRDO
04367  E108  A2 68              LDX #TEMPST
04368  E10A  86 65              STX TEMPPT
04369  E10C  A9 00              LDA #<RAMLOC
04370  E10E  A0 04              LDY #>RAMLOC
04371  E110  85 08              STA LINNUM
04372  E112  84 09              STY LINNUM+1
04373  E114  A0 00              LDY #0

04375  E116  E6 08       LOOPMM INC LINNUM






CODE26......PAGE 005E

LINE# LOC   CODE        LINE


04376  E118  D0 08              BNE LOOPM1
04377  E11A  E6 09              INC LINNUM+1
04378  E11C  A5 09              LDA LINNUM+1
04379  E11E  C9 80              CMP #$80
04380  E120  F0 0F              BEQ USEDEC
04381  E122  A9 92       LOOPM1 LDA #146
04382  E124  91 08              STA (LINNUM)Y
04383  E126  D1 08              CMP (LINNUM)Y
04384  E128  D0 07              BNE USEDEC
04385  E12A  0A                 ASL A
04386  E12B  91 08              STA (LINNUM)Y
04387  E12D  D1 08              CMP (LINNUM)Y
04388  E12F  F0 E5              BEQ LOOPMM
04389  E131  A5 08       USEDEC LDA LINNUM
04390  E133  A4 09              LDY LINNUM+1
04391  E135  85 86       USEDEF STA MEMSIZ
04392  E137  84 87              STY MEMSIZ+1
04393  E139  85 82              STA FRETOP
04394  E13B  84 83              STY FRETOP+1
04395  E13D  A2 00              LDX #<RAMLOC
04396  E13F  A0 04              LDY #>RAMLOC
04397  E141  86 7A              STX TXTTAB
04398  E143  84 7B              STY TXTTAB+1
04399  E145  A0 00              LDY #0
04400  E147  98                 TYA
04401  E148  91 7A              STA (TXTTAB)Y
04402  E14A  E6 7A              INC TXTTAB
04403  E14C  D0 02              BNE INIT20
04404  E14E  E6 7B              INC TXTTAB+1
04405  E150  A5 7A       INIT20 LDA TXTTAB
04406  E152  A4 7B              LDY TXTTAB+1
04407  E154  20 2A C3           JSR REASON
04408  E157  20 D2 C9           JSR CRDO
04409  E15A  A5 86              LDA MEMSIZ
04410  E15C  38                 SEC
04411  E15D  E5 7A              SBC TXTTAB
04412  E15F  AA                 TAX
04413  E160  A5 87              LDA MEMSIZ+1
04414  E162  E5 7B              SBC TXTTAB+1
04415  E164  20 9F DC           JSR LINPRT
04416  E167  A9 74              LDA #<WORDS
04417  E169  A0 E1              LDY #>WORDS
04418  E16B  20 27 CA           JSR STROUT
04419  E16E  20 53 C5           JSR SCRTCH
04420  E171  4C 8B C3           JMP READY
04421  E174  20 42       WORDS  .BYT ' BYTES FREE'
04422  E17F  13          FREMES .BYT 19,'*** COMMODORE BASIC ***'
04422  E180  2A 2A 
04423  E197  11                 .BYT 17,17,17,0
04423  E198  11 
04423  E199  11 
04423  E19A  00 
04424  E19B              .FIL   PATCH
04425  E19B  18          PATCH1 CLC
04426  E19C  4C 2B C7           JMP     STPEND






CODE26......PAGE 005F

LINE# LOC   CODE        LINE


04428  E19F  24 B4       PATCH2 BIT     FACLO
04429  E1A1  10 07              BPL     LE1AA
04430  E1A3  C9 54              CMP     #'T
04431  E1A5  D0 03              BNE     LE1AA
04432  E1A7  4C 3B CE           JMP     LCE3B
04433  E1AA  60          LE1AA  RTS

04435  E1AB  24 B4       PATCH3 BIT     FACLO
04436  E1AD  30 03              BMI     *+5
04437  E1AF  4C 90 CE           JMP     GOMOVF
04438  E1B2  C9 54              CMP     #'T
04439  E1B4  F0 03              BEQ     *+5
04440  E1B6  4C 82 CE           JMP     QSTATV
04441  E1B9  4C 69 CE           JMP     LCE69

04443  E1BC  85 5A       PATCH4 STA     CHARAC
04444  E1BE  E8                 INX
04445  E1BF  4C D9 E1           JMP     PATCH7

04447  E1C2  10 05       PATCH5 BPL     LE1C9
04448  E1C4  A5 8E              LDA     DATLIN
04449  E1C6  A4 8F              LDY     DATLIN+1
04450  E1C8  60                 RTS
04451  E1C9  A0 FF       LE1C9  LDY     #$FF
04452  E1CB  60                 RTS

04454  E1CC  D0 0A       PATCH6 BNE     LE1D8
04455  E1CE  E6 05       LE1CE  INC     TRMPOS
04456  E1D0  D0 06              BNE     LE1D8
04457  E1D2  A5 E2              LDA     PNTR
04458  E1D4  85 05              STA     TRMPOS
04459  E1D6  D0 F6              BNE     LE1CE
04460  E1D8  60          LE1D8  RTS

04462  E1D9  86 C9       PATCH7 STX     TXTPTR
04463  E1DB  68                 PLA
04464  E1DC  68                 PLA
04465  E1DD  98                 TYA
04466  E1DE  4C 88 CB           JMP     RESETC

04468  E1E1              LASTWR
04469  E1E1              .END


ERRORS = 00000


SYMBOL TABLE

SYMBOL VALUE
 ABS      DB2A    ADDEND   0077    ADDFRS   C2D2    ADDIND   D209
 ADDON    C7F3    ADDPR2   0002    ADDPR4   0004    ADDPR8   0008
 ADDPRC   0001    AFFRTS   C546    ANDMSK   0098    ANDOP    CED9
 ARGEXP   00B8    ARGHO    00B9    ARGLO    00BC    ARGMO    00BB








SYMBOL TABLE

SYMBOL VALUE
 ARGMOH   00BA    ARGSGN   00BD    ARISGN   00BE    ARYDON   D05D
 ARYGET   D488    ARYPNT   00A7    ARYSTR   D48A    ARYTAB   007E
 ARYVA2   D44A    ARYVA3   D44E    ARYVAR   D442    ARYVGO   D459
 ASC      D663    ASPAC    CA1A    ATN      E048    ATN1     E050
 ATN2     E05E    ATN3     E071    ATN4     E077    ATNCON   E078
 AYINT    D0A7    BIGGES   DD04    BITS     00B7    BLT1     C2FE
 BLTLP    C30A    BLTU     C2DA    BLTUC    C2E1    BRKTXT   C2A4
 BSERR    D12D    BSERR7   D1F1    BUF      000A    BUFFUL   CB0C
 BUFLEN   0050    BUFOFS   0000    BUFPTR   00C0    CAT      D515
 CCALL    FFE7    CCCHN    FFCC    CCLOS    FFC3    CGETL    FFE4
 CHANNL   0003    CHARAC   005A    CHDGOT   E0BB    CHDRTS   E0CC
 CHEAD    C43C    CHKCLS   CE0B    CHKCOM   CE11    CHKERR   CCB3
 CHKNUM   CCA7    CHKOK    CCB0    CHKOPN   CE0E    CHKSTR   CCA9
 CHKVAL   CCAA    CHRD     D5C4    CHRGET   00C2    CHRGOT   00C8
 CHRRTS   00D9    CHTIM    9044    CINCH    FFCF    CKEOL    C6CF
 CLEAR    C770    CLEARC   C56A    CLMWID   000A    CLOAD    FFD5
 CLRFAC   DBBB    CLRPOS   C9F4    CLSCHN   FFCC    CMD      C985
 CMPFOR   C2C6    CMPSPC   C49E    CNTWFL   0064    COIN     FFC6
 COLIS    C4EF    COMBYT   D6CA    COMPRT   C9F9    CONINT   D679
 CONT     C745    CONTRT   C75E    CONUPK   D95E    COOUT    FFC9
 COPEN    FFC0    COPFLT   C8CE    COPSTR   C8D1    COPY     C951
 COPYC    C967    COS      DF9E    COSC     E016    COUNT    005C
 CRDO     C9D2    CRDONE   C51A    CRFIN    C9E2    CRTSKP   CA44
 CRUNCH   C48D    CSAVE    FFD8    CSTAT    020C    CSYS     FFDE
 CTIMR    0200    CURLIN   0088    CURTOL   00C0    CVERF    FFDB
 CZLOOP   C447    DATA     C7F0    DATAN    C7FE    DATATK   0083
 DATBK    CB67    DATBK1   CB6B    DATLIN   008E    DATLOP   CBCF
 DATPTR   0090    DECBLT   C315    DECCNT   00AC    DECCUR   D1B6
 DEF      D295    DEFFIN   D333    DEFPNT   009D    DEFSTF   D2FC
 DEGREE   00B6    DIM      CF71    DIM3     CF6E    DIMFLG   005D
 DIMRTS   D232    DIRCON   C6C4    DIRIS    C733    DIV10    D9D0
 DIVIDE   D9FB    DIVNRM   DA50    DIVSUB   DA2F    DNTCPY   C94A
 DOAGIN   CA8F    DOCMP    CF62    DOCO     C840    DOCOND   C838
 DOCSTR   CCB1    DOMASK   0063    DOMIN    CE21    DOPRE1   CD3A
 DOPREC   CD13    DOREL    CF06    DORES    0060    DOSGFL   D6F6
 DPTFLG   00AE    DSCPNT   009F    DSCTMP   00B0    DV0ERR   DA5C
 DVAR     D4A1    DVAR2    D4B6    DVAR3    D4C0    DVARS    D497
 DVARTS   D4D0    EATEM    CFA0    END      C71E    ENDCHR   005B
 ENDCON   C735    ENDREL   CCF1    ENDTK    0080    EORMSK   0099
 EPSGN    00AF    EQULTK   00B2    ERR      C28D    ERRBD    00C4
 ERRBS    0070    ERRCN    00DF    ERRCRD   C366    ERRDD    007D
 ERRDIR   D28B    ERRDVO   008A    ERRFC    0035    ERRFIN   C380
 ERRGO1   D292    ERRGO2   D3B2    ERRGO3   D132    ERRGO4   CCB5
 ERRGO5   CC4A    ERRID    009A    ERRLS    00B5    ERRNF    0000
 ERROD    002A    ERROM    0052    ERROR    C359    ERROV    004A
 ERRRG    0016    ERRSN    0010    ERRST    00CC    ERRTAB   C190
 ERRTM    00A8    ERRUF    00ED    ERRUS    005F    EVAL     CD9D
 EVAL0    CDA1    EVAL1    CDA6    EVAL2    CDA9    EVAL3    CDE0
 EVAL4    CDF7    EXCHQT   C809    EXIGNT   CC12    EXP      DEA0
 EXP1     DEBE    EXPCON   DE77    EXPSGN   00AF    FAC      00B0
 FACEXP   00B0    FACHO    00B1    FACLO    00B4    FACMO    00B3
 FACMOH   00B2    FACOV    00BF    FACSGN   00B5    FADD     D73C
 FADD1    D76C    FADD2    D7D3    FADD4    D778    FADD5    D737
 FADDA    D768    FADDC    D74C    FADDH    D71E    FADDT    D73F
 FADFLT   D7A7    FBUFFR   0100    FBUFPT   00C0    FCERR    D130








SYMBOL TABLE

SYMBOL VALUE
 FCERR1   C76D    FCOMP    DB2D    FCOMPC   DB64    FCOMPD   DB6A
 FCOMPN   DB2F    FCOMPS   DB03    FCSIGN   DB01    FDCEND   DE0C
 FDECPT   0096    FDIV     D9E1    FDIVF    D9D9    FDIVT    D9E4
 FFLOOP   C2B1    FFRTS    C2D9    FHALF    DDE3    FIN      DBC5
 FIN1     DBE1    FINC     DBDC    FINDG1   DC43    FINDGQ   DBDF
 FINDIG   DC3C    FINDIV   DC24    FINDP    DC13    FINE     DC19
 FINE1    DC1B    FINEC    DC02    FINEC1   DC00    FINEC2   DC07
 FINEDG   DC63    FINGO    CEC6    FINI     C430    FININ1   C476
 FININL   C9C8    FINLOG   DC50    FINML6   D9BF    FINMUL   DC2D
 FINNOW   D083    FINPTR   D079    FINQNG   DC34    FINRE2   CD2B
 FINREL   CD21    FINZLP   DBC9    FLINRT   C54F    FLNRTS   C550
 FLOAD    C581    FLOAT    DB0E    FLOATB   DB21    FLOATC   DB1B
 FLOATS   DB16    FMAPTR   D088    FMULT    D8FD    FMULTT   D900
 FNDFOR   C2AC    FNDLIN   C522    FNDLNC   C526    FNDLO1   C53D
 FNDOER   D2D6    FNDVAR   D408    FNEDG1   DC05    FNTK     00A5
 FNWAIT   D702    FONE     D891    FOR      C649    FORPNT   0098
 FORPSH   CD5D    FORSIZ   0012    FORTK    0081    FOULDY   DD96
 FOUR6    00A2    FOUT     DCAF    FOUT1    DCB9    FOUT11   DD98
 FOUT12   DDA5    FOUT14   DDB5    FOUT15   DDC1    FOUT16   DD36
 FOUT17   DDD9    FOUT19   DDD6    FOUT2    DD3C    FOUT20   DDDE
 FOUT3    DCE8    FOUT37   DCD2    FOUT38   DCF3    FOUT39   DD25
 FOUT4    DCDD    FOUT40   DD62    FOUT41   DD60    FOUT5    DD01
 FOUT6    DD1A    FOUT7    DCDB    FOUT8    DD38    FOUT9    DCFA
 FOUTBL   DDE8    FOUTC    DCB1    FOUTIM   DD3A    FOUTPI   DD19
 FOUTYP   DD69    FPWR1    DE51    FPWRT    DE2E    FPWRT1   DE37
 FR4      E024    FRE      D264    FREFAC   D57E    FREMES   E17F
 FREPLA   D5AD    FRERTS   D5C3    FRESPC   0084    FRESTR   D57B
 FRETMP   D582    FRETMS   D5B3    FRETOP   0082    FRETRT   D5AE
 FRMEV1   CCBE    FRMEVL   CCB8    FRMNUM   CCA4    FSUB     D725
 FSUBT    D728    FUNDSP   C046    GARBA2   D404    GARBAG   D3F4
 GARBFL   0060    GET      CA9F    GETADR   D6D0    GETAGN   CAF8
 GETBPT   C4DA    GETBYT   D676    GETCMP   CF56    GETCON   D6F3
 GETDEF   D1D3    GETDTL   CA7B    GETERR   C36C    GETFNM   D2C3
 GETFOR   CC3C    GETNTH   CB64    GETNUM   D6C4    GETSPA   D3D2
 GETSPT   C92B    GETSTK   C31D    GETTIM   CE76    GETTTY   CAB6
 GINLIN   CB21    GIVAYF   D278    GLET     C6F9    GMOVMF   DF9B
 GOBADV   D02C    GOFLOT   CF6B    GOFUC    D670    GOGO     D492
 GOLST    C5B0    GOMLDV   DEBB    GOMOVF   CE90    GONE     C6E9
 GONE2    C6F5    GONE3    C6F2    GONPRC   CE23    GOOO     CE54
 GOOOOO   CE65    GOOVER   D9B1    GORDY    C742    GORTS    C7C9
 GOSUB    C780    GOSUTK   008D    GOTARY   D135    GOTNUM   C926
 GOTO     C79D    GOTOTK   0089    GRBPAS   D4E0    GRBPNT   009D
 GRBRTS   D4DB    GRBTOP   00AE    GREASE   D1A2    GREATK   00B1
 GRODY    C61E    GTBYTC   D673    HAVFOR   CC4C    HIGHDS   00A7
 HIGHTR   00A9    IF       C820    INCFAC   D844    INCFRT   D852
 INCHR    C479    INCRND   DAF5    INCRTS   C48C    INDEX    0071
 INDEX1   0071    INDEX2   0073    INDICE   00B3    INDLOP   D0C3
 INIT     E0D2    INIT20   E150    INITAT   E0B5    INLIN    C468
 INLINC   C46A    INLINN   C465    INLOOP   CB30    INLPN1   D1F8
 INLPN2   D1F7    INLPNM   D1DB    INPCO1   CB2A    INPCOM   C8D2
 INPCON   CB29    INPFLG   0062    INPPTR   0092    INPRT    DC94
 INPRTS   CC11    INPUT    CAE0    INPUTN   CAC6    INT      DB9E
 INTEGR   005A    INTERR   CF8C    INTFLG   005F    INTIDX   D09D
 INTRTS   DBC4    INTXT    C294    IODONE   CAD6    IORELE   CAD8
 ISARY    D0B9    ISCNTC   FFE1    ISCRTS   C71B    ISFUN    CE97








SYMBOL TABLE

SYMBOL VALUE
 ISLETC   D005    ISLRTS   D00E    ISSEC    CF9F    ISVAR    CE28
 ISVRET   CE2B    JMPER    00A3    JSRGM    D094    KLOOP    C493
 KLOOP1   C4B4    LASNUM   00C7    LASTPT   0066    LASTWR   E1E1
 LC9D8    C9D8    LCA5A    CA5A    LCA64    CA64    LCE3B    CE3B
 LCE69    CE69    LD100    DA4C    LD657    D657    LDFONE   C692
 LDZR     D015    LE1AA    E1AA    LE1C9    E1C9    LE1CE    E1CE
 LE1D8    E1D8    LE7F3    E7F3    LEFTD    D5D8    LEN      D654
 LEN1     D65A    LESSTK   00B3    LET      C89D    LINGET   C863
 LINLEN   0028    LINLIN   C462    LINNUM   0008    LINPRT   DC9F
 LIST     C5A8    LIST4    C5D5    LNKPRG   C433    LOFBUF   00FF
 LOG      D8BF    LOG1     D8C9    LOG2     D8BA    LOGCN2   D896
 LOGEB2   DE72    LOGERR   D8C6    LOOPDN   CC92    LOOPM1   E122
 LOOPMM   E116    LOPFDA   D104    LOPFDV   D110    LOPFN    CFED
 LOPFND   CFE3    LOPPTA   D16F    LOPREL   CCD5    LOWDS    00AC
 LOWTR    00AE    LPOPER   CCC3    LSTEND   C5C7    LSTPNT   0098
 LUK4IT   C7B4    LUKALL   C7B8    MAIN     C394    MAIN1    C3AC
 MEMSIZ   0086    MID2     D620    MIDD     D60F    MINUTK   00AB
 MLDEXP   D98B    MLDVEX   D9A6    MLEX10   DC72    MLEXMI   DC70
 MLOOP    C3EF    MLTPL1   D930    MLTPL2   D933    MLTPL3   D94F
 MLTPLY   D92B    MORCO1   C9FC    MOREN1   C30E    MORLIN   C869
 MORSTS   C6C8    MOV1F    DA9C    MOV2F    DA99    MOVAF    DADE
 MOVAFL   DAE3    MOVCHG   E0E7    MOVDO    D564    MOVEF    DAE1
 MOVFA    DACE    MOVFA1   DAD0    MOVFAL   DAD4    MOVFM    DA74
 MOVFR    DA61    MOVINS   D552    MOVLP    D568    MOVMF    DAA6
 MOVRTS   DAEC    MOVSTR   D560    MOVVF    DAA2    MUL10    D9B4
 MUL10R   D9CA    MULDIV   D989    MULSHF   D858    MULTRT   D95D
 MUSTCR   C4BC    MVDONE   D571    MVSTRT   D57A    N0999    DC85
 N32768   D099    N9999    DC8A    NCMPOS   001E    NEGFAC   D81C
 NEGFCH   D822    NEGHLF   D8B5    NEGOP    DE67    NEGPRC   CD14
 NEGRTS   DE71    NEGTAB   C089    NEGXQS   DC39    NEWCHR   C99C
 NEWSGO   CC8F    NEWSTT   C6B5    NEXT     CC36    NMARY1   D11F
 NMIL     DC8F    NODATT   C4F1    NODEL    C3FD    NODELC   C418
 NOFREF   D26B    NOML6    C902    NONONO   D0B4    NORM1    D7FE
 NORM2    D7F2    NORM3    D7B0    NORMAL   D7AC    NOSEC    CFAA
 NOTABR   CA21    NOTDIM   D17F    NOTEVE   D04D    NOTEVL   D01C
 NOTFDD   D149    NOTFL1   D218    NOTFLT   D15D    NOTFNS   D00F
 NOTIT    CFFB    NOTOL    C65A    NOTOP    CDE8    NOTQTI   CAF1
 NOTSTR   CFB4    NOTTAB   C08C    NOTTK    00A8    NOWGE1   CB94
 NOWGET   CB89    NOWLIN   CBE8    NTHIS    C507    NTHIS1   C50B
 NULCNT   0004    NULL     C75F    NUMINS   CBA0    NUMLEV   0017
 NXTCMP   CF4B    NXTLGC   C897    NXTPTR   CFFA    OFFSET   8000
 OKGOTO   C82F    OKNORM   CEC1    OLDLIN   008A    OLDOV    00A5
 OLDTXT   008C    OMERR    C357    OMERR1   D1F4    ONEFUN   00B4
 ONEON    C6A6    ONGLOP   C84F    ONGLP1   C857    ONGOTO   C843
 ONGRTS   C862    OPMASK   009C    OPPTR    009A    OPTAB    C074
 OROP     CED6    OUTCH    FFD2    OUTDO    CA49    OUTDO1   CA6A
 OUTQST   CA47    OUTRTS   CA74    OVERR    D853    PARCHK   CE05
 PATCH1   E19B    PATCH2   E19F    PATCH3   E1AB    PATCH4   E1BC
 PATCH5   E1C2    PATCH6   E1CC    PATCH7   E1D9    PEEK     D6E6
 PI       00FF    PI2      E01A    PIVAL    CDBC    PLOOP    C5FF
 PLOOP1   C60C    PLUSTK   00AA    PNTR     00E2    POKE     D6F9
 POKER    0008    POLY     DF09    POLY1    DF0D    POLY2    DF20
 POLY3    DF1C    POLY4    DF2D    POLYPT   00C0    POLYX    DEF3
 POS      D285    POSINT   D0A3    PREAM    D637    PRINT    C99F
 PRINTC   C9A1    PRINTK   0099    PRINTN   C97F    PRIT3    C63E








SYMBOL TABLE

SYMBOL VALUE
 PRIT4    C5FB    PRTNUL   C9EE    PRTRTS   C9F8    PTDORL   C08F
 PTRGET   CF7B    PTRGT1   CF80    PTRGT2   CF82    PTRGT3   CF8F
 PULMOR   D5FD    PULSTK   CD80    PUSHF    CD52    PUSHF1   CD4D
 PUTNEW   D3AA    PUTNW1   D3B5    QCHNUM   CD77    QCOMP    CF51
 QDATA    CB5B    QDECT1   C3E7    QDOT     CDC1    QINLIN   CB17
 QINT     DB6D    QINT1    DB8D    QINTGO   D0B6    QINTGR   C8BA
 QINTRT   DB8C    QISHFT   DB81    QNUM     00CF    QOP      CD72
 QOPGO    CD75    QOPRTS   CD9A    QPLOP    C621    QPLUS    DBD8
 QPREC    CD0A    QPREC1   CD33    QSETNR   DF63    QSHFT    DA1E
 QSTATV   CE82    QSTAVR   D02F    QVARIA   C93C    RADDC    DF41
 RAMLOC   0400    READ     CB24    READY    C38B    REARTS   C356
 REASAV   C338    REASON   C32A    REASTO   C343    REDDY    C299
 REM      C833    REMER    C811    REMN     C801    REMRTS   C7FD
 REMTK    008F    RESCON   C4C8    RESCR1   C636    RESER    C4C6
 RESETC   CB88    RESFIN   C717    RESHO    0075    RESLO    0078
 RESLST   C092    RESMO    0077    RESMOH   0076    RESPUL   C4C7
 RESRCH   C633    RESTOR   C70D    RETU1    C7E3    RETURN   C7CA
 RIGHTD   D604    RLEFT    D5DE    RLEFT1   D5E4    RLEFT2   D5E5
 RLEFT3   D5E6    RMULC    DF3D    RND      DF45    RND1     DF78
 RNDRTS   D81B    RNDSHF   D80D    RNDX     00DA    ROLSHF   D885
 ROMLOC   C000    ROUND    DAED    RUN      C775    RUNC     C567
 RUNC2    C794    SAVEIT   C98F    SAVQUO   DA11    SCRATH   C551
 SCRATK   00A2    SCRTCH   C553    SETQUT   CB7C    SGN      DB0B
 SGNFLG   00B6    SHFARG   DA21    SHFTR2   D85A    SHFTR3   D87B
 SHFTR4   D881    SHFTRT   D88F    SHIFTR   D86E    SIGN     DAFD
 SIGNRT   DB0A    SIN      DFA5    SIN1     DFD7    SIN2     DFDA
 SIN3     DFE7    SINCON   E029    SIZE     00A4    SIZEOK   D535
 SNERR    CE1C    SNERR1   C6CC    SNERR2   C7E0    SNERR3   C84B
 SNERR4   CA83    SNERR5   CD4A    SNGFLT   D287    SPCTK    00A6
 SQR      DE24    SQR05    D8AB    SQR20    D8B0    SQUEEZ   D80B
 ST2TXT   D6BB    STASGN   CF46    STCURL   CA7F    STEPTK   00A9
 STKEND   01FF    STKINI   C584    STKRTS   C599    STMDSP   C000
 STOLD    DEB0    STOLOP   C428    STOML1   D21E    STOMLT   D166
 STOP     C71C    STOPC    C71F    STORDO   D711    STPEND   C72B
 STR1     C4F8    STRCMP   CF1E    STRD     D349    STRDN2   CBA8
 STRDON   C999    STREND   0080    STRFI1   D38C    STRFI2   D38D
 STRFIN   D388    STRFRE   D3E9    STRGET   D37B    STRINI   D359
 STRLIT   D36B    STRLT2   D371    STRNAM   CFCB    STRNEX   DF88
 STRNG    C500    STRNG1   00BE    STRNG2   00C0    STROU2   DCAC
 STROUT   CA27    STRPR2   CA31    STRPRT   CA2A    STRRTS   CE53
 STRSIZ   0003    STRSPA   D361    STRST2   D399    STRTX2   CDDA
 STRTXT   CDD1    STUFFH   C4DC    STXBUF   DD84    STXFND   CFE1
 STXFOR   CC3F    STXTPT   C59A    SUBFLG   0061    SUBIT    D784
 SVAR     D435    SVARGO   D43D    SVARS    D429    SWAPLP   DECE
 SYNCHR   CE13    TABER    CA06    TABTK    00A3    TAN      DFEE
 TANSGN   0063    TEMPF1   00A6    TEMPF2   00AB    TEMPF3   009D
 TEMPPT   0065    TEMPST   0068    TENC     D9CB    TENEXP   00AD
 THENTK   00A7    TIMELP   C8E8    TIMEND   DE24    TIMEST   C912
 TIMNUM   C91C    TIMSTR   D353    TOTK     00A4    TRMNO1   CA86
 TRMNOK   CA77    TRMOK    CBB4    TRMPOS   0005    TRYAG2   D3D4
 TRYAG3   D3DF    TRYAGN   CC23    TRYMOR   C334    TRYOFF   D996
 TRYOUT   CA70    TSTDUN   C5F2    TSTOP    CCD2    TURNON   CFC4
 TVAR     D420    TWOPI    E01F    TXTPTR   00C9    TXTTAB   007A
 TYPERR   C379    TYPLIN   C5F4    UMLCNT   D25F    UMLRTS   D263
 UMULT    D233    UMULTC   D246    UMULTD   D23C    UNPRTS   CD9C








SYMBOL TABLE

SYMBOL VALUE
 UNPSTK   CD7E    USEDEC   E131    USEDEF   E135    USERR    C7DB
 USRLOC   C04C    USRPOK   0000    VAL      D685    VAL2     D6A5
 VALRTS   D6C3    VALTYP   005E    VAREND   CBF5    VARNAM   0094
 VAROK    D037    VARPNT   0096    VARTAB   007C    VARTXT   0008
 VARY0    CC00    WAITER   D715    WORDS    E174    XSPAC1   CA1B
 XSPAC2   CA1E    ZEREMV   D9AC    ZERITA   D1B1    ZERO     D01A
 ZEROF1   D7CE    ZEROFC   D7CC    ZEROML   D7D0    ZERRTS   D71D
 ZZ1      0009    ZZ2      000B    ZZ4      0009    ZZ5      0009
 ZZ6      CE2A    ZZ7      01FE   

END OF ASSEMBLY
ossrc......PAGE 0001

LINE# LOC   CODE        LINE


00001  0000              ;**********************************
00002  0000              ;*                                *
00003  0000              ;* PET 2001 OPERATING SYSTEM      *
00004  0000              ;*                                *
00005  0000              ;* VERSION 1.0  AUGUST 8,1977     *
00006  0000              ;*                                *
00007  0000              ;* ROMS PRODUCED: 901439-03       *
00008  0000              ;*                901439-04       *
00009  0000              ;*                901439-07       *
00010  0000              ;* RECONSTR.: M.HOFFMANN-VETTER   *
00011  0000              ;*                                *
00012  0000              ;**********************************

00014  0000              OFFSET =$8000          ;FOR *** HARD MACHINE ***

00016  0000              ; LISTING DATE ??/??/??

00018  0000                     * =$0
00019  0000              BUF                    ;BASIC INPUT BUFFER
00020  0000                     * =$E0
00021  00E0              PNT    *=*+1
00022  00E1              POINT  *=*+1
00023  00E2              PNTR   *=*+1
00024  00E3              SAL    *=*+1
00025  00E4              SAH    *=*+1
00026  00E5              EAL    *=*+1
00027  00E6              EAH    *=*+1
00028  00E7              CMP0   *=*+1
00029  00E8              TEMP   *=*+1
00030  00E9              T1     *=*+1           ;TEMPORARY 1
00031  00EA              QTSW   *=*+1
00032  00EB              SNSW1  *=*+1
00033  00EC              DIFF   *=*+1
00034  00ED              PRP    *=*+1
00035  00EE              FNLEN  *=*+1           ;LENGTH CURRENT FILE N STR
00036  00EF              LA     *=*+1           ;CURRENT FILE LOGICAL ADDR
00037  00F0              SA     *=*+1           ;CURRENT FILE 2ND ADDR
00038  00F1              FA     *=*+1           ;CURRENT FILE PRIMARY ADDR
00039  00F2              LNMX   *=*+1
00040  00F3              TBUF   *=*+2
00041  00F5              TBLX   *=*+1
00042  00F6              DATA   *=*+1
00043  00F7              STAL   *=*+1
00044  00F8              STAH   *=*+1
00045  00F9              FNADR  *=*+2           ;ADDR CURRENT FILE NAME STR
00046  00FB              INSRT  *=*+1
00047  00FC              OCHAR  *=*+1
00048  00FD              FSBLK  *=*+1           ;CASSETTE READ BLOCK COUNT
00049  00FE              MYCH   *=*+1
00050  00FF                     *=$100
00051  0100              BAD    *=*+1
00052  0101                     * =$200
00053  0200              TIME   *=*+3           ;24 HR CLOCK IN 1/60 SEC
00054  0203              LSTX   *=*+1           ;INDEX TO CHAR IN KEYSCAN
00055  0204              SFST   *=*+1           ;KEYBOARD SHIFT FLAG






ossrc......PAGE 0002

LINE# LOC   CODE        LINE


00056  0205              CRFAC  *=*+2           ;CORRECTION FACTOR TIME
00057  0207              CAS1   *=*+1
00058  0208              CAS2   *=*+1
00059  0209              STKEY  *=*+1           ;STOP KEY FLAG
00060  020A              SVXT   *=*+1           ;TEMPORARY
00061  020B              VERCK  *=*+1           ;LOAD OR VERIFY FLAG
00062  020C              SATUS  *=*+1           ;OPERATION STATUS BYTE
00063  020D              NDX    *=*+1           ;INDEX TO KEYD QUEUE
00064  020E              RVS    *=*+1           ;REVERSE FIELD ENABLED
00065  020F              KEYD   *=*+10
00066  0219              CINV   *=*+2           ;IRQ RAM VECTOR
00067  021B              CBINV  *=*+2           ;BRK INSTR RAM VECTOR
00068  021D              C3P0   *=*+1           ;CASSETTE SERVQ CONSTANT
00069  021E              INDX   *=*+1           ;
00070  021F              SNSW   *=*+1           ;CASSETTE....
00071  0220              LSXP   *=*+1           ;START GF SCREEN INPUT
00072  0221              LSTP   *=*+1
00073  0222              BSOUR  *=*+1           ;CHAR BUFFER FOR IEEE
00074  0223              SFDX   *=*+1           ;SHIFT MODE FOR PRINT
00075  0224              BLNSW  *=*+1           ;CURSOR BLINK ENABLE
00076  0225              BLNCT  *=*+1           ;COUNTER TO FLIP CURSORBREAK
00077  0226              GDBLN  *=*+1           ;O0LD CHAR BEFORE BLINK
00078  0227              BLNON  *=*+1           ;ON/OFF BLINK FLAG
00079  0228              SYNO   *=*+1           ;CASSETTE SYNC #
00080  0229              LDTB1  *=*+25
00081  0242              ;TABLES FOR OPEN FILES
00082  0242              LAT    *=*+10          ;LOGICAL FILE NUMBERS
00083  024C              FAT    *=*+10          ;PRIMARY DEVICE NUMBERS
00084  0256              SAT    *=*+10          ;SECONDARY ADDRESSES
00085  0260              CRSW   *=*+1           ;INPUT/GET FLAG
00086  0261              XSAV   *=*+1           ;TEMP FOR BASIN
00087  0262              LDTND  *=*+1           ;INDEX TO LOGICAL FILE
00088  0263              DFLTN  *=*+1           ;DEFAULT INPUT DEVICE #
00089  0264              DFLTO  *=*+1           ;DEFAULT QUTPUT DEVICE #
00090  0265              PRTY   *=*+1           ;CASSETTE PARITY
00091  0266              DPSW   *=*+1           ;CASSETTE DIPOLE SWITCH
00092  0267              WSW    *=*+1           ;CASSETE WRITE ENABLE
00093  0268              RCNT
00094  0268              T2     *=*+1           ;TEMPORARY 2
00095  0269              T3     *=*+1           ;TEMPORARY 3
00096  026A              L026A  *=*+2
00097  026C              PCNTR  *=*+1           ;CASSETTE STUFF
00098  026D                     *=*+2
00099  026F              FIRT   *=*+1
00100  0270              CNTDN  *=*+1           ;CASSETTE SYNC CQUNTDOWN
00101  0271              BUFPT  *=*+2           ;POINTER TO ACTIVE CASSETTE BUFFE
00102  0273              SHCNL  *=*+1           ;CASSETTE SHORT COUNT
00103  0274              RER    *=*+1           ;CASSETTE READ ERROR
00104  0275              REZ    *=*+1           ;CASSETE READING ZEROES
00105  0276              PTR1   *=*+1           ;CASSETTE ERROR PASS1
00106  0277              PTR2   *=*+1           ;CASSETTE ERROR PASS2
00107  0278              RDFLG  *=*+1           ;CASSETTE READ MODE
00108  0279              SHCNH  *=*+1           ;CASSETTE SHORT CNT
00109  027A              TAPE1  *=*+192
00110  033A              TAPE2  *=*+192         ;192 BYTES RESERVED






ossrc......PAGE 0003

LINE# LOC   CODE        LINE


00111  03FA                     *=$E810
00112  E810              PIAL   *=*+1
00113  E811              PIAL1  *=*+1
00114  E812              PIAK   *=*+1
00115  E813              PIAS   *=*+1
00116  E814                     *=$E820
00117  E820              IEEI   *=*+1
00118  E821              IEEIS  *=*+1
00119  E822              IEEO   *=*+1
00120  E823              IEEOS  *=*+1
00121  E824                     *=$E840
00122  E840              PIA    *=*+1
00123  E841              SYNC   *=*+1
00124  E842              P2DB   *=*+1
00125  E843              P2DA   *=*+1
00126  E844              TIL    *=*+1
00127  E845              TIH    *=*+1
00128  E846              TILL   *=*+1
00129  E847              TILH   *=*+1
00130  E848              T2L    *=*+1
00131  E849              T2H    *=*+1
00132  E84A              SR     *=*+1
00133  E84B              ACR    *=*+1
00134  E84C              PCR    *=*+1
00135  E84D              IFR    *=*+1
00136  E84E              IER    *=*+1
00137  E84F              SYNC1  *=*+1





00139  E850              ;CONSTANTS FROM BASIC
00140  E850              INIT   =$E0D2+OFFSET-$8000
00141  E850              FRMNUM =$CCA4+OFFSET-$8000
00142  E850              GETADR =$D6D0+OFFSET-$8000
00143  E850              LINNUM =$0008
00144  E850              TXTPTR =$00C9
00145  E850              FINI   =$C430+OFFSET-$8000
00146  E850              STXTPT =$C59A+OFFSET-$8000
00147  E850              FLOAD  =$C581+OFFSET-$8000
00148  E850              VARTAB =$007C
00149  E850              GETBYT =$D676+OFFSET-$8000
00150  E850              SNERR  =$CE1C+OFFSET-$8000
00151  E850              CHRGOT =$00C8
00152  E850              TYPERR =$C379+OFFSET-$8000
00153  E850              SYNCHR =$CE13+OFFSET-$8000
00154  E850              FRESTR =$D57B+OFFSET-$8000
00155  E850              FRMEVL =$CCB8+OFFSET-$8000
00156  E850              BSTOP  =$C71C+OFFSET-$8000 ;BASIC SYMB STOP
00157  E850              INDEX1 =$0071
00158  E850              LASTWR =$E1E1+OFFSET-$8000









ossrc......PAGE 0004

LINE# LOC   CODE        LINE


00160  E850              ;TAPE BLOCK TYPES
00161  E850              EOT=5
00162  E850              BLF=1
00163  E850              BDF=2
00164  E850              BDFH=4
00165  E850              BUFSZ=192
00166  E850              .FILE  OA1SRC






















































SCREEN EDITOR & I/O......PAGE 0005

LINE# LOC   CODE        LINE


00168  E850                     *=LASTWR
00169  E1E1              ;*** SOFT MACHINE ******
00170  E1E1  A9 7F       CINT   LDA #$7F
00171  E1E3  8D 4E E8           STA IER
00172  E1E6  85 06              STA 6
00173  E1E8  85 07              STA 6+1
00174  E1EA  A2 00              LDX #0
00175  E1EC  8A                 TXA
00176  E1ED  9D 00 02    PX1    STA TIME,X
00177  E1F0  CA          LE1F0  DEX
00178  E1F1  D0 FA              BNE PX1
00179  E1F3  CA                 DEX
00180  E1F4  A9 85              LDA #<KEY
00181  E1F6  8D 19 02           STA CINV
00182  E1F9  A9 E6              LDA #>KEY
00183  E1FB  8D 1A 02           STA CINV+1
00184  E1FE  A9 03              LDA #3
00185  E200  8D 64 02           STA DFLTO
00186  E203  A9 0F              LDA #$F
00187  E205  8D 10 E8           STA PIAL
00188  E208  0A                 ASL A
00189  E209  8D 40 E8           STA PIA
00190  E20C  8D 42 E8           STA P2DB
00191  E20F  8E 22 E8           STX IEEO
00192  E212  8E 45 E8           STX TIH
00193  E215  A9 3D              LDA #$3D
00194  E217  8D 13 E8           STA PIAS
00195  E21A  2C 12 E8           BIT PIAK
00196  E21D  A9 3C              LDA #$3C
00197  E21F  8D 21 E8           STA IEEIS
00198  E222  8D 23 E8           STA IEEOS
00199  E225  8D 11 E8           STA PIAL1
00200  E228  8E 22 E8           STX IEEO
00201  E22B  A9 0C              LDA #$C
00202  E22D  8D 4C E8           STA PCR
00203  E230  8D 25 02           STA BLNCT
00204  E233  8D 24 02           STA BLNSW
00205  E236  A0 00       CLSR   LDY #0
00206  E238  8C 0E 02           STY RVS
00207  E23B  84 E0              STY PNT
00208  E23D  A9 84              LDA #$84
00209  E23F  85 E1              STA PNT+1
00210  E241  A9 20       LE241  LDA #' 
00211  E243  C6 E1              DEC PNT+1
00212  E245  91 E0       LPS4   STA (PNT)Y
00213  E247  88                 DEY
00214  E248  D0 FB              BNE LPS4
00215  E24A  A5 E1              LDA PNT+1
00216  E24C  C9 80              CMP #$80
00217  E24E  D0 F1              BNE LE241
00218  E250  A9 80              LDA #$80
00219  E252  A2 19              LDX #25
00220  E254  9D 28 02    LPS1   STA LDTB1-1,X
00221  E257  CA          LPS3   DEX
00222  E258  D0 FA              BNE LPS1






SCREEN EDITOR & I/O......PAGE 0006

LINE# LOC   CODE        LINE


00223  E25A  A0 12              LDY #18
00224  E25C  20 73 E2           JSR LE273
00225  E25F  A0 0C              LDY #12
00226  E261  20 73 E2           JSR LE273
00227  E264  A0 05              LDY #5
00228  E266  20 73 E2           JSR LE273
00229  E269  A0 00       NXTD   LDY #0
00230  E26B  84 E2              STY PNTR
00231  E26D  84 F5              STY TBLX
00232  E26F  20 DB E5           JSR STUPT
00233  E272  60                 RTS
00234  E273  A2 18       LE273  LDX #24
00235  E275  FE 29 02    LE275  INC LDTB1,X
00236  E278  CA                 DEX
00237  E279  88                 DEY
00238  E27A  D0 F9              BNE LE275
00239  E27C  60                 RTS
00240  E27D  AC 0F 02    LP2    LDY KEYD
00241  E280  A2 00              LDX #0
00242  E282  BD 10 02    LP1    LDA KEYD+1,X
00243  E285  9D 0F 02           STA KEYD,X
00244  E288  E8                 INX
00245  E289  EC 0D 02           CPX NDX
00246  E28C  D0 F4              BNE LP1
00247  E28E  CE 0D 02           DEC NDX
00248  E291  98                 TYA
00249  E292  58                 CLI
00250  E293  60                 RTS
00251  E294  20 EA E3    LOOP4  JSR PRT
00252  E297  AD 0D 02    LOOP3  LDA NDX
00253  E29A  8D 24 02           STA BLNSW
00254  E29D  F0 F8              BEQ LOOP3
00255  E29F  78                 SEI
00256  E2A0  AD 27 02           LDA BLNON
00257  E2A3  F0 0B              BEQ LP21
00258  E2A5  AD 26 02           LDA GDBLN
00259  E2A8  A0 00              LDY #0
00260  E2AA  8C 27 02           STY BLNON
00261  E2AD  20 AC E7           JSR DSPP
00262  E2B0  20 7D E2    LP21   JSR LP2
00263  E2B3  C9 83              CMP #$83
00264  E2B5  D0 11              BNE LP22
00265  E2B7  78                 SEI
00266  E2B8  A2 09              LDX #9
00267  E2BA  8E 0D 02           STX NDX
00268  E2BD  BD D4 E7    LP23   LDA RUNTB-1,X
00269  E2C0  9D 0E 02           STA KEYD-1,X
00270  E2C3  CA                 DEX
00271  E2C4  D0 F7              BNE LP23
00272  E2C6  F0 CF              BEQ LOOP3
00273  E2C8  C9 0D       LP22   CMP #$D
00274  E2CA  D0 C8              BNE LOOP4
00275  E2CC  A4 F2              LDY LNMX
00276  E2CE  8C 60 02           STY CRSW
00277  E2D1  B1 E0       CLP5   LDA (PNT)Y






SCREEN EDITOR & I/O......PAGE 0007

LINE# LOC   CODE        LINE


00278  E2D3  C9 20              CMP #' 
00279  E2D5  D0 03              BNE CLP6
00280  E2D7  88                 DEY
00281  E2D8  D0 F7              BNE CLP5
00282  E2DA  C8          CLP6   INY
00283  E2DB  8C 1E 02           STY INDX
00284  E2DE  A0 00              LDY #0
00285  E2E0  84 E2              STY PNTR
00286  E2E2  84 EA              STY QTSW
00287  E2E4  AD 20 02           LDA LSXP
00288  E2E7  30 1A              BMI LOP5
00289  E2E9  C5 F5              CMP TBLX
00290  E2EB  D0 16              BNE LOP5
00291  E2ED  AD 21 02           LDA LSTP
00292  E2F0  85 E2              STA PNTR
00293  E2F2  CD 1E 02           CMP INDX
00294  E2F5  90 0C              BCC LOP5
00295  E2F7  4C 27 E3           JMP CLP2
00296  E2FA  98          LOOP5  TYA
00297  E2FB  48                 PHA
00298  E2FC  8A                 TXA
00299  E2FD  48                 PHA
00300  E2FE  AD 60 02           LDA CRSW
00301  E301  F0 94              BEQ LOOP3
00302  E303  A4 E2       LOP5   LDY PNTR
00303  E305  B1 E0              LDA (PNT)Y
00304  E307  85 F6              STA DATA
00305  E309  29 3F       LOP51  AND #$3F
00306  E30B  06 F6              ASL DATA
00307  E30D  24 F6              BIT DATA
00308  E30F  10 02              BPL LOP54
00309  E311  09 80              ORA #$80
00310  E313  90 04       LOP54  BCC LOP52
00311  E315  A6 EA              LDX QTSW
00312  E317  D0 04              BNE LOP53
00313  E319  70 02       LOP52  BVS LOP53
00314  E31B  09 40              ORA #$40
00315  E31D  E6 E2       LOP53  INC PNTR
00316  E31F  20 49 E3           JSR QTSWC
00317  E322  CC 1E 02           CPY INDX
00318  E325  D0 13              BNE CLP1
00319  E327  A9 00       CLP2   LDA #0
00320  E329  8D 60 02           STA CRSW
00321  E32C  A9 0D              LDA #$D
00322  E32E  AE 64 02           LDX DFLTO
00323  E331  E0 03              CPX #3
00324  E333  F0 03              BEQ CLP21
00325  E335  20 EA E3    CLP2A  JSR PRT
00326  E338  A9 0D       CLP21  LDA #$D
00327  E33A  85 F6       CLP1   STA DATA
00328  E33C  68                 PLA
00329  E33D  AA                 TAX
00330  E33E  68                 PLA
00331  E33F  A8                 TAY
00332  E340  A5 F6              LDA DATA






SCREEN EDITOR & I/O......PAGE 0008

LINE# LOC   CODE        LINE


00333  E342  C9 DE              CMP #$DE
00334  E344  D0 02              BNE CLP7
00335  E346  A9 FF              LDA #$FF
00336  E348  60          CLP7   RTS
00337  E349  C9 22       QTSWC  CMP #$22
00338  E34B  D0 08              BNE QTSWL
00339  E34D  A5 EA              LDA QTSW
00340  E34F  49 01              EOR #$1
00341  E351  85 EA              STA QTSW
00342  E353  A9 22              LDA #$22
00343  E355  60          QTSWL  RTS
00344  E356  09 40       NXT33  ORA #$40
00345  E358  AE 0E 02    NXT3   LDX RVS
00346  E35B  F0 02              BEQ NVS
00347  E35D  09 80       NC3    ORA #$80
00348  E35F  A6 FB       NVS    LDX INSRT
00349  E361  F0 02              BEQ NVS1
00350  E363  C6 FB              DEC INSRT
00351  E365  20 AC E7    NVS1   JSR DSPP
00352  E368  E6 E2       JSTS   INC PNTR
00353  E36A  A4 F2              LDY LNMX
00354  E36C  C4 E2              CPY PNTR
00355  E36E  B0 1A              BCS LOOP2
00356  E370  A6 F5              LDX TBLX
00357  E372  C0 4F              CPY #79
00358  E374  D0 0D              BNE JSTS1
00359  E376  20 97 E3           JSR JSTSX
00360  E379  20 30 E5           JSR NXLN
00361  E37C  A9 00              LDA #0
00362  E37E  85 E2              STA PNTR
00363  E380  4C 8A E3           JMP LOOP2
00364  E383  E0 18       JSTS1  CPX #24
00365  E385  D0 1D              BNE JTS2
00366  E387  20 AA E3           JSR SCRL
00367  E38A  68          LOOP2  PLA
00368  E38B  A8                 TAY
00369  E38C  A5 FB              LDA INSRT
00370  E38E  F0 02              BEQ LOP2
00371  E390  46 EA              LSR QTSW
00372  E392  68          LOP2   PLA
00373  E393  AA                 TAX
00374  E394  68                 PLA
00375  E395  58                 CLI
00376  E396  60                 RTS
00377  E397  E0 17       JSTSX  CPX #23
00378  E399  B0 08              BCS JSXB
00379  E39B  BD 2B 02           LDA LDTB1+2,X
00380  E39E  09 80              ORA #$80
00381  E3A0  9D 2B 02           STA LDTB1+2,X
00382  E3A3  60          JSXB   RTS
00383  E3A4  20 B1 E3    JTS2   JSR JSTS2
00384  E3A7  4C 8A E3           JMP LOOP2
00385  E3AA  20 59 E5    SCRL   JSR SCROL
00386  E3AD  C6 F5              DEC TBLX
00387  E3AF  A6 F5              LDX TBLX






SCREEN EDITOR & I/O......PAGE 0009

LINE# LOC   CODE        LINE


00388  E3B1  1E 2A 02    JSTS2  ASL LDTB1+1,X
00389  E3B4  5E 2A 02           LSR LDTB1+1,X
00390  E3B7  20 97 E3           JSR JSTSX
00391  E3BA  A5 E2              LDA PNTR
00392  E3BC  48                 PHA
00393  E3BD  20 DB E5           JSR STUPT
00394  E3C0  68                 PLA
00395  E3C1  85 E2              STA PNTR
00396  E3C3  60                 RTS
00397  E3C4  A0 27       BKLN   LDY #39
00398  E3C6  A6 F5              LDX TBLX
00399  E3C8  D0 06              BNE BKLN1
00400  E3CA  86 E2              STX PNTR
00401  E3CC  68                 PLA
00402  E3CD  68                 PLA
00403  E3CE  D0 BA              BNE LOOP2
00404  E3D0  BD 28 02    BKLN1  LDA LDTB1-1,X
00405  E3D3  30 06              BMI NTCN2
00406  E3D5  CA                 DEX
00407  E3D6  BD 28 02           LDA LDTB1-1,X
00408  E3D9  A0 4F              LDY #79
00409  E3DB  CA          NTCN2  DEX
00410  E3DC  86 F5              STX TBLX
00411  E3DE  85 E1              STA POINT
00412  E3E0  BD BC E7           LDA LDTB2,X
00413  E3E3  85 E0              STA PNT
00414  E3E5  84 E2              STY PNTR
00415  E3E7  84 F2              STY LNMX
00416  E3E9  60                 RTS
00417  E3EA  48          PRT    PHA
00418  E3EB  85 F6              STA DATA
00419  E3ED  8A                 TXA
00420  E3EE  48                 PHA
00421  E3EF  98                 TYA
00422  E3F0  48                 PHA
00423  E3F1  A9 00              LDA #0
00424  E3F3  8D 60 02           STA CRSW
00425  E3F6  A4 E2              LDY PNTR
00426  E3F8  A5 F6              LDA DATA
00427  E3FA  10 03              BPL *+5
00428  E3FC  4C 8F E4           JMP NXTX
00429  E3FF  C9 0D              CMP #$D
00430  E401  D0 03              BNE NJT1
00431  E403  4C 48 E5           JMP NXT1
00432  E406  C9 20       NJT1   CMP #' 
00433  E408  90 08              BCC NTCN
00434  E40A  29 3F              AND #$3F
00435  E40C  20 49 E3           JSR QTSWC
00436  E40F  4C 58 E3           JMP NXT3
00437  E412  A6 FB       NTCN   LDX INSRT
00438  E414  F0 03              BEQ CNC3X
00439  E416  4C 5D E3           JMP NC3
00440  E419  C9 14       CNC3X  CMP #$14
00441  E41B  D0 1C              BNE NTCN1
00442  E41D  88                 DEY






SCREEN EDITOR & I/O......PAGE 000A

LINE# LOC   CODE        LINE


00443  E41E  84 E2              STY PNTR
00444  E420  10 06              BPL BK1
00445  E422  20 C4 E3           JSR BKLN
00446  E425  4C 33 E4           JMP BK2
00447  E428  C8          BK1    INY
00448  E429  B1 E0              LDA (PNT)Y
00449  E42B  88                 DEY
00450  E42C  91 E0              STA (PNT)Y
00451  E42E  C8                 INY
00452  E42F  C4 F2              CPY LNMX
00453  E431  D0 F5              BNE BK1
00454  E433  A9 20       BK2    LDA #' 
00455  E435  91 E0              STA (PNT)Y
00456  E437  D0 3D              BNE JPL3
00457  E439  A6 EA       NTCN1  LDX QTSW
00458  E43B  F0 03              BEQ NC3W
00459  E43D  4C 5D E3    CNC3   JMP NC3
00460  E440  C9 12       NC3W   CMP #$12
00461  E442  D0 03              BNE NC1
00462  E444  8D 0E 02           STA RVS
00463  E447  C9 13       NC1    CMP #$13
00464  E449  D0 03              BNE NC2
00465  E44B  20 69 E2           JSR NXTD
00466  E44E  C9 1D       NC2    CMP #$1D
00467  E450  D0 12              BNE NCX2
00468  E452  C8                 INY
00469  E453  84 E2              STY PNTR
00470  E455  88                 DEY
00471  E456  C4 F2              CPY LNMX
00472  E458  90 07              BCC NCZ2
00473  E45A  20 30 E5           JSR NXLN
00474  E45D  A0 00              LDY #0
00475  E45F  84 E2       JPL4   STY PNTR
00476  E461  4C 8A E3    NCZ2   JMP LOOP2
00477  E464  C9 11       NCX2   CMP #$11
00478  E466  D0 0E              BNE JPL3
00479  E468  18                 CLC
00480  E469  98                 TYA
00481  E46A  69 28              ADC #40
00482  E46C  A8                 TAY
00483  E46D  C5 F2              CMP LNMX
00484  E46F  90 EE              BCC JPL4
00485  E471  F0 EC              BEQ JPL4
00486  E473  20 30 E5           JSR NXLN
00487  E476  4C 8A E3    JPL3   JMP LOOP2
00488  E479  E8          PRT1   INX
00489  E47A  85 F5              STA TBLX
00490  E47C  98                 TYA
00491  E47D  E9 28              SBC #40
00492  E47F  85 E2              STA PNTR
00493  E481  E6 F5       PRT2   INC TBLX
00494  E483  AD BC E7           LDA LDTB2
00495  E486  85 E0              STA PNT
00496  E488  AD 29 02           LDA LDTB1
00497  E48B  85 E1              STA POINT






SCREEN EDITOR & I/O......PAGE 000B

LINE# LOC   CODE        LINE


00498  E48D  D0 E7              BNE JPL3
00499  E48F  29 7F       NXTX   AND #$7F
00500  E491  C9 7F              CMP #$7F
00501  E493  D0 02              BNE NXTX1
00502  E495  A9 5E              LDA #$5E
00503  E497  C9 20       NXTX1  CMP #' 
00504  E499  90 03              BCC *+5
00505  E49B  4C 56 E3           JMP NXT33
00506  E49E  C9 0D              CMP #$D
00507  E4A0  D0 03              BNE UP5
00508  E4A2  4C 48 E5           JMP NXT1
00509  E4A5  A6 EA       UP5    LDX  QTSW
00510  E4A7  D0 30              BNE UP6
00511  E4A9  C9 14              CMP #$14
00512  E4AB  D0 28              BNE UP9
00513  E4AD  A4 F2              LDY LNMX
00514  E4AF  B1 E0              LDA (PNT)Y
00515  E4B1  C9 20              CMP #' 
00516  E4B3  D0 04              BNE INS3
00517  E4B5  C4 E2              CPY PNTR
00518  E4B7  D0 07              BNE INS1
00519  E4B9  C0 4F       INS3   CPY #79
00520  E4BB  F0 B9              BEQ JPL3
00521  E4BD  20 05 E6           JSR NEWLN
00522  E4C0  A4 F2       INS1   LDY LNMX
00523  E4C2  88          INS2   DEY
00524  E4C3  B1 E0              LDA (PNT)Y
00525  E4C5  C8                 INY
00526  E4C6  91 E0              STA (PNT)Y
00527  E4C8  88                 DEY
00528  E4C9  C4 E2              CPY PNTR
00529  E4CB  D0 F5              BNE INS2
00530  E4CD  A9 20              LDA #$20
00531  E4CF  91 E0              STA (PNT)Y
00532  E4D1  E6 FB              INC INSRT
00533  E4D3  D0 58              BNE JLP2
00534  E4D5  A6 FB       UP9    LDX INSRT
00535  E4D7  F0 05              BEQ UP2
00536  E4D9  09 40       UP6    ORA #$40
00537  E4DB  4C 5D E3           JMP NC3
00538  E4DE  C9 11       UP2    CMP #$11
00539  E4E0  D0 2C              BNE NXT2
00540  E4E2  A5 E2              LDA PNTR
00541  E4E4  C9 28              CMP #40
00542  E4E6  90 06              BCC UP1
00543  E4E8  E9 28              SBC #40
00544  E4EA  85 E2              STA PNTR
00545  E4EC  B0 3F              BCS JLP2
00546  E4EE  A6 F5       UP1    LDX TBLX
00547  E4F0  F0 3B              BEQ JLP2
00548  E4F2  BD 28 02           LDA LDTB1-1,X
00549  E4F5  10 07              BPL UP3
00550  E4F7  C6 F5              DEC TBLX
00551  E4F9  20 DB E5           JSR STUPT
00552  E4FC  90 2F              BCC JLP2






SCREEN EDITOR & I/O......PAGE 000C

LINE# LOC   CODE        LINE


00553  E4FE  CA          UP3    DEX
00554  E4FF  CA                 DEX
00555  E500  86 F5              STX TBLX
00556  E502  20 DB E5           JSR STUPT
00557  E505  A5 E2              LDA PNTR
00558  E507  18                 CLC
00559  E508  69 28              ADC #40
00560  E50A  85 E2              STA PNTR
00561  E50C  D0 1F              BNE JLP2
00562  E50E  C9 12       NXT2   CMP #$12
00563  E510  D0 05              BNE NXT6
00564  E512  A9 00              LDA #0
00565  E514  8D 0E 02           STA RVS
00566  E517  C9 1D       NXT6   CMP #$1D
00567  E519  D0 0B              BNE NXT61
00568  E51B  88                 DEY
00569  E51C  84 E2              STY PNTR
00570  E51E  10 0D              BPL JLP2
00571  E520  20 C4 E3           JSR BKLN
00572  E523  4C 8A E3           JMP LOOP2
00573  E526  C9 13       NXT61  CMP #$13
00574  E528  D0 03              BNE JLP2
00575  E52A  20 36 E2           JSR CLSR
00576  E52D  4C 8A E3    JLP2   JMP LOOP2
00577  E530  38          NXLN   SEC
00578  E531  4E 20 02           LSR LSXP
00579  E534  A6 F5              LDX TBLX
00580  E536  E8          NXLN2  INX
00581  E537  E0 19              CPX #25
00582  E539  D0 03              BNE NXLN1
00583  E53B  20 59 E5           JSR SCROL
00584  E53E  BD 29 02    NXLN1  LDA LDTB1,X
00585  E541  10 F3              BPL NXLN2
00586  E543  86 F5              STX TBLX
00587  E545  4C DB E5           JMP STUPT
00588  E548  A9 00       NXT1   LDA #0
00589  E54A  85 FB              STA INSRT
00590  E54C  8D 0E 02           STA RVS
00591  E54F  85 EA              STA QTSW
00592  E551  85 E2              STA PNTR
00593  E553  20 30 E5           JSR NXLN
00594  E556  4C 8A E3           JMP LOOP2
00595  E559              .FILE  OA2SRC


















SCREEN EDITOR & I/O......PAGE 000D

LINE# LOC   CODE        LINE


00597  E559  78          SCROL  SEI
00598  E55A  A0 00              LDY #0
00599  E55C  84 E0              STY POINT-1
00600  E55E  A9 80              LDA #$80
00601  E560  85 E4              STA SAH
00602  E562  85 E1              STA POINT
00603  E564  A9 28              LDA #40
00604  E566  2C 2A 02           BIT LDTB1+1
00605  E569  30 02              BMI SCRL1
00606  E56B  A9 50              LDA #80
00607  E56D  85 E3       SCRL1  STA SAL
00608  E56F  A9 34              LDA #$34
00609  E571  8D 11 E8           STA PIAL1
00610  E574  B1 E3       MLP1   LDA (SAL)Y
00611  E576  91 E0              STA (POINT-1)Y
00612  E578  C8                 INY
00613  E579  D0 F9              BNE MLP1
00614  E57B  E6 E4              INC SAH
00615  E57D  E6 E1              INC POINT
00616  E57F  A9 84              LDA #$84
00617  E581  C5 E4              CMP SAH
00618  E583  D0 EF              BNE MLP1
00619  E585  A9 E8              LDA #232
00620  E587  85 E0              STA PNT
00621  E589  C6 E1              DEC POINT
00622  E58B  A9 20              LDA #' 
00623  E58D  C6 E0       MLP2   DEC PNT
00624  E58F  C6 E3              DEC SAL
00625  E591  91 E0              STA (PNT)Y
00626  E593  D0 F8              BNE MLP2
00627  E595  A2 19              LDX #25
00628  E597  86 F5              STX TBLX
00629  E599  A2 00       SCRL4  LDX #0
00630  E59B  C6 F5              DEC TBLX
00631  E59D  BD 29 02    SCRL5  LDA LDTB1,X
00632  E5A0  29 7F              AND #$7F
00633  E5A2  BC 2A 02           LDY LDTB1+1,X
00634  E5A5  10 02              BPL SCRL3
00635  E5A7  09 80              ORA #$80
00636  E5A9  9D 29 02    SCRL3  STA LDTB1,X
00637  E5AC  E8                 INX
00638  E5AD  E0 19              CPX #25
00639  E5AF  D0 EC              BNE SCRL5
00640  E5B1  A9 83              LDA #$83
00641  E5B3  8D 41 02           STA LDTB1+24
00642  E5B6  AD 29 02           LDA LDTB1
00643  E5B9  10 DE              BPL SCRL4
00644  E5BB  A9 3C              LDA #$3C
00645  E5BD  8D 11 E8           STA PIAL1
00646  E5C0  58                 CLI
00647  E5C1  A9 FE              LDA #$FE
00648  E5C3  CD 12 E8           CMP PIAK
00649  E5C6  D0 10              BNE MLP42
00650  E5C8  A0 08              LDY #8
00651  E5CA  8D 45 E8    MLP4   STA TIH






SCREEN EDITOR & I/O......PAGE 000E

LINE# LOC   CODE        LINE


00652  E5CD  2C 4D E8    MLP41  BIT IFR
00653  E5D0  50 FB              BVC MLP41
00654  E5D2  88                 DEY
00655  E5D3  D0 F5              BNE MLP4
00656  E5D5  8C 0D 02           STY NDX
00657  E5D8  A6 F5       MLP42  LDX TBLX
00658  E5DA  60                 RTS
00659  E5DB  A6 F5       STUPT  LDX TBLX
00660  E5DD  BD 29 02           LDA LDTB1,X
00661  E5E0  09 80              ORA #$80
00662  E5E2  85 E1              STA POINT
00663  E5E4  BD BC E7           LDA LDTB2,X
00664  E5E7  85 E0              STA PNT
00665  E5E9  A9 27              LDA #39
00666  E5EB  85 F2              STA LNMX
00667  E5ED  E0 18              CPX #24
00668  E5EF  F0 09              BEQ STUPZ
00669  E5F1  BD 2A 02           LDA LDTB1+1,X
00670  E5F4  30 04              BMI STUPZ
00671  E5F6  A9 4F              LDA #79
00672  E5F8  85 F2              STA LNMX
00673  E5FA  A5 E2       STUPZ  LDA PNTR
00674  E5FC  C9 28              CMP #40
00675  E5FE  90 04              BCC STUPR
00676  E600  E9 28              SBC #40
00677  E602  85 E2              STA PNTR
00678  E604  60          STUPR  RTS
00679  E605  A6 F5       NEWLN  LDX TBLX
00680  E607  E8                 INX
00681  E608  78                 SEI
00682  E609  A9 34              LDA #$34
00683  E60B  8D 11 E8           STA PIAL1
00684  E60E  E0 17              CPX #23
00685  E610  F0 36              BEQ BLKLN
00686  E612  90 03              BCC NEWLX
00687  E614  4C AA E3           JMP SCRL
00688  E617  A2 17       NEWLX  LDX #23
00689  E619  BD 2A 02    NEWL1  LDA LDTB1+1,X
00690  E61C  09 80              ORA #$80
00691  E61E  85 E4              STA SAH
00692  E620  BC 29 02           LDY LDTB1,X
00693  E623  30 02              BMI NEWLA
00694  E625  29 7F              AND #$7F
00695  E627  9D 2A 02    NEWLA  STA LDTB1+1,X
00696  E62A  98                 TYA
00697  E62B  09 80              ORA #$80
00698  E62D  85 E1              STA POINT
00699  E62F  A0 27              LDY #39
00700  E631  BD BD E7           LDA LDTB2+1,X
00701  E634  85 E3              STA SAL
00702  E636  BD BC E7           LDA LDTB2,X
00703  E639  85 E0              STA PNT
00704  E63B  B1 E0       NELL   LDA (PNT)Y
00705  E63D  91 E3              STA (SAL)Y
00706  E63F  88                 DEY






SCREEN EDITOR & I/O......PAGE 000F

LINE# LOC   CODE        LINE


00707  E640  10 F9              BPL NELL
00708  E642  CA                 DEX
00709  E643  E4 F5              CPX TBLX
00710  E645  D0 D2              BNE NEWL1
00711  E647  E8                 INX
00712  E648  BD 29 02    BLKLN  LDA LDTB1,X
00713  E64B  09 80              ORA #$80
00714  E64D  85 E1              STA POINT
00715  E64F  29 7F              AND #$7F
00716  E651  9D 29 02           STA LDTB1,X
00717  E654  BD BC E7           LDA LDTB2,X
00718  E657  85 E0              STA PNT
00719  E659  A0 27              LDY #39
00720  E65B  A9 20              LDA #' 
00721  E65D  91 E0       BLKL   STA (PNT)Y
00722  E65F  88                 DEY
00723  E660  10 FB              BPL BLKL
00724  E662  A9 3C              LDA #$3C
00725  E664  8D 11 E8           STA PIAL1
00726  E667  58                 CLI
00727  E668  4C DB E5           JMP STUPT
00728  E66B  48          PULS   PHA
00729  E66C  8A                 TXA
00730  E66D  48                 PHA
00731  E66E  98                 TYA
00732  E66F  48                 PHA
00733  E670  BA                 TSX
00734  E671  BD 04 01           LDA $104,X
00735  E674  29 10              AND #$10
00736  E676  F0 03              BEQ PULS1
00737  E678  6C 1B 02           JMP (CBINV)
00738  E67B  6C 19 02    PULS1  JMP (CINV)
00739  E67E  68          PREND  PLA
00740  E67F  A8                 TAY
00741  E680  68                 PLA
00742  E681  AA                 TAX
00743  E682  68                 PLA
00744  E683  40                 RTI
00745  E684  60                 RTS
00746  E685  20 EA FF    KEY    JSR KUDTIM
00747  E688  AD 24 02           LDA BLNSW
00748  E68B  D0 23              BNE KEY4
00749  E68D  CE 25 02           DEC BLNCT
00750  E690  D0 1E              BNE KEY4
00751  E692  A9 14              LDA #20
00752  E694  8D 25 02           STA BLNCT
00753  E697  A4 E2              LDY PNTR
00754  E699  4E 27 02           LSR BLNON
00755  E69C  B1 E0              LDA (POINT-1)Y
00756  E69E  B0 06              BCS KEY5
00757  E6A0  EE 27 02           INC BLNON
00758  E6A3  8D 26 02           STA GDBLN
00759  E6A6  0A          KEY5   ASL A
00760  E6A7  B0 03              BCS LE6AC
00761  E6A9  38                 SEC






SCREEN EDITOR & I/O......PAGE 0010

LINE# LOC   CODE        LINE


00762  E6AA  B0 01              BCS LE6AD
00763  E6AC  18          LE6AC  CLC
00764  E6AD  6A          LE6AD  ROR A
00765  E6AE  91 E0              STA (POINT-1)Y
00766  E6B0  A2 FF       KEY4   LDX #$FF
00767  E6B2  8E 23 02           STX SFDX
00768  E6B5  E8                 INX
00769  E6B6  8E 04 02           STX SFST
00770  E6B9  A2 50              LDX #80
00771  E6BB  AD 10 E8           LDA PIAL
00772  E6BE  29 F0              AND #$F0
00773  E6C0  8D 10 E8           STA PIAL
00774  E6C3  A0 00              LDY #0
00775  E6C5  AD 10 E8           LDA PIAL
00776  E6C8  0A                 ASL A
00777  E6C9  0A                 ASL A
00778  E6CA  0A                 ASL A
00779  E6CB  10 07              BPL KEY3
00780  E6CD  8C 07 02           STY CAS1
00781  E6D0  A9 3D              LDA #$3D
00782  E6D2  D0 07              BNE KL24
00783  E6D4  AD 07 02    KEY3   LDA CAS1
00784  E6D7  D0 05              BNE KL2
00785  E6D9  A9 35              LDA #$35
00786  E6DB  8D 13 E8    KL24   STA PIAS
00787  E6DE  90 0A       KL2    BCC KL23
00788  E6E0  8C 08 02           STY CAS2
00789  E6E3  AD 40 E8           LDA PIA
00790  E6E6  09 10              ORA #$10
00791  E6E8  D0 0A              BNE KL25
00792  E6EA  AD 08 02    KL23   LDA CAS2
00793  E6ED  D0 08              BNE KL22
00794  E6EF  AD 40 E8           LDA PIA
00795  E6F2  29 EF              AND #$EF
00796  E6F4  8D 40 E8    KL25   STA PIA
00797  E6F7  A0 08       KL22   LDY #8
00798  E6F9  AD 12 E8           LDA PIAK
00799  E6FC  CD 12 E8           CMP PIAK
00800  E6FF  D0 F6              BNE KL22
00801  E701  4A          KL1    LSR A
00802  E702  B0 05              BCS CKIT
00803  E704  48                 PHA
00804  E705  20 3F E7           JSR LE73F
00805  E708  68                 PLA
00806  E709  CA          CKIT   DEX
00807  E70A  F0 08              BEQ CKIT1
00808  E70C  88                 DEY
00809  E70D  D0 F2              BNE KL1
00810  E70F  EE 10 E8           INC PIAL
00811  E712  D0 E3              BNE KL22
00812  E714  AD 23 02    CKIT1  LDA SFDX
00813  E717  CD 03 02           CMP LSTX
00814  E71A  F0 20              BEQ PREND0
00815  E71C  8D 03 02           STA LSTX
00816  E71F  AA                 TAX






SCREEN EDITOR & I/O......PAGE 0011

LINE# LOC   CODE        LINE


00817  E720  30 1A              BMI PREND0
00818  E722  BD 5B E7           LDA CHAR-1,X
00819  E725  4E 04 02           LSR SFST
00820  E728  90 02              BCC KN1
00821  E72A  09 80              ORA #$80
00822  E72C  AE 0D 02    KN1    LDX NDX
00823  E72F  9D 0F 02           STA KEYD,X
00824  E732  E8                 INX
00825  E733  E0 0A              CPX #10
00826  E735  D0 02              BNE KEYF
00827  E737  A2 00              LDX #0
00828  E739  8E 0D 02    KEYF   STX NDX
00829  E73C  4C 7E E6    PREND0 JMP PREND
00830  E73F  BD 5B E7    LE73F  LDA CHAR-1,X
00831  E742  D0 07              BNE CKIS1
00832  E744  A9 01              LDA #1
00833  E746  8D 04 02           STA SFST
00834  E749  D0 10              BNE CKUT
00835  E74B  C9 FF       CKIS1  CMP #$FF
00836  E74D  F0 0C              BEQ CKUT
00837  E74F  C9 3C              CMP #$3C
00838  E751  D0 05              BNE SPCK
00839  E753  2C 11 E8           BIT PIAL1
00840  E756  30 03              BMI CKUT
00841  E758  8E 23 02    SPCK   STX SFDX
00842  E75B  60          CKUT   RTS
00843  E75C  3D          CHAR   .BYT $3D,$2E
00843  E75D  2E 
00844  E75E  FF                 .BYT $FF,$3,$3C,$20,$5B,$12
00844  E75F  03 
00844  E760  3C 
00844  E761  20 
00844  E762  5B 
00844  E763  12 
00845  E764  2D                 .BYT $2D,$30,0,$3E,$FF,$5D,$40,0
00845  E765  30 
00845  E766  00 
00845  E767  3E 
00845  E768  FF 
00845  E769  5D 
00845  E76A  40 
00845  E76B  00 
00846  E76C  2B                 .BYT $2B,$32,$FF,$3F,$2C,$4E,$56,$58
00846  E76D  32 
00846  E76E  FF 
00846  E76F  3F 
00846  E770  2C 
00846  E771  4E 
00846  E772  56 
00846  E773  58 
00847  E774  33                 .BYT $33,$31,$D,$3B,$4D,$42,$43,$5A
00847  E775  31 
00847  E776  0D 
00847  E777  3B 
00847  E778  4D 






SCREEN EDITOR & I/O......PAGE 0012

LINE# LOC   CODE        LINE


00847  E779  42 
00847  E77A  43 
00847  E77B  5A 
00848  E77C  2A                 .BYT $2A,$35,$FF,$3A,$4B,$48,$46,$53
00848  E77D  35 
00848  E77E  FF 
00848  E77F  3A 
00848  E780  4B 
00848  E781  48 
00848  E782  46 
00848  E783  53 
00849  E784  36                 .BYT $36,$34,$FF,$4C,$4A,$47,$44,$41
00849  E785  34 
00849  E786  FF 
00849  E787  4C 
00849  E788  4A 
00849  E789  47 
00849  E78A  44 
00849  E78B  41 
00850  E78C  2F                 .BYT $2F,$38,$FF,$50,$49,$59,$52,$57
00850  E78D  38 
00850  E78E  FF 
00850  E78F  50 
00850  E790  49 
00850  E791  59 
00850  E792  52 
00850  E793  57 
00851  E794  39                 .BYT $39,$37,$5E,$4F,$55,$54,$45,$51
00851  E795  37 
00851  E796  5E 
00851  E797  4F 
00851  E798  55 
00851  E799  54 
00851  E79A  45 
00851  E79B  51 
00852  E79C  14                 .BYT $14,$11,$FF,$29,$5C,$27,$24,$22
00852  E79D  11 
00852  E79E  FF 
00852  E79F  29 
00852  E7A0  5C 
00852  E7A1  27 
00852  E7A2  24 
00852  E7A3  22 
00853  E7A4  1D                 .BYT $1D,$13,$5F,$28,$26,$25,$23,$21
00853  E7A5  13 
00853  E7A6  5F 
00853  E7A7  28 
00853  E7A8  26 
00853  E7A9  25 
00853  E7AA  23 
00853  E7AB  21 
00854  E7AC  A8          DSPP   TAY
00855  E7AD  AD 40 E8    DSPP1  LDA PIA
00856  E7B0  29 20              AND #$20
00857  E7B2  D0 F9              BNE DSPP1






SCREEN EDITOR & I/O......PAGE 0013

LINE# LOC   CODE        LINE


00858  E7B4  98                 TYA
00859  E7B5  A4 E2              LDY PNTR
00860  E7B7  91 E0              STA (POINT-1)Y
00861  E7B9  60                 RTS
00862  E7BA  68                 PLA
00863  E7BB  60                 RTS
00864  E7BC  00          LDTB2  .BYT 0,40,80,120,160,200
00864  E7BD  28 
00864  E7BE  50 
00864  E7BF  78 
00864  E7C0  A0 
00864  E7C1  C8 
00865  E7C2  F0                 .BYT 240,280-256,320-256,360-256
00865  E7C3  18 
00865  E7C4  40 
00865  E7C5  68 
00866  E7C6  90                 .BYT 400-256,440-256,480-256
00866  E7C7  B8 
00866  E7C8  E0 
00867  E7C9  08                 .BYT 520-512,560-512
00867  E7CA  30 
00868  E7CB  58                 .BYT 600-512,640-512,680-512
00868  E7CC  80 
00868  E7CD  A8 
00869  E7CE  D0                 .BYT 720-512,760-512,800-768
00869  E7CF  F8 
00869  E7D0  20 
00870  E7D1  48                 .BYT 840-768,880-768,920-768,960-768
00870  E7D2  70 
00870  E7D3  98 
00870  E7D4  C0 
00871  E7D5  4C 4F       RUNTB  .BYT 'LOAD',$D,'RUN',$D
00871  E7D9  0D 
00871  E7DA  52 55 4E 
00871  E7DD  0D 
00872  E7DE              ;
00873  E7DE              .FIL   OB1SRC
























MESSAGES & IEEE......PAGE 0014

LINE# LOC   CODE        LINE


00875  E7DE  B9 00 F0    MSG    LDA MS1,Y
00876  E7E1  08                 PHP
00877  E7E2  29 7F              AND #$7F
00878  E7E4  20 EA E3           JSR PRT
00879  E7E7  C8                 INY
00880  E7E8  28                 PLP
00881  E7E9  10 F3              BPL MSG
00882  E7EB  60                 RTS
00883  E7EC                     *=$7000+OFFSET  ;SOFT OFFSET
00884  F000  54 4F       MS1    .BYT 'TOO MANY FILE',$D3
00884  F00D  D3 
00885  F00E  46 49       MS2    .BYT 'FILE OPE',$CE
00885  F016  CE 
00886  F017  46 49       MS3    .BYT 'FILE NOT OPE',$CE
00886  F023  CE 
00887  F024  46 49       MS4    .BYT 'FILE NOT FOUN',$C4
00887  F031  C4 
00888  F032  0D          MS5    .BYT $D,'SEARCH'
00888  F033  53 45 
00889  F039  49 4E 47    MS20   .BYT 'ING',$A0
00889  F03C  A0 
00890  F03D  46 4F 52    MS6    .BYT 'FOR',$A0
00890  F040  A0 
00891  F041  0D          MS7    .BYT $D,'PRESS PLAY',$A0
00891  F042  50 52 
00891  F04C  A0 
00892  F04D  26 20       MS8    .BYT '& RECORD',$A0
00892  F055  A0 
00893  F056  4F 4E       MS9    .BYT 'ON TAPE ',$A3
00893  F05E  A3 
00894  F05F  0D          MS10   .BYT $D
00895  F060  4C 4F 41    MS22   .BYT 'LOA',$C4
00895  F063  C4 
00896  F064  0D          MS11   .BYT $D,'WRITING',$A0
00896  F065  57 52 
00896  F06C  A0 
00897  F06D  0D          MS21   .BYT $D
00898  F06E  56 45       MS12   .BYT 'VERIF',$D9
00898  F073  D9 
00899  F074  44 45       MS13   .BYT 'DEVICE NOT PRESEN',$D4
00899  F085  D4 
00900  F086  4E 4F       MS15   .BYT 'NOT INPUT FIL',$C5
00900  F093  C5 
00901  F094  4E 4F       MS16   .BYT 'NOT OUTPUT FIL',$C5
00901  F0A2  C5 
00902  F0A3  0D          MS17   .BYT $D,'FOUND',$A0
00902  F0A4  46 4F 
00902  F0A9  A0 
00903  F0AA  0D          MS18   .BYT $D,'OK',$8D
00903  F0AB  4F 4B 
00903  F0AD  8D 
00904  F0AE  0D          MS19   .BYT $D,'READY.',$8D
00904  F0AF  52 45 
00904  F0B5  8D 
00905  F0B6  A9 40       TALK   LDA #$40






MESSAGES & IEEE......PAGE 0015

LINE# LOC   CODE        LINE


00906  F0B8  D0 02              BNE LIST1
00907  F0BA  A9 20       LISTN  LDA #' 
00908  F0BC  48          LIST1  PHA
00909  F0BD  AD 40 E8           LDA PIA
00910  F0C0  09 02              ORA #2
00911  F0C2  8D 40 E8           STA PIA
00912  F0C5  A9 3C              LDA #$3C
00913  F0C7  8D 21 E8           STA IEEIS
00914  F0CA  2C 1D 02           BIT C3P0
00915  F0CD  F0 12              BEQ LIST2
00916  F0CF  A9 34              LDA #$34
00917  F0D1  8D 11 E8           STA PIAL1
00918  F0D4  20 F1 F0           JSR ISOUR
00919  F0D7  A9 00              LDA #0
00920  F0D9  8D 1D 02           STA C3P0
00921  F0DC  A9 3C              LDA #$3C
00922  F0DE  8D 11 E8           STA PIAL1
00923  F0E1  68          LIST2  PLA
00924  F0E2  05 F1              ORA FA
00925  F0E4  8D 22 02           STA BSOUR
00926  F0E7  AD 40 E8    LIST4  LDA PIA
00927  F0EA  10 FB              BPL LIST4
00928  F0EC  29 FB              AND #$FB
00929  F0EE  8D 40 E8           STA PIA
00930  F0F1  A9 3C       ISOUR  LDA #$3C
00931  F0F3  8D 23 E8           STA IEEOS
00932  F0F6  AD 40 E8           LDA PIA
00933  F0F9  29 41              AND #$41
00934  F0FB  C9 41              CMP #$41
00935  F0FD  F0 43              BEQ ERRP7
00936  F0FF  AD 22 02           LDA BSOUR
00937  F102  49 FF              EOR #$FF
00938  F104  8D 22 E8           STA IEEO
00939  F107  2C 40 E8    ISR1   BIT PIA
00940  F10A  50 FB              BVC ISR1
00941  F10C  A9 34              LDA #$34
00942  F10E  8D 23 E8           STA IEEOS
00943  F111  A9 FF       ISR0   LDA #$FF
00944  F113  8D 45 E8           STA TIH
00945  F116  AD 40 E8    ISR2   LDA PIA
00946  F119  2C 4D E8           BIT IFR
00947  F11C  70 1D              BVS ERRP0
00948  F11E  4A                 LSR A
00949  F11F  90 F5              BCC ISR2
00950  F121  A9 3C       ISR3   LDA #$3C
00951  F123  8D 23 E8           STA IEEOS
00952  F126  A9 FF              LDA #$FF
00953  F128  8D 22 E8           STA IEEO
00954  F12B  60                 RTS
00955  F12C  8D 22 02    SECND  STA BSOUR
00956  F12F  20 F1 F0           JSR ISOUR
00957  F132  AD 40 E8    SCATN  LDA PIA
00958  F135  09 04              ORA #4
00959  F137  8D 40 E8           STA PIA
00960  F13A  60                 RTS






MESSAGES & IEEE......PAGE 0016

LINE# LOC   CODE        LINE


00961  F13B  A9 01       ERRP0  LDA #1
00962  F13D  20 E5 FB    ERR01  JSR UDST
00963  F140  D0 DF              BNE ISR3
00964  F142  A9 80       ERRP7  LDA #$80
00965  F144  30 F7              BMI ERR01
00966  F146  A9 02       ERRP1  LDA #2
00967  F148  20 E5 FB           JSR UDST
00968  F14B  AD 40 E8    ER001  LDA PIA
00969  F14E  29 FD              AND #$FD
00970  F150  8D 40 E8           STA PIA
00971  F153  A9 34              LDA #$34
00972  F155  8D 21 E8           STA IEEIS
00973  F158  A9 0D              LDA #$0D
00974  F15A  60                 RTS
00975  F15B  8D 22 02    TKSA   STA BSOUR
00976  F15E  20 F1 F0           JSR ISOUR
00977  F161  20 4B F1    TKATN  JSR ER001
00978  F164  4C 32 F1           JMP SCATN
00979  F167  2C 1D 02    CIOUT  BIT C3P0
00980  F16A  30 05              BMI CI2
00981  F16C  CE 1D 02           DEC C3P0
00982  F16F  D0 05              BNE CI4
00983  F171  48          CI2    PHA
00984  F172  20 F1 F0           JSR ISOUR
00985  F175  68                 PLA
00986  F176  8D 22 02    CI4    STA BSOUR
00987  F179  60                 RTS
00988  F17A  A9 5F       UNTLK  LDA #$5F
00989  F17C  D0 02              BNE UNLSN1
00990  F17E  A9 3F       UNLSN  LDA #$3F
00991  F180  85 F1       UNLSN1 STA FA
00992  F182  20 BC F0           JSR LIST1
00993  F185  D0 AB              BNE SCATN
00994  F187  A9 34       ACPTR  LDA #$34
00995  F189  8D 21 E8           STA IEEIS
00996  F18C  AD 40 E8           LDA PIA
00997  F18F  09 02              ORA #2
00998  F191  8D 40 E8           STA PIA
00999  F194  A9 FF       ACP00  LDA #$FF
01000  F196  8D 45 E8           STA TIH
01001  F199  2C 4D E8    ACP01  BIT IFR
01002  F19C  70 A8              BVS ERRP1
01003  F19E  2C 40 E8           BIT PIA
01004  F1A1  30 F6              BMI ACP01
01005  F1A3  AD 40 E8           LDA PIA
01006  F1A6  29 FD              AND #$FD
01007  F1A8  8D 40 E8           STA PIA
01008  F1AB  2C 10 E8           BIT PIAL
01009  F1AE  70 05              BVS ACP03
01010  F1B0  A9 40              LDA #$40
01011  F1B2  20 E5 FB           JSR UDST
01012  F1B5  AD 20 E8    ACP03  LDA IEEI
01013  F1B8  49 FF              EOR #$FF
01014  F1BA  48                 PHA
01015  F1BB  A9 3C              LDA #$3C






MESSAGES & IEEE......PAGE 0017

LINE# LOC   CODE        LINE


01016  F1BD  8D 21 E8           STA IEEIS
01017  F1C0  2C 40 E8    ACP05  BIT PIA
01018  F1C3  10 FB              BPL ACP05
01019  F1C5  A9 34              LDA #$34
01020  F1C7  8D 21 E8           STA IEEIS
01021  F1CA  68                 PLA
01022  F1CB  60                 RTS
01023  F1CC  A9 00       GETIN  LDA #0
01024  F1CE  8D 0C 02           STA SATUS
01025  F1D1  AD 63 02           LDA DFLTN
01026  F1D4  D0 1B              BNE BN10
01027  F1D6  AD 0D 02           LDA NDX
01028  F1D9  F0 51              BEQ BN32
01029  F1DB  78                 SEI
01030  F1DC  4C 7D E2           JMP LP2
01031  F1DF  AD 63 02    BASIN  LDA DFLTN
01032  F1E2  D0 0D              BNE BN10 .
01033  F1E4  A5 E2              LDA PNTR
01034  F1E6  8D 21 02           STA LSTP
01035  F1E9  A5 F5              LDA TBLX
01036  F1EB  8D 20 02           STA LSXP
01037  F1EE  4C FA E2           JMP LOOP5
01038  F1F1  C9 03       BN10   CMP #3
01039  F1F3  D0 0B              BNE BN20
01040  F1F5  8D 60 02           STA CRSW
01041  F1F8  A5 F2              LDA LNMX
01042  F1FA  8D 1E 02           STA INDX
01043  F1FD  4C FA E2           JMP LOOP5
01044  F200  B0 25       BN20   BCS BN30
01045  F202  8E 61 02           STX XSAV
01046  F205  20 2D F8    JTGET  JSR JTP20
01047  F208  D0 0E              BNE JTG10
01048  F20A  20 7F F8           JSR RBLK
01049  F20D  A0 00              LDY #0
01050  F20F  98                 TYA
01051  F210  A6 F1              LDX FA
01052  F212  9D 70 02           STA BUFPT-1,X
01053  F215  4C 05 F2           JMP JTGET
01054  F218  B1 F3       JTG10  LDA (TBUF)Y
01055  F21A  D0 07              BNE JTG35
01056  F21C  A9 40              LDA #64
01057  F21E  20 E5 FB           JSR UDST
01058  F221  D0 E2              BNE JTGET
01059  F223  AE 61 02    JTG35  LDX XSAV
01060  F226  60                 RTS
01061  F227  AD 0C 02    BN30   LDA SATUS
01062  F22A  F0 01              BEQ BN35
01063  F22C  60          BN32   RTS
01064  F22D  4C 87 F1    BN35   JMP ACPTR
01065  F230  48          BSOUT  PHA
01066  F231  AD 64 02           LDA DFLTO
01067  F234  D0 03              BNE *+5
01068  F236  4C 79 C3           JMP TYPERR
01069  F239  C9 03              CMP #3
01070  F23B  D0 04              BNE BO10






MESSAGES & IEEE......PAGE 0018

LINE# LOC   CODE        LINE


01071  F23D  68                 PLA
01072  F23E  4C EA E3           JMP PRT
01073  F241  30 04       BO10   BMI BO20
01074  F243  68                 PLA
01075  F244  4C 67 F1           JMP CIOUT
01076  F247  68          BO20   PLA
01077  F248  85 E9       BO21   STA T1
01078  F24A  C9 1D              CMP #$1D
01079  F24C  D0 05              BNE LF253
01080  F24E  EE 6A 02           INC L026A
01081  F251  F0 D9              BEQ BN32
01082  F253  C9 0A       LF253  CMP #$A
01083  F255  F0 D5              BEQ BN32
01084  F257  48                 PHA
01085  F258  8A                 TXA
01086  F259  48                 PHA
01087  F25A  98                 TYA
01088  F25B  48                 PHA
01089  F25C  20 2D F8           JSR JTP20
01090  F25F  D0 12              BNE JTP10
01091  F261  20 B9 F8           JSR WBLK
01092  F264  A6 F1              LDX FA
01093  F266  A9 01              LDA #1
01094  F268  9D 70 02           STA BUFPT-1,X
01095  F26B  20 E3 F5           JSR LF5E3
01096  F26E  A9 02              LDA #BDF
01097  F270  91 F3              STA (TBUF)Y
01098  F272  C8                 INY
01099  F273  A5 E9       JTP10  LDA T1
01100  F275  91 F3              STA (TBUF)Y
01101  F277  68          RSTOR  PLA
01102  F278  A8                 TAY
01103  F279  68                 PLA
01104  F27A  AA                 TAX
01105  F27B  68                 PLA
01106  F27C  60                 RTS
01107  F27D              CLRCHN
01108  F27D  AD 64 02    CLRCH  LDA DFLTO
01109  F280  F0 09              BEQ JX750
01110  F282  C9 03              CMP #3
01111  F284  F0 05              BEQ JX750
01112  F286  30 03              BMI JX750
01113  F288  20 7E F1           JSR UNLSN
01114  F28B  AD 63 02    JX750  LDA DFLTN
01115  F28E  F0 09              BEQ JX770
01116  F290  C9 03              CMP #3
01117  F292  F0 05              BEQ JX770
01118  F294  30 03              BMI JX770
01119  F296  20 7A F1           JSR UNTLK
01120  F299  A9 00       JX770  LDA #0
01121  F29B  8D 63 02           STA DFLTN
01122  F29E  A9 03              LDA #3
01123  F2A0  8D 64 02           STA DFLTO
01124  F2A3  60                 RTS
01125  F2A4  A9 00       CLALL  LDA #0






MESSAGES & IEEE......PAGE 0019

LINE# LOC   CODE        LINE


01126  F2A6  8D 62 02           STA LDTND
01127  F2A9  F0 D2              BEQ CLRCHN
01128  F2AB  AE 62 02    JLTLK  LDX LDTND
01129  F2AE  CA          JX600  DEX
01130  F2AF  30 16              BMI JZ101
01131  F2B1  DD 42 02           CMP LAT,X
01132  F2B4  F0 11              BEQ JZ101
01133  F2B6  D0 F6              BNE JX600
01134  F2B8  BD 42 02    JZ100  LDA LAT,X
01135  F2BB  85 EF              STA LA
01136  F2BD  BD 4C 02           LDA FAT,X
01137  F2C0  85 F1              STA FA
01138  F2C2  BD 56 02           LDA SAT,X
01139  F2C5  85 F0              STA SA
01140  F2C7  60          JZ101  RTS
01141  F2C8              .FILE  OB2SRC













































CLOSE-LOAD-OPEN......PAGE 001A

LINE# LOC   CODE        LINE


01143  F2C8  20 D4 F4    CLOSE  JSR PARS2
01144  F2CB  A5 EF              LDA LA
01145  F2CD              CLOS5                  ;DOUBLE LABEL
01146  F2CD  20 AB F2    FCLOSE JSR JLTLK
01147  F2D0  D0 57              BNE JX170
01148  F2D2  20 B8 F2    CLOS10 JSR JZ100
01149  F2D5  8A                 TXA
01150  F2D6  48                 PHA
01151  F2D7  A5 F1              LDA FA
01152  F2D9  F0 2F              BEQ JX150
01153  F2DB  C9 03              CMP #3
01154  F2DD  F0 2B              BEQ JX150
01155  F2DF  B0 26              BCS JX120
01156  F2E1  A5 F0              LDA SA          ;READ?
01157  F2E3  F0 25              BEQ JX150       ;YES
01158  F2E5  20 67 F6           JSR ZZZ         ;NO    .IT IS WRITE
01159  F2E8  A2 02              LDX #2
01160  F2EA  BD 04 F3    LF2EA  LDA LF304,X
01161  F2ED  20 48 F2           JSR BO21
01162  F2F0  CA                 DEX
01163  F2F1  10 F7              BPL LF2EA
01164  F2F3  20 B9 F8           JSR WBLK        ;EMPTY LAST BUFFER
01165  F2F6  A5 F0              LDA SA
01166  F2F8  C9 02              CMP #$02        ;WRITE END OF TAPE BLOCK
01167  F2FA  D0 0E              BNE JX150
01168  F2FC  A9 05              LDA #EOT        ;YES
01169  F2FE  20 ED F5           JSR TAPEH
01170  F301  4C 0A F3           JMP JX150
01171  F304  0D          LF304  .BYT $D,'1',0
01171  F305  31 
01171  F306  00 
01172  F307  20 E6 F6    JX120  JSR CLSE1
01173  F30A              ;
01174  F30A              ;ENTRY TO REMOVE A GIVE LOGICAL FILE
01175  F30A              ;FROM TABLE OF LOGICAL, PRIMARY,
01176  F30A              ;AND SECONDARY ADDRESSES
01177  F30A              ;
01178  F30A  68          JX150  PLA
01179  F30B  AA                 TAX
01180  F30C  CE 62 02           DEC LDTND
01181  F30F  EC 62 02           CPX LDTND
01182  F312  F0 15              BEQ JX170
01183  F314  AC 62 02           LDY LDTND
01184  F317  B9 42 02           LDA LAT,Y
01185  F31A  9D 42 02           STA LAT,X
01186  F31D  B9 4C 02           LDA FAT,Y
01187  F320  9D 4C 02           STA FAT,X
01188  F323  B9 56 02           LDA SAT,Y
01189  F326  9D 56 02           STA SAT,X
01190  F329  60          JX170  RTS
01191  F32A  AD 09 02    STOP1  LDA STKEY
01192  F32D  C9 EF              CMP #$EF
01193  F32F  D0 07              BNE STOP2
01194  F331  08                 PHP
01195  F332  A9 00              LDA #0






CLOSE-LOAD-OPEN......PAGE 001B

LINE# LOC   CODE        LINE


01196  F334  8D 0D 02           STA NDX
01197  F337  28                 PLP
01198  F338  60          STOP2  RTS
01199  F339  20 2A F3    STOP   JSR STOP1
01200  F33C  4C 1C C7           JMP BSTOP
01201  F33F  A5 CA       SPMSG  LDA TXTPTR+1
01202  F341  D0 F5              BNE STOP2
01203  F343  4C DE E7           JMP MSG
01204  F346  A9 00       LOAD   LDA #0
01205  F348  8D 0B 02           STA VERCK
01206  F34B  20 33 F4    LD10   JSR PARS1 ***VERIFY ENTRY
01207  F34E  A9 FF       LOADNP LDA #$FF
01208  F350  CD 09 02    LD11   CMP STKEY
01209  F353  D0 FB              BNE LD11
01210  F355  CD 09 02           CMP STKEY
01211  F358  D0 F6              BNE LD11
01212  F35A  A9 04              LDA #>$0400
01213  F35C  85 F8              STA STAH
01214  F35E  A9 00              LDA #<$0400
01215  F360  85 F7              STA STAL
01216  F362  A5 F1              LDA FA
01217  F364  D0 03              BNE *+5
01218  F366  4C 1C CE    LD20   JMP SNERR
01219  F369  C9 03              CMP #3
01220  F36B  F0 F9              BEQ LD20
01221  F36D  90 36              BCC LD100
01222  F36F  20 1C F7           JSR LF71C
01223  F372  20 FF F3           JSR LD300
01224  F375  20 62 F4           JSR OPENI
01225  F378  20 B6 F0           JSR TALK
01226  F37B  20 22 F4    LD30   JSR LD400

01228  F37E  20 39 F3    LD40   JSR STOP        ;EXIT ON STOP KEY
01229  F381  20 87 F1           JSR ACPTR       ;GET BYTE OFF IEEE
01230  F384  AE 0C 02           LDX SATUS
01231  F387  30 43              BMI LF3CC

01233  F389  AC 0B 02           LDY VERCK       ;PERFORMING VERIFY?
01234  F38C  F0 0C              BEQ LD50        ;NO...A LOAD
01235  F38E  88                 DEY             ;.Y IS A 1...MAKE IT 0
01236  F38F  D1 F7              CMP (STAL)Y     ;COMPARE TO MEMORY
01237  F391  F0 09              BEQ LD60        ;VERIFIES O.K.
01238  F393              ;LDX #SPERR      ;NO GOOD... VERIFY ERROR
01239  F393  A2 02              LDX #$02        ;NO GOOD... VERIFY ERROR
01240  F395  8E 0C 02           STX SATUS
01241  F398  D0 02              BNE LD60
01242  F39A  91 F7       LD50   STA (STAL)Y
01243  F39C  E6 F7       LD60   INC STAL        ;INCREMENT POINTER
01244  F39E  D0 DE              BNE LD40
01245  F3A0  E6 F8              INC STAH
01246  F3A2  4C 7E F3           JMP LD40

01248  F3A5  20 67 F6    LD100  JSR ZZZ
01249  F3A8  20 3B F8           JSR CSTE1
01250  F3AB  20 FF F3           JSR LD300






CLOSE-LOAD-OPEN......PAGE 001C

LINE# LOC   CODE        LINE


01251  F3AE  A5 EE       LD112  LDA FNLEN
01252  F3B0  F0 08              BEQ LD150
01253  F3B2  20 95 F4           JSR FAF
01254  F3B5  D0 08              BNE LD170
01255  F3B7  4C 79 F5    LD120  JMP OP160
01256  F3BA  20 AE F5    LD150  JSR FAH
01257  F3BD  F0 F8              BEQ LD120
01258  F3BF  E0 01       LD170  CPX #BLF
01259  F3C1  D0 EB              BNE LD112
01260  F3C3  20 4D F6           JSR LDAD2
01261  F3C6  20 22 F4           JSR LD400
01262  F3C9  20 8A F8           JSR TRD
01263  F3CC  AD 0B 02    LF3CC  LDA VERCK
01264  F3CF  D0 50              BNE LD115
01265  F3D1  20 13 F9           JSR TWAIT
01266  F3D4  AD 0C 02           LDA SATUS
01267  F3D7  29 10              AND #SPERR
01268  F3D9  F0 0A              BEQ LD210
01269  F3DB  A0 00              LDY #0
01270  F3DD  8C 0D 02           STY NDX
01271  F3E0  A0 60              LDY #MS22-MS1
01272  F3E2  4C 7B F5           JMP ERMSG
01273  F3E5  A0 AE       LD210  LDY #MS19-MS1
01274  F3E7  20 3F F3           JSR SPMSG
01275  F3EA  A5 CA              LDA TXTPTR+1
01276  F3EC  D0 0B              BNE LD205
01277  F3EE  A5 E6              LDA EAH
01278  F3F0  85 7D              STA VARTAB+1
01279  F3F2  A5 E5              LDA EAL
01280  F3F4  85 7C              STA VARTAB
01281  F3F6  4C 30 C4           JMP FINI
01282  F3F9  20 9A C5    LD205  JSR STXTPT
01283  F3FC  4C 81 C5           JMP FLOAD
01284  F3FF  A5 CA       LD300  LDA TXTPTR+1
01285  F401  D0 1E              BNE LD115
01286  F403  A0 32              LDY #MS5-MS1
01287  F405  20 DE E7           JSR MSG
01288  F408  A5 EE              LDA FNLEN
01289  F40A  F0 15              BEQ LD115
01290  F40C  A0 3D              LDY #MS6-MS1
01291  F40E  20 DE E7           JSR MSG
01292  F411  A4 EE       LD105  LDY FNLEN
01293  F413  F0 0C              BEQ LD115
01294  F415  A0 00              LDY #0
01295  F417  B1 F9       LD110  LDA (FNADR)Y
01296  F419  20 EA E3           JSR PRT
01297  F41C  C8                 INY
01298  F41D  C4 EE              CPY FNLEN
01299  F41F  D0 F6              BNE LD110
01300  F421  60          LD115  RTS
01301  F422  A0 5F       LD400  LDY #MS10-MS1
01302  F424  AD 0B 02           LDA VERCK
01303  F427  F0 02              BEQ LD410
01304  F429  A0 6D              LDY #MS21-MS1
01305  F42B  20 3F F3    LD410  JSR SPMSG






CLOSE-LOAD-OPEN......PAGE 001D

LINE# LOC   CODE        LINE


01306  F42E  A0 39              LDY #MS20-MS1
01307  F430  4C 3F F3           JMP SPMSG
01308  F433              ;USES BASIC ROUTINES TO PARSE
01309  F433              ;LOAD,SAVE,VERIFY STATEMENTS
01310  F433              ;     LOAD
01311  F433              ;          (FILE NAME OPTION)
01312  F433              ;          (OPT DEVICE #) DFLT=1
01313  F433              ;          (EOT CMD) DFLT=0=NO
01314  F433  A2 00       PARS1  LDX #0
01315  F435  8E 0C 02           STX SATUS
01316  F438  86 E5              STX EAL
01317  F43A  86 EE              STX FNLEN
01318  F43C  86 F0              STX SA
01319  F43E  E8                 INX
01320  F43F  86 F1              STX FA
01321  F441  A9 04              LDA #$04
01322  F443  86 E6              STX EAH         ;Ist das nicht ein Fehler?
01323  F445  20 15 F5           JSR PR140
01324  F448  20 04 F5           JSR PR200
01325  F44B  20 15 F5           JSR PR140
01326  F44E  20 5C F4           JSR PR070
01327  F451  86 F1              STX FA
01328  F453  20 15 F5           JSR PR140
01329  F456  20 5C F4           JSR PR070
01330  F459  86 F0              STX SA
01331  F45B  60          PR060  RTS
01332  F45C  20 1D F5    PR070  JSR PR150
01333  F45F  4C 76 D6           JMP GETBYT
01334  F462  A5 F0       OPENI  LDA SA
01335  F464  30 F5              BMI PR060
01336  F466  A4 EE              LDY FNLEN
01337  F468  F0 F1              BEQ PR060
01338  F46A  20 BA F0           JSR LISTN
01339  F46D  A5 F0              LDA SA
01340  F46F  09 40              ORA #$40
01341  F471  85 F0              STA SA
01342  F473  09 F0              ORA #$F0
01343  F475  20 2C F1    OPENIB JSR SECND
01344  F478  AD 0C 02           LDA SATUS
01345  F47B  10 05              BPL OP35
01346  F47D  A0 74       OP37   LDY #MS13-MS1
01347  F47F  4C 7B F5           JMP ERMSG
01348  F482  A5 EE       OP35   LDA FNLEN
01349  F484  F0 0C              BEQ OP45
01350  F486  A0 00              LDY #0
01351  F488  B1 F9       OP40   LDA (FNADR)Y
01352  F48A  20 67 F1           JSR CIOUT
01353  F48D  C8                 INY
01354  F48E  C4 EE              CPY FNLEN
01355  F490  D0 F6              BNE OP40
01356  F492  4C 7E F1    OP45   JMP UNLSN
01357  F495  20 AE F5    FAF    JSR FAH
01358  F498  F0 20              BEQ FAF40
01359  F49A  A0 05              LDY #5
01360  F49C  8C 68 02           STY T2






CLOSE-LOAD-OPEN......PAGE 001E

LINE# LOC   CODE        LINE


01361  F49F  A0 00              LDY #0
01362  F4A1  84 E9              STY T1
01363  F4A3  C4 EE       FAF20  CPY FNLEN
01364  F4A5  F0 12              BEQ FAF30
01365  F4A7  B1 F9              LDA (FNADR)Y
01366  F4A9  AC 68 02           LDY T2
01367  F4AC  D1 F3              CMP (TBUF)Y
01368  F4AE  D0 E5              BNE FAF
01369  F4B0  E6 E9              INC T1
01370  F4B2  EE 68 02           INC T2
01371  F4B5  A4 E9              LDY T1
01372  F4B7  D0 EA              BNE FAF20
01373  F4B9  98          FAF30  TYA
01374  F4BA  60          FAF40  RTS
01375  F4BB  A9 01       VER    LDA #1
01376  F4BD  8D 0B 02           STA VERCK
01377  F4C0  20 4B F3           JSR LD10
01378  F4C3  AD 0C 02           LDA SATUS
01379  F4C6  29 10              AND #SPERR
01380  F4C8  F0 05              BEQ VER10
01381  F4CA  A0 6E              LDY #MS12-MS1
01382  F4CC  4C 7B F5           JMP ERMSG
01383  F4CF  A0 AA       VER10  LDY #MS18-MS1
01384  F4D1  4C DE E7           JMP MSG
01385  F4D4              ;USES BASIC ROUTINES TO PARSE
01386  F4D4              ;OPEN,CLOSE
01387  F4D4              ;     OPEN LFN (NO DEFAULT)
01388  F4D4              ;          DEV # (DFLT=1)
01389  F4D4              ;         2ND ADR (DFLT=0 OR NONE)
01390  F4D4              ;          FILE NM STRNG (DEF=NUL)
01391  F4D4  A2 00       PARS2  LDX #0
01392  F4D6  86 F0              STX SA
01393  F4D8  8E 0C 02           STX SATUS
01394  F4DB  86 EE              STX FNLEN
01395  F4DD  E8                 INX
01396  F4DE  86 F1              STX FA
01397  F4E0  20 22 F5           JSR PR130
01398  F4E3  20 76 D6           JSR GETBYT
01399  F4E6  86 EF              STX LA
01400  F4E8  20 15 F5           JSR PR140
01401  F4EB  20 5C F4           JSR PR070
01402  F4EE  86 F1              STX FA
01403  F4F0  E0 03              CPX #3
01404  F4F2  90 02              BCC PR100
01405  F4F4  C6 F0              DEC SA
01406  F4F6  20 15 F5    PR100  JSR PR140
01407  F4F9  20 5C F4           JSR PR070
01408  F4FC  86 F0              STX SA
01409  F4FE  20 15 F5           JSR PR140
01410  F501  20 1D F5           JSR PR150
01411  F504  20 B8 CC    PR200  JSR FRMEVL
01412  F507  20 7B D5           JSR FRESTR
01413  F50A  85 EE              STA FNLEN
01414  F50C  A5 71              LDA INDEX1
01415  F50E  85 F9              STA FNADR






CLOSE-LOAD-OPEN......PAGE 001F

LINE# LOC   CODE        LINE


01416  F510  A5 72              LDA INDEX1+1
01417  F512  85 FA              STA FNADR+1
01418  F514  60                 RTS
01419  F515  20 C8 00    PR140  JSR CHRGOT
01420  F518  D0 02              BNE PR147
01421  F51A  68                 PLA
01422  F51B  68                 PLA
01423  F51C  60          PR147  RTS
01424  F51D  A9 2C       PR150  LDA #',
01425  F51F  20 13 CE           JSR SYNCHR
01426  F522  20 C8 00    PR130  JSR CHRGOT
01427  F525  D0 F5              BNE PR147
01428  F527  4C 1C CE           JMP SNERR
01429  F52A  20 D4 F4    OPEN   JSR PARS2
01430  F52D  A5 EF              LDA LA
01431  F52F  D0 03       FOPEN  BNE OP98
01432  F531  4C 1C CE           JMP SNERR
01433  F534  20 AB F2    OP98   JSR JLTLK
01434  F537  D0 04              BNE OP100
01435  F539  A0 0E              LDY #MS2-MS1
01436  F53B  D0 3E       LF53B  BNE ERMSG
01437  F53D  AE 62 02    OP100  LDX LDTND
01438  F540  A0 00              LDY #0
01439  F542  8C 0C 02           STY SATUS
01440  F545  E0 0A              CPX #10
01441  F547  F0 F2              BEQ LF53B
01442  F549  EE 62 02           INC LDTND
01443  F54C              ;STORE GPEN FILE PARMS INTO TABLE
01444  F54C  A5 EF              LDA LA
01445  F54E  9D 42 02           STA LAT,X
01446  F551  A5 F0              LDA SA
01447  F553  9D 56 02           STA SAT,X
01448  F556  A5 F1              LDA FA
01449  F558  9D 4C 02           STA FAT,X
01450  F55B  F0 50              BEQ OP175
01451  F55D  C9 03              CMP #3
01452  F55F  F0 4C              BEQ OP175
01453  F561  90 03              BCC OP150
01454  F563  4C 62 F4           JMP OPENI
01455  F566  A5 F0       OP150  LDA SA
01456  F568  D0 28              BNE OP200
01457  F56A  20 3B F8           JSR CSTE1
01458  F56D  20 FF F3           JSR LD300
01459  F570  A5 EE              LDA FNLEN
01460  F572  F0 17              BEQ OP170
01461  F574  20 95 F4           JSR FAF
01462  F577  D0 21              BNE OP171
01463  F579  A0 24       OP160  LDY #MS4-MS1
01464  F57B  A9 0D       ERMSG  LDA #$D
01465  F57D  20 EA E3           JSR PRT
01466  F580  A9 3F              LDA #$3F
01467  F582  20 EA E3           JSR PRT
01468  F585  20 DE E7           JSR MSG
01469  F588  4C 79 C3           JMP TYPERR
01470  F58B  20 AE F5    OP170  JSR FAH






CLOSE-LOAD-OPEN......PAGE 0020

LINE# LOC   CODE        LINE


01471  F58E  F0 E9              BEQ OP160
01472  F590  D0 08              BNE OP171
01473  F592  20 71 F8    OP200  JSR CSTE2
01474  F595  A9 04              LDA #BDFH
01475  F597  20 ED F5           JSR TAPEH
01476  F59A  A6 F1       OP171  LDX FA
01477  F59C  A9 BF              LDA #BUFSZ-1
01478  F59E  A4 F0              LDY SA
01479  F5A0  F0 08              BEQ OP172
01480  F5A2  20 E3 F5           JSR LF5E3
01481  F5A5  A9 02              LDA #BDF
01482  F5A7  91 F3              STA (TBUF)Y
01483  F5A9  98                 TYA
01484  F5AA  9D 70 02    OP172  STA BUFPT-1,X
01485  F5AD  60          OP175  RTS
01486  F5AE              .FILE  OB3SRC













































SAVE-SYS-TIME......PAGE 0021

LINE# LOC   CODE        LINE


01488  F5AE  AD 0B 02    FAH    LDA VERCK
01489  F5B1  48                 PHA
01490  F5B2  20 7F F8    FAH30  JSR RBLK
01491  F5B5  A0 00              LDY #0
01492  F5B7  B1 F3              LDA (TBUF)Y
01493  F5B9  C9 05              CMP #EOT
01494  F5BB  F0 20              BEQ FAH40
01495  F5BD  C9 01              CMP #BLF
01496  F5BF  F0 04              BEQ FAH50
01497  F5C1  C9 04              CMP #BDFH
01498  F5C3  D0 ED              BNE FAH30
01499  F5C5  AA          FAH50  TAX
01500  F5C6  A5 CA              LDA TXTPTR+1
01501  F5C8  D0 11              BNE FAH45
01502  F5CA  A0 A3              LDY #MS17-MS1
01503  F5CC  20 DE E7           JSR MSG
01504  F5CF  A0 05              LDY #5
01505  F5D1  B1 F3       FAH55  LDA (TBUF)Y
01506  F5D3  20 EA E3           JSR PRT
01507  F5D6  C8                 INY
01508  F5D7  C0 15              CPY #21
01509  F5D9  D0 F6              BNE FAH55
01510  F5DB  A0 01       FAH45  LDY #1
01511  F5DD  68          FAH40  PLA
01512  F5DE  8D 0B 02           STA VERCK
01513  F5E1  98                 TYA
01514  F5E2  60                 RTS
01515  F5E3  A0 BF       LF5E3  LDY #192-1
01516  F5E5  A9 20              LDA #' 
01517  F5E7  91 F3       LF5E7  STA (TBUF)Y
01518  F5E9  88                 DEY
01519  F5EA  D0 FB              BNE LF5E7
01520  F5EC  60                 RTS
01521  F5ED  85 E9       TAPEH  STA T1
01522  F5EF  A5 F8              LDA STAH
01523  F5F1  48                 PHA
01524  F5F2  A5 F7              LDA STAL
01525  F5F4  48                 PHA
01526  F5F5  A5 E6              LDA EAH
01527  F5F7  48                 PHA
01528  F5F8  A5 E5              LDA EAL
01529  F5FA  48                 PHA
01530  F5FB  20 E3 F5           JSR LF5E3
01531  F5FE  A5 E9              LDA T1
01532  F600  91 F3              STA (TBUF)Y
01533  F602  C8                 INY
01534  F603  A5 F7              LDA STAL
01535  F605  91 F3              STA (TBUF)Y
01536  F607  C8                 INY
01537  F608  A5 F8              LDA STAH
01538  F60A  91 F3              STA (TBUF)Y
01539  F60C  C8                 INY
01540  F60D  A5 E5              LDA EAL
01541  F60F  91 F3              STA (TBUF)Y
01542  F611  C8                 INY






SAVE-SYS-TIME......PAGE 0022

LINE# LOC   CODE        LINE


01543  F612  A5 E6              LDA EAH
01544  F614  91 F3              STA (TBUF)Y
01545  F616  C8                 INY
01546  F617  8C 68 02           STY T2
01547  F61A  A0 00              LDY #0
01548  F61C  84 E9              STY T1
01549  F61E  A4 E9       TH20   LDY T1
01550  F620  C4 EE              CPY FNLEN
01551  F622  F0 0E              BEQ TH30
01552  F624  B1 F9              LDA (FNADR)Y
01553  F626  AC 68 02           LDY T2
01554  F629  91 F3              STA (TBUF)Y
01555  F62B  E6 E9              INC T1
01556  F62D  EE 68 02           INC T2
01557  F630  D0 EC              BNE TH20
01558  F632  20 7D F6    TH30   JSR LDAD1
01559  F635  20 13 F9           JSR TWAIT
01560  F638  A9 69              LDA #$69
01561  F63A  8D 79 02           STA SHCNH
01562  F63D  20 C4 F8           JSR TWRT2
01563  F640  68                 PLA
01564  F641  85 E5              STA EAL
01565  F643  68                 PLA
01566  F644  85 E6              STA EAH
01567  F646  68                 PLA
01568  F647  85 F7              STA STAL
01569  F649  68                 PLA
01570  F64A  85 F8              STA STAH
01571  F64C  60                 RTS
01572  F64D  20 13 F9    LDAD2  JSR TWAIT
01573  F650  A2 00              LDX #0
01574  F652  A0 01              LDY #1
01575  F654  B1 F3       LDAD3  LDA (TBUF)Y
01576  F656  95 E3              STA SAL,X
01577  F658  E8                 INX
01578  F659  C8                 INY
01579  F65A  E0 04              CPX #4
01580  F65C  D0 F6              BNE LDAD3
01581  F65E  A5 E3              LDA SAL
01582  F660  85 F7              STA STAL
01583  F662  A5 E4              LDA SAH
01584  F664  85 F8              STA STAH
01585  F666  60                 RTS
01586  F667  A9 7A       ZZZ    LDA #<TAPE1
01587  F669  85 F3              STA TBUF
01588  F66B  A9 02              LDA #>TAPE1
01589  F66D  85 F4              STA TBUF+1
01590  F66F  A5 F1              LDA FA
01591  F671  4A                 LSR A
01592  F672  B0 08              BCS ZZ10
01593  F674  A9 3A              LDA #<TAPE2
01594  F676  85 F3              STA TBUF
01595  F678  A9 03              LDA #>TAPE2
01596  F67A  85 F4              STA TBUF+1
01597  F67C  60          ZZ10   RTS






SAVE-SYS-TIME......PAGE 0023

LINE# LOC   CODE        LINE


01598  F67D  20 13 F9    LDAD1  JSR TWAIT
01599  F680  20 67 F6           JSR ZZZ
01600  F683  A5 F3              LDA TBUF
01601  F685  85 F7              STA STAL
01602  F687  18                 CLC
01603  F688  69 C0              ADC #BUFSZ
01604  F68A  85 E5              STA EAL
01605  F68C  A5 F4              LDA TBUF+1
01606  F68E  85 F8              STA STAH
01607  F690  69 00              ADC #0
01608  F692  85 E6              STA EAH
01609  F694  60                 RTS
01610  F695  20 A4 CC    SYS    JSR FRMNUM
01611  F698  20 D0 D6           JSR GETADR
01612  F69B  6C 08 00           JMP (LINNUM)
01613  F69E  20 33 F4    SAVE   JSR PARS1
01614  F6A1  A5 7C              LDA VARTAB
01615  F6A3  85 E5              STA EAL
01616  F6A5  A5 7D              LDA VARTAB+1
01617  F6A7  85 E6              STA EAH
01618  F6A9  A9 04              LDA #>$0400
01619  F6AB  85 F8              STA STAH
01620  F6AD  A9 00              LDA #<$0400
01621  F6AF  85 F7              STA STAL
01622  F6B1  A5 F1              LDA FA
01623  F6B3  D0 05              BNE SV20
01624  F6B5  A0 74       SV10   LDY #MS13-MS1
01625  F6B7  4C 7B F5           JMP ERMSG
01626  F6BA  C9 03       SV20   CMP #3
01627  F6BC  F0 F7              BEQ SV10
01628  F6BE  90 36              BCC SV100
01629  F6C0  20 1C F7           JSR LF71C
01630  F6C3  20 62 F4           JSR OPENI
01631  F6C6  20 BA F0           JSR LISTN
01632  F6C9  A0 00              LDY #0
01633  F6CB  20 DC FB           JSR RD300
01634  F6CE  20 90 FD    SV30   JSR WRT62
01635  F6D1  F0 10              BEQ SV50
01636  F6D3  B1 E3              LDA (SAL)Y
01637  F6D5  20 67 F1           JSR CIOUT
01638  F6D8  20 39 F3           JSR STOP
01639  F6DB  E6 E3              INC SAL
01640  F6DD  D0 EF              BNE SV30
01641  F6DF  E6 E4              INC SAH
01642  F6E1  D0 EB              BNE SV30
01643  F6E3  20 7E F1    SV50   JSR UNLSN
01644  F6E6  24 F0       CLSE1  BIT SA
01645  F6E8  30 4B              BMI LF735
01646  F6EA  20 BA F0           JSR LISTN
01647  F6ED  A5 F0              LDA SA
01648  F6EF  29 EF              AND #$EF
01649  F6F1  09 E0              ORA #$E0
01650  F6F3  4C 2C F1           JMP SECND
01651  F6F6  20 67 F6    SV100  JSR ZZZ
01652  F6F9  20 71 F8           JSR CSTE2






SAVE-SYS-TIME......PAGE 0024

LINE# LOC   CODE        LINE


01653  F6FC  A5 CA              LDA TXTPTR+1
01654  F6FE  D0 08              BNE SV105
01655  F700  A0 64              LDY #MS11-MS1
01656  F702  20 DE E7           JSR MSG
01657  F705  20 11 F4           JSR LD105
01658  F708  A9 01       SV105  LDA #BLF
01659  F70A  20 ED F5           JSR TAPEH
01660  F70D  20 BC F8           JSR TWRT
01661  F710  A6 F0              LDX SA
01662  F712  F0 21              BEQ LF735
01663  F714  CA                 DEX
01664  F715  F0 1E              BEQ LF735
01665  F717  A9 05              LDA #EOT
01666  F719  4C ED F5           JMP TAPEH
01667  F71C  A2 00       LF71C  LDX #0
01668  F71E  86 F0              STX SA
01669  F720  A2 00       LF720  LDX #0
01670  F722  E6 F0              INC SA
01671  F724  EC 62 02    LF724  CPX LDTND
01672  F727  F0 5E              BEQ UD65
01673  F729  BD 56 02           LDA SAT,X
01674  F72C  29 1F              AND #$1F
01675  F72E  C5 F0              CMP SA
01676  F730  F0 EE              BEQ LF720
01677  F732  E8                 INX
01678  F733  D0 EF              BNE LF724
01679  F735  60          LF735  RTS
01680  F736  AD 05 02    UDTIM  LDA CRFAC
01681  F739  69 01              ADC #1
01682  F73B  8D 05 02           STA CRFAC
01683  F73E  90 03              BCC UD10
01684  F740  EE 06 02           INC CRFAC+1
01685  F743  C9 6F       UD10   CMP #$6F
01686  F745  D0 07              BNE UD20
01687  F747  AD 06 02           LDA CRFAC+1
01688  F74A  C9 02              CMP #2
01689  F74C  F0 26              BEQ UD50
01690  F74E  EE 02 02    UD20   INC TIME+2
01691  F751  D0 08              BNE UD30
01692  F753  EE 01 02           INC TIME+1
01693  F756  D0 03              BNE UD30
01694  F758  EE 00 02           INC TIME
01695  F75B  A2 00       UD30   LDX #0
01696  F75D  BD 00 02    UD40   LDA TIME,X
01697  F760  DD 88 F7           CMP UD70,X
01698  F763  90 17              BCC UD60
01699  F765  E8                 INX
01700  F766  E0 03              CPX #3
01701  F768  D0 F3              BNE UD40
01702  F76A  A9 00              LDA #0
01703  F76C  9D FF 01    UD45   STA TIME-1,X
01704  F76F  CA                 DEX
01705  F770  D0 FA              BNE UD45
01706  F772  F0 08              BEQ UD60
01707  F774  A9 00       UD50   LDA #0






SAVE-SYS-TIME......PAGE 0025

LINE# LOC   CODE        LINE


01708  F776  8D 05 02           STA CRFAC
01709  F779  8D 06 02           STA CRFAC+1
01710  F77C  AD 12 E8    UD60   LDA PIAK
01711  F77F  CD 12 E8           CMP PIAK
01712  F782  D0 F8              BNE UD60
01713  F784  8D 09 02           STA STKEY
01714  F787  60          UD65   RTS
01715  F788  4F          UD70   .BYT $4F,$1A,1
01715  F789  1A 
01715  F78A  01 
01716  F78B              .FILE  OB4SRC


















































O/C CHAN,R/W TAPE......PAGE 0026

LINE# LOC   CODE        LINE


01718  F78B  48          CHKIN  PHA
01719  F78C  8A                 TXA
01720  F78D  48                 PHA
01721  F78E  98                 TYA
01722  F78F  48                 PHA
01723  F790  A9 00              LDA #0
01724  F792  8D 0C 02           STA SATUS
01725  F795  8A                 TXA
01726  F796  20 AB F2           JSR JLTLK
01727  F799  F0 05              BEQ JX310
01728  F79B  A0 17       JX300  LDY #MS3-MS1
01729  F79D  4C 7B F5    JX305  JMP ERMSG
01730  F7A0  20 B8 F2    JX310  JSR JZ100
01731  F7A3  A5 F1              LDA FA
01732  F7A5  F0 0E              BEQ JX320
01733  F7A7  C9 03              CMP #3
01734  F7A9  F0 0A              BEQ JX320
01735  F7AB  B0 0E              BCS JX330
01736  F7AD  A6 F0              LDX SA
01737  F7AF  F0 04              BEQ JX320
01738  F7B1  A0 86              LDY #MS15-MS1
01739  F7B3  D0 E8              BNE JX305
01740  F7B5  8D 63 02    JX320  STA DFLTN
01741  F7B8  4C 77 F2           JMP RSTOR
01742  F7BB  48          JX330  PHA
01743  F7BC  20 B6 F0    JX3301 JSR TALK
01744  F7BF  A5 F0              LDA SA
01745  F7C1  10 06              BPL JX340
01746  F7C3  20 61 F1           JSR TKATN
01747  F7C6  4C D0 F7           JMP JX350
01748  F7C9  29 1F       JX340  AND #$1F
01749  F7CB  09 60              ORA #$60
01750  F7CD  20 5B F1           JSR TKSA
01751  F7D0  AD 0C 02    JX350  LDA SATUS
01752  F7D3  10 03              BPL *+5
01753  F7D5  4C 7D F4           JMP OP37
01754  F7D8  68                 PLA
01755  F7D9  4C B5 F7           JMP JX320
01756  F7DC              CHKOUT
01757  F7DC  48          CKOUT  PHA
01758  F7DD  8A                 TXA
01759  F7DE  48                 PHA
01760  F7DF  98                 TYA
01761  F7E0  48                 PHA
01762  F7E1  A9 00              LDA #0
01763  F7E3  8D 0C 02           STA SATUS
01764  F7E6  A9 FF              LDA #$FF
01765  F7E8  8D 6A 02           STA L026A
01766  F7EB  8A                 TXA
01767  F7EC  20 AB F2           JSR JLTLK
01768  F7EF  D0 AA              BNE JX300
01769  F7F1  20 B8 F2           JSR JZ100
01770  F7F4  A5 F1              LDA FA
01771  F7F6  F0 A3              BEQ JX300
01772  F7F8  C9 03       CK10   CMP #3






O/C CHAN,R/W TAPE......PAGE 0027

LINE# LOC   CODE        LINE


01773  F7FA  F0 0A              BEQ JX360
01774  F7FC  10 0E              BPL JX370
01775  F7FE  A6 F0              LDX SA
01776  F800  D0 04              BNE JX360
01777  F802  A0 94              LDY #MS16-MS1
01778  F804  D0 97              BNE JX305
01779  F806  8D 64 02    JX360  STA DFLTO
01780  F809  4C 77 F2           JMP RSTOR
01781  F80C  48          JX370  PHA
01782  F80D  20 BA F0           JSR LISTN
01783  F810  A5 F0              LDA SA
01784  F812  10 06              BPL JX380
01785  F814  20 32 F1           JSR SCATN
01786  F817  4C 21 F8           JMP JX390
01787  F81A  29 1F       JX380  AND #$1F
01788  F81C  09 60              ORA #$60
01789  F81E  20 2C F1           JSR SECND
01790  F821  AD 0C 02    JX390  LDA SATUS
01791  F824  10 03              BPL *+5
01792  F826  4C 7D F4           JMP OP37
01793  F829  68                 PLA
01794  F82A  4C 06 F8           JMP JX360
01795  F82D  20 67 F6    JTP20  JSR ZZZ
01796  F830  A6 F1              LDX FA
01797  F832  FE 70 02           INC BUFPT-1,X
01798  F835  BC 70 02           LDY BUFPT-1,X
01799  F838  C0 C0              CPY #BUFSZ
01800  F83A  60                 RTS
01801  F83B              ;STAYS IN ROUTINE TILL PLAY SWITCH
01802  F83B  20 5E F8    CSTE1  JSR CS10
01803  F83E  F0 30              BEQ CS25
01804  F840  A0 41              LDY #MS7-MS1    ;"PRESS PLAY"
01805  F842  20 DE E7    CS30   JSR MSG
01806  F845  A0 56              LDY #MS9-MS1    ;"ON CASSETTE #"
01807  F847  20 DE E7           JSR MSG
01808  F84A  A5 F1              LDA FA
01809  F84C  09 30              ORA #'0
01810  F84E  20 EA E3           JSR PRT         ;PRINT CASSETTE #
01811  F851  20 39 F3    CS40   JSR STOP        ;WATCH FOR STOP KEY
01812  F854  20 5E F8           JSR CS10        ;WATCH CASSETTE SWITCHES
01813  F857  D0 F8              BNE CS40
01814  F859  A0 AA              LDY #MS18-MS1   ;"OK"
01815  F85B  4C DE E7           JMP MSG
01816  F85E              ;SUBR RETURNS <> FOR CASSETTE SWITCH
01817  F85E  A9 10       CS10   LDA #$10        ;ASSUME CASSETTE #1
01818  F860  A6 F1              LDX FA
01819  F862  E0 01              CPX #$01        ;REALLY CASSETTE 1
01820  F864  F0 02              BEQ CS20        ;YES.   .
01821  F866  A9 20              LDA #$20        ;NO. . .CASSETTE #2
01822  F868  2C 10 E8    CS20   BIT PIAL        ;CLOSED
01823  F86B  D0 03              BNE CS25        ;NO. . .
01824  F86D  2C 10 E8           BIT PIAL        ;CHECK AGAIN TO DEBOUNCE
01825  F870  60          CS25   RTS
01826  F871              ;CHECKS FOR PLAY & RECORD
01827  F871  20 5E F8    CSTE2  JSR CS10






O/C CHAN,R/W TAPE......PAGE 0028

LINE# LOC   CODE        LINE


01828  F874  F0 FA              BEQ CS25
01829  F876  A0 41              LDY #MS7-MS1    ;"PRESS PLAY AND"
01830  F878  20 DE E7           JSR MSG
01831  F87B  A0 4D              LDY #MS8-MS1    ;"RECORD"
01832  F87D  D0 C3              BNE CS30
01833  F87F  A9 00       RBLK   LDA #0
01834  F881  8D 0C 02           STA SATUS
01835  F884  8D 0B 02           STA VERCK
01836  F887  20 7D F6           JSR LDAD1
01837  F88A  20 13 F9    TRD    JSR TWAIT
01838  F88D  20 3B F8           JSR CSTE1
01839  F890  78                 SEI
01840  F891  A9 00              LDA #0
01841  F893  8D 78 02           STA RDFLG
01842  F896  85 EB              STA SNSW1
01843  F898  85 E7              STA CMP0
01844  F89A  8D 76 02           STA PTR1
01845  F89D  8D 77 02           STA PTR2
01846  F8A0  8D 66 02           STA DPSW
01847  F8A3  A2 0E              LDX #$0E
01848  F8A5  20 1B FD           JSR BSIV
01849  F8A8  A6 F1              LDX FA
01850  F8AA  CA                 DEX
01851  F8AB  F0 07              BEQ TRD2
01852  F8AD  A9 90              LDA #$90
01853  F8AF  8D 4E E8           STA IER
01854  F8B2  D0 1E              BNE TAPE
01855  F8B4  EE 11 E8    TRD2   INC PIAL1
01856  F8B7  D0 19              BNE TAPE
01857  F8B9  20 7D F6    WBLK   JSR LDAD1
01858  F8BC  20 13 F9    TWRT   JSR TWAIT
01859  F8BF  A9 14              LDA #20
01860  F8C1  8D 79 02           STA SHCNH
01861  F8C4  20 71 F8    TWRT2  JSR CSTE2
01862  F8C7  78                 SEI
01863  F8C8  A9 A0              LDA #$A0
01864  F8CA  8D 4E E8           STA IER
01865  F8CD  A2 08              LDX #8
01866  F8CF  20 1B FD           JSR BSIV
01867  F8D2  A9 02       TAPE   LDA #2
01868  F8D4  85 FD              STA FSBLK
01869  F8D6  20 EC FB           JSR NEWCH
01870  F8D9  CE 13 E8           DEC PIAS
01871  F8DC  A6 F1              LDX FA
01872  F8DE  CA                 DEX
01873  F8DF  D0 0A              BNE TP20
01874  F8E1  A9 34              LDA #$34
01875  F8E3  8D 13 E8           STA PIAS
01876  F8E6  8D 07 02           STA CAS1
01877  F8E9  D0 0B              BNE TP30
01878  F8EB  AD 40 E8    TP20   LDA PIA
01879  F8EE  8E 08 02           STX CAS2
01880  F8F1  29 EF              AND #$EF
01881  F8F3  8D 40 E8           STA PIA
01882  F8F6  8D 49 E8    TP30   STA T2H






O/C CHAN,R/W TAPE......PAGE 0029

LINE# LOC   CODE        LINE


01883  F8F9  58                 CLI
01884  F8FA  A9 E6       TP40   LDA #>KEY
01885  F8FC  CD 1A 02           CMP CINV+1
01886  F8FF  F0 11              BEQ TP50
01887  F901  20 1E F9           JSR TSTOP
01888  F904  2C 13 E8           BIT PIAS
01889  F907  10 F1              BPL TP40
01890  F909  2C 12 E8           BIT PIAK
01891  F90C  20 36 F7           JSR UDTIM
01892  F90F  4C FA F8           JMP TP40
01893  F912  60          TP50   RTS
01894  F913  20 1E F9    TWAIT  JSR TSTOP
01895  F916  A9 E6              LDA #>KEY
01896  F918  CD 1A 02           CMP CINV+1
01897  F91B  D0 F6              BNE TWAIT
01898  F91D  60                 RTS
01899  F91E  20 2A F3    TSTOP  JSR STOP1
01900  F921  D0 08              BNE STOP3
01901  F923  08                 PHP
01902  F924  20 FB FC           JSR TNIF
01903  F927  20 99 F2           JSR JX770
01904  F92A  28                 PLP
01905  F92B  4C 1C C7    STOP3  JMP BSTOP
01906  F92E  86 E8       STT1   STX TEMP
01907  F930  A5 E7              LDA CMP0
01908  F932  0A                 ASL A
01909  F933  0A                 ASL A
01910  F934  18                 CLC
01911  F935  65 E7              ADC CMP0
01912  F937  18                 CLC
01913  F938  65 E8              ADC TEMP
01914  F93A  85 E8              STA TEMP
01915  F93C  A9 00              LDA #0
01916  F93E  24 E7              BIT CMP0
01917  F940  30 01              BMI STT2
01918  F942  2A                 ROL A
01919  F943  06 E8       STT2   ASL TEMP
01920  F945  2A                 ROL A
01921  F946  06 E8              ASL TEMP
01922  F948  2A                 ROL A
01923  F949  AA                 TAX
01924  F94A  AD 48 E8    STT3   LDA T2L
01925  F94D  C9 15              CMP #21
01926  F94F  90 F9              BCC STT3
01927  F951  65 E8              ADC TEMP
01928  F953  8D 44 E8           STA TIL
01929  F956  8A                 TXA
01930  F957  6D 49 E8           ADC T2H
01931  F95A  8D 45 E8           STA TIH
01932  F95D  58                 CLI
01933  F95E  60                 RTS
01934  F95F              .FILE  OB5SRC









CASSETTE READ......PAGE 002A

LINE# LOC   CODE        LINE


01936  F95F  AE 49 E8    READ   LDX T2H
01937  F962  A0 FF              LDY #$FF
01938  F964  98                 TYA
01939  F965  ED 48 E8           SBC T2L
01940  F968  EC 49 E8           CPX T2H
01941  F96B  D0 F2              BNE READ
01942  F96D  86 E8       RD1    STX TEMP
01943  F96F  AA                 TAX
01944  F970  8C 48 E8           STY T2L
01945  F973  8C 49 E8           STY T2H
01946  F976  98                 TYA
01947  F977  E5 E8              SBC TEMP
01948  F979  86 E8              STX TEMP
01949  F97B  4A                 LSR A
01950  F97C  66 E8              ROR TEMP
01951  F97E  4A                 LSR A
01952  F97F  66 E8       RADS   ROR TEMP
01953  F981  A5 E7       RD3    LDA CMP0
01954  F983  18                 CLC
01955  F984  69 3C              ADC #60
01956  F986  2C 40 E8           BIT PIA
01957  F989  2C 10 E8           BIT PIAL
01958  F98C  C5 E8              CMP TEMP
01959  F98E  B0 55              BCS RDBK
01960  F990  AE 66 02           LDX DPSW
01961  F993  F0 03              BEQ RJDJ
01962  F995  4C A3 FA    JRADJ  JMP RADJ
01963  F998  AE 6C 02    RJDJ   LDX PCNTR
01964  F99B  30 1B              BMI JRAD2
01965  F99D  A2 00              LDX #0
01966  F99F  69 30              ADC #48
01967  F9A1  65 E7              ADC CMP0
01968  F9A3  C5 E8              CMP TEMP
01969  F9A5  B0 1E              BCS RADX2
01970  F9A7  E8                 INX
01971  F9A8  69 26              ADC #38
01972  F9AA  65 E7              ADC CMP0
01973  F9AC  C5 E8              CMP TEMP
01974  F9AE  B0 1B              BCS RADL
01975  F9B0  69 2C              ADC #44
01976  F9B2  65 E7              ADC CMP0
01977  F9B4  C5 E8              CMP TEMP
01978  F9B6  90 03              BCC *+5
01979  F9B8  4C 4A FA    JRAD2  JMP RAD2
01980  F9BB  EA                 NOP
01981  F9BC  A5 EB       SRER   LDA SNSW1
01982  F9BE  F0 25              BEQ RDBK
01983  F9C0  8D 74 02           STA RER
01984  F9C3  D0 20              BNE RDBK
01985  F9C5  EE 75 02    RADX2  INC REZ
01986  F9C8  B0 04              BCS RAD5
01987  F9CA  EA          LF9CA  NOP
01988  F9CB  CE 75 02    RADL   DEC REZ
01989  F9CE  38          RAD5   SEC
01990  F9CF  E9 13              SBC #19






CASSETTE READ......PAGE 002B

LINE# LOC   CODE        LINE


01991  F9D1  E5 E8              SBC TEMP
01992  F9D3  6D 0A 02           ADC SVXT
01993  F9D6  8D 0A 02           STA SVXT
01994  F9D9  AD 6F 02           LDA FIRT
01995  F9DC  49 01              EOR #1
01996  F9DE  8D 6F 02           STA FIRT
01997  F9E1  F0 24              BEQ RAD3
01998  F9E3  86 F6              STX DATA
01999  F9E5  A5 EB       RDBK   LDA SNSW1
02000  F9E7  F0 1B              BEQ RADBK
02001  F9E9  2C 4D E8           BIT IFR
02002  F9EC  50 16              BVC RADBK
02003  F9EE  A9 00              LDA #0
02004  F9F0  8D 6F 02           STA FIRT
02005  F9F3  AD 6C 02           LDA PCNTR
02006  F9F6  10 36              BPL RAD4
02007  F9F8  30 BE              BMI JRAD2
02008  F9FA  A2 A6       RADP   LDX #166
02009  F9FC  20 2E F9           JSR STT1
02010  F9FF  AD 65 02           LDA PRTY
02011  FA02  D0 B8              BNE SRER
02012  FA04  4C 7E E6    RADBK  JMP PREND
02013  FA07  AD 0A 02    RAD3   LDA SVXT
02014  FA0A  F0 08              BEQ ROUT1
02015  FA0C  30 04              BMI ROUT2
02016  FA0E  C6 E7              DEC CMP0
02017  FA10  C6 E7              DEC CMP0
02018  FA12  E6 E7       ROUT2  INC CMP0
02019  FA14  A9 00       ROUT1  LDA #0
02020  FA16  8D 0A 02           STA SVXT
02021  FA19  E4 F6              CPX DATA
02022  FA1B  D0 11              BNE RAD4
02023  FA1D  8A                 TXA
02024  FA1E  D0 9C              BNE SRER
02025  FA20  AD 75 02           LDA REZ
02026  FA23  30 C0              BMI RDBK
02027  FA25  C9 10              CMP #16
02028  FA27  90 BC              BCC RDBK
02029  FA29  8D 28 02    RAD3G  STA SYNO
02030  FA2C  B0 B7              BCS RDBK
02031  FA2E  8A          RAD4   TXA
02032  FA2F  4D 65 02           EOR PRTY
02033  FA32  8D 65 02           STA PRTY
02034  FA35  A5 EB              LDA SNSW1
02035  FA37  F0 CB              BEQ RADBK
02036  FA39  CE 6C 02           DEC PCNTR
02037  FA3C  30 BC              BMI RADP
02038  FA3E  46 F6              LSR DATA
02039  FA40  66 FE              ROR MYCH
02040  FA42  A2 DA              LDX #218
02041  FA44  20 2E F9           JSR STT1
02042  FA47  4C 7E E6           JMP PREND
02043  FA4A  AD 28 02    RAD2   LDA SYNO
02044  FA4D  F0 04              BEQ RAD2Y
02045  FA4F  A5 EB              LDA SNSW1






CASSETTE READ......PAGE 002C

LINE# LOC   CODE        LINE


02046  FA51  F0 08              BEQ RAD2X
02047  FA53  AD 6C 02    RAD2Y  LDA PCNTR
02048  FA56  30 03              BMI RAD2X
02049  FA58              ;JMP RADL
02050  FA58  4C CA F9           JMP LF9CA
02051  FA5B  46 E8       RAD2X  LSR TEMP
02052  FA5D  A9 93              LDA #147
02053  FA5F  38                 SEC
02054  FA60  E5 E8              SBC TEMP
02055  FA62  65 E7              ADC CMP0
02056  FA64  0A                 ASL A
02057  FA65  AA                 TAX
02058  FA66  20 2E F9           JSR STT1
02059  FA69  EE 66 02           INC DPSW
02060  FA6C  A5 EB       RADQ   LDA SNSW1
02061  FA6E  D0 14              BNE RADQ2
02062  FA70  AD 28 02    RADQ1  LDA SYNO
02063  FA73  F0 2B              BEQ RDBK2
02064  FA75  8D 74 02           STA RER
02065  FA78  A9 00              LDA #0
02066  FA7A  8D 28 02           STA SYNO
02067  FA7D  A9 C0              LDA #$C0
02068  FA7F  8D 4E E8           STA IER
02069  FA82  85 EB              STA SNSW1
02070  FA84  AD 28 02    RADQ2  LDA SYNO
02071  FA87  85 EC              STA DIFF
02072  FA89  F0 09              BEQ RADK
02073  FA8B  A9 00              LDA #0
02074  FA8D  85 EB              STA SNSW1
02075  FA8F  A9 40              LDA #$40
02076  FA91  8D 4E E8           STA IER
02077  FA94  A5 FE       RADK   LDA MYCH
02078  FA96  85 FC              STA OCHAR
02079  FA98  AD 74 02           LDA RER
02080  FA9B  0D 75 02    RADR1  ORA REZ
02081  FA9E  85 ED              STA PRP
02082  FAA0  4C 7E E6    RDBK2  JMP PREND
02083  FAA3  20 EC FB    RADJ   JSR NEWCH
02084  FAA6  8D 66 02           STA DPSW
02085  FAA9  A2 DA              LDX #218
02086  FAAB  20 2E F9           JSR STT1
02087  FAAE  A5 FD              LDA FSBLK
02088  FAB0  F0 03              BEQ RD15
02089  FAB2  8D 73 02           STA SHCNL
02090  FAB5              SPERR=16
02091  FAB5              CKERR=32
02092  FAB5              SBERR=4
02093  FAB5              LBERR=8
02094  FAB5  A9 0F       RD15   LDA #$F
02095  FAB7  2C 78 02           BIT RDFLG
02096  FABA  10 18              BPL RD20
02097  FABC  A5 EC              LDA DIFF
02098  FABE  D0 0C              BNE RD12
02099  FAC0  A6 FD              LDX FSBLK
02100  FAC2  CA                 DEX






CASSETTE READ......PAGE 002D

LINE# LOC   CODE        LINE


02101  FAC3  D0 0C              BNE RD10
02102  FAC5              ;LONG BLOCK ERROR
02103  FAC5  A9 08              LDA #LBERR
02104  FAC7  20 E5 FB           JSR UDST
02105  FACA  D0 05              BNE RD10
02106  FACC  A9 00       RD12   LDA #0
02107  FACE  8D 78 02           STA RDFLG
02108  FAD1  4C 7E E6    RD10   JMP PREND
02109  FAD4  70 37       RD20   BVS RD60
02110  FAD6  D0 1A              BNE RD200
02111  FAD8  A5 EC              LDA DIFF
02112  FADA  D0 F5              BNE RD10
02113  FADC  A5 ED              LDA PRP
02114  FADE  D0 F1              BNE RD10
02115  FAE0  AD 73 02           LDA SHCNL
02116  FAE3  4A                 LSR A
02117  FAE4  A5 FC              LDA OCHAR
02118  FAE6  30 03              BMI RD22
02119  FAE8  90 1C              BCC RD40
02120  FAEA  18                 CLC
02121  FAEB  B0 19       RD22   BCS RD40
02122  FAED  29 0F              AND #$F
02123  FAEF  8D 78 02           STA RDFLG
02124  FAF2  CE 78 02    RD200  DEC RDFLG
02125  FAF5  D0 DA              BNE RD10
02126  FAF7  A9 40              LDA #$40
02127  FAF9  8D 78 02           STA RDFLG
02128  FAFC  20 DC FB           JSR RD300
02129  FAFF  A9 00              LDA #0
02130  FB01  8D 79 02           STA SHCNH
02131  FB04  F0 CB              BEQ RD10
02132  FB06  A9 80       RD40   LDA #$80
02133  FB08  8D 78 02           STA RDFLG
02134  FB0B  D0 C4              BNE RD10
02135  FB0D  A5 EC       RD60   LDA DIFF
02136  FB0F  F0 0A              BEQ RD70
02137  FB11  A9 04              LDA #SBERR
02138  FB13              ; SHORT BLOCK ERROR
02139  FB13  20 E5 FB           JSR UDST
02140  FB16  A9 00              LDA #0
02141  FB18  4C A7 FB           JMP RD161
02142  FB1B  20 90 FD    RD70   JSR WRT62
02143  FB1E  D0 03              BNE *+5
02144  FB20  4C A5 FB           JMP RD160
02145  FB23  AE 73 02           LDX SHCNL
02146  FB26  CA                 DEX
02147  FB27  F0 31              BEQ RD58
02148  FB29  AD 0B 02           LDA VERCK
02149  FB2C  F0 0C              BEQ RD80
02150  FB2E  A0 00              LDY #0
02151  FB30  A5 FC              LDA OCHAR
02152  FB32  D1 E3              CMP (SAL)Y
02153  FB34  F0 04              BEQ RD80
02154  FB36  A9 01              LDA #1
02155  FB38  85 ED              STA PRP






CASSETTE READ......PAGE 002E

LINE# LOC   CODE        LINE


02156  FB3A  A5 ED       RD80   LDA PRP
02157  FB3C  F0 54              BEQ RD59
02158  FB3E  A2 3D              LDX #61
02159  FB40  EC 76 02           CPX PTR1
02160  FB43  90 46              BCC RD55
02161  FB45  AE 76 02    RD56   LDX PTR1
02162  FB48  A5 E4              LDA SAH
02163  FB4A  9D 01 01           STA BAD+1,X
02164  FB4D  A5 E3              LDA SAL
02165  FB4F  9D 00 01           STA BAD,X
02166  FB52  E8                 INX
02167  FB53  E8                 INX
02168  FB54  8E 76 02           STX PTR1
02169  FB57  4C 92 FB           JMP RD59
02170  FB5A  AE 77 02    RD58   LDX PTR2
02171  FB5D  EC 76 02           CPX PTR1
02172  FB60  F0 3B              BEQ RD90
02173  FB62  A5 E3              LDA SAL
02174  FB64  DD 00 01           CMP BAD,X
02175  FB67  D0 34              BNE RD90
02176  FB69  A5 E4              LDA SAH
02177  FB6B  DD 01 01           CMP BAD+1,X
02178  FB6E  D0 2D              BNE RD90
02179  FB70  EE 77 02           INC PTR2
02180  FB73  EE 77 02           INC PTR2
02181  FB76  AD 0B 02           LDA VERCK
02182  FB79  F0 0C              BEQ RD52
02183  FB7B  A5 FC              LDA OCHAR
02184  FB7D  A0 00              LDY #0
02185  FB7F  D1 E3              CMP (SAL)Y
02186  FB81  F0 1A              BEQ RD90
02187  FB83  A9 01              LDA #1
02188  FB85  85 ED              STA PRP
02189  FB87  A5 ED       RD52   LDA PRP
02190  FB89  F0 07              BEQ RD59
02191  FB8B              ;SECOND PASS ERR
02192  FB8B  A9 10       RD55   LDA #SPERR
02193  FB8D  20 E5 FB           JSR UDST
02194  FB90  D0 0B              BNE RD90
02195  FB92  AD 0B 02    RD59   LDA VERCK
02196  FB95  D0 06              BNE RD90
02197  FB97  A5 FC              LDA OCHAR
02198  FB99  A0 00              LDY #0
02199  FB9B  91 E3              STA (SAL)Y
02200  FB9D  E6 E3       RD90   INC SAL
02201  FB9F  D0 38              BNE RD180
02202  FBA1  E6 E4              INC SAH
02203  FBA3  D0 34              BNE RD180
02204  FBA5  A9 80       RD160  LDA #$80
02205  FBA7  8D 78 02    RD161  STA RDFLG
02206  FBAA  A6 FD              LDX FSBLK
02207  FBAC  CA                 DEX
02208  FBAD  30 02              BMI RD167
02209  FBAF  86 FD              STX FSBLK
02210  FBB1  CE 73 02    RD167  DEC SHCNL






CASSETTE READ......PAGE 002F

LINE# LOC   CODE        LINE


02211  FBB4  F0 09              BEQ RD175
02212  FBB6  AD 76 02           LDA PTR1
02213  FBB9  D0 1E              BNE RD180
02214  FBBB  85 FD              STA FSBLK
02215  FBBD  F0 1A              BEQ RD180
02216  FBBF  20 FB FC    RD175  JSR TNIF
02217  FBC2  20 DC FB           JSR RD300
02218  FBC5  A0 00              LDY #0
02219  FBC7  8C 79 02           STY SHCNH
02220  FBCA  20 7C FD           JSR VPRTY
02221  FBCD  AD 79 02           LDA SHCNH
02222  FBD0  45 FC              EOR OCHAR
02223  FBD2  F0 05              BEQ RD180
02224  FBD4  A9 20              LDA #CKERR
02225  FBD6              ;CHKSUM ERROR
02226  FBD6  20 E5 FB           JSR UDST
02227  FBD9  4C 7E E6    RD180  JMP PREND
02228  FBDC  A5 F8       RD300  LDA STAH
02229  FBDE  85 E4              STA SAH
02230  FBE0  A5 F7              LDA STAL
02231  FBE2  85 E3              STA SAL
02232  FBE4  60                 RTS
02233  FBE5  0D 0C 02    UDST   ORA SATUS
02234  FBE8  8D 0C 02           STA SATUS
02235  FBEB  60                 RTS
02236  FBEC  A9 08       NEWCH  LDA #8
02237  FBEE  8D 6C 02           STA PCNTR
02238  FBF1  A9 00              LDA #0
02239  FBF3  8D 6F 02           STA FIRT
02240  FBF6  8D 74 02           STA RER
02241  FBF9  8D 65 02           STA PRTY
02242  FBFC  8D 75 02           STA REZ
02243  FBFF  60                 RTS
02244  FC00              .FILE  OB6SRC



























TAPE WRITE & INIT......PAGE 0030

LINE# LOC   CODE        LINE


02246  FC00  A5 FC       WRITE  LDA OCHAR
02247  FC02  4A                 LSR A
02248  FC03  A9 60              LDA #96
02249  FC05  90 02              BCC WRT1
02250  FC07  A9 B0       WRTW   LDA #176
02251  FC09  A2 00       WRT1   LDX #0
02252  FC0B  8D 48 E8    WRTX   STA T2L
02253  FC0E  8E 49 E8           STX T2H
02254  FC11  AD 40 E8           LDA PIA
02255  FC14  49 08              EOR #8
02256  FC16  8D 40 E8           STA PIA
02257  FC19  29 08              AND #8
02258  FC1B  60                 RTS
02259  FC1C  38          WRTL3  SEC
02260  FC1D  66 E4              ROR SAH
02261  FC1F  30 44              BMI WRT3
02262  FC21  AD 74 02    WRTN   LDA RER
02263  FC24  D0 13              BNE WRTN1
02264  FC26  A9 10              LDA #16
02265  FC28  A2 01              LDX #1
02266  FC2A  20 0B FC           JSR WRTX
02267  FC2D  D0 36              BNE WRT3
02268  FC2F  EE 74 02           INC RER
02269  FC32  A5 E4              LDA SAH
02270  FC34  10 2F              BPL WRT3
02271  FC36  4C BB FC           JMP WRNC
02272  FC39  AD 75 02    WRTN1  LDA REZ
02273  FC3C  D0 0A              BNE WRTN2
02274  FC3E  20 07 FC           JSR WRTW
02275  FC41  D0 22              BNE WRT3
02276  FC43  EE 75 02           INC REZ
02277  FC46  D0 1D              BNE WRT3
02278  FC48  20 00 FC    WRTN2  JSR WRITE
02279  FC4B  D0 18              BNE WRT3
02280  FC4D  AD 6F 02           LDA FIRT
02281  FC50  49 01              EOR #1
02282  FC52  8D 6F 02           STA FIRT
02283  FC55  F0 11              BEQ WRT2
02284  FC57  A5 FC              LDA OCHAR
02285  FC59  49 01              EOR #1
02286  FC5B  85 FC              STA OCHAR
02287  FC5D  29 01              AND #1
02288  FC5F  4D 65 02           EOR PRTY
02289  FC62  8D 65 02           STA PRTY
02290  FC65  4C 7E E6    WRT3   JMP PREND
02291  FC68  46 FC       WRT2   LSR OCHAR
02292  FC6A  CE 6C 02           DEC PCNTR
02293  FC6D  AD 6C 02           LDA PCNTR
02294  FC70  F0 3F              BEQ WRT4
02295  FC72  10 F1              BPL WRT3
02296  FC74  20 EC FB    WRTS   JSR NEWCH
02297  FC77  58                 CLI
02298  FC78  AD 70 02           LDA CNTDN
02299  FC7B  F0 13              BEQ WRT6
02300  FC7D  A2 00              LDX #0






TAPE WRITE & INIT......PAGE 0031

LINE# LOC   CODE        LINE


02301  FC7F  86 F6              STX DATA
02302  FC81  CE 70 02    WRTS1  DEC CNTDN
02303  FC84  A6 FD              LDX FSBLK
02304  FC86  E0 02              CPX #2
02305  FC88  D0 02              BNE WRT61
02306  FC8A  09 80              ORA #$80
02307  FC8C  85 FC       WRT61  STA OCHAR
02308  FC8E  D0 D5              BNE WRT3
02309  FC90  20 90 FD    WRT6   JSR WRT62
02310  FC93  90 0A              BCC WRT7 
02311  FC95  D0 85              BNE WRTL3
02312  FC97  E6 E4              INC SAH
02313  FC99  A5 F6              LDA DATA
02314  FC9B  85 FC              STA OCHAR
02315  FC9D  B0 C6              BCS WRT3
02316  FC9F  A0 00       WRT7   LDY #0
02317  FCA1  B1 E3              LDA (SAL)Y
02318  FCA3  85 FC              STA OCHAR
02319  FCA5  45 F6              EOR DATA
02320  FCA7  85 F6              STA DATA
02321  FCA9  E6 E3              INC SAL
02322  FCAB  D0 B8              BNE WRT3
02323  FCAD  E6 E4              INC SAH
02324  FCAF  D0 B4              BNE WRT3
02325  FCB1  AD 65 02    WRT4   LDA PRTY
02326  FCB4  49 01              EOR #1
02327  FCB6  85 FC              STA OCHAR
02328  FCB8  4C 7E E6    WRTBK  JMP PREND
02329  FCBB  C6 FD       WRNC   DEC FSBLK
02330  FCBD  D0 03              BNE WREND
02331  FCBF  20 ED FF           JSR TNOF
02332  FCC2  A9 50       WREND  LDA #80
02333  FCC4  8D 73 02           STA SHCNL
02334  FCC7  A2 08              LDX #8
02335  FCC9  78                 SEI
02336  FCCA  20 1B FD           JSR BSIV
02337  FCCD  D0 E9              BNE WRTBK
02338  FCCF  A9 78       WRTZ   LDA #120
02339  FCD1  20 09 FC           JSR WRT1
02340  FCD4  D0 E2              BNE WRTBK
02341  FCD6  CE 73 02           DEC SHCNL
02342  FCD9  D0 DD              BNE WRTBK
02343  FCDB  20 EC FB           JSR NEWCH
02344  FCDE  CE 79 02           DEC SHCNH
02345  FCE1  10 D5              BPL WRTBK
02346  FCE3  A2 0A              LDX #10
02347  FCE5  20 1B FD           JSR BSIV
02348  FCE8  58                 CLI
02349  FCE9  EE 79 02           INC SHCNH
02350  FCEC  A5 FD              LDA FSBLK
02351  FCEE  F0 26              BEQ STKY
02352  FCF0  20 DC FB           JSR RD300
02353  FCF3  A2 09              LDX #9
02354  FCF5  8E 70 02           STX CNTDN
02355  FCF8  4C 74 FC           JMP WRTS






TAPE WRITE & INIT......PAGE 0032

LINE# LOC   CODE        LINE


02356  FCFB  08          TNIF   PHP
02357  FCFC  78                 SEI
02358  FCFD  20 ED FF           JSR TNOF
02359  FD00  A9 7F              LDA #$7F
02360  FD02  8D 4E E8           STA IER
02361  FD05  A9 3C              LDA #$3C
02362  FD07  8D 11 E8           STA PIAL1
02363  FD0A  A9 3D              LDA #$3D
02364  FD0C  8D 13 E8           STA PIAS
02365  FD0F  A2 0C              LDX #12
02366  FD11  20 1B FD           JSR BSIV
02367  FD14  28                 PLP
02368  FD15  60                 RTS
02369  FD16  20 FB FC    STKY   JSR TNIF
02370  FD19  F0 9D              BEQ WRTBK
02371  FD1B  BD 28 FD    BSIV   LDA BSIT,X
02372  FD1E  8D 19 02           STA CINV
02373  FD21  BD 29 FD           LDA BSIT+1,X
02374  FD24  8D 1A 02           STA CINV+1
02375  FD27  60                 RTS
02376  FD28  C2 FD       BSIT   .WOR BSYI1,BCI1,0,BCI2
02376  FD2A  80 FE 
02376  FD2C  00 00 
02376  FD2E  9E FE 
02377  FD30  CF FC              .WOR WRTZ,WRTN,KEY,READ
02377  FD32  21 FC 
02377  FD34  85 E6 
02377  FD36  5F F9 
02378  FD38  A2 FF       START  LDX #$FF
02379  FD3A  9A                 TXS
02380  FD3B  D8                 CLD
02381  FD3C  20 E1 E1           JSR CINT
02382  FD3F  AD 10 E8           LDA PIAL
02383  FD42  10 57              BPL LFD9B
02384  FD44  58                 CLI
02385  FD45  4C D2 E0           JMP INIT
02386  FD48  84 00       LFD48  STY 0
02387  FD4A  84 01              STY 0+1
02388  FD4C  A0 03              LDY #3
02389  FD4E  98          LFD4E  TYA
02390  FD4F  18                 CLC
02391  FD50  65 01              ADC 0+1
02392  FD52  45 02              EOR 0+2
02393  FD54  91 00              STA (0),Y
02394  FD56  C8                 INY
02395  FD57  D0 F5              BNE LFD4E
02396  FD59  E6 01              INC 0+1
02397  FD5B  E4 01              CPX 0+1
02398  FD5D  D0 EF              BNE LFD4E
02399  FD5F  84 00              STY 0
02400  FD61  84 01              STY 0+1
02401  FD63  A0 03              LDY #3
02402  FD65  98          LFD65  TYA
02403  FD66  18                 CLC
02404  FD67  65 01              ADC 0+1






TAPE WRITE & INIT......PAGE 0033

LINE# LOC   CODE        LINE


02405  FD69  45 02              EOR 0+2
02406  FD6B  D1 00              CMP (0),Y
02407  FD6D  D0 FE       LFD6D  BNE LFD6D
02408  FD6F  C8                 INY
02409  FD70  D0 F3              BNE LFD65
02410  FD72  E6 01              INC 0+1
02411  FD74  E4 01              CPX 0+1
02412  FD76  D0 ED              BNE LFD65
02413  FD78  4C 2D FE           JMP LFE2D
02414  FD7B  00                 BRK
02415  FD7C  B1 E3       VPRTY  LDA (SAL)Y
02416  FD7E  4D 79 02           EOR SHCNH
02417  FD81  8D 79 02           STA SHCNH
02418  FD84  E6 E3              INC SAL
02419  FD86  D0 02              BNE VP10
02420  FD88  E6 E4              INC SAH
02421  FD8A  20 90 FD    VP10   JSR WRT62
02422  FD8D  D0 ED              BNE VPRTY
02423  FD8F  60                 RTS
02424  FD90  A5 E4       WRT62  LDA SAH
02425  FD92  C5 E6              CMP EAH
02426  FD94  D0 04              BNE WRT64
02427  FD96  A5 E3              LDA SAL
02428  FD98  C5 E5              CMP EAL
02429  FD9A  60          WRT64  RTS
02430  FD9B              .FIL   DIAG
02431  FD9B              L00    =$00
02432  FD9B              L02    =$02
02433  FD9B  8E 11 E8    LFD9B  STX PIAL1
02434  FD9E  8E 10 E8           STX PIAL
02435  FDA1  A9 04              LDA #$04
02436  FDA3  8D 11 E8           STA PIAL1
02437  FDA6  8D 10 E8           STA PIAL
02438  FDA9  20 1B FD           JSR BSIV
02439  FDAC  CA                 DEX
02440  FDAD  8E 44 E8           STX TIL
02441  FDB0  2C 12 E8           BIT PIAK
02442  FDB3  2C 13 E8    LFDB3  BIT PIAS
02443  FDB6  10 FB              BPL LFDB3
02444  FDB8  8E 45 E8           STX TIH
02445  FDBB  2C 12 E8           BIT PIAK
02446  FDBE  58                 CLI
02447  FDBF  4C BF FD           JMP *
02448  FDC2  AD 44 E8    BSYI1  LDA TIL
02449  FDC5  AC 45 E8           LDY TIH
02450  FDC8  2C 13 E8           BIT PIAS
02451  FDCB  10 FE              BPL *
02452  FDCD  29 C0              AND #$C0
02453  FDCF  C9 C0              CMP #$C0
02454  FDD1  D0 FE              BNE *
02455  FDD3  C0 BE              CPY #$BE
02456  FDD5  D0 FE              BNE *
02457  FDD7  CE 13 E8           DEC PIAS
02458  FDDA  2C 12 E8           BIT PIAK
02459  FDDD  A9 00              LDA #$00






TAPE WRITE & INIT......PAGE 0034

LINE# LOC   CODE        LINE


02460  FDDF  8D 79 02           STA SHCNH
02461  FDE2  85 E3              STA SAL
02462  FDE4  85 E5              STA EAL
02463  FDE6  A8                 TAY
02464  FDE7  A2 C0              LDX #>$C000
02465  FDE9  86 E4              STX SAH
02466  FDEB  A2 E8              LDX #>$E800
02467  FDED  86 E6              STX EAH
02468  FDEF  20 7C FD           JSR VPRTY
02469  FDF2  A2 F0              LDX #>$F000
02470  FDF4  86 E4              STX SAH
02471  FDF6  84 E6              STY EAH
02472  FDF8  20 7C FD           JSR VPRTY
02473  FDFB  CC 79 02           CPY SHCNH
02474  FDFE  D0 FE              BNE *
02475  FE00  A0 FF              LDY #$FF
02476  FE02  84 02              STY L02
02477  FE04  C8                 INY
02478  FE05  84 00              STY L00
02479  FE07  A9 10              LDA #>$1000
02480  FE09  85 01              STA L00+1
02481  FE0B  A2 20              LDX #$20
02482  FE0D  B1 00       LFE0D  LDA (L00),Y
02483  FE0F  45 02              EOR L02
02484  FE11  91 00              STA (L00),Y
02485  FE13  D1 00              CMP (L00),Y
02486  FE15  F0 01              BEQ LFE18
02487  FE17  C8                 INY
02488  FE18  E6 01       LFE18  INC L00+1
02489  FE1A  E4 01              CPX L00+1
02490  FE1C  D0 EF              BNE LFE0D
02491  FE1E  C0 00              CPY #$00
02492  FE20  F0 08              BEQ LFE2A
02493  FE22  C0 10              CPY #$10
02494  FE24  D0 FE              BNE *
02495  FE26  A2 10              LDX #$10
02496  FE28  A0 00              LDY #$00
02497  FE2A  4C 48 FD    LFE2A  JMP LFD48
02498  FE2D  E6 02       LFE2D  INC L02
02499  FE2F  C4 02              CPY L02
02500  FE31  F0 F7              BEQ LFE2A
02501  FE33  8C 11 E8           STY PIAL1
02502  FE36  A9 0F              LDA #$0F
02503  FE38  8D 10 E8           STA PIAL
02504  FE3B  A9 3C              LDA #$3C
02505  FE3D  8D 11 E8           STA PIAL1
02506  FE40  A9 FD              LDA #$FD
02507  FE42  A2 09              LDX #$09
02508  FE44  8E 10 E8    LFE44  STX PIAL
02509  FE47  CD 12 E8           CMP PIAK
02510  FE4A  D0 FE              BNE *
02511  FE4C  4A                 LSR A
02512  FE4D  90 02              BCC LFE51
02513  FE4F  09 80              ORA #$80
02514  FE51  CA          LFE51  DEX






TAPE WRITE & INIT......PAGE 0035

LINE# LOC   CODE        LINE


02515  FE52  10 F0              BPL LFE44
02516  FE54  8E 10 E8           STX PIAL
02517  FE57  EC 12 E8           CPX PIAK
02518  FE5A  D0 FE              BNE *
02519  FE5C  8C 11 E8           STY PIAL1
02520  FE5F  8C 10 E8           STY PIAL
02521  FE62  A9 3C              LDA #$3C
02522  FE64  8D 11 E8           STA PIAL1
02523  FE67  A2 02              LDX #2
02524  FE69  20 1B FD           JSR BSIV
02525  FE6C  A2 F7              LDX #$F7
02526  FE6E  8E 40 E8           STX PIA
02527  FE71  EE 11 E8           INC PIAL1
02528  FE74  2C 10 E8           BIT PIAL
02529  FE77  58                 CLI
02530  FE78  0E 40 E8           ASL PIA
02531  FE7B  4E 40 E8           LSR PIA
02532  FE7E  D0 FE              BNE *
02533  FE80  CE 11 E8    BCI1   DEC PIAL1
02534  FE83  10 FE              BPL *
02535  FE85  2C 10 E8           BIT PIAL
02536  FE88  A2 06              LDX #6
02537  FE8A  20 1B FD           JSR BSIV
02538  FE8D  2C 40 E8           BIT PIA
02539  FE90  A9 90              LDA #$90
02540  FE92  8D 4E E8           STA IER
02541  FE95  58                 CLI
02542  FE96  0E 40 E8           ASL PIA
02543  FE99  4E 40 E8           LSR PIA
02544  FE9C  D0 FE              BNE *
02545  FE9E  2C 4D E8    BCI2   BIT IFR
02546  FEA1  10 FE              BPL *
02547  FEA3  A9 7F              LDA #$7F
02548  FEA5  8D 4E E8           STA IER
02549  FEA8  2C 40 E8           BIT PIA
02550  FEAB  4C C3 FE           JMP LFEC3
02551  FEAE  2C 41 E8    LFEAE  BIT SYNC
02552  FEB1  70 FB              BVS LFEAE
02553  FEB3  2C 4F E8    LFEB3  BIT SYNC1
02554  FEB6  50 FB              BVC LFEB3
02555  FEB8  2C 4F E8    LFEB8  BIT SYNC1
02556  FEBB  70 FB              BVS LFEB8
02557  FEBD  AD 4D E8           LDA IFR
02558  FEC0  29 02              AND #$02
02559  FEC2  60                 RTS
02560  FEC3  A2 0A       LFEC3  LDX #10
02561  FEC5  2C 41 E8    LFEC5  BIT SYNC
02562  FEC8  10 FB              BPL LFEC5
02563  FECA  2C 41 E8    LFECA  BIT SYNC
02564  FECD  30 FB              BMI LFECA
02565  FECF  CA          LFECF  DEX
02566  FED0  D0 FD              BNE LFECF
02567  FED2  2C 41 E8           BIT SYNC
02568  FED5  30 02              BMI LFED9
02569  FED7  10 FE              BPL *






TAPE WRITE & INIT......PAGE 0036

LINE# LOC   CODE        LINE


02570  FED9  EE FF FF    LFED9  INC $FFFF
02571  FEDC  2C 41 E8           BIT SYNC
02572  FEDF  30 FE              BMI *
02573  FEE1  2C 41 E8    LFEE1  BIT SYNC
02574  FEE4  50 FB              BVC LFEE1
02575  FEE6  2C 41 E8    LFEE6  BIT SYNC
02576  FEE9  70 FB              BVS LFEE6
02577  FEEB  2C 41 E8    LFEEB  BIT SYNC
02578  FEEE  50 FB              BVC LFEEB
02579  FEF0  2C 41 E8    LFEF0  BIT SYNC
02580  FEF3  70 FB              BVS LFEF0
02581  FEF5  20 F0 E1           JSR LE1F0
02582  FEF8  20 AE FE           JSR LFEAE
02583  FEFB  D0 FE              BNE *
02584  FEFD  A0 00              LDY #$00
02585  FEFF  A9 A0       LFEFF  LDA #$A0
02586  FF01  91 E0              STA (PNT),Y
02587  FF03  20 AE FE           JSR LFEAE
02588  FF06  F0 FE              BEQ *
02589  FF08  A9 20              LDA #$20
02590  FF0A  91 E0              STA (PNT),Y
02591  FF0C  20 AE FE           JSR LFEAE
02592  FF0F  D0 FE              BNE *
02593  FF11  C0 E7              CPY #$E7
02594  FF13  D0 06              BNE LFF1B
02595  FF15  A9 83              LDA #$83
02596  FF17  C5 E1              CMP PNT+1
02597  FF19  F0 09              BEQ LFF24
02598  FF1B  C8          LFF1B  INY
02599  FF1C  D0 E1              BNE LFEFF
02600  FF1E  E6 E1              INC PNT+1
02601  FF20  D0 DD              BNE LFEFF
02602  FF22  F0 FE              BEQ *
02603  FF24  98          LFF24  TYA
02604  FF25  91 E0              STA (PNT),Y
02605  FF27  88                 DEY
02606  FF28  C0 FF              CPY #$FF
02607  FF2A  D0 F8              BNE LFF24
02608  FF2C  C6 E1              DEC PNT+1
02609  FF2E  A9 7F              LDA #$7F
02610  FF30  C5 E1              CMP PNT+1
02611  FF32  D0 F0              BNE LFF24
02612  FF34  A9 34              LDA #$34
02613  FF36  8D 11 E8           STA PIAL1
02614  FF39  20 AE FE           JSR LFEAE
02615  FF3C  D0 FE              BNE *
02616  FF3E  A9 3C              LDA #$3C
02617  FF40  8D 11 E8           STA PIAL1
02618  FF43  A6 00              LDX L00
02619  FF45  8E 22 E8    LFF45  STX IEEO
02620  FF48  EC 20 E8           CPX IEEI
02621  FF4B  D0 FE              BNE *
02622  FF4D  E8                 INX
02623  FF4E  D0 F5              BNE LFF45
02624  FF50  2C 20 E8           BIT IEEI






TAPE WRITE & INIT......PAGE 0037

LINE# LOC   CODE        LINE


02625  FF53  A9 FB              LDA #$FB
02626  FF55  8D 40 E8           STA PIA
02627  FF58  2C 21 E8           BIT IEEIS
02628  FF5B  10 FE              BPL *
02629  FF5D  2C 40 E8           BIT PIA
02630  FF60  50 FE              BVC *
02631  FF62  4A                 LSR A
02632  FF63  8D 40 E8           STA PIA
02633  FF66  2C 40 E8           BIT PIA
02634  FF69  70 FE              BVS *
02635  FF6B  10 FE              BPL *
02636  FF6D  A9 34              LDA #$34
02637  FF6F  8D 23 E8           STA IEEOS
02638  FF72  AD 40 E8           LDA PIA
02639  FF75  30 FE              BMI *
02640  FF77  4A                 LSR A
02641  FF78  90 FE              BCC *
02642  FF7A  A9 34              LDA #$34
02643  FF7C  8D 21 E8           STA IEEIS
02644  FF7F  4E 40 E8           LSR PIA
02645  FF82  B0 FE              BCS *
02646  FF84  A9 02              LDA #$02
02647  FF86  8D 43 E8           STA P2DA
02648  FF89  8D 41 E8           STA SYNC
02649  FF8C  2C 10 E8           BIT PIAL
02650  FF8F  50 FE              BVC *
02651  FF91  8E 41 E8           STX SYNC
02652  FF94  2C 10 E8           BIT PIAL
02653  FF97  50 05              BVC LFF9E
02654  FF99  EA                 NOP
02655  FF9A  EA                 NOP
02656  FF9B  4C 9B FF           JMP *
02657  FF9E  8E 11 E8    LFF9E  STX PIAL1
02658  FFA1  A0 0F              LDY #$0F
02659  FFA3  8C 10 E8           STY PIAL
02660  FFA6  0A                 ASL A
02661  FFA7  8D 11 E8           STA PIAL1
02662  FFAA  49 FF              EOR #$FF
02663  FFAC  8D 10 E8           STA PIAL
02664  FFAF  4C AF FF           JMP *
02665  FFB2              .FIL   OB7SRC
02666  FFB2                     *=$7FC0+OFFSET
02667  FFC0  4C 2A F5           JMP OPEN
02668  FFC3  4C C8 F2           JMP CLOSE
02669  FFC6  4C 8B F7           JMP CHKIN
02670  FFC9  4C DC F7           JMP CKOUT
02671  FFCC  4C 7D F2           JMP CLRCH
02672  FFCF  4C DF F1    KBASIN JMP BASIN
02673  FFD2  4C 30 F2    KBSOUT JMP BSOUT
02674  FFD5  4C 46 F3           JMP LOAD
02675  FFD8  4C 9E F6           JMP SAVE
02676  FFDB  4C BB F4           JMP VER
02677  FFDE  4C 95 F6           JMP SYS
02678  FFE1  4C 39 F3           JMP STOP
02679  FFE4  4C CC F1           JMP GETIN






TAPE WRITE & INIT......PAGE 0038

LINE# LOC   CODE        LINE


02680  FFE7  4C A4 F2           JMP CLALL
02681  FFEA  4C 36 F7    KUDTIM JMP UDTIM
02682  FFED  A9 3C       TNOF   LDA #$3C
02683  FFEF  8D 13 E8           STA PIAS
02684  FFF2  AD 40 E8           LDA PIA
02685  FFF5  09 10              ORA #$10
02686  FFF7  8D 40 E8           STA PIA
02687  FFFA  60                 RTS
02688  FFFB                     *=$FFFC
02689  FFFC  38 FD              .WOR START
02690  FFFE  6B E6              .WOR PULS
02691  0000              .END


ERRORS = 00000


SYMBOL TABLE

SYMBOL VALUE
 ACP00    F194    ACP01    F199    ACP03    F1B5    ACP05    F1C0
 ACPTR    F187    ACR      E84B    BAD      0100    BASIN    F1DF
 BCI1     FE80    BCI2     FE9E    BDF      0002    BDFH     0004
 BK1      E428    BK2      E433    BKLN     E3C4    BKLN1    E3D0
 BLF      0001    BLKL     E65D    BLKLN    E648    BLNCT    0225
 BLNON    0227    BLNSW    0224    BN10     F1F1    BN20     F200
 BN30     F227    BN32     F22C    BN35     F22D    BO10     F241
 BO20     F247    BO21     F248    BSIT     FD28    BSIV     FD1B
 BSOUR    0222    BSOUT    F230    BSTOP    C71C    BSYI1    FDC2
 BUF      0000    BUFPT    0271    BUFSZ    00C0    C3P0     021D
 CAS1     0207    CAS2     0208    CBINV    021B    CHAR     E75C
 CHKIN    F78B    CHKOUT   F7DC    CHRGOT   00C8    CI2      F171
 CI4      F176    CINT     E1E1    CINV     0219    CIOUT    F167
 CK10     F7F8    CKERR    0020    CKIS1    E74B    CKIT     E709
 CKIT1    E714    CKOUT    F7DC    CKUT     E75B    CLALL    F2A4
 CLOS10   F2D2    CLOS5    F2CD    CLOSE    F2C8    CLP1     E33A
 CLP2     E327    CLP21    E338    CLP2A    E335    CLP5     E2D1
 CLP6     E2DA    CLP7     E348    CLRCH    F27D    CLRCHN   F27D
 CLSE1    F6E6    CLSR     E236    CMP0     00E7    CNC3     E43D
 CNC3X    E419    CNTDN    0270    CRFAC    0205    CRSW     0260
 CS10     F85E    CS20     F868    CS25     F870    CS30     F842
 CS40     F851    CSTE1    F83B    CSTE2    F871    DATA     00F6
 DFLTN    0263    DFLTO    0264    DIFF     00EC    DPSW     0266
 DSPP     E7AC    DSPP1    E7AD    EAH      00E6    EAL      00E5
 EOT      0005    ER001    F14B    ERMSG    F57B    ERR01    F13D
 ERRP0    F13B    ERRP1    F146    ERRP7    F142    FA       00F1
 FAF      F495    FAF20    F4A3    FAF30    F4B9    FAF40    F4BA
 FAH      F5AE    FAH30    F5B2    FAH40    F5DD    FAH45    F5DB
 FAH50    F5C5    FAH55    F5D1    FAT      024C    FCLOSE   F2CD
 FINI     C430    FIRT     026F    FLOAD    C581    FNADR    00F9
 FNLEN    00EE    FOPEN    F52F    FRESTR   D57B    FRMEVL   CCB8
 FRMNUM   CCA4    FSBLK    00FD    GDBLN    0226    GETADR   D6D0
 GETBYT   D676    GETIN    F1CC    IEEI     E820    IEEIS    E821
 IEEO     E822    IEEOS    E823    IER      E84E    IFR      E84D








SYMBOL TABLE

SYMBOL VALUE
 INDEX1   0071    INDX     021E    INIT     E0D2    INS1     E4C0
 INS2     E4C2    INS3     E4B9    INSRT    00FB    ISOUR    F0F1
 ISR0     F111    ISR1     F107    ISR2     F116    ISR3     F121
 JLP2     E52D    JLTLK    F2AB    JPL3     E476    JPL4     E45F
 JRAD2    F9B8    JRADJ    F995    JSTS     E368    JSTS1    E383
 JSTS2    E3B1    JSTSX    E397    JSXB     E3A3    JTG10    F218
 JTG35    F223    JTGET    F205    JTP10    F273    JTP20    F82D
 JTS2     E3A4    JX120    F307    JX150    F30A    JX170    F329
 JX300    F79B    JX305    F79D    JX310    F7A0    JX320    F7B5
 JX330    F7BB    JX3301   F7BC    JX340    F7C9    JX350    F7D0
 JX360    F806    JX370    F80C    JX380    F81A    JX390    F821
 JX600    F2AE    JX750    F28B    JX770    F299    JZ100    F2B8
 JZ101    F2C7    KBASIN   FFCF    KBSOUT   FFD2    KEY      E685
 KEY3     E6D4    KEY4     E6B0    KEY5     E6A6    KEYD     020F
 KEYF     E739    KL1      E701    KL2      E6DE    KL22     E6F7
 KL23     E6EA    KL24     E6DB    KL25     E6F4    KN1      E72C
 KUDTIM   FFEA    L00      0000    L02      0002    L026A    026A
 LA       00EF    LASTWR   E1E1    LAT      0242    LBERR    0008
 LD10     F34B    LD100    F3A5    LD105    F411    LD11     F350
 LD110    F417    LD112    F3AE    LD115    F421    LD120    F3B7
 LD150    F3BA    LD170    F3BF    LD20     F366    LD205    F3F9
 LD210    F3E5    LD30     F37B    LD300    F3FF    LD40     F37E
 LD400    F422    LD410    F42B    LD50     F39A    LD60     F39C
 LDAD1    F67D    LDAD2    F64D    LDAD3    F654    LDTB1    0229
 LDTB2    E7BC    LDTND    0262    LE1F0    E1F0    LE241    E241
 LE273    E273    LE275    E275    LE6AC    E6AC    LE6AD    E6AD
 LE73F    E73F    LF253    F253    LF2EA    F2EA    LF304    F304
 LF3CC    F3CC    LF53B    F53B    LF5E3    F5E3    LF5E7    F5E7
 LF71C    F71C    LF720    F720    LF724    F724    LF735    F735
 LF9CA    F9CA    LFD48    FD48    LFD4E    FD4E    LFD65    FD65
 LFD6D    FD6D    LFD9B    FD9B    LFDB3    FDB3    LFE0D    FE0D
 LFE18    FE18    LFE2A    FE2A    LFE2D    FE2D    LFE44    FE44
 LFE51    FE51    LFEAE    FEAE    LFEB3    FEB3    LFEB8    FEB8
 LFEC3    FEC3    LFEC5    FEC5    LFECA    FECA    LFECF    FECF
 LFED9    FED9    LFEE1    FEE1    LFEE6    FEE6    LFEEB    FEEB
 LFEF0    FEF0    LFEFF    FEFF    LFF1B    FF1B    LFF24    FF24
 LFF45    FF45    LFF9E    FF9E    LINNUM   0008    LIST1    F0BC
 LIST2    F0E1    LIST4    F0E7    LISTN    F0BA    LNMX     00F2
 LOAD     F346    LOADNP   F34E    LOOP2    E38A    LOOP3    E297
 LOOP4    E294    LOOP5    E2FA    LOP2     E392    LOP5     E303
 LOP51    E309    LOP52    E319    LOP53    E31D    LOP54    E313
 LP1      E282    LP2      E27D    LP21     E2B0    LP22     E2C8
 LP23     E2BD    LPS1     E254    LPS3     E257    LPS4     E245
 LSTP     0221    LSTX     0203    LSXP     0220    MLP1     E574
 MLP2     E58D    MLP4     E5CA    MLP41    E5CD    MLP42    E5D8
 MS1      F000    MS10     F05F    MS11     F064    MS12     F06E
 MS13     F074    MS15     F086    MS16     F094    MS17     F0A3
 MS18     F0AA    MS19     F0AE    MS2      F00E    MS20     F039
 MS21     F06D    MS22     F060    MS3      F017    MS4      F024
 MS5      F032    MS6      F03D    MS7      F041    MS8      F04D
 MS9      F056    MSG      E7DE    MYCH     00FE    NC1      E447
 NC2      E44E    NC3      E35D    NC3W     E440    NCX2     E464
 NCZ2     E461    NDX      020D    NELL     E63B    NEWCH    FBEC
 NEWL1    E619    NEWLA    E627    NEWLN    E605    NEWLX    E617
 NJT1     E406    NTCN     E412    NTCN1    E439    NTCN2    E3DB








SYMBOL TABLE

SYMBOL VALUE
 NVS      E35F    NVS1     E365    NXLN     E530    NXLN1    E53E
 NXLN2    E536    NXT1     E548    NXT2     E50E    NXT3     E358
 NXT33    E356    NXT6     E517    NXT61    E526    NXTD     E269
 NXTX     E48F    NXTX1    E497    OCHAR    00FC    OFFSET   8000
 OP100    F53D    OP150    F566    OP160    F579    OP170    F58B
 OP171    F59A    OP172    F5AA    OP175    F5AD    OP200    F592
 OP35     F482    OP37     F47D    OP40     F488    OP45     F492
 OP98     F534    OPEN     F52A    OPENI    F462    OPENIB   F475
 P2DA     E843    P2DB     E842    PARS1    F433    PARS2    F4D4
 PCNTR    026C    PCR      E84C    PIA      E840    PIAK     E812
 PIAL     E810    PIAL1    E811    PIAS     E813    PNT      00E0
 PNTR     00E2    POINT    00E1    PR060    F45B    PR070    F45C
 PR100    F4F6    PR130    F522    PR140    F515    PR147    F51C
 PR150    F51D    PR200    F504    PREND    E67E    PREND0   E73C
 PRP      00ED    PRT      E3EA    PRT1     E479    PRT2     E481
 PRTY     0265    PTR1     0276    PTR2     0277    PULS     E66B
 PULS1    E67B    PX1      E1ED    QTSW     00EA    QTSWC    E349
 QTSWL    E355    RAD2     FA4A    RAD2X    FA5B    RAD2Y    FA53
 RAD3     FA07    RAD3G    FA29    RAD4     FA2E    RAD5     F9CE
 RADBK    FA04    RADJ     FAA3    RADK     FA94    RADL     F9CB
 RADP     F9FA    RADQ     FA6C    RADQ1    FA70    RADQ2    FA84
 RADR1    FA9B    RADS     F97F    RADX2    F9C5    RBLK     F87F
 RCNT     0268    RD1      F96D    RD10     FAD1    RD12     FACC
 RD15     FAB5    RD160    FBA5    RD161    FBA7    RD167    FBB1
 RD175    FBBF    RD180    FBD9    RD20     FAD4    RD200    FAF2
 RD22     FAEB    RD3      F981    RD300    FBDC    RD40     FB06
 RD52     FB87    RD55     FB8B    RD56     FB45    RD58     FB5A
 RD59     FB92    RD60     FB0D    RD70     FB1B    RD80     FB3A
 RD90     FB9D    RDBK     F9E5    RDBK2    FAA0    RDFLG    0278
 READ     F95F    RER      0274    REZ      0275    RJDJ     F998
 ROUT1    FA14    ROUT2    FA12    RSTOR    F277    RUNTB    E7D5
 RVS      020E    SA       00F0    SAH      00E4    SAL      00E3
 SAT      0256    SATUS    020C    SAVE     F69E    SBERR    0004
 SCATN    F132    SCRL     E3AA    SCRL1    E56D    SCRL3    E5A9
 SCRL4    E599    SCRL5    E59D    SCROL    E559    SECND    F12C
 SFDX     0223    SFST     0204    SHCNH    0279    SHCNL    0273
 SNERR    CE1C    SNSW     021F    SNSW1    00EB    SPCK     E758
 SPERR    0010    SPMSG    F33F    SR       E84A    SRER     F9BC
 STAH     00F8    STAL     00F7    START    FD38    STKEY    0209
 STKY     FD16    STOP     F339    STOP1    F32A    STOP2    F338
 STOP3    F92B    STT1     F92E    STT2     F943    STT3     F94A
 STUPR    E604    STUPT    E5DB    STUPZ    E5FA    STXTPT   C59A
 SV10     F6B5    SV100    F6F6    SV105    F708    SV20     F6BA
 SV30     F6CE    SV50     F6E3    SVXT     020A    SYNC     E841
 SYNC1    E84F    SYNCHR   CE13    SYNO     0228    SYS      F695
 T1       00E9    T2       0268    T2H      E849    T2L      E848
 T3       0269    TALK     F0B6    TAPE     F8D2    TAPE1    027A
 TAPE2    033A    TAPEH    F5ED    TBLX     00F5    TBUF     00F3
 TEMP     00E8    TH20     F61E    TH30     F632    TIH      E845
 TIL      E844    TILH     E847    TILL     E846    TIME     0200
 TKATN    F161    TKSA     F15B    TNIF     FCFB    TNOF     FFED
 TP20     F8EB    TP30     F8F6    TP40     F8FA    TP50     F912
 TRD      F88A    TRD2     F8B4    TSTOP    F91E    TWAIT    F913
 TWRT     F8BC    TWRT2    F8C4    TXTPTR   00C9    TYPERR   C379
 UD10     F743    UD20     F74E    UD30     F75B    UD40     F75D








SYMBOL TABLE

SYMBOL VALUE
 UD45     F76C    UD50     F774    UD60     F77C    UD65     F787
 UD70     F788    UDST     FBE5    UDTIM    F736    UNLSN    F17E
 UNLSN1   F180    UNTLK    F17A    UP1      E4EE    UP2      E4DE
 UP3      E4FE    UP5      E4A5    UP6      E4D9    UP9      E4D5
 VARTAB   007C    VER      F4BB    VER10    F4CF    VERCK    020B
 VP10     FD8A    VPRTY    FD7C    WBLK     F8B9    WREND    FCC2
 WRITE    FC00    WRNC     FCBB    WRT1     FC09    WRT2     FC68
 WRT3     FC65    WRT4     FCB1    WRT6     FC90    WRT61    FC8C
 WRT62    FD90    WRT64    FD9A    WRT7     FC9F    WRTBK    FCB8
 WRTL3    FC1C    WRTN     FC21    WRTN1    FC39    WRTN2    FC48
 WRTS     FC74    WRTS1    FC81    WRTW     FC07    WRTX     FC0B
 WRTZ     FCCF    WSW      0267    XSAV     0261    ZZ10     F67C
 ZZZ      F667   

END OF ASSEMBLY
